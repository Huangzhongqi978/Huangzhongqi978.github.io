[{"title":"åŸºäºSpring Cloudä¸Vue3çš„AIæ™ºèƒ½ç­”é¢˜ç³»ç»Ÿ","url":"/2025/01/27/AI%E6%99%BA%E8%83%BD%E7%AD%94%E9%A2%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/","content":"åŸºäºSpring Cloudå¾®æœåŠ¡æ¶æ„çš„AIæ™ºèƒ½ç­”é¢˜ç³»ç»Ÿï¼Œé›†æˆäº†ç°ä»£åˆ†å¸ƒå¼æŠ€æœ¯æ ˆä¸äººå·¥æ™ºèƒ½èƒ½åŠ›ï¼Œä¸ºç”¨æˆ·æä¾›æ™ºèƒ½åŒ–çš„é¢è¯•é¢˜ç»ƒä¹ ä¸AIè¾…åŠ©ç­”é¢˜æœåŠ¡ã€‚ç³»ç»Ÿé‡‡ç”¨äº‘åŸç”Ÿæ¶æ„è®¾è®¡ï¼Œå…·å¤‡é«˜å¯ç”¨ã€é«˜å¹¶å‘ã€å¯æ‰©å±•çš„ç‰¹æ€§ã€‚\n\n\nç³»ç»Ÿæ¦‚è¿°æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºSpring Cloudå¾®æœåŠ¡æ¶æ„çš„AIæ™ºèƒ½ç­”é¢˜å¹³å°ï¼Œæ—¨åœ¨ä¸ºç”¨æˆ·æä¾›æ™ºèƒ½åŒ–çš„é¢è¯•é¢˜ç»ƒä¹ æœåŠ¡ã€‚ç³»ç»Ÿé›†æˆäº†OpenAIå¤§è¯­è¨€æ¨¡å‹ã€é˜¿é‡Œäº‘è¯­éŸ³åˆæˆã€åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ç­‰å…ˆè¿›æŠ€æœ¯ï¼Œæ„å»ºäº†å®Œæ•´çš„æ™ºèƒ½ç­”é¢˜ç”Ÿæ€ã€‚\næ ¸å¿ƒç‰¹æ€§\næ™ºèƒ½AIç­”é¢˜ï¼šé›†æˆOpenAI GPTæ¨¡å‹ï¼Œæä¾›æ™ºèƒ½é¢˜ç›®ç”Ÿæˆä¸ç­”æ¡ˆè¯„ä¼°\nå¤šæ¨¡æ€äº¤äº’ï¼šæ”¯æŒæ–‡æœ¬ã€è¯­éŸ³ç­‰å¤šç§äº¤äº’æ–¹å¼\nåˆ†å¸ƒå¼æ¶æ„ï¼šåŸºäºSpring Cloudå¾®æœåŠ¡æ¶æ„ï¼Œæ”¯æŒæ°´å¹³æ‰©å±•\näº‘åŸç”Ÿéƒ¨ç½²ï¼šé›†æˆNacosé…ç½®ä¸­å¿ƒã€Redisç¼“å­˜ã€MinIOå¯¹è±¡å­˜å‚¨\næ™ºèƒ½å®¡æ ¸ï¼šAIè‡ªåŠ¨å®¡æ ¸ç”¨æˆ·æäº¤çš„é¢˜ç›®å†…å®¹\n\nç³»ç»Ÿæ¶æ„è®¾è®¡æ•´ä½“æ¶æ„å›¾graph TB\n    %% ç”¨æˆ·å±‚\n    subgraph \"ç”¨æˆ·å±‚\"\n        A[Webå‰ç«¯]\n        B[ç§»åŠ¨ç«¯H5]\n        C[å¾®ä¿¡å°ç¨‹åº]\n    end\n\n    %% ç½‘å…³å±‚\n    subgraph \"ç½‘å…³å±‚\"\n        D[Spring Cloud Gateway]\n    end\n\n    %% ä¸šåŠ¡æœåŠ¡å±‚\n    subgraph \"ä¸šåŠ¡æœåŠ¡å±‚\"\n        subgraph \"ç”¨æˆ·æœåŠ¡æ¨¡å—\"\n            E1[ç”¨æˆ·æ³¨å†Œ/ç™»å½•]\n            E2[ç”¨æˆ·ä¿¡æ¯ç®¡ç†]\n            E3[æƒé™æ§åˆ¶]\n        end\n        \n        subgraph \"é¢˜åº“æœåŠ¡æ¨¡å—\"\n            F1[é¢˜ç›®ç®¡ç†]\n            F2[åˆ†ç±»ç®¡ç†]\n            F3[å›¾ç‰‡ä¸Šä¼ ]\n            F4[åˆ·é¢˜è®°å½•]\n        end\n        \n        subgraph \"AIæœåŠ¡æ¨¡å—\"\n            G1[æ™ºèƒ½ç­”é¢˜]\n            G2[è¯­éŸ³åˆæˆ]\n            G3[OpenAIé›†æˆ]\n        end\n        \n        subgraph \"å®‰å…¨æœåŠ¡æ¨¡å—\"\n            H1[JWTè®¤è¯]\n            H2[æƒé™æ ¡éªŒ]\n            H3[å®‰å…¨æ§åˆ¶]\n        end\n    end\n\n    %% åŸºç¡€è®¾æ–½å±‚\n    subgraph \"åŸºç¡€è®¾æ–½å±‚\"\n        subgraph \"æ¶ˆæ¯é˜Ÿåˆ—\"\n            I1[RabbitMQ]\n        end\n        \n        subgraph \"ç¼“å­˜æœåŠ¡\"\n            J1[Redis]\n        end\n        \n        subgraph \"æ–‡ä»¶å­˜å‚¨\"\n            K1[MinIO]\n        end\n        \n        subgraph \"é…ç½®ä¸­å¿ƒ\"\n            L1[Nacos]\n        end\n        \n        subgraph \"æ•°æ®åº“\"\n            M1[MySQL]\n        end\n    end\n\n    %% è¿æ¥å…³ç³»\n    A --> D\n    B --> D\n    C --> D\n    \n    D --> E1\n    D --> E2\n    D --> E3\n    D --> F1\n    D --> F2\n    D --> F3\n    D --> F4\n    D --> G1\n    D --> G2\n    D --> G3\n    D --> H1\n    D --> H2\n    D --> H3\n\n    E1 --> I1\n    E2 --> J1\n    E3 --> M1\n    F1 --> M1\n    F2 --> M1\n    F3 --> K1\n    F4 --> M1\n    G1 --> I1\n    G2 --> K1\n    G3 --> I1\n    H1 --> J1\n    H2 --> M1\n    H3 --> L1\n\n    %% æ ·å¼\n    classDef userLayer fill:#e1f5fe\n    classDef gatewayLayer fill:#f3e5f5\n    classDef serviceLayer fill:#e8f5e8\n    classDef infraLayer fill:#fff3e0\n\n    class A,B,C userLayer\n    class D gatewayLayer\n    class E1,E2,E3,F1,F2,F3,F4,G1,G2,G3,H1,H2,H3 serviceLayer\n    class I1,J1,K1,L1,M1 infraLayer\n\næŠ€æœ¯æ ˆé€‰å‹\n\n\næŠ€æœ¯åˆ†ç±»\næŠ€æœ¯é€‰å‹\nç‰ˆæœ¬\nä½œç”¨è¯´æ˜\n\n\n\nå¾®æœåŠ¡æ¡†æ¶\nSpring Cloud\n2023.0.0\nå¾®æœåŠ¡æ²»ç†æ¡†æ¶\n\n\næœåŠ¡æ³¨å†Œå‘ç°\nNacos\n2.2.0\næœåŠ¡æ³¨å†Œä¸é…ç½®ç®¡ç†\n\n\nç½‘å…³æœåŠ¡\nSpring Cloud Gateway\n4.0.0\nç»Ÿä¸€ç½‘å…³å…¥å£\n\n\næ•°æ®åº“\nMySQL\n8.0\nå…³ç³»å‹æ•°æ®åº“\n\n\nç¼“å­˜\nRedis\n7.0\nåˆ†å¸ƒå¼ç¼“å­˜\n\n\næ¶ˆæ¯é˜Ÿåˆ—\nRabbitMQ\n3.11\nå¼‚æ­¥æ¶ˆæ¯å¤„ç†\n\n\nå¯¹è±¡å­˜å‚¨\nMinIO\næœ€æ–°ç‰ˆ\nåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨\n\n\nAIæœåŠ¡\nOpenAI API\nGPT-4\nå¤§è¯­è¨€æ¨¡å‹\n\n\nè¯­éŸ³åˆæˆ\né˜¿é‡Œäº‘TTS\næœ€æ–°ç‰ˆ\næ–‡æœ¬è½¬è¯­éŸ³\n\n\nå‰ç«¯æ¡†æ¶\nVue3 + TypeScript\n3.3+\nç°ä»£åŒ–å‰ç«¯æ¡†æ¶\n\n\nç§»åŠ¨ç«¯\nuni-app\n3.0+\nè·¨å¹³å°ç§»åŠ¨åº”ç”¨\n\n\næ ¸å¿ƒæ¨¡å—å®ç°1. AIæœåŠ¡æ¨¡å—AIæœåŠ¡æ¨¡å—æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè´Ÿè´£æ™ºèƒ½ç­”é¢˜ã€è¯­éŸ³åˆæˆç­‰åŠŸèƒ½ã€‚\næ™ºèƒ½å¯¹è¯å®ç°@Service\n@Slf4j\npublic class ModelServiceImpl implements ModelService &#123;\n    private final ChatClient chatClient;\n    \n    /**\n     * æ™ºèƒ½å¯¹è¯å¤„ç†\n     * æ”¯æŒä¸‰ç§æ¨¡å¼ï¼šç³»ç»Ÿæ¨¡å¼ã€AIæ¨¡å¼ã€æ··åˆæ¨¡å¼\n     */\n    public Flux&lt;String> chat(ChatDto chatDto) &#123;\n        // è®°å½•AIä½¿ç”¨ç»Ÿè®¡\n        recordAi(chatDto.getNickname());\n        recordAiUser();\n        \n        // æ ¹æ®æ¨¡å¼åˆ†å‘å¤„ç†\n        if (chatDto.getModel().equals(AiConstant.SYSTEM_MODEL)) &#123;\n            return systemModel(chatDto);  // ç³»ç»Ÿé¢˜åº“æ¨¡å¼\n        &#125; else if (chatDto.getModel().equals(AiConstant.AI_MODEL)) &#123;\n            return aiModel(chatDto);      // AIç”Ÿæˆæ¨¡å¼\n        &#125;\n        return mixModel(chatDto);         // æ··åˆæ¨¡å¼\n    &#125;\n    \n    /**\n     * æ··åˆæ¨¡å¼å®ç°\n     * ä¼˜å…ˆä»ç³»ç»Ÿé¢˜åº“è·å–ï¼Œæ— åˆ™AIç”Ÿæˆ\n     */\n    private Flux&lt;String> mixModel(ChatDto chatDto) &#123;\n        Long currentId = SecurityUtils.getCurrentId();\n        String currentName = SecurityUtils.getCurrentName();\n        AiHistory aiHistory = getCurrentHistory(chatDto);\n        \n        if (aiHistory == null) &#123;\n            // é¦–æ¬¡å¯¹è¯ï¼Œæ ¡éªŒä¸“é¢˜æ˜¯å¦å­˜åœ¨\n            Long subjectId = disposeSystemModel(chatDto);\n            if (subjectId == null) &#123;\n                return verifyPrompt(chatDto, null);  // AIç”Ÿæˆ\n            &#125;\n            return sendRandomTopicToUser(chatDto);    // ç³»ç»Ÿé¢˜åº“\n        &#125; else &#123;\n            // å¤„ç†ç”¨æˆ·ç­”æ¡ˆè¯„ä¼°\n            return processUserAnswer(chatDto, aiHistory);\n        &#125;\n    &#125;\n&#125;\n\nè¯­éŸ³åˆæˆå®ç°/**\n * è¯­éŸ³åˆæˆæœåŠ¡\n * é›†æˆé˜¿é‡Œäº‘TTSï¼Œæ”¯æŒå¤šç§è¯­éŸ³ç±»å‹\n */\npublic ResponseEntity&lt;byte[]> tts(TtsDto text) &#123;\n    recordAiUser();  // è®°å½•ä½¿ç”¨ç»Ÿè®¡\n    \n    // æ„å»ºè¯­éŸ³åˆæˆå‚æ•°\n    SpeechSynthesisParam param = SpeechSynthesisParam.builder()\n            .apiKey(ttsProperties.getApiKey())\n            .model(ttsProperties.getModel())\n            .voice(ttsProperties.getVoice())\n            .build();\n    \n    // æ‰§è¡Œè¯­éŸ³åˆæˆ\n    SpeechSynthesizer synthesizer = new SpeechSynthesizer(param, null);\n    ByteBuffer audio = synthesizer.call(text.getText());\n    byte[] audioBytes = audio.array();\n    \n    // è®¾ç½®å“åº”å¤´\n    HttpHeaders headers = new HttpHeaders();\n    headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);\n    headers.set(HttpHeaders.CONTENT_DISPOSITION, \"inline; filename=output.mp3\");\n    \n    return ResponseEntity.ok()\n            .headers(headers)\n            .body(audioBytes);\n&#125;\n\n2. é¢˜åº“æœåŠ¡æ¨¡å—é¢˜åº“æœåŠ¡è´Ÿè´£é¢˜ç›®ç®¡ç†ã€åˆ†ç±»ç®¡ç†ã€ç”¨æˆ·åˆ·é¢˜è®°å½•ç­‰åŠŸèƒ½ã€‚\né¢˜ç›®ç®¡ç†å®ç°@Data\npublic class Topic extends BaseEntity &#123;\n    private String topicName;      // é¢˜ç›®æ ‡é¢˜\n    private String answer;         // æ ‡å‡†ç­”æ¡ˆ\n    private String aiAnswer;       // AIç”Ÿæˆç­”æ¡ˆ\n    private Integer sorted;        // æ’åº\n    private Integer isEveryday;   // æ˜¯å¦æ¯æ—¥ä¸€é¢˜\n    private Integer isMember;     // æ˜¯å¦ä¼šå‘˜ä¸“äº«\n    private Long viewCount;       // æµè§ˆæ¬¡æ•°\n    private Integer status;       // çŠ¶æ€\n    private String createBy;      // åˆ›å»ºè€…\n    private String failMsg;        // å¤±è´¥åŸå› \n&#125;\n\næ™ºèƒ½å®¡æ ¸å®ç°/**\n * AIæ™ºèƒ½å®¡æ ¸é¢˜ç›®å†…å®¹\n * è‡ªåŠ¨åˆ¤æ–­é¢˜ç›®è´¨é‡å¹¶ç”ŸæˆAIç­”æ¡ˆ\n */\npublic void auditTopic(TopicAudit topicAudit) &#123;\n    String topicName = topicAudit.getTopicName();\n    String subjectName = topicAudit.getTopicSubjectName();\n    String labelName = topicAudit.getTopicLabelName();\n    String answer = topicAudit.getAnswer();\n    \n    // æ„å»ºå®¡æ ¸æç¤ºè¯\n    String prompt = PromptConstant.AUDIT_TOPIC + \"\\n\" +\n            \"é¢è¯•é¢˜åç§°: ã€\" + topicName + \"ã€‘\\n\" +\n            \"ç”¨æˆ·è¾“å…¥çš„é¢è¯•é¢˜ç­”æ¡ˆ: ã€\" + answer + \"ã€‘\\n\" +\n            \"å…³è”æ ‡ç­¾: ã€\" + labelName + \"ã€‘\\n\" +\n            \"æ‰€å±ä¸“é¢˜: ã€\" + subjectName + \"ã€‘\\n\";\n    \n    // è°ƒç”¨AIå®¡æ ¸\n    String content = getAiContent(prompt, topicAudit.getAccount(), topicAudit.getUserId());\n    \n    // è§£æAIè¿”å›ç»“æœ\n    JSONObject jsonObject = JSON.parseObject(content);\n    boolean result = jsonObject.getBooleanValue(\"result\");\n    String reason = jsonObject.getString(\"reason\");\n    \n    Topic topic = new Topic();\n    topic.setId(topicAudit.getId());\n    if (result) &#123;\n        topic.setStatus(StatusEnums.NORMAL.getCode());\n        log.info(\"å®¡æ ¸é€šè¿‡: &#123;&#125;\", reason);\n    &#125; else &#123;\n        topic.setStatus(StatusEnums.AUDIT_FAIL.getCode());\n        topic.setFailMsg(reason);\n        log.warn(\"å®¡æ ¸æœªé€šè¿‡: &#123;&#125;\", reason);\n    &#125;\n    \n    // æ›´æ–°é¢˜ç›®çŠ¶æ€\n    topicFeignClient.auditTopic(topic);\n    recordAuditLog(reason, topicAudit.getAccount(), topicAudit.getUserId());\n&#125;\n\n3. ç”¨æˆ·æœåŠ¡æ¨¡å—ç”¨æˆ·æœåŠ¡è´Ÿè´£ç”¨æˆ·è®¤è¯ã€æƒé™ç®¡ç†ã€ç”¨æˆ·ä¿¡æ¯ç»´æŠ¤ç­‰åŠŸèƒ½ã€‚\nç”¨æˆ·å®ä½“è®¾è®¡@Data\npublic class SysUser extends BaseEntity &#123;\n    private String account;        // è´¦å·\n    private String avatar;         // å¤´åƒ\n    private String password;       // å¯†ç \n    private String email;         // é‚®ç®±\n    private Integer status;       // çŠ¶æ€\n    private LocalDateTime memberTime;  // ä¼šå‘˜æ—¶é—´\n    private String nickname;      // æ˜µç§°\n&#125;\n\nJWTè®¤è¯å®ç°/**\n * ç”¨æˆ·è®¤è¯æœåŠ¡\n * åŸºäºJWTå®ç°æ— çŠ¶æ€è®¤è¯\n */\n@Service\npublic class SecurityUserDetailsService implements UserDetailsService &#123;\n    \n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123;\n        // æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯\n        SysUser user = sysUserService.getByAccount(username);\n        if (user == null) &#123;\n            throw new UsernameNotFoundException(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n        &#125;\n        \n        // æŸ¥è¯¢ç”¨æˆ·æƒé™\n        List&lt;String> permissions = sysUserService.getPermissions(user.getId());\n        \n        // æ„å»ºç”¨æˆ·è¯¦æƒ…\n        return new SecurityUserDetails(user, permissions);\n    &#125;\n&#125;\n\n4. å®‰å…¨æœåŠ¡æ¨¡å—å®‰å…¨æœåŠ¡æä¾›ç»Ÿä¸€çš„è®¤è¯æˆæƒã€æƒé™æ ¡éªŒç­‰åŠŸèƒ½ã€‚\næƒé™æ ¡éªŒå®ç°/**\n * æƒé™æ ¡éªŒåˆ‡é¢\n * åŸºäºæ³¨è§£å®ç°æ–¹æ³•çº§æƒé™æ§åˆ¶\n */\n@Aspect\n@Component\npublic class SecurityAspect &#123;\n    \n    @Around(\"@annotation(RequirePermission)\")\n    public Object checkPermission(ProceedingJoinPoint joinPoint) throws Throwable &#123;\n        // è·å–å½“å‰ç”¨æˆ·\n        Long currentId = SecurityUtils.getCurrentId();\n        String currentRole = SecurityUtils.getCurrentRole();\n        \n        // æ ¡éªŒæƒé™\n        if (!hasPermission(currentId, currentRole)) &#123;\n            throw new TopicException(ResultCodeEnum.PERMISSION_DENIED);\n        &#125;\n        \n        return joinPoint.proceed();\n    &#125;\n&#125;\n\næ•°æ®åº“è®¾è®¡æ ¸å¿ƒè¡¨ç»“æ„ç”¨æˆ·ç›¸å…³è¡¨-- ç”¨æˆ·è¡¨\nCREATE TABLE sys_user (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç”¨æˆ·ID',\n    account VARCHAR(50) NOT NULL UNIQUE COMMENT 'è´¦å·',\n    password VARCHAR(255) NOT NULL COMMENT 'å¯†ç ',\n    nickname VARCHAR(50) COMMENT 'æ˜µç§°',\n    email VARCHAR(100) COMMENT 'é‚®ç®±',\n    avatar VARCHAR(255) COMMENT 'å¤´åƒURL',\n    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€',\n    member_time DATETIME COMMENT 'ä¼šå‘˜æ—¶é—´',\n    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,\n    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- è§’è‰²è¡¨\nCREATE TABLE sys_role (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è§’è‰²ID',\n    role_name VARCHAR(50) NOT NULL COMMENT 'è§’è‰²åç§°',\n    role_code VARCHAR(50) NOT NULL UNIQUE COMMENT 'è§’è‰²ç¼–ç ',\n    description VARCHAR(200) COMMENT 'è§’è‰²æè¿°',\n    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€',\n    create_time DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\né¢˜åº“ç›¸å…³è¡¨-- é¢˜ç›®è¡¨\nCREATE TABLE topic (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'é¢˜ç›®ID',\n    topic_name VARCHAR(500) NOT NULL COMMENT 'é¢˜ç›®æ ‡é¢˜',\n    answer TEXT COMMENT 'æ ‡å‡†ç­”æ¡ˆ',\n    ai_answer TEXT COMMENT 'AIç­”æ¡ˆ',\n    sorted INT DEFAULT 0 COMMENT 'æ’åº',\n    is_everyday TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦æ¯æ—¥ä¸€é¢˜',\n    is_member TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦ä¼šå‘˜ä¸“äº«',\n    view_count BIGINT DEFAULT 0 COMMENT 'æµè§ˆæ¬¡æ•°',\n    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€',\n    create_by VARCHAR(50) COMMENT 'åˆ›å»ºè€…',\n    fail_msg TEXT COMMENT 'å¤±è´¥åŸå› ',\n    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,\n    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\n-- é¢˜ç›®åˆ†ç±»è¡¨\nCREATE TABLE topic_category (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'åˆ†ç±»ID',\n    category_name VARCHAR(100) NOT NULL COMMENT 'åˆ†ç±»åç§°',\n    parent_id BIGINT DEFAULT 0 COMMENT 'çˆ¶åˆ†ç±»ID',\n    sort_order INT DEFAULT 0 COMMENT 'æ’åº',\n    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€',\n    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,\n    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n\nAIæœåŠ¡ç›¸å…³è¡¨-- AIå¯¹è¯å†å²è¡¨\nCREATE TABLE ai_history (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è®°å½•ID',\n    chat_id VARCHAR(100) NOT NULL COMMENT 'å¯¹è¯ID',\n    user_id BIGINT NOT NULL COMMENT 'ç”¨æˆ·ID',\n    account VARCHAR(50) COMMENT 'è´¦å·',\n    title VARCHAR(200) COMMENT 'å¯¹è¯æ ‡é¢˜',\n    content TEXT COMMENT 'å¯¹è¯å†…å®¹',\n    status TINYINT COMMENT 'çŠ¶æ€',\n    mode VARCHAR(20) COMMENT 'æ¨¡å¼',\n    parent TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦çˆ¶çº§',\n    original_title VARCHAR(200) COMMENT 'åŸå§‹æ ‡é¢˜',\n    create_time DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\n-- AIä½¿ç”¨è®°å½•è¡¨\nCREATE TABLE ai_record (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è®°å½•ID',\n    user_id BIGINT NOT NULL COMMENT 'ç”¨æˆ·ID',\n    nickname VARCHAR(50) COMMENT 'æ˜µç§°',\n    count BIGINT DEFAULT 1 COMMENT 'ä½¿ç”¨æ¬¡æ•°',\n    ai_time DATETIME COMMENT 'ä½¿ç”¨æ—¶é—´',\n    create_time DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\nç³»ç»Ÿä¼˜åŒ–ä¸äº®ç‚¹1. æ€§èƒ½ä¼˜åŒ–Redisç¼“å­˜ç­–ç•¥/**\n * ç¼“å­˜ä¼˜åŒ–å®ç°\n * ä½¿ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½\n */\n@Service\npublic class CacheService &#123;\n    \n    @Autowired\n    private StringRedisTemplate stringRedisTemplate;\n    \n    /**\n     * ç¼“å­˜ç”¨æˆ·ä¿¡æ¯\n     */\n    public void cacheUserInfo(Long userId, SysUser user) &#123;\n        String key = RedisConstant.USER_INFO_PREFIX + userId;\n        stringRedisTemplate.opsForValue().set(key, JSON.toJSONString(user), \n                Duration.ofHours(24));\n    &#125;\n    \n    /**\n     * ç¼“å­˜é¢˜ç›®åˆ—è¡¨\n     */\n    public List&lt;Topic> getCachedTopics(Long categoryId) &#123;\n        String key = RedisConstant.TOPIC_LIST_PREFIX + categoryId;\n        String cached = stringRedisTemplate.opsForValue().get(key);\n        if (StringUtils.isNotEmpty(cached)) &#123;\n            return JSON.parseArray(cached, Topic.class);\n        &#125;\n        return null;\n    &#125;\n&#125;\n\næ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–# æ•°æ®åº“è¿æ¥æ± é…ç½®\nspring:\n  datasource:\n    hikari:\n      maximum-pool-size: 20\n      minimum-idle: 5\n      connection-timeout: 30000\n      idle-timeout: 600000\n      max-lifetime: 1800000\n      leak-detection-threshold: 60000\n\n2. é«˜å¯ç”¨è®¾è®¡æœåŠ¡ç†”æ–­é™çº§/**\n * æœåŠ¡ç†”æ–­å®ç°\n * ä½¿ç”¨Hystrixå®ç°æœåŠ¡é™çº§\n */\n@Component\npublic class TopicFeignFallback implements TopicFeignClient &#123;\n    \n    @Override\n    public List&lt;Topic> getSubjectTopicList(Long subjectId) &#123;\n        log.warn(\"é¢˜åº“æœåŠ¡è°ƒç”¨å¤±è´¥ï¼Œè¿”å›é»˜è®¤æ•°æ®\");\n        return Collections.emptyList();\n    &#125;\n    \n    @Override\n    public void auditTopic(Topic topic) &#123;\n        log.warn(\"é¢˜ç›®å®¡æ ¸æœåŠ¡è°ƒç”¨å¤±è´¥ï¼Œè®°å½•æ—¥å¿—\");\n        // è®°å½•å¤±è´¥æ—¥å¿—ï¼Œåç»­é‡è¯•\n    &#125;\n&#125;\n\nåˆ†å¸ƒå¼é”å®ç°/**\n * åˆ†å¸ƒå¼é”å®ç°\n * é˜²æ­¢é‡å¤æäº¤å’Œå¹¶å‘é—®é¢˜\n */\n@Service\npublic class DistributedLockService &#123;\n    \n    @Autowired\n    private StringRedisTemplate stringRedisTemplate;\n    \n    public boolean tryLock(String lockKey, String lockValue, long expireTime) &#123;\n        Boolean result = stringRedisTemplate.opsForValue()\n                .setIfAbsent(lockKey, lockValue, Duration.ofSeconds(expireTime));\n        return Boolean.TRUE.equals(result);\n    &#125;\n    \n    public void releaseLock(String lockKey, String lockValue) &#123;\n        String script = \"if redis.call('get', KEYS[1]) == ARGV[1] then \" +\n                \"return redis.call('del', KEYS[1]) else return 0 end\";\n        stringRedisTemplate.execute(new DefaultRedisScript&lt;>(script, Long.class),\n                Collections.singletonList(lockKey), lockValue);\n    &#125;\n&#125;\n\n3. ç›‘æ§ä¸æ—¥å¿—ç³»ç»Ÿç›‘æ§/**\n * ç³»ç»Ÿç›‘æ§æŒ‡æ ‡\n * é›†æˆMicrometerå®ç°ç³»ç»Ÿç›‘æ§\n */\n@Component\npublic class SystemMetrics &#123;\n    \n    private final MeterRegistry meterRegistry;\n    private final Counter aiRequestCounter;\n    private final Timer aiResponseTimer;\n    \n    public SystemMetrics(MeterRegistry meterRegistry) &#123;\n        this.meterRegistry = meterRegistry;\n        this.aiRequestCounter = Counter.builder(\"ai.requests.total\")\n                .description(\"AIè¯·æ±‚æ€»æ•°\")\n                .register(meterRegistry);\n        this.aiResponseTimer = Timer.builder(\"ai.response.time\")\n                .description(\"AIå“åº”æ—¶é—´\")\n                .register(meterRegistry);\n    &#125;\n    \n    public void recordAiRequest() &#123;\n        aiRequestCounter.increment();\n    &#125;\n    \n    public void recordAiResponseTime(Duration duration) &#123;\n        aiResponseTimer.record(duration);\n    &#125;\n&#125;\n\nå­¦ä¹ æˆæœä¸æŠ€èƒ½æå‡æŠ€æœ¯èƒ½åŠ›æå‡\nå¾®æœåŠ¡æ¶æ„è®¾è®¡\n\næ·±å…¥ç†è§£Spring Cloudå¾®æœåŠ¡ç”Ÿæ€\næŒæ¡æœåŠ¡æ³¨å†Œå‘ç°ã€é…ç½®ç®¡ç†ã€ç½‘å…³è·¯ç”±ç­‰æ ¸å¿ƒæ¦‚å¿µ\nå­¦ä¼šå¾®æœåŠ¡æ‹†åˆ†åŸåˆ™å’Œè¾¹ç•Œåˆ’åˆ†\n\n\nåˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘\n\nç†Ÿç»ƒä½¿ç”¨Nacosè¿›è¡ŒæœåŠ¡æ²»ç†\næŒæ¡Redisåˆ†å¸ƒå¼ç¼“å­˜åº”ç”¨\nç†è§£RabbitMQæ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥å¤„ç†æœºåˆ¶\n\n\nAIæŠ€æœ¯é›†æˆ\n\né›†æˆOpenAI GPTæ¨¡å‹å®ç°æ™ºèƒ½å¯¹è¯\næŒæ¡é˜¿é‡Œäº‘TTSè¯­éŸ³åˆæˆæŠ€æœ¯\nå®ç°AIå†…å®¹å®¡æ ¸å’Œæ™ºèƒ½è¯„ä¼°\n\n\näº‘åŸç”ŸæŠ€æœ¯æ ˆ\n\nä½¿ç”¨MinIOå®ç°åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨\næŒæ¡Dockerå®¹å™¨åŒ–éƒ¨ç½²\nç†è§£äº‘åŸç”Ÿåº”ç”¨è®¾è®¡åŸåˆ™\n\n\n\nç³»ç»Ÿè®¾è®¡èƒ½åŠ›\næ¶æ„è®¾è®¡æ€ç»´\n\nå­¦ä¼šä»ä¸šåŠ¡éœ€æ±‚åˆ°æŠ€æœ¯æ¶æ„çš„è½¬æ¢\næŒæ¡é«˜å¯ç”¨ã€é«˜å¹¶å‘ç³»ç»Ÿè®¾è®¡åŸåˆ™\nç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿçš„CAPç†è®ºåº”ç”¨\n\n\næ•°æ®åº“è®¾è®¡èƒ½åŠ›\n\nè®¾è®¡åˆç†çš„æ•°æ®åº“è¡¨ç»“æ„\næŒæ¡ç´¢å¼•ä¼˜åŒ–å’ŒæŸ¥è¯¢æ€§èƒ½è°ƒä¼˜\nç†è§£æ•°æ®åº“åˆ†åº“åˆ†è¡¨ç­–ç•¥\n\n\nå®‰å…¨è®¾è®¡æ„è¯†\n\nå®ç°JWTæ— çŠ¶æ€è®¤è¯\næŒæ¡RBACæƒé™æ§åˆ¶æ¨¡å‹\nç†è§£ç³»ç»Ÿå®‰å…¨é˜²æŠ¤æœºåˆ¶\n\n\n\nå·¥ç¨‹å®è·µèƒ½åŠ›\nä»£ç è´¨é‡ç®¡æ§\n\nä½¿ç”¨Lombokç®€åŒ–ä»£ç ç¼–å†™\næŒæ¡å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•\nç†è§£ä»£ç é‡æ„å’Œä¼˜åŒ–æŠ€å·§\n\n\næµ‹è¯•é©±åŠ¨å¼€å‘\n\nç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•\næŒæ¡Mockæµ‹è¯•æŠ€æœ¯\nç†è§£æµ‹è¯•è¦†ç›–ç‡çš„é‡è¦æ€§\n\n\nDevOpså®è·µ\n\nä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶\næŒæ¡CI&#x2F;CDæµæ°´çº¿è®¾è®¡\nç†è§£å®¹å™¨åŒ–éƒ¨ç½²æµç¨‹\n\n\n\nç³»ç»Ÿäº®ç‚¹æ€»ç»“æŠ€æœ¯åˆ›æ–°ç‚¹\nAIæ™ºèƒ½å®¡æ ¸æœºåˆ¶\n\nè‡ªåŠ¨å®¡æ ¸ç”¨æˆ·æäº¤çš„é¢˜ç›®å†…å®¹\nAIç”Ÿæˆæ ‡å‡†ç­”æ¡ˆå’Œè§£æ\næå‡å†…å®¹è´¨é‡å’Œç”¨æˆ·ä½“éªŒ\n\n\nå¤šæ¨¡æ€äº¤äº’ä½“éªŒ\n\næ”¯æŒæ–‡æœ¬å’Œè¯­éŸ³åŒé‡äº¤äº’\næ™ºèƒ½è¯­éŸ³åˆæˆæŠ€æœ¯\næå‡ç”¨æˆ·äº¤äº’ä½“éªŒ\n\n\næ™ºèƒ½æ¨èç®—æ³•\n\nåŸºäºç”¨æˆ·è¡Œä¸ºæ¨èé¢˜ç›®\nä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„è§„åˆ’\næå‡å­¦ä¹ æ•ˆç‡\n\n\n\næ¶æ„ä¼˜åŠ¿\né«˜å¯æ‰©å±•æ€§\n\nå¾®æœåŠ¡æ¶æ„æ”¯æŒæ°´å¹³æ‰©å±•\næœåŠ¡é—´æ¾è€¦åˆè®¾è®¡\næ”¯æŒç‹¬ç«‹éƒ¨ç½²å’Œå‡çº§\n\n\né«˜å¯ç”¨æ€§\n\næœåŠ¡ç†”æ–­é™çº§æœºåˆ¶\nåˆ†å¸ƒå¼ç¼“å­˜æå‡æ€§èƒ½\nå¤šå‰¯æœ¬éƒ¨ç½²ä¿è¯å¯ç”¨æ€§\n\n\né«˜æ€§èƒ½\n\nRedisç¼“å­˜çƒ­ç‚¹æ•°æ®\næ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–\nå¼‚æ­¥æ¶ˆæ¯å¤„ç†æœºåˆ¶\n\n\n\nä¸šåŠ¡ä»·å€¼\nç”¨æˆ·ä½“éªŒæå‡\n\næ™ºèƒ½åŒ–ç­”é¢˜ä½“éªŒ\nä¸ªæ€§åŒ–å­¦ä¹ æ¨è\nå¤šç«¯ç»Ÿä¸€ä½“éªŒ\n\n\nè¿è¥æ•ˆç‡æå‡\n\nAIè‡ªåŠ¨å®¡æ ¸å‡å°‘äººå·¥æˆæœ¬\næ•°æ®ç»Ÿè®¡åˆ†ææ”¯æŒå†³ç­–\nè‡ªåŠ¨åŒ–è¿ç»´é™ä½ç»´æŠ¤æˆæœ¬\n\n\næŠ€æœ¯ç§¯ç´¯\n\nå¾®æœåŠ¡æ¶æ„æœ€ä½³å®è·µ\nAIæŠ€æœ¯åº”ç”¨ç»éªŒ\nåˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡èƒ½åŠ›\n\n\n\næ€»ç»“é€šè¿‡æœ¬é¡¹ç›®çš„å¼€å‘å®è·µï¼Œæ·±å…¥æŒæ¡äº†ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘çš„æ ¸å¿ƒæŠ€æœ¯æ ˆï¼ŒåŒ…æ‹¬Spring Cloudå¾®æœåŠ¡æ¶æ„ã€AIæŠ€æœ¯é›†æˆã€äº‘åŸç”Ÿåº”ç”¨å¼€å‘ç­‰ã€‚é¡¹ç›®ä¸ä»…å®ç°äº†é¢„æœŸçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œæ›´é‡è¦çš„æ˜¯åœ¨æŠ€æœ¯æ¶æ„è®¾è®¡ã€ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–ã€ç”¨æˆ·ä½“éªŒæå‡ç­‰æ–¹é¢ç§¯ç´¯äº†å®è´µç»éªŒã€‚\nç³»ç»Ÿé‡‡ç”¨å¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œå…·å¤‡è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ï¼›é›†æˆAIæŠ€æœ¯æä¾›æ™ºèƒ½åŒ–æœåŠ¡ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼›ä½¿ç”¨äº‘åŸç”ŸæŠ€æœ¯æ ˆï¼Œæ”¯æŒå®¹å™¨åŒ–éƒ¨ç½²å’Œè‡ªåŠ¨åŒ–è¿ç»´ã€‚è¿™äº›æŠ€æœ¯å®è·µä¸ºåç»­çš„å¤§å‹ç³»ç»Ÿå¼€å‘å¥ å®šäº†åšå®åŸºç¡€ã€‚\nåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ä»…æå‡äº†æŠ€æœ¯èƒ½åŠ›ï¼Œæ›´é‡è¦çš„æ˜¯åŸ¹å…»äº†ç³»ç»Ÿæ€ç»´å’Œå·¥ç¨‹å®è·µèƒ½åŠ›ï¼Œä¸ºæˆä¸ºä¸€åä¼˜ç§€çš„è½¯ä»¶å·¥ç¨‹å¸ˆå¥ å®šäº†åšå®åŸºç¡€ã€‚\n","categories":["æŠ€æœ¯åˆ†äº«","å¾®æœåŠ¡æ¶æ„","AIåº”ç”¨"],"tags":["Java","æ™ºèƒ½é—®ç­”"]},{"title":"Topicæ ‡ç­¾æ’ä»¶å®Œæ•´æŒ‡å—","url":"/2023/09/07/Butterfly%E4%B8%BB%E9%A2%98%E6%A0%87%E7%AD%BE%E6%8F%92%E4%BB%B6%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/","content":"ä¸»é¢˜æ ‡ç­¾æ’ä»¶å®Œæ•´æŒ‡å—ä¸»é¢˜æä¾›äº†ä¸°å¯Œçš„æ ‡ç­¾æ’ä»¶ï¼ˆTag Pluginsï¼‰ï¼Œè®©ä½ å¯ä»¥åœ¨ Markdown æ–‡ç« ä¸­è½»æ¾æ’å…¥å„ç§æ ·å¼ä¸°å¯Œçš„ç»„ä»¶ã€‚æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»æ‰€æœ‰å¯ç”¨çš„æ ‡ç­¾æ’ä»¶åŠå…¶ä½¿ç”¨æ–¹æ³•ã€‚\n\nğŸ“‹ ç›®å½•\n1. æŒ‰é’®æ’ä»¶ (btn)\n2. æç¤ºæ¡†æ’ä»¶ (note&#x2F;subnote)\n3. æ ‡ç­¾é¡µæ’ä»¶ (tabs)\n4. éšè—å†…å®¹æ’ä»¶ (hide)\n5. æ ‡ç­¾æ’ä»¶ (label)\n6. æ—¶é—´çº¿æ’ä»¶ (timeline)\n7. ç›¸å†Œæ’ä»¶ (gallery)\n8. è¡Œå†…å›¾ç‰‡æ’ä»¶ (inlineImg)\n9. ç³»åˆ—æ–‡ç« æ’ä»¶ (series)\n10. ä¹è°±æ’ä»¶ (score)\n11. å›¾è¡¨æ’ä»¶ (chartjs)\n12. æµç¨‹å›¾æ’ä»¶ (mermaid)\n13. å‹æƒ…é“¾æ¥æ’ä»¶ (flink)\n\n\n1. æŒ‰é’®æ’ä»¶ (btn)è¯­æ³•\n&#123;% btn url, text, icon, option %&#125;\n\n\nå‚æ•°è¯´æ˜\nurl: æŒ‰é’®é“¾æ¥åœ°å€ï¼ˆå¿…å¡«ï¼‰\ntext: æŒ‰é’®æ˜¾ç¤ºæ–‡æœ¬ï¼ˆå¯é€‰ï¼‰\nicon: Font Awesome å›¾æ ‡ç±»åï¼ˆå¯é€‰ï¼‰\noption: æ ·å¼é€‰é¡¹ï¼ˆå¯é€‰ï¼‰\ncolor: é¢œè‰²æ ·å¼ - default&#x2F;blue&#x2F;pink&#x2F;red&#x2F;purple&#x2F;orange&#x2F;green\noutline: è½®å»“æ ·å¼\ncenter: å±…ä¸­å¯¹é½\nblock: å—çº§æŒ‰é’®\nlarger: å¤§å°ºå¯¸æŒ‰é’®\n\n\n\nä½¿ç”¨ç¤ºä¾‹\n&lt;!-- åŸºç¡€æŒ‰é’® -->\n&#123;% btn https://github.com, GitHub %&#125;\n\n&lt;!-- å¸¦å›¾æ ‡å’Œé¢œè‰² -->\n&#123;% btn https://github.com, GitHub, fab fa-github, blue %&#125;\n\n&lt;!-- è½®å»“æ ·å¼æŒ‰é’® -->\n&#123;% btn https://butterfly.js.org, è®¿é—®å®˜ç½‘, fas fa-home, pink outline %&#125;\n\n&lt;!-- å—çº§å¤§æŒ‰é’® -->\n&#123;% btn https://butterfly.js.org, è®¿é—®Butterflyä¸»é¢˜å®˜ç½‘, fas fa-home, green block larger %&#125;\n\n&lt;!-- å±…ä¸­å¯¹é½ -->\n&#123;% btn https://github.com, æŸ¥çœ‹æºç , fab fa-github, purple center %&#125;\n\n\næ¸²æŸ“æ•ˆæœGitHub\n\n\n2. æç¤ºæ¡†æ’ä»¶ (note&#x2F;subnote)è¯­æ³•\n&#123;% note [style] [icon] [color] %&#125;\nå†…å®¹æ”¯æŒ Markdown è¯­æ³•\n&#123;% endnote %&#125;\n\n\nå‚æ•°è¯´æ˜\nstyle: æ ·å¼ç±»å‹ï¼ˆå¯é€‰ï¼‰\ndefault: é»˜è®¤æ ·å¼\nprimary: ä¸»è¦æ ·å¼\nsuccess: æˆåŠŸæ ·å¼\ninfo: ä¿¡æ¯æ ·å¼\nwarning: è­¦å‘Šæ ·å¼\ndanger: å±é™©æ ·å¼\n\n\nicon: Font Awesome å›¾æ ‡ç±»åï¼ˆå¯é€‰ï¼‰\ncolor: é¢œè‰²æ ·å¼ï¼ˆå¯é€‰ï¼‰\n\nä½¿ç”¨ç¤ºä¾‹\n&lt;!-- é»˜è®¤æç¤ºæ¡† -->\n&#123;% note %&#125;\nè¿™æ˜¯é»˜è®¤æç¤ºæ¡†ï¼Œç”¨äºä¸€èˆ¬ä¿¡æ¯å±•ç¤ºã€‚\n&#123;% endnote %&#125;\n\n&lt;!-- æˆåŠŸæç¤ºæ¡† -->\n&#123;% note success %&#125;\næ“ä½œæˆåŠŸå®Œæˆï¼\n&#123;% endnote %&#125;\n\n&lt;!-- ä¿¡æ¯æç¤ºæ¡† -->\n&#123;% note info %&#125;\nè¿™æ˜¯ä¸€æ¡é‡è¦ä¿¡æ¯ï¼Œè¯·æ³¨æ„æŸ¥çœ‹ã€‚\n&#123;% endnote %&#125;\n\n&lt;!-- è­¦å‘Šæç¤ºæ¡† -->\n&#123;% note warning %&#125;\nè­¦å‘Šï¼šæ­¤æ“ä½œä¸å¯é€†ï¼Œè¯·è°¨æ…æ“ä½œã€‚\n&#123;% endnote %&#125;\n\n&lt;!-- å±é™©æç¤ºæ¡† -->\n&#123;% note danger %&#125;\nå±é™©ï¼šåˆ é™¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤æ•°æ®ï¼Œæ— æ³•æ¢å¤ã€‚\n&#123;% endnote %&#125;\n\n&lt;!-- å¸¦è‡ªå®šä¹‰å›¾æ ‡ -->\n&#123;% note info fas fa-lightbulb %&#125;\nè¿™æ˜¯ä¸€ä¸ªå¸¦è‡ªå®šä¹‰å›¾æ ‡çš„æç¤ºæ¡†ã€‚\n&#123;% endnote %&#125;\n\n&lt;!-- ä¸»è¦æ ·å¼ -->\n&#123;% note primary %&#125;\nè¿™æ˜¯ä¸»è¦ä¿¡æ¯çš„æç¤ºæ¡†ã€‚\n&#123;% endnote %&#125;\n\n\næ¸²æŸ“æ•ˆæœè¿™æ˜¯é»˜è®¤æç¤ºæ¡†ï¼Œç”¨äºä¸€èˆ¬ä¿¡æ¯å±•ç¤ºã€‚\n\n\næ“ä½œæˆåŠŸå®Œæˆï¼\n\n\n\n3. æ ‡ç­¾é¡µæ’ä»¶ (tabs)è¯­æ³•\n&#123;% tabs [name], [active] %&#125;\n&lt;!-- tab [title]@[icon] -->\nå†…å®¹æ”¯æŒ Markdown è¯­æ³•\n&lt;!-- endtab -->\n&#123;% endtabs %&#125;\n\n\nå‚æ•°è¯´æ˜\nname: æ ‡ç­¾é¡µç»„åç§°ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º â€œtabâ€ï¼‰\nactive: é»˜è®¤æ¿€æ´»çš„æ ‡ç­¾é¡µåºå·ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º 1ï¼‰\ntitle: æ ‡ç­¾é¡µæ ‡é¢˜\nicon: Font Awesome å›¾æ ‡ç±»åï¼ˆå¯é€‰ï¼‰\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% tabs ä»£ç ç¤ºä¾‹, 1 %&#125;\n&lt;!-- tab JavaScript@fab fa-js -->\n```javascript\nconsole.log('Hello, World!');\n\n\n\nprint(\"Hello, World!\")\n\n\n\nSystem.out.println(\"Hello, World!\");\n\n{% endtabs %}\n&#123;% endraw %&#125;\n\n### åµŒå¥—æ ‡ç­¾é¡µ\n\nButterfly æ”¯æŒåµŒå¥—æ ‡ç­¾é¡µï¼Œå¯ä»¥ä½¿ç”¨ &#96;subtabs&#96; å’Œ &#96;subsubtabs&#96;ï¼š\n\n&#123;% raw %&#125;\n&#96;&#96;&#96;markdown\n&#123;% tabs å‰ç«¯æŠ€æœ¯æ ˆ %&#125;\n&lt;!-- tab HTML@fab fa-html5 --&gt;\nHTML åŸºç¡€å†…å®¹\n&lt;!-- endtab --&gt;\n\n&lt;!-- tab CSS@fab fa-css3-alt --&gt;\nCSS æ ·å¼å†…å®¹\n&lt;!-- endtab --&gt;\n\n&lt;!-- tab JavaScript@fab fa-js --&gt;\nJavaScript ç›¸å…³å†…å®¹\n\n&#123;% subtabs JavaScriptæ¡†æ¶ %&#125;\n&lt;!-- tab Vue@fab fa-vuejs --&gt;\nVue.js æ¡†æ¶ä»‹ç»\n&lt;!-- endtab --&gt;\n\n&lt;!-- tab React@fab fa-react --&gt;\nReact æ¡†æ¶ä»‹ç»\n&lt;!-- endtab --&gt;\n&#123;% endsubtabs %&#125;\n\n&lt;!-- endtab --&gt;\n&#123;% endtabs %&#125;\n\n\n\n4. éšè—å†…å®¹æ’ä»¶ (hide)Butterfly æä¾›äº†ä¸‰ç§éšè—å†…å®¹çš„æ–¹å¼ï¼š\n4.1 hideInline - è¡Œå†…éšè—è¯­æ³•\n&#123;% hideInline content, display, bg, color %&#125;\n\n\nå‚æ•°è¯´æ˜\ncontent: è¦éšè—çš„å†…å®¹ï¼ˆå¿…å¡«ï¼Œä¸èƒ½åŒ…å«å•å¼•å·ï¼Œå¯ç”¨ &amp;apos; ä»£æ›¿ï¼‰\ndisplay: æŒ‰é’®æ˜¾ç¤ºæ–‡æœ¬ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º â€œClickâ€ï¼‰\nbg: æŒ‰é’®èƒŒæ™¯è‰²ï¼ˆå¯é€‰ï¼‰\ncolor: æŒ‰é’®æ–‡å­—é¢œè‰²ï¼ˆå¯é€‰ï¼‰\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% hideInline è¿™æ˜¯éšè—çš„å†…å®¹, ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ, #f0f0f0, #333 %&#125;\n\n\n4.2 hideBlock - å—çº§éšè—è¯­æ³•\n&#123;% hideBlock display, bg, color %&#125;\nå†…å®¹æ”¯æŒ Markdown è¯­æ³•\n&#123;% endhideBlock %&#125;\n\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% hideBlock ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ %&#125;\nè¿™æ˜¯ä¸€æ®µè¢«éšè—çš„å†…å®¹ï¼Œæ”¯æŒ Markdown è¯­æ³•ã€‚\n\n- åˆ—è¡¨é¡¹ 1\n- åˆ—è¡¨é¡¹ 2\n- åˆ—è¡¨é¡¹ 3\n&#123;% endhideBlock %&#125;\n\n\n4.3 hideToggle - æŠ˜å éšè—è¯­æ³•\n&#123;% hideToggle display, bg, color %&#125;\nå†…å®¹æ”¯æŒ Markdown è¯­æ³•\n&#123;% endhideToggle %&#125;\n\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% hideToggle ç‚¹å‡»å±•å¼€è¯¦ç»†å†…å®¹ %&#125;\nè¿™æ˜¯æŠ˜å çš„å†…å®¹ï¼Œç‚¹å‡»åå¯ä»¥å±•å¼€æŸ¥çœ‹ã€‚\n\næ”¯æŒå¤šæ®µå†…å®¹ï¼š\n\n1. ç¬¬ä¸€é¡¹\n2. ç¬¬äºŒé¡¹\n3. ç¬¬ä¸‰é¡¹\n\nä¹Ÿå¯ä»¥åŒ…å«ä»£ç ï¼š\n\n```python\ndef hello():\n    print(\"Hello!\")\n{% endhideToggle %}\n&#123;% endraw %&#125;\n\n---\n\n## 5. æ ‡ç­¾æ’ä»¶ (label)\n\n### è¯­æ³•\n\n&#123;% raw %&#125;\n&#96;&#96;&#96;markdown\n&#123;% label text color %&#125;\n\n\nå‚æ•°è¯´æ˜\ntext: æ ‡ç­¾æ–‡æœ¬ï¼ˆå¿…å¡«ï¼‰\ncolor: æ ‡ç­¾é¢œè‰²ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º defaultï¼‰\ndefault: é»˜è®¤\nprimary: ä¸»è¦\nsuccess: æˆåŠŸ\ninfo: ä¿¡æ¯\nwarning: è­¦å‘Š\ndanger: å±é™©\npink: ç²‰è‰²\nred: çº¢è‰²\norange: æ©™è‰²\ngreen: ç»¿è‰²\nblue: è“è‰²\npurple: ç´«è‰²\n\n\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% label é‡è¦ %&#125;\n&#123;% label å·²å®Œæˆ success %&#125;\n&#123;% label å¾…å¤„ç† warning %&#125;\n&#123;% label é”™è¯¯ danger %&#125;\n&#123;% label æ–°åŠŸèƒ½ primary %&#125;\n&#123;% label çƒ­é—¨ pink %&#125;\n&#123;% label æ¨è blue %&#125;\n\n\næ¸²æŸ“æ•ˆæœé‡è¦\nå·²å®Œæˆ\nå¾…å¤„ç†\né”™è¯¯\n\n\n6. æ—¶é—´çº¿æ’ä»¶ (timeline)è¯­æ³•\n&#123;% timeline [headline], [color] %&#125;\n&lt;!-- timeline [title] -->\nå†…å®¹æ”¯æŒ Markdown è¯­æ³•\n&lt;!-- endtimeline -->\n&#123;% endtimeline %&#125;\n\n\nå‚æ•°è¯´æ˜\nheadline: æ—¶é—´çº¿æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰\ncolor: æ—¶é—´çº¿é¢œè‰²ï¼ˆå¯é€‰ï¼‰\ntitle: æ—¶é—´èŠ‚ç‚¹æ ‡é¢˜\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% timeline é¡¹ç›®å¼€å‘æ—¶é—´çº¿ %&#125;\n&lt;!-- timeline 2023-01-15 -->\né¡¹ç›®å¯åŠ¨ï¼Œå®Œæˆéœ€æ±‚åˆ†æã€‚\n&lt;!-- endtimeline -->\n\n&lt;!-- timeline 2023-02-20 -->\nå®Œæˆæ•°æ®åº“è®¾è®¡ï¼Œå¼€å§‹åç«¯å¼€å‘ã€‚\n&lt;!-- endtimeline -->\n\n&lt;!-- timeline 2023-03-10 -->\nåç«¯ API å¼€å‘å®Œæˆï¼Œå¼€å§‹å‰ç«¯å¼€å‘ã€‚\n&lt;!-- endtimeline -->\n\n&lt;!-- timeline 2023-04-01 -->\nå‰ç«¯å¼€å‘å®Œæˆï¼Œè¿›å…¥æµ‹è¯•é˜¶æ®µã€‚\n&lt;!-- endtimeline -->\n\n&lt;!-- timeline 2023-04-15 -->\né¡¹ç›®ä¸Šçº¿å‘å¸ƒã€‚\n&lt;!-- endtimeline -->\n&#123;% endtimeline %&#125;\n\n\n\n7. ç›¸å†Œæ’ä»¶ (gallery)7.1 gallery - ç›¸å†Œè¯­æ³•\n&#123;% gallery [button], [limit], [firstLimit] %&#125;\n![å›¾ç‰‡æè¿°](å›¾ç‰‡URL)\n![å›¾ç‰‡æè¿°](å›¾ç‰‡URL)\n&#123;% endgallery %&#125;\n\n\næˆ–è€…ä½¿ç”¨ URL æ–¹å¼ï¼š\n\n&#123;% gallery url, [url], [button] %&#125;\n\n\nå‚æ•°è¯´æ˜\nbutton: æ˜¯å¦æ˜¾ç¤ºåŠ è½½æ›´å¤šæŒ‰é’®ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º falseï¼‰\nlimit: æ¯é¡µæ˜¾ç¤ºæ•°é‡ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º 10ï¼‰\nfirstLimit: é¦–æ¬¡åŠ è½½æ•°é‡ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º 10ï¼‰\nurl: å›¾ç‰‡ URL åœ°å€ï¼ˆURL æ¨¡å¼ï¼‰\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% gallery true, 6, 6 %&#125;\n![å›¾ç‰‡1](https://example.com/image1.jpg)\n![å›¾ç‰‡2](https://example.com/image2.jpg)\n![å›¾ç‰‡3](https://example.com/image3.jpg)\n![å›¾ç‰‡4](https://example.com/image4.jpg)\n![å›¾ç‰‡5](https://example.com/image5.jpg)\n![å›¾ç‰‡6](https://example.com/image6.jpg)\n&#123;% endgallery %&#125;\n\n\n7.2 galleryGroup - ç›¸å†Œç»„è¯­æ³•\n&#123;% galleryGroup [name] [descr] [url] [img] %&#125;\n\n\nå‚æ•°è¯´æ˜\nname: ç›¸å†Œç»„åç§°\ndescr: ç›¸å†Œç»„æè¿°\nurl: ç›¸å†Œé“¾æ¥åœ°å€\nimg: ç›¸å†Œå°é¢å›¾ç‰‡\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% galleryGroup æ—…è¡Œç…§ç‰‡ è®°å½•ç¾å¥½æ—¶å…‰ /photos/travel /images/travel-cover.jpg %&#125;\n&#123;% galleryGroup ç¾é£Ÿåˆ†äº« åˆ†äº«ç¾é£Ÿä½“éªŒ /photos/food /images/food-cover.jpg %&#125;\n\n\n\n8. è¡Œå†…å›¾ç‰‡æ’ä»¶ (inlineImg)è¯­æ³•\n&#123;% inlineImg [img] [height] %&#125;\n\n\nå‚æ•°è¯´æ˜\nimg: å›¾ç‰‡è·¯å¾„æˆ– URLï¼ˆå¿…å¡«ï¼‰\nheight: å›¾ç‰‡é«˜åº¦ï¼ˆå¯é€‰ï¼Œå•ä½ï¼špxï¼‰\n\nä½¿ç”¨ç¤ºä¾‹\nè¿™æ˜¯ä¸€æ®µæ–‡å­—ï¼Œ&#123;% inlineImg /images/logo.png 30px %&#125; è¿™é‡Œæ’å…¥äº†ä¸€ä¸ªè¡Œå†…å›¾ç‰‡ã€‚\n\n&#123;% inlineImg https://example.com/icon.png 40px %&#125; è¿™æ˜¯å¦ä¸€ä¸ªè¡Œå†…å›¾ç‰‡ã€‚\n\n\n\n9. ç³»åˆ—æ–‡ç« æ’ä»¶ (series)å‰ç½®é…ç½®é¦–å…ˆéœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¯ç”¨ç³»åˆ—æ’ä»¶ï¼š\nseries:\n  enable: true\n  orderBy: 'title'  # æˆ– 'date'\n  order: 1  # 1: å‡åº, -1: é™åº\n  number: true  # æ˜¯å¦æ˜¾ç¤ºåºå·\n\nè¯­æ³•åœ¨æ–‡ç«  Front Matter ä¸­æ·»åŠ  series å­—æ®µï¼š\n---\ntitle: æ–‡ç« æ ‡é¢˜\nseries: ç³»åˆ—åç§°\n---\n\nåœ¨æ–‡ç« ä¸­ä½¿ç”¨æ ‡ç­¾æ’ä»¶ï¼š\n\n&#123;% series [series name] %&#125;\n\n\nå‚æ•°è¯´æ˜\nseries name: ç³»åˆ—åç§°ï¼ˆå¯é€‰ï¼Œå¦‚æœä¸æŒ‡å®šåˆ™ä½¿ç”¨å½“å‰æ–‡ç« çš„ series å­—æ®µå€¼ï¼‰\n\nä½¿ç”¨ç¤ºä¾‹æ–‡ç« 1 (series.md):\n---\ntitle: PythonåŸºç¡€æ•™ç¨‹ï¼ˆä¸€ï¼‰\nseries: Pythonæ•™ç¨‹\n---\n\næ–‡ç« 2 (series-2.md):\n---\ntitle: PythonåŸºç¡€æ•™ç¨‹ï¼ˆäºŒï¼‰\nseries: Pythonæ•™ç¨‹\n---\n\nåœ¨æ–‡ç« ä¸­ä½¿ç”¨ï¼š\n\n&#123;% series Pythonæ•™ç¨‹ %&#125;\n\n\næˆ–è€…ï¼š\n\n&#123;% series %&#125;\n\n\n\n10. ä¹è°±æ’ä»¶ (score)å‰ç½®é…ç½®éœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¯ç”¨ ABCJSï¼š\nabcjs:\n  enable: true\n  per_page: true\n\nè¯­æ³•\n&#123;% score %&#125;\n[å‚æ•°JSON]\n------\nABCä¹è°±ä»£ç \n&#123;% endscore %&#125;\n\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% score %&#125;\n&#123;&#125;\n------\nX:1\nT:ç¤ºä¾‹ä¹è°±\nM:4/4\nL:1/4\nK:C\nC D E F|G A B c|\n&#123;% endscore %&#125;\n\n\n\n11. å›¾è¡¨æ’ä»¶ (chartjs)å‰ç½®é…ç½®éœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¯ç”¨ ChartJSï¼š\nchartjs:\n  enable: true\n\nè¯­æ³•\n&#123;% chartjs [width], [abreast], [chartId] %&#125;\n&lt;!-- chart -->\nå›¾è¡¨é…ç½® JSON\n&lt;!-- endchart -->\n&lt;!-- desc -->\nå›¾è¡¨æè¿°ï¼ˆå¯é€‰ï¼‰\n&lt;!-- enddesc -->\n&#123;% endchartjs %&#125;\n\n\nå‚æ•°è¯´æ˜\nwidth: å›¾è¡¨å®½åº¦ç™¾åˆ†æ¯”ï¼ˆå¯é€‰ï¼‰\nabreast: æ˜¯å¦å¹¶æ’æ˜¾ç¤ºï¼ˆå¯é€‰ï¼Œå¸ƒå°”å€¼ï¼‰\nchartId: å›¾è¡¨ IDï¼ˆå¯é€‰ï¼‰\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% chartjs 100% %&#125;\n&lt;!-- chart -->\n&#123;\n  \"type\": \"bar\",\n  \"data\": &#123;\n    \"labels\": [\"ä¸€æœˆ\", \"äºŒæœˆ\", \"ä¸‰æœˆ\", \"å››æœˆ\"],\n    \"datasets\": [&#123;\n      \"label\": \"é”€å”®é¢\",\n      \"data\": [12, 19, 3, 5],\n      \"backgroundColor\": [\n        \"rgba(255, 99, 132, 0.2)\",\n        \"rgba(54, 162, 235, 0.2)\",\n        \"rgba(255, 206, 86, 0.2)\",\n        \"rgba(75, 192, 192, 0.2)\"\n      ]\n    &#125;]\n  &#125;,\n  \"options\": &#123;\n    \"scales\": &#123;\n      \"y\": &#123;\n        \"beginAtZero\": true\n      &#125;\n    &#125;\n  &#125;\n&#125;\n&lt;!-- endchart -->\n&lt;!-- desc -->\n2023å¹´ç¬¬ä¸€å­£åº¦é”€å”®é¢ç»Ÿè®¡\n&lt;!-- enddesc -->\n&#123;% endchartjs %&#125;\n\n\n\n12. æµç¨‹å›¾æ’ä»¶ (mermaid)å‰ç½®é…ç½®éœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¯ç”¨ Mermaidï¼š\nmermaid:\n  enable: true\n  code_write: false\n  theme:\n    light: default\n    dark: dark\n\nè¯­æ³•æ–¹å¼ä¸€ï¼šä½¿ç”¨æ ‡ç­¾æ’ä»¶\n&#123;% mermaid %&#125;\næµç¨‹å›¾ä»£ç \n&#123;% endmermaid %&#125;\n\n\næ–¹å¼äºŒï¼šä½¿ç”¨ä»£ç å—ï¼ˆå½“ code_write: false æ—¶ï¼‰\n```mermaid\næµç¨‹å›¾ä»£ç \n```\n\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% mermaid %&#125;\ngraph TD\n    A[å¼€å§‹] --> B&#123;åˆ¤æ–­æ¡ä»¶&#125;\n    B -->|æ˜¯| C[æ‰§è¡Œæ“ä½œ1]\n    B -->|å¦| D[æ‰§è¡Œæ“ä½œ2]\n    C --> E[ç»“æŸ]\n    D --> E\n&#123;% endmermaid %&#125;\n\n\næˆ–è€…ä½¿ç”¨ä»£ç å—ï¼š\n\n```mermaid\nsequenceDiagram\n    participant A as ç”¨æˆ·\n    participant B as æœåŠ¡å™¨\n    A->>B: å‘é€è¯·æ±‚\n    B-->>A: è¿”å›å“åº”\n```\n\n\næ”¯æŒçš„å›¾è¡¨ç±»å‹\næµç¨‹å›¾ï¼ˆFlowchartï¼‰\nåºåˆ—å›¾ï¼ˆSequence Diagramï¼‰\nç”˜ç‰¹å›¾ï¼ˆGantt Chartï¼‰\nç±»å›¾ï¼ˆClass Diagramï¼‰\nçŠ¶æ€å›¾ï¼ˆState Diagramï¼‰\nå®ä½“å…³ç³»å›¾ï¼ˆER Diagramï¼‰\nç”¨æˆ·æ—…ç¨‹å›¾ï¼ˆUser Journeyï¼‰\nç­‰ç­‰â€¦\n\n\n13. å‹æƒ…é“¾æ¥æ’ä»¶ (flink)è¯­æ³•\n&#123;% flink %&#125;\n- class_name: åˆ†ç±»åç§°\n  class_desc: åˆ†ç±»æè¿°\n  link_list:\n    - name: é“¾æ¥åç§°\n      link: é“¾æ¥åœ°å€\n      avatar: å¤´åƒåœ°å€\n      descr: é“¾æ¥æè¿°\n&#123;% endflink %&#125;\n\n\nä½¿ç”¨ç¤ºä¾‹\n&#123;% flink %&#125;\n- class_name: æŠ€æœ¯åšå®¢\n  class_desc: ä¼˜ç§€çš„æŠ€æœ¯åšå®¢æ¨è\n  link_list:\n    - name: Butterfly ä¸»é¢˜\n      link: https://butterfly.js.org\n      avatar: https://butterfly.js.org/img/favicon.png\n      descr: ä¸€ä¸ªç®€æ´ç¾è§‚çš„ Hexo ä¸»é¢˜\n    - name: Hexo å®˜æ–¹\n      link: https://hexo.io\n      avatar: https://hexo.io/favicon.ico\n      descr: å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶\n\n- class_name: å·¥å…·ç½‘ç«™\n  class_desc: å®ç”¨çš„åœ¨çº¿å·¥å…·\n  link_list:\n    - name: GitHub\n      link: https://github.com\n      avatar: https://github.com/favicon.ico\n      descr: å…¨çƒæœ€å¤§çš„ä»£ç æ‰˜ç®¡å¹³å°\n&#123;% endflink %&#125;\n\n\n\nğŸ¨ ç»„åˆä½¿ç”¨ç¤ºä¾‹æ ‡ç­¾æ’ä»¶å¯ä»¥çµæ´»ç»„åˆä½¿ç”¨ï¼Œåˆ›é€ å‡ºæ›´ä¸°å¯Œçš„æ•ˆæœï¼š\n\n&#123;% note info %&#125;\nè¿™æ˜¯ä¸€ä¸ªæç¤ºæ¡†ï¼Œé‡Œé¢å¯ä»¥åŒ…å«å…¶ä»–æ ‡ç­¾æ’ä»¶ã€‚\n&#123;% endnote %&#125;\n\n&#123;% tabs ç»„åˆç¤ºä¾‹ %&#125;\n&lt;!-- tab æŒ‰é’®ç»„ -->\n&#123;% btn https://github.com, GitHub, fab fa-github, blue %&#125;\n&#123;% btn https://butterfly.js.org, å®˜ç½‘, fas fa-home, pink %&#125;\n&lt;!-- endtab -->\n\n&lt;!-- tab æ ‡ç­¾ç»„ -->\n&#123;% label é‡è¦ %&#125;\n&#123;% label å·²å®Œæˆ success %&#125;\n&#123;% label å¾…å¤„ç† warning %&#125;\n&lt;!-- endtab -->\n&#123;% endtabs %&#125;\n\n\n\nğŸ“ æ³¨æ„äº‹é¡¹\næ ‡ç­¾æ’ä»¶è¯­æ³•ï¼šæ‰€æœ‰æ ‡ç­¾æ’ä»¶ä½¿ç”¨ &#123;% %&#125; åŒ…è£¹ï¼ŒåŒºåˆ†å¤§å°å†™\nMarkdown æ”¯æŒï¼šå¤§éƒ¨åˆ†æ ‡ç­¾æ’ä»¶å†…éƒ¨æ”¯æŒ Markdown è¯­æ³•\nå‚æ•°åˆ†éš”ï¼šå¤šä¸ªå‚æ•°ä½¿ç”¨é€—å· , åˆ†éš”\nåµŒå¥—ä½¿ç”¨ï¼šéƒ¨åˆ†æ ‡ç­¾æ’ä»¶æ”¯æŒåµŒå¥—ä½¿ç”¨ï¼ˆå¦‚ tabsã€noteï¼‰\né…ç½®è¦æ±‚ï¼šéƒ¨åˆ†æ’ä»¶ï¼ˆå¦‚ mermaidã€chartjsã€scoreï¼‰éœ€è¦å…ˆåœ¨ä¸»é¢˜é…ç½®ä¸­å¯ç”¨\nå›¾æ ‡ä½¿ç”¨ï¼šå›¾æ ‡ä½¿ç”¨ Font Awesome ç±»åï¼Œéœ€è¦åœ¨ä¸»é¢˜ä¸­å¼•å…¥ Font Awesome\n\n\nğŸ”— ç›¸å…³èµ„æº\nButterfly ä¸»é¢˜å®˜æ–¹æ–‡æ¡£\nFont Awesome å›¾æ ‡åº“\nMermaid è¯­æ³•æ–‡æ¡£\nChart.js å®˜æ–¹æ–‡æ¡£\nHexo å®˜æ–¹æ–‡æ¡£\n\n\nğŸ“š æ€»ç»“Butterfly ä¸»é¢˜æä¾›äº† 13 ç§æ ‡ç­¾æ’ä»¶ï¼Œæ¶µç›–äº†æŒ‰é’®ã€æç¤ºæ¡†ã€æ ‡ç­¾é¡µã€éšè—å†…å®¹ã€æ ‡ç­¾ã€æ—¶é—´çº¿ã€ç›¸å†Œã€å›¾ç‰‡ã€ç³»åˆ—æ–‡ç« ã€ä¹è°±ã€å›¾è¡¨ã€æµç¨‹å›¾å’Œå‹æƒ…é“¾æ¥ç­‰åŠŸèƒ½ã€‚è¿™äº›æ ‡ç­¾æ’ä»¶å¯ä»¥å¤§å¤§å¢å¼ºæ–‡ç« çš„è§†è§‰æ•ˆæœå’Œäº¤äº’æ€§ï¼Œè®©ä½ çš„åšå®¢å†…å®¹æ›´åŠ ä¸°å¯Œå¤šå½©ã€‚\nå¸Œæœ›æœ¬æ–‡æ¡£èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ä½¿ç”¨ Butterfly ä¸»é¢˜çš„æ ‡ç­¾æ’ä»¶åŠŸèƒ½ã€‚å¦‚æœ‰ç–‘é—®ï¼Œæ¬¢è¿å‚è€ƒå®˜æ–¹æ–‡æ¡£æˆ–æå‡º issueã€‚\n\næœ€åæ›´æ–°: 2023-09-07\n","categories":["æ•™ç¨‹"],"tags":["æ ‡ç­¾æ’ä»¶"]},{"title":"ECAPA-TDNNå£°çº¹è¯†åˆ«ç³»ç»Ÿè®¾è®¡ä¸å®ç°","url":"/2024/12/19/ECAPA-TDNN%E5%A3%B0%E7%BA%B9%E8%AF%86%E5%88%AB%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/","content":"åŸºäºECAPA-TDNNæ¶æ„çš„å£°çº¹è¯†åˆ«ç³»ç»Ÿï¼Œé›†æˆå®æ—¶å½•éŸ³ã€å£°çº¹æ³¨å†Œã€èº«ä»½è¯†åˆ«å’Œå£°çº¹éªŒè¯åŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œæå–å£°çº¹ç‰¹å¾ï¼Œé€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—å®ç°é«˜ç²¾åº¦å£°çº¹åŒ¹é…ï¼Œå¹¶æ„å»ºäº†å®Œæ•´çš„PyQt5å›¾å½¢ç•Œé¢ã€‚\n\n\nç³»ç»Ÿæ¶æ„æ¦‚è¿°æœ¬å£°çº¹è¯†åˆ«ç³»ç»ŸåŸºäºECAPA-TDNNï¼ˆExtended Context Aggregation and Propagation for Time-Delay Neural Networksï¼‰æ¶æ„ï¼Œå®ç°äº†å®Œæ•´çš„å£°çº¹è¯†åˆ«å·¥ä½œæµç¨‹ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼ŒåŒ…å«éŸ³é¢‘å¤„ç†ã€ç‰¹å¾æå–ã€æ¨¡å‹æ¨ç†å’Œç”¨æˆ·ç•Œé¢å››ä¸ªæ ¸å¿ƒæ¨¡å—ã€‚\næ ¸å¿ƒæŠ€æœ¯æ ˆ\næ·±åº¦å­¦ä¹ æ¡†æ¶: PyTorch\néŸ³é¢‘å¤„ç†: soundcard, soundfile\nå›¾å½¢ç•Œé¢: PyQt5\nç‰¹å¾æå–: MelSpectrogram\nç›¸ä¼¼åº¦è®¡ç®—: ä½™å¼¦ç›¸ä¼¼åº¦\n\nECAPA-TDNNæ¨¡å‹æ¶æ„ECAPA-TDNNæ˜¯å½“å‰æœ€å…ˆè¿›çš„å£°çº¹è¯†åˆ«æ¨¡å‹ä¹‹ä¸€ï¼Œé€šè¿‡æ”¹è¿›çš„Res2Netç»“æ„å’Œæ³¨æ„åŠ›æœºåˆ¶å®ç°é«˜ç²¾åº¦å£°çº¹ç‰¹å¾æå–ã€‚\næ ¸å¿ƒç»„ä»¶è®¾è®¡class EcapaTdnn(nn.Module):\n    def __init__(self, input_size=80, channels=512, embd_dim=192, pooling_type=\"ASP\"):\n        super().__init__()\n        # åˆå§‹å·ç§¯å±‚ï¼š5x1å·ç§¯æ ¸ï¼Œpadding=2ï¼Œä¿æŒæ—¶é—´ç»´åº¦\n        self.layer1 = Conv1dReluBn(input_size, channels, kernel_size=5, padding=2, dilation=1)\n        \n        # SE-Res2Blockç»“æ„ï¼šå¤šå°ºåº¦ç‰¹å¾æå–\n        self.layer2 = SE_Res2Block(channels, kernel_size=3, stride=1, padding=2, dilation=2, scale=8)\n        self.layer3 = SE_Res2Block(channels, kernel_size=3, stride=1, padding=3, dilation=3, scale=8)\n        self.layer4 = SE_Res2Block(channels, kernel_size=3, stride=1, padding=4, dilation=4, scale=8)\n        \n        # ç‰¹å¾èåˆï¼šè¿æ¥ä¸åŒå±‚çš„è¾“å‡º\n        cat_channels = channels * 3\n        self.conv = nn.Conv1d(cat_channels, cat_channels, kernel_size=1)\n        \n        # æ³¨æ„åŠ›ç»Ÿè®¡æ± åŒ–ï¼šæå–å…¨å±€ç‰¹å¾\n        if pooling_type == \"ASP\":\n            self.pooling = AttentiveStatsPool(cat_channels, 128)\n            self.bn1 = nn.BatchNorm1d(cat_channels * 2)\n            self.linear = nn.Linear(cat_channels * 2, embd_dim)\n            self.bn2 = nn.BatchNorm1d(embd_dim)\n\nSE-Res2Blockç»“æ„def SE_Res2Block(channels, kernel_size, stride, padding, dilation, scale):\n    return nn.Sequential(\n        # 1x1å·ç§¯é™ç»´\n        Conv1dReluBn(channels, channels, kernel_size=1, stride=1, padding=0),\n        # Res2Netå¤šå°ºåº¦å·ç§¯\n        Res2Conv1dReluBn(channels, kernel_size, stride, padding, dilation, scale=scale),\n        # 1x1å·ç§¯å‡ç»´\n        Conv1dReluBn(channels, channels, kernel_size=1, stride=1, padding=0),\n        # é€šé“æ³¨æ„åŠ›æœºåˆ¶\n        SE_Connect(channels)\n    )\n\næ³¨æ„åŠ›æœºåˆ¶å®ç°class SE_Connect(nn.Module):\n    def __init__(self, channels, s=2):\n        super().__init__()\n        # å…¨å±€å¹³å‡æ± åŒ– + å…¨è¿æ¥å±‚å®ç°é€šé“æ³¨æ„åŠ›\n        self.linear1 = nn.Linear(channels, channels // s)\n        self.linear2 = nn.Linear(channels // s, channels)\n\n    def forward(self, x):\n        # å…¨å±€å¹³å‡æ± åŒ–\n        out = x.mean(dim=2)\n        # é™ç»´ + æ¿€æ´»\n        out = F.relu(self.linear1(out))\n        # å‡ç»´ + Sigmoidæ¿€æ´»\n        out = torch.sigmoid(self.linear2(out))\n        # é€šé“åŠ æƒ\n        out = x * out.unsqueeze(2)\n        return out\n\néŸ³é¢‘å¤„ç†æ¨¡å—å®æ—¶å½•éŸ³å®ç°class RecordAudio:\n    def __init__(self, channels=1, sample_rate=16000):\n        self.channels = channels\n        self.sample_rate = sample_rate\n        # è·å–ç³»ç»Ÿé»˜è®¤éº¦å…‹é£\n        try:\n            self.default_mic = soundcard.default_microphone()\n        except Exception as e:\n            print(f\"éº¦å…‹é£åˆå§‹åŒ–å¤±è´¥: &#123;e&#125;\")\n            self.default_mic = None\n\n    def record(self, record_seconds=3, save_path=None):\n        \"\"\"é«˜è´¨é‡å½•éŸ³å®ç°\"\"\"\n        if self.default_mic is None:\n            raise Exception(\"éº¦å…‹é£ä¸å¯ç”¨\")\n            \n        # è®¡ç®—éŸ³é¢‘å¸§æ•°\n        num_frames = int(record_seconds * self.sample_rate)\n        \n        # å½•åˆ¶éŸ³é¢‘æ•°æ®\n        data = self.default_mic.record(\n            samplerate=self.sample_rate, \n            numframes=num_frames, \n            channels=self.channels\n        )\n        \n        # æ•°æ®é¢„å¤„ç†ï¼šå»é™¤å•ç»´åº¦\n        if len(data.shape) > 1:\n            audio_data = data.squeeze()\n        else:\n            audio_data = data\n            \n        # å¯é€‰ä¿å­˜éŸ³é¢‘æ–‡ä»¶\n        if save_path is not None:\n            os.makedirs(os.path.dirname(save_path), exist_ok=True)\n            soundfile.write(save_path, data=data, samplerate=self.sample_rate)\n            \n        return audio_data\n\nç‰¹å¾æå–é…ç½®# MelSpectrogramç‰¹å¾æå–å‚æ•°\nfeature_conf:\n  sample_rate: 16000      # é‡‡æ ·ç‡\n  n_fft: 1024            # FFTçª—å£å¤§å°\n  hop_length: 320        # è·³è·ƒé•¿åº¦\n  win_length: 1024       # çª—å£é•¿åº¦\n  f_min: 50.0           # æœ€å°é¢‘ç‡\n  f_max: 14000.0        # æœ€å¤§é¢‘ç‡\n  n_mels: 64            # Melæ»¤æ³¢å™¨æ•°é‡\n\nå£°çº¹è¯†åˆ«æ ¸å¿ƒç®—æ³•ç‰¹å¾æå–ä¸åŒ¹é…class MVectorPredictor:\n    def __init__(self, configs, threshold=0.6, audio_db_path=None, model_path=None, use_gpu=True):\n        # è®¾å¤‡é€‰æ‹©ï¼šGPUåŠ é€Ÿæ¨ç†\n        self.device = torch.device(\"cuda\" if use_gpu and torch.cuda.is_available() else \"cpu\")\n        self.threshold = threshold\n        \n        # éŸ³é¢‘ç‰¹å¾æå–å™¨\n        self._audio_featurizer = AudioFeaturizer(\n            feature_conf=self.configs.feature_conf, \n            **self.configs.preprocess_conf\n        )\n        \n        # åŠ è½½é¢„è®­ç»ƒæ¨¡å‹\n        self.predictor = self._load_model(model_path)\n        \n        # å£°çº¹åº“ç®¡ç†\n        self.audio_feature = None\n        self.users_name = []\n        self.users_audio_path = []\n        \n    def _extract_feature(self, audio_data, sample_rate):\n        \"\"\"æå–å£°çº¹ç‰¹å¾å‘é‡\"\"\"\n        # éŸ³é¢‘é¢„å¤„ç†\n        audio_segment = AudioSegment.from_numpy(audio_data, sample_rate)\n        \n        # ç‰¹å¾æå–ï¼šMelSpectrogram\n        feature = self._audio_featurizer(audio_segment)\n        \n        # æ¨¡å‹æ¨ç†ï¼šæå–å£°çº¹åµŒå…¥\n        with torch.no_grad():\n            embedding = self.predictor(feature.unsqueeze(0))\n            embedding = F.normalize(embedding, p=2, dim=1)\n            \n        return embedding.cpu().numpy()\n\nç›¸ä¼¼åº¦è®¡ç®—ä¸è¯†åˆ«def recognition(self, audio_path, threshold=0.6, sample_rate=16000):\n    \"\"\"å£°çº¹è¯†åˆ«ï¼š1:NåŒ¹é…\"\"\"\n    # æå–å¾…è¯†åˆ«éŸ³é¢‘ç‰¹å¾\n    audio_data = self._load_audio(audio_path, sample_rate)\n    feature = self._extract_feature(audio_data, sample_rate)\n    \n    # ä¸å£°çº¹åº“ä¸­æ‰€æœ‰ç”¨æˆ·æ¯”è¾ƒ\n    similarities = cosine_similarity(feature, self.audio_feature)\n    max_similarity = similarities.max()\n    max_index = similarities.argmax()\n    \n    # é˜ˆå€¼åˆ¤æ–­\n    if max_similarity > threshold:\n        return self.users_name[max_index]\n    else:\n        return None\n\ndef contrast(self, audio_path1, audio_path2):\n    \"\"\"å£°çº¹éªŒè¯ï¼š1:1åŒ¹é…\"\"\"\n    # æå–ä¸¤ä¸ªéŸ³é¢‘çš„ç‰¹å¾\n    audio1 = self._load_audio(audio_path1, self.sample_rate)\n    audio2 = self._load_audio(audio_path2, self.sample_rate)\n    \n    feature1 = self._extract_feature(audio1, self.sample_rate)\n    feature2 = self._extract_feature(audio2, self.sample_rate)\n    \n    # è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦\n    similarity = cosine_similarity(feature1, feature2)[0][0]\n    return similarity\n\nå›¾å½¢ç•Œé¢è®¾è®¡PyQt5ç•Œé¢æ¶æ„class myAPP(QWidget, Ui_Form):\n    def __init__(self):\n        super(myAPP, self).__init__()\n        self.setupUi(self)\n        \n        # åˆå§‹åŒ–ç»„ä»¶\n        self.register_cnt = 0\n        self.recognition_cnt = 0\n        self.record_audio = RecordAudio()\n        \n        # äº‹ä»¶ç»‘å®š\n        self._bind_events()\n        \n        # åŠ è½½å£°çº¹åº“\n        self.users_name = load_audio_db()\n        self.show_speakerdatabase()\n        \n    def _bind_events(self):\n        \"\"\"äº‹ä»¶ç»‘å®šï¼šæ¨¡å—åŒ–è®¾è®¡\"\"\"\n        # å£°çº¹æ³¨å†Œæ¨¡å—\n        self.pushButton_2.clicked.connect(self.register_oepnaudio_pubutton_clicked)\n        self.pushButton.clicked.connect(self.register_record_pubutton_clicked)\n        self.pushButton_7.clicked.connect(self.register_pubutton_clicked)\n        \n        # å£°çº¹è¯†åˆ«æ¨¡å—\n        self.pushButton_3.clicked.connect(self.recognition_record_pubutton_clicked)\n        self.pushButton_4.clicked.connect(self.recognition_oepnaudio_pubutton_clicked)\n        self.pushButton_8.clicked.connect(self.recognition_pubutton_clicked)\n        \n        # å£°çº¹éªŒè¯æ¨¡å—\n        self.pushButton_5.clicked.connect(self.compare_openaduio1)\n        self.pushButton_6.clicked.connect(self.compare_openaduio2)\n        self.pushButton_9.clicked.connect(self.compare_pubutton_clicked)\n\nå¼‚æ­¥å½•éŸ³å¤„ç†def register_record_pubutton_clicked(self):\n    \"\"\"å½•éŸ³æŒ‰é’®çŠ¶æ€æœº\"\"\"\n    if self.register_cnt == 0:\n        # çŠ¶æ€1ï¼šå‡†å¤‡å½•éŸ³\n        self.register_cnt = 1\n        self.set_register_recorder_mode(self.register_cnt)\n        \n    elif self.register_cnt == 1:\n        # çŠ¶æ€2ï¼šæ‰§è¡Œå½•éŸ³ï¼ˆå¼‚æ­¥ï¼‰\n        try:\n            # ä½¿ç”¨QTimeré¿å…é˜»å¡GUIçº¿ç¨‹\n            QTimer.singleShot(100, self._perform_recording)\n        except Exception as e:\n            self._handle_recording_error(e)\n            \n    elif self.register_cnt == 2:\n        # çŠ¶æ€3ï¼šå½•éŸ³å®Œæˆï¼Œé‡ç½®\n        self.register_cnt = 0\n        self.set_register_recorder_mode(self.register_cnt)\n\ndef _perform_recording(self):\n    \"\"\"å¼‚æ­¥å½•éŸ³æ‰§è¡Œ\"\"\"\n    try:\n        # æ‰§è¡Œå½•éŸ³\n        self.register_audio_path = self.record_audio.record(\n            record_seconds=args.record_seconds\n        )\n        \n        # æ›´æ–°GUIçŠ¶æ€\n        self.register_cnt = 2\n        self.set_register_recorder_mode(self.register_cnt)\n        \n    except Exception as e:\n        self._handle_recording_error(e)\n\nç³»ç»Ÿä¼˜åŒ–ä¸äº®ç‚¹1. æ¨¡å‹æ¶æ„ä¼˜åŒ–\nå¤šå°ºåº¦ç‰¹å¾æå–: Res2Netç»“æ„å®ç°ä¸åŒæ„Ÿå—é‡çš„ç‰¹å¾èåˆ\næ³¨æ„åŠ›æœºåˆ¶: SEæ¨¡å—å¢å¼ºé‡è¦ç‰¹å¾é€šé“çš„è¡¨è¾¾èƒ½åŠ›\næ®‹å·®è¿æ¥: ç¼“è§£æ·±å±‚ç½‘ç»œæ¢¯åº¦æ¶ˆå¤±é—®é¢˜\n\n2. éŸ³é¢‘å¤„ç†ä¼˜åŒ–\nå®æ—¶å½•éŸ³: åŸºäºsoundcardåº“çš„é«˜è´¨é‡éŸ³é¢‘é‡‡é›†\næ•°æ®é¢„å¤„ç†: è‡ªåŠ¨éŸ³é¢‘å½’ä¸€åŒ–å’Œç»´åº¦å¤„ç†\né”™è¯¯å¤„ç†: å®Œå–„çš„å¼‚å¸¸æ•è·å’Œç”¨æˆ·æç¤º\n\n3. ç•Œé¢äº¤äº’ä¼˜åŒ–\nçŠ¶æ€æœºè®¾è®¡: æ¸…æ™°çš„å½•éŸ³çŠ¶æ€ç®¡ç†\nå¼‚æ­¥å¤„ç†: QTimeré¿å…GUIé˜»å¡\næ¨¡å—åŒ–æ¶æ„: åŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œä¾¿äºç»´æŠ¤\n\n4. æ€§èƒ½ä¼˜åŒ–\nGPUåŠ é€Ÿ: æ”¯æŒCUDAæ¨ç†åŠ é€Ÿ\næ‰¹å¤„ç†: æ”¯æŒæ‰¹é‡éŸ³é¢‘å¤„ç†\nå†…å­˜ç®¡ç†: é«˜æ•ˆçš„éŸ³é¢‘æ•°æ®ç¼“å­˜\n\næŠ€æœ¯äº®ç‚¹æ€»ç»“æ·±åº¦å­¦ä¹ æŠ€èƒ½\nECAPA-TDNNæ¶æ„: æŒæ¡æœ€å…ˆè¿›çš„å£°çº¹è¯†åˆ«æ¨¡å‹è®¾è®¡\næ³¨æ„åŠ›æœºåˆ¶: ç†è§£SEæ¨¡å—åœ¨ç‰¹å¾æå–ä¸­çš„ä½œç”¨\nå¤šå°ºåº¦å·ç§¯: æŒæ¡Res2Netçš„å¤šå°ºåº¦ç‰¹å¾èåˆæŠ€æœ¯\n\néŸ³é¢‘å¤„ç†æŠ€èƒ½\nå®æ—¶éŸ³é¢‘é‡‡é›†: åŸºäºsoundcardçš„éŸ³é¢‘æµå¤„ç†\nç‰¹å¾å·¥ç¨‹: MelSpectrogramç‰¹å¾æå–å’Œé¢„å¤„ç†\néŸ³é¢‘æ ¼å¼å¤„ç†: æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼çš„è¯»å–å’Œä¿å­˜\n\nç³»ç»Ÿè®¾è®¡æŠ€èƒ½\næ¨¡å—åŒ–æ¶æ„: æ¸…æ™°çš„ä»£ç ç»„ç»‡å’ŒåŠŸèƒ½åˆ†ç¦»\nå¼‚æ­¥ç¼–ç¨‹: PyQt5çš„å¼‚æ­¥äº‹ä»¶å¤„ç†æœºåˆ¶\né”™è¯¯å¤„ç†: å®Œå–„çš„å¼‚å¸¸æ•è·å’Œç”¨æˆ·åé¦ˆ\n\nå·¥ç¨‹å®è·µæŠ€èƒ½\nGUIå¼€å‘: PyQt5å›¾å½¢ç•Œé¢è®¾è®¡å’Œäº‹ä»¶å¤„ç†\né…ç½®ç®¡ç†: YAMLé…ç½®æ–‡ä»¶çš„è§£æå’Œåº”ç”¨\næ¨¡å‹éƒ¨ç½²: é¢„è®­ç»ƒæ¨¡å‹çš„åŠ è½½å’Œæ¨ç†ä¼˜åŒ–\n\nç³»ç»Ÿæµç¨‹å›¾éŸ³é¢‘è¾“å…¥ â†’ é¢„å¤„ç† â†’ ç‰¹å¾æå– â†’ æ¨¡å‹æ¨ç† â†’ ç‰¹å¾åŒ¹é… â†’ ç»“æœè¾“å‡º\n    â†“         â†“         â†“         â†“         â†“         â†“\n  å½•éŸ³&#x2F;æ–‡ä»¶ â†’ å½’ä¸€åŒ– â†’ MelSpec â†’ ECAPA-TDNN â†’ ä½™å¼¦ç›¸ä¼¼åº¦ â†’ èº«ä»½è¯†åˆ«\n\nåº”ç”¨åœºæ™¯\nèº«ä»½è®¤è¯: åŸºäºå£°çº¹çš„ç”Ÿç‰©è¯†åˆ«ç³»ç»Ÿ\nè¯­éŸ³åŠ©æ‰‹: ä¸ªæ€§åŒ–è¯­éŸ³äº¤äº’ç³»ç»Ÿ\nå®‰å…¨ç›‘æ§: å£°çº¹è¯†åˆ«é—¨ç¦ç³»ç»Ÿ\nè¯­éŸ³åˆ†æ: è¯´è¯äººåˆ†ç¦»å’Œè¯†åˆ«\n\næœ¬ç³»ç»Ÿå±•ç¤ºäº†æ·±åº¦å­¦ä¹ åœ¨å£°çº¹è¯†åˆ«é¢†åŸŸçš„å®Œæ•´åº”ç”¨ï¼Œä»æ¨¡å‹è®¾è®¡åˆ°ç³»ç»Ÿå®ç°ï¼Œä½“ç°äº†ç°ä»£AIç³»ç»Ÿçš„å·¥ç¨‹åŒ–å®è·µã€‚\n","categories":["æ·±åº¦å­¦ä¹ ","è¯­éŸ³è¯†åˆ«","è®¡ç®—æœºè§†è§‰"],"tags":["ECAPA-TDNN","å£°çº¹è¯†åˆ«","PyQt5","æ·±åº¦å­¦ä¹ ","è¯­éŸ³å¤„ç†","ç‰¹å¾æå–"]},{"title":"åŸºäºMinio+Redis+Springboot+Vueçš„äº‘ç›˜å­˜å‚¨ç³»ç»Ÿ","url":"/2024/12/24/EasyPan%E4%BA%91%E7%9B%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/","content":"åŸºäºSpring Boot + Vue.jsæ„å»ºçš„ç°ä»£åŒ–äº‘ç›˜å­˜å‚¨ç³»ç»Ÿï¼Œé›†æˆMinIOå¯¹è±¡å­˜å‚¨ã€Redisç¼“å­˜ã€MySQLæ•°æ®åº“ï¼Œå®ç°æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ã€åˆ†äº«ã€é¢„è§ˆç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œæ”¯æŒQQç¬¬ä¸‰æ–¹ç™»å½•ã€æ–‡ä»¶å›æ”¶ç«™ã€è§†é¢‘è½¬ç ç­‰é«˜çº§ç‰¹æ€§ã€‚\n\n\nç³»ç»Ÿæ¶æ„è®¾è®¡æŠ€æœ¯æ ˆé€‰å‹åç«¯æŠ€æœ¯æ ˆï¼š\n\nSpring Boot 2.6.1 - å¾®æœåŠ¡æ¡†æ¶\nMyBatis Plus 3.4.1 - ORMæ¡†æ¶\nMySQL 8.0.30 - å…³ç³»å‹æ•°æ®åº“\nRedis - ç¼“å­˜ä¸ä¼šè¯ç®¡ç†\nMinIO - å¯¹è±¡å­˜å‚¨æœåŠ¡\nFFmpeg - è§†é¢‘è½¬ç å¤„ç†\n\nå‰ç«¯æŠ€æœ¯æ ˆï¼š\n\nVue.js 3.x - å‰ç«¯æ¡†æ¶\nElement Plus - UIç»„ä»¶åº“\nAxios - HTTPå®¢æˆ·ç«¯\nVue Router - è·¯ç”±ç®¡ç†\n\nç³»ç»Ÿæ¶æ„å›¾graph TB\n    A[ç”¨æˆ·æµè§ˆå™¨] --> B[Nginxåå‘ä»£ç†]\n    B --> C[Vue.jså‰ç«¯åº”ç”¨]\n    B --> D[Spring Bootåç«¯æœåŠ¡]\n    D --> E[MySQLæ•°æ®åº“]\n    D --> F[Redisç¼“å­˜]\n    D --> G[MinIOå¯¹è±¡å­˜å‚¨]\n    D --> H[FFmpegè½¬ç æœåŠ¡]\n    \n    subgraph \"æ ¸å¿ƒæ¨¡å—\"\n        I[ç”¨æˆ·ç®¡ç†æ¨¡å—]\n        J[æ–‡ä»¶ç®¡ç†æ¨¡å—]\n        K[åˆ†äº«ç®¡ç†æ¨¡å—]\n        L[å›æ”¶ç«™æ¨¡å—]\n    end\n    \n    D --> I\n    D --> J\n    D --> K\n    D --> L\n\næ ¸å¿ƒåŠŸèƒ½å®ç°1. æ–‡ä»¶å­˜å‚¨æ¶æ„ç³»ç»Ÿé‡‡ç”¨MinIOå¯¹è±¡å­˜å‚¨ä½œä¸ºä¸»è¦å­˜å‚¨æ–¹æ¡ˆï¼Œç»“åˆRedisç¼“å­˜ä¼˜åŒ–æ€§èƒ½ï¼š\n/**\n * MinIOæœåŠ¡æ¥å£ - æ–‡ä»¶å­˜å‚¨æ ¸å¿ƒæœåŠ¡\n */\npublic interface MinioService &#123;\n    // ä¸Šä¼ æ–‡ä»¶åˆ°MinIO\n    void uploadFile(String objectName, MultipartFile file);\n    \n    // åˆ†ç‰‡ä¸Šä¼ æ”¯æŒå¤§æ–‡ä»¶\n    void uploadChunk(String objectName, MultipartFile file, int chunkIndex);\n    \n    // åˆå¹¶åˆ†ç‰‡æ–‡ä»¶\n    void mergeChunks(String objectName, int chunkCount, String userId, String fileId);\n    \n    // è·å–æ–‡ä»¶è¾“å…¥æµ\n    InputStream getFileInputStream(String objectName);\n    \n    // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨\n    boolean fileExists(String objectName);\n&#125;\n\nå­˜å‚¨ä¼˜åŒ–ç­–ç•¥ï¼š\n\nåˆ†ç‰‡ä¸Šä¼ ï¼šæ”¯æŒå¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ \næ–‡ä»¶å»é‡ï¼šåŸºäºMD5å“ˆå¸Œå€¼é¿å…é‡å¤å­˜å‚¨\nç¼“å­˜æœºåˆ¶ï¼šRedisç¼“å­˜çƒ­ç‚¹æ–‡ä»¶å…ƒæ•°æ®\nCDNåŠ é€Ÿï¼šé™æ€èµ„æºé€šè¿‡Nginxç¼“å­˜\n\n2. æ–‡ä»¶åˆ†äº«æœºåˆ¶å®ç°å®‰å…¨å¯æ§çš„æ–‡ä»¶åˆ†äº«åŠŸèƒ½ï¼Œæ”¯æŒæå–ç å’Œè¿‡æœŸæ—¶é—´ï¼š\n/**\n * æ–‡ä»¶åˆ†äº«æ§åˆ¶å™¨ - æ ¸å¿ƒåˆ†äº«é€»è¾‘\n */\n@RestController\n@RequestMapping(\"/file\")\npublic class FileInfoController &#123;\n    \n    /**\n     * åˆ›å»ºæ–‡ä»¶åˆ†äº«é“¾æ¥\n     * æ”¯æŒè‡ªå®šä¹‰æå–ç å’Œè¿‡æœŸæ—¶é—´\n     */\n    @PostMapping(\"/shareFile\")\n    @LoginValidator\n    public Map&lt;String, String> shareFile(HttpSession session, @RequestBody ShareDTO shareDTO) &#123;\n        SessionWebUserVO user = (SessionWebUserVO) session.getAttribute(Constants.SESSION_KEY);\n        \n        // éªŒè¯æ–‡ä»¶æ‰€æœ‰æƒ\n        FileInfo fileInfo = fileInfoService.getOne(new LambdaQueryWrapper&lt;FileInfo>()\n                .eq(FileInfo::getId, shareDTO.getFileId())\n                .eq(FileInfo::getUserId, user.getId()));\n        if (fileInfo == null) throw new BizException(\"æ–‡ä»¶ä¸å­˜åœ¨\");\n        \n        // ç”Ÿæˆåˆ†äº«ä»¤ç‰Œå’Œæå–ç \n        String token = StringTools.getRandomString(32);\n        String code = shareDTO.getExtractCode();\n        long expire = shareDTO.getExpireHours() != null ? shareDTO.getExpireHours() : 24;\n        \n        // æ„å»ºä¸‹è½½ä¿¡æ¯DTO\n        DownloadFileDTO dto = new DownloadFileDTO();\n        dto.setCode(token);\n        dto.setFilename(fileInfo.getFilename());\n        dto.setFilePath(fileInfo.getFilePath());\n        dto.setExtractCode(code);\n        \n        // å­˜å‚¨åˆ°Redisï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´\n        redisComponent.saveDownloadCode(token, dto, expire * 3600);\n        \n        Map&lt;String, String> result = new HashMap&lt;>();\n        result.put(\"shareUrl\", \"/file/shareDownload/\" + token);\n        result.put(\"extractCode\", code);\n        result.put(\"expireTime\", expire + \"å°æ—¶\");\n        return result;\n    &#125;\n    \n    /**\n     * åˆ†äº«æ–‡ä»¶ä¸‹è½½ - æ”¯æŒæœªç™»å½•è®¿é—®\n     * éªŒè¯æå–ç å’Œè¿‡æœŸæ—¶é—´\n     */\n    @GetMapping(\"/shareDownload/&#123;token&#125;\")\n    public void shareDownload(HttpServletRequest request, HttpServletResponse response,\n                              @PathVariable String token, \n                              @RequestParam(required = false) String extractCode) &#123;\n        DownloadFileDTO dto = redisComponent.getDownloadCode(token);\n        if (dto == null) &#123;\n            response.setContentType(\"application/json;charset=UTF-8\");\n            response.getWriter().write(\"&#123;\\\"error\\\":\\\"é“¾æ¥å·²å¤±æ•ˆ\\\"&#125;\");\n            return;\n        &#125;\n        \n        // éªŒè¯æå–ç \n        if (dto.getExtractCode() != null &amp;&amp; !dto.getExtractCode().isEmpty()) &#123;\n            if (!dto.getExtractCode().equals(extractCode)) &#123;\n                response.setContentType(\"application/json;charset=UTF-8\");\n                response.getWriter().write(\"&#123;\\\"error\\\":\\\"æå–ç é”™è¯¯\\\"&#125;\");\n                return;\n            &#125;\n        &#125;\n        \n        // ä»MinIOä¸‹è½½æ–‡ä»¶\n        String filePath = dto.getFilePath();\n        String filename = dto.getFilename();\n        if (minioService.fileExists(filePath)) &#123;\n            InputStream inputStream = minioService.getFileInputStream(filePath);\n            response.setContentType(\"application/x-msdownload; charset=UTF-8\");\n            filename = new String(filename.getBytes(\"UTF-8\"), \"ISO8859-1\");\n            response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + filename + \"\\\"\");\n            FileUtil.readFileFromStream(response, inputStream);\n        &#125;\n    &#125;\n&#125;\n\n3. ç”¨æˆ·è®¤è¯ä¸æˆæƒé›†æˆQQç¬¬ä¸‰æ–¹ç™»å½•ï¼Œå®ç°å¤šç§è®¤è¯æ–¹å¼ï¼š\n/**\n * ç”¨æˆ·æ§åˆ¶å™¨ - è®¤è¯ä¸æˆæƒç®¡ç†\n */\n@RestController\npublic class UserInfoController &#123;\n    \n    /**\n     * QQç¬¬ä¸‰æ–¹ç™»å½•å›è°ƒå¤„ç†\n     * å®ç°OAuth2.0æ ‡å‡†æµç¨‹\n     */\n    @PostMapping(\"/api/qq/callback\")\n    public SessionWebUserVO qqCallback(@RequestBody Map&lt;String, String> param) &#123;\n        String code = param.get(\"code\");\n        RestTemplate restTemplate = new RestTemplate();\n        \n        // 1. æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ\n        String tokenUrl = String.format(\n            \"https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&amp;client_id=%s&amp;client_secret=%s&amp;code=%s&amp;redirect_uri=%s\", \n            qqAppId, qqAppKey, code, qqRedirectUri);\n        String tokenResp = restTemplate.getForObject(tokenUrl, String.class);\n        \n        // 2. è®¿é—®ä»¤ç‰Œæ¢å–OpenID\n        String accessToken = extractAccessToken(tokenResp);\n        String openIdUrl = String.format(\"https://graph.qq.com/oauth2.0/me?access_token=%s\", accessToken);\n        String openIdResp = restTemplate.getForObject(openIdUrl, String.class);\n        String openId = extractOpenId(openIdResp);\n        \n        // 3. è·å–ç”¨æˆ·ä¿¡æ¯\n        String userInfoUrl = String.format(\n            \"https://graph.qq.com/user/get_user_info?access_token=%s&amp;oauth_consumer_key=%s&amp;openid=%s\", \n            accessToken, qqAppId, openId);\n        String userInfoResp = restTemplate.getForObject(userInfoUrl, String.class);\n        JSONObject userJson = new JSONObject(userInfoResp);\n        \n        // 4. æŸ¥æ‰¾æˆ–åˆ›å»ºç”¨æˆ·\n        UserInfo user = userInfoService.getOne(new LambdaQueryWrapper&lt;UserInfo>()\n                .eq(UserInfo::getQqOpenId, openId));\n        if (user == null) &#123;\n            user = createUserFromQQ(userJson, openId);\n            userInfoService.save(user);\n        &#125;\n        \n        // 5. æ„å»ºä¼šè¯ä¿¡æ¯\n        SessionWebUserVO vo = new SessionWebUserVO();\n        vo.setId(user.getId());\n        vo.setNickname(user.getNickname());\n        vo.setAvatar(user.getQqAvatar());\n        return vo;\n    &#125;\n    \n    /**\n     * å¤´åƒä¸Šä¼ ä¸æ›´æ–°\n     * æ”¯æŒMinIOå­˜å‚¨å’Œæœ¬åœ°æ–‡ä»¶å…¼å®¹\n     */\n    @PostMapping(\"/updateUserAvatar\")\n    @LoginValidator\n    public void updateUserAvatar(HttpSession session, MultipartFile avatar) &#123;\n        SessionWebUserVO userVo = (SessionWebUserVO) session.getAttribute(Constants.SESSION_KEY);\n        String avatarObjectName = Constants.FILE_FOLDER_AVATAR_NAME + userVo.getId() + Constants.AVATAR_SUFFIX;\n        \n        try &#123;\n            // ä¸Šä¼ åˆ°MinIO\n            minioService.uploadFile(avatarObjectName, avatar);\n            \n            // æ›´æ–°æ•°æ®åº“\n            UserInfo userInfo = new UserInfo();\n            userInfo.setId(userVo.getId());\n            userInfo.setAvatar(avatarObjectName);\n            userInfo.setQqAvatar(\"\"); // æ¸…é™¤QQå¤´åƒ\n            userInfoService.updateById(userInfo);\n            \n            // æ›´æ–°ä¼šè¯\n            userVo.setAvatar(avatarObjectName);\n            session.setAttribute(Constants.SESSION_KEY, userVo);\n        &#125; catch (Exception e) &#123;\n            throw new BizException(\"å¤´åƒæ›´æ–°å¤±è´¥\");\n        &#125;\n    &#125;\n&#125;\n\n4. æ–‡ä»¶é¢„è§ˆç³»ç»Ÿæ”¯æŒå¤šæ ¼å¼æ–‡ä»¶é¢„è§ˆï¼ŒåŒ…æ‹¬å›¾ç‰‡ã€è§†é¢‘ã€æ–‡æ¡£ç­‰ï¼š\n/**\n * æ–‡ä»¶é¢„è§ˆæ§åˆ¶å™¨ - å¤šæ ¼å¼é¢„è§ˆæ”¯æŒ\n */\n@GetMapping(\"/preview/&#123;id&#125;\")\npublic void previewFile(HttpSession session, HttpServletResponse response,\n                       @PathVariable(\"id\") @NotBlank String id) &#123;\n    SessionWebUserVO user = (SessionWebUserVO) session.getAttribute(Constants.SESSION_KEY);\n    FileInfo fileInfo = fileInfoService.getOne(new LambdaQueryWrapper&lt;FileInfo>()\n            .eq(FileInfo::getId, id)\n            .eq(FileInfo::getUserId, user.getId()));\n    \n    if (fileInfo == null) return;\n    \n    String filePath = fileInfo.getFilePath();\n    String filename = fileInfo.getFilename();\n    \n    if (minioService.fileExists(filePath)) &#123;\n        InputStream inputStream = minioService.getFileInputStream(filePath);\n        String contentType = getPreviewContentType(filename);\n        \n        // æ£€æŸ¥æ˜¯å¦æ”¯æŒé¢„è§ˆ\n        if (\"application/octet-stream\".equals(contentType)) &#123;\n            response.setContentType(\"application/json;charset=UTF-8\");\n            response.getWriter().write(\"&#123;\\\"error\\\":\\\"æš‚ä¸æ”¯æŒè¯¥ç±»å‹æ–‡ä»¶é¢„è§ˆ\\\"&#125;\");\n            return;\n        &#125;\n        \n        response.setContentType(contentType);\n        // å›¾ç‰‡è®¾ç½®ç¼“å­˜\n        if (contentType.startsWith(\"image/\")) &#123;\n            response.setHeader(\"Cache-Control\", \"max-age=2592000\");\n        &#125;\n        FileUtil.readFileFromStream(response, inputStream);\n    &#125;\n&#125;\n\n/**\n * æ ¹æ®æ–‡ä»¶æ‰©å±•åè·å–é¢„è§ˆContent-Type\n */\nprivate String getPreviewContentType(String filename) &#123;\n    String suffix = StringTools.getFileSuffix(filename).toLowerCase();\n    switch (suffix) &#123;\n        case \".jpg\":\n        case \".jpeg\":\n            return \"image/jpeg\";\n        case \".png\":\n            return \"image/png\";\n        case \".mp4\":\n            return \"video/mp4\";\n        case \".pdf\":\n            return \"application/pdf\";\n        case \".txt\":\n            return \"text/plain\";\n        case \".html\":\n            return \"text/html\";\n        default:\n            return \"application/octet-stream\";\n    &#125;\n&#125;\n\n5. å›æ”¶ç«™æœºåˆ¶å®ç°è½¯åˆ é™¤å’Œæ¢å¤æœºåˆ¶ï¼Œä¿æŠ¤ç”¨æˆ·æ•°æ®ï¼š\n/**\n * å›æ”¶ç«™æ§åˆ¶å™¨ - æ–‡ä»¶æ¢å¤ä¸å½»åº•åˆ é™¤\n */\n@RestController\n@RequestMapping(\"/recycle\")\npublic class RecycleController &#123;\n    \n    /**\n     * åŠ è½½å›æ”¶ç«™æ–‡ä»¶åˆ—è¡¨\n     * æŒ‰åˆ é™¤æ—¶é—´å€’åºæ’åˆ—\n     */\n    @GetMapping(\"/loadRecycleList\")\n    public IPage&lt;FileInfoVO> loadRecycleList(HttpSession session, FileInfoQuery query) &#123;\n        Page&lt;FileInfo> pageParam = new Page&lt;>(query.getPage(), query.getLimit());\n        query.setUserId(((SessionWebUserVO) session.getAttribute(Constants.SESSION_KEY)).getId());\n        query.setDeleted(FileDelFlagEnums.RECYCLE.getFlag());\n        query.setOrderBy(\"recovery_time desc\");\n        return fileInfoService.pageInfo(pageParam, query);\n    &#125;\n    \n    /**\n     * æ¢å¤æ–‡ä»¶åˆ°åŸä½ç½®\n     * æ”¯æŒæ‰¹é‡æ¢å¤\n     */\n    @PutMapping(\"/recoverFile/&#123;ids&#125;\")\n    public void recoverFile(HttpSession session, @PathVariable(\"ids\") @NotEmpty String ids) &#123;\n        SessionWebUserVO user = (SessionWebUserVO) session.getAttribute(Constants.SESSION_KEY);\n        fileInfoService.recoverFileBatch(user.getId(), ids);\n    &#125;\n    \n    /**\n     * å½»åº•åˆ é™¤æ–‡ä»¶\n     * ä»æ•°æ®åº“å’ŒMinIOä¸­æ°¸ä¹…åˆ é™¤\n     */\n    @DeleteMapping(\"/delFile/&#123;ids&#125;\")\n    public void delFile(HttpSession session, @PathVariable(\"ids\") @NotEmpty String ids) &#123;\n        SessionWebUserVO user = (SessionWebUserVO) session.getAttribute(Constants.SESSION_KEY);\n        userFileService.delFileBatch(user.getId(), ids, false);\n    &#125;\n&#125;\n\nç³»ç»Ÿä¼˜åŒ–ä¸äº®ç‚¹1. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ç¼“å­˜æ¶æ„è®¾è®¡ï¼š\n/**\n * Redisç¼“å­˜ç»„ä»¶ - å¤šçº§ç¼“å­˜ç­–ç•¥\n */\n@Component(\"redisComponent\")\npublic class RedisComponent &#123;\n    \n    // ç”¨æˆ·ç©ºé—´ä½¿ç”¨æƒ…å†µç¼“å­˜\n    public void saveUserSpaceUse(String userId, UserSpaceDTO userSpaceDto) &#123;\n        redisUtils.setex(Constants.REDIS_KEY_USER_SPACE_USE + userId, \n                        userSpaceDto, Constants.REDIS_KEY_EXPIRE_ONE_DAY);\n    &#125;\n    \n    // æ–‡ä»¶ä¸‹è½½ç ç¼“å­˜ï¼ˆæ”¯æŒè‡ªå®šä¹‰è¿‡æœŸæ—¶é—´ï¼‰\n    public void saveDownloadCode(String code, DownloadFileDTO fileDTO, long expireSeconds) &#123;\n        redisUtils.setex(Constants.REDIS_KEY_DOWNLOAD + code, fileDTO, expireSeconds);\n    &#125;\n    \n    // ä¸´æ—¶æ–‡ä»¶å¤§å°ç»Ÿè®¡\n    public void saveFileTempSize(String userId, String fileId, Long fileSize) &#123;\n        Long currentSize = getFileTempSize(userId, fileId);\n        String key = Constants.REDIS_KEY_USER_FILE_TEMP_SIZE + userId + fileId;\n        redisUtils.setex(key, currentSize + fileSize, Constants.REDIS_KEY_EXPIRE_ONE_HOUR);\n    &#125;\n&#125;\n\næ•°æ®åº“ä¼˜åŒ–ï¼š\n\nç´¢å¼•ä¼˜åŒ–ï¼šç”¨æˆ·IDã€æ–‡ä»¶ç±»å‹ã€åˆ é™¤çŠ¶æ€ç­‰å…³é”®å­—æ®µå»ºç«‹å¤åˆç´¢å¼•\nåˆ†é¡µæŸ¥è¯¢ï¼šMyBatis Plusåˆ†é¡µæ’ä»¶ï¼Œé¿å…å…¨è¡¨æ‰«æ\nè¿æ¥æ± é…ç½®ï¼šHikariCPé«˜æ€§èƒ½è¿æ¥æ± \n\n2. å®‰å…¨æœºåˆ¶è®¾è®¡æ–‡ä»¶è®¿é—®æ§åˆ¶ï¼š\n/**\n * ç™»å½•éªŒè¯åˆ‡é¢ - ç»Ÿä¸€æƒé™æ§åˆ¶\n */\n@Aspect\n@Component\npublic class LoginAspect &#123;\n    \n    @Around(\"@annotation(loginValidator)\")\n    public Object around(ProceedingJoinPoint point, LoginValidator loginValidator) throws Throwable &#123;\n        if (loginValidator.validated()) &#123;\n            // éªŒè¯ç”¨æˆ·ç™»å½•çŠ¶æ€\n            HttpSession session = getHttpSession(point);\n            SessionWebUserVO user = (SessionWebUserVO) session.getAttribute(Constants.SESSION_KEY);\n            if (user == null) &#123;\n                throw new BizException(ResponseCode.CODE_901);\n            &#125;\n        &#125;\n        return point.proceed();\n    &#125;\n&#125;\n\næ•°æ®åŠ å¯†å­˜å‚¨ï¼š\n\nå¯†ç åŠ å¯†ï¼šMD5 + ç›å€¼åŠ å¯†\næ–‡ä»¶è·¯å¾„ï¼šUUIDç”Ÿæˆå”¯ä¸€æ ‡è¯†\nåˆ†äº«é“¾æ¥ï¼š32ä½éšæœºå­—ç¬¦ä¸²\n\n3. å¾®æœåŠ¡æ¶æ„è®¾è®¡æ¨¡å—åŒ–è®¾è®¡ï¼š\neasypan-server&#x2F;\nâ”œâ”€â”€ common&#x2F;                 # å…¬å…±æ¨¡å—\nâ”‚   â””â”€â”€ common-util&#x2F;        # å·¥å…·ç±»åº“\nâ”œâ”€â”€ server&#x2F;                # ä¸»æœåŠ¡æ¨¡å—\nâ”‚   â”œâ”€â”€ controller&#x2F;        # æ§åˆ¶å™¨å±‚\nâ”‚   â”œâ”€â”€ service&#x2F;          # ä¸šåŠ¡é€»è¾‘å±‚\nâ”‚   â”œâ”€â”€ mapper&#x2F;           # æ•°æ®è®¿é—®å±‚\nâ”‚   â””â”€â”€ entity&#x2F;           # å®ä½“ç±»\n\nä¾èµ–ç®¡ç†ï¼š\n&lt;!-- çˆ¶POMç»Ÿä¸€ç‰ˆæœ¬ç®¡ç† -->\n&lt;properties>\n    &lt;springboot.version>2.6.1&lt;/springboot.version>\n    &lt;mysql.version>8.0.30&lt;/mysql.version>\n    &lt;mybatis-plus.version>3.4.1&lt;/mybatis-plus.version>\n    &lt;fastjson.version>2.0.21&lt;/fastjson.version>\n&lt;/properties>\n\næŠ€æœ¯äº®ç‚¹æ€»ç»“1. æ¶æ„è®¾è®¡äº®ç‚¹\nåˆ†å±‚æ¶æ„ï¼šController-Service-Mapperæ¸…æ™°åˆ†å±‚\næ¨¡å—åŒ–è®¾è®¡ï¼šcommon-utilå·¥å…·åº“ç‹¬ç«‹æ‰“åŒ…\nç¼“å­˜ç­–ç•¥ï¼šRediså¤šçº§ç¼“å­˜æå‡æ€§èƒ½\nå­˜å‚¨åˆ†ç¦»ï¼šMinIOå¯¹è±¡å­˜å‚¨ + MySQLå…ƒæ•°æ®\n\n2. åŠŸèƒ½å®ç°äº®ç‚¹\nåˆ†ç‰‡ä¸Šä¼ ï¼šæ”¯æŒå¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ \næ–‡ä»¶åˆ†äº«ï¼šæå–ç  + è¿‡æœŸæ—¶é—´åŒé‡ä¿æŠ¤\nç¬¬ä¸‰æ–¹ç™»å½•ï¼šQQ OAuth2.0æ ‡å‡†å®ç°\næ–‡ä»¶é¢„è§ˆï¼šå¤šæ ¼å¼é¢„è§ˆæ”¯æŒ\nå›æ”¶ç«™æœºåˆ¶ï¼šè½¯åˆ é™¤ + æ¢å¤åŠŸèƒ½\n\n3. æ€§èƒ½ä¼˜åŒ–äº®ç‚¹\nè¿æ¥æ± ä¼˜åŒ–ï¼šHikariCPé«˜æ€§èƒ½è¿æ¥æ± \nç¼“å­˜ç­–ç•¥ï¼šRedisç¼“å­˜çƒ­ç‚¹æ•°æ®\né™æ€èµ„æºï¼šNginxç¼“å­˜ + CDNåŠ é€Ÿ\næ•°æ®åº“ä¼˜åŒ–ï¼šå¤åˆç´¢å¼• + åˆ†é¡µæŸ¥è¯¢\n\n4. å®‰å…¨æœºåˆ¶äº®ç‚¹\næƒé™æ§åˆ¶ï¼šAOPåˆ‡é¢ç»Ÿä¸€éªŒè¯\næ•°æ®åŠ å¯†ï¼šå¯†ç MD5åŠ å¯†å­˜å‚¨\næ–‡ä»¶éš”ç¦»ï¼šç”¨æˆ·æ–‡ä»¶è·¯å¾„éš”ç¦»\nè®¿é—®æ§åˆ¶ï¼šåˆ†äº«é“¾æ¥æƒé™éªŒè¯\n\nå­¦ä¹ æ”¶è·ä¸æŠ€èƒ½æå‡æŠ€æœ¯èƒ½åŠ›æå‡\nSpring Bootå¾®æœåŠ¡æ¶æ„ï¼šæŒæ¡ä¼ä¸šçº§åº”ç”¨å¼€å‘æ¨¡å¼\nå¯¹è±¡å­˜å‚¨æŠ€æœ¯ï¼šMinIOåˆ†å¸ƒå¼å­˜å‚¨å®è·µ\nç¼“å­˜æ¶æ„è®¾è®¡ï¼šRediså¤šçº§ç¼“å­˜ç­–ç•¥\nç¬¬ä¸‰æ–¹é›†æˆï¼šOAuth2.0æ ‡å‡†å®ç°\næ–‡ä»¶å¤„ç†æŠ€æœ¯ï¼šåˆ†ç‰‡ä¸Šä¼ ã€è½¬ç ã€é¢„è§ˆ\n\nç³»ç»Ÿè®¾è®¡èƒ½åŠ›\næ¶æ„è®¾è®¡ï¼šåˆ†å±‚æ¶æ„ã€æ¨¡å—åŒ–è®¾è®¡\næ€§èƒ½ä¼˜åŒ–ï¼šç¼“å­˜ç­–ç•¥ã€æ•°æ®åº“ä¼˜åŒ–\nå®‰å…¨è®¾è®¡ï¼šæƒé™æ§åˆ¶ã€æ•°æ®åŠ å¯†\nç”¨æˆ·ä½“éªŒï¼šæ–‡ä»¶é¢„è§ˆã€åˆ†äº«æœºåˆ¶\n\nå·¥ç¨‹å®è·µèƒ½åŠ›\nä»£ç è§„èŒƒï¼šç»Ÿä¸€å¼‚å¸¸å¤„ç†ã€å“åº”æ ¼å¼\næµ‹è¯•é©±åŠ¨ï¼šå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•\néƒ¨ç½²è¿ç»´ï¼šDockerå®¹å™¨åŒ–ã€Nginxé…ç½®\nç›‘æ§å‘Šè­¦ï¼šæ—¥å¿—ç®¡ç†ã€æ€§èƒ½ç›‘æ§\n\né€šè¿‡EasyPanäº‘ç›˜ç³»ç»Ÿçš„è®¾è®¡ä¸å®ç°ï¼Œæ·±å…¥ç†è§£äº†ç°ä»£Webåº”ç”¨çš„å…¨æ ˆå¼€å‘æ¨¡å¼ï¼ŒæŒæ¡äº†å¾®æœåŠ¡æ¶æ„ã€å¯¹è±¡å­˜å‚¨ã€ç¼“å­˜è®¾è®¡ç­‰æ ¸å¿ƒæŠ€æœ¯ï¼Œä¸ºåç»­å¤§å‹é¡¹ç›®å¼€å‘å¥ å®šäº†åšå®åŸºç¡€ã€‚\n","categories":["åç«¯å¼€å‘","ç³»ç»Ÿè®¾è®¡"],"tags":["Spring Boot","Vue.js","MinIO","Redis","MySQL","äº‘å­˜å‚¨","æ–‡ä»¶ç®¡ç†","å¾®æœåŠ¡æ¶æ„"]},{"title":"GPT-2ä¸­æ–‡èŠå¤©æœºå™¨äººï¼šåŸºäºDialoGPTçš„åŒæ¨¡å‹æ¶æ„è®¾è®¡ä¸å®ç°","url":"/2024/12/19/GPT2%E4%B8%AD%E6%96%87%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0/","content":"åŸºäºGPT-2æ¶æ„çš„ä¸­æ–‡èŠå¤©æœºå™¨äººç³»ç»Ÿï¼Œé‡‡ç”¨DialoGPTçš„åŒæ¨¡å‹è®¾è®¡ç†å¿µï¼Œé€šè¿‡å¯¹è¯æ¨¡å‹å’Œäº’ä¿¡æ¯æ¨¡å‹çš„ååŒå·¥ä½œï¼Œå®ç°äº†é«˜è´¨é‡çš„ä¸­æ–‡å¯¹è¯ç”Ÿæˆã€‚æœ¬æ–‡æ·±å…¥åˆ†æäº†ç³»ç»Ÿçš„æŠ€æœ¯æ¶æ„ã€æ ¸å¿ƒç®—æ³•å®ç°ä»¥åŠä¼˜åŒ–ç­–ç•¥ã€‚\n\n\nç³»ç»Ÿæ¦‚è¿°æœ¬ç³»ç»ŸåŸºäºå¾®è½¯DialoGPTè®ºæ–‡çš„è®¾è®¡æ€æƒ³ï¼Œæ„å»ºäº†ä¸€ä¸ªåŒæ¨¡å‹æ¶æ„çš„ä¸­æ–‡èŠå¤©æœºå™¨äººã€‚ç³»ç»Ÿæ ¸å¿ƒåˆ›æ–°åœ¨äºå¼•å…¥äº’ä¿¡æ¯æœ€å¤§åŒ–ï¼ˆMMIï¼‰æœºåˆ¶ï¼Œé€šè¿‡å¯¹è¯æ¨¡å‹ç”Ÿæˆå¤šä¸ªå€™é€‰å“åº”ï¼Œå†ä½¿ç”¨MMIæ¨¡å‹è¿›è¡Œç­›é€‰ï¼Œæ˜¾è‘—æå‡äº†å¯¹è¯è´¨é‡å’Œä¸Šä¸‹æ–‡è¿è´¯æ€§ã€‚\næ ¸å¿ƒç‰¹æ€§\nåŒæ¨¡å‹æ¶æ„ï¼šå¯¹è¯æ¨¡å‹è´Ÿè´£ç”Ÿæˆï¼ŒMMIæ¨¡å‹è´Ÿè´£ç­›é€‰\nä¸­æ–‡ä¼˜åŒ–ï¼šé’ˆå¯¹ä¸­æ–‡è¯­è¨€ç‰¹ç‚¹è¿›è¡Œæ¨¡å‹è°ƒä¼˜\nä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼šæ”¯æŒå¤šè½®å¯¹è¯å†å²ç®¡ç†\næ™ºèƒ½é‡‡æ ·ï¼šé›†æˆTop-kå’ŒNucleusé‡‡æ ·ç­–ç•¥\næ‰¹é‡ä¼˜åŒ–ï¼šæ”¯æŒæ‰¹é‡ç”Ÿæˆå’Œç­›é€‰æœºåˆ¶\n\næŠ€æœ¯æ¶æ„è®¾è®¡ç³»ç»Ÿæ¶æ„å›¾\næ ¸å¿ƒç»„ä»¶åˆ†æ1. å¯¹è¯æ¨¡å‹ (Dialogue Model)å¯¹è¯æ¨¡å‹åŸºäºGPT-2æ¶æ„ï¼Œè´Ÿè´£æ ¹æ®å¯¹è¯å†å²ç”Ÿæˆå€™é€‰å“åº”ã€‚å…¶è®­ç»ƒæ•°æ®é‡‡ç”¨é¡ºåºæ‹¼æ¥æ–¹å¼ï¼š\n# å¯¹è¯æ¨¡å‹è®­ç»ƒæ•°æ®æ ¼å¼\n# è¾“å…¥: [CLS]ç”¨æˆ·1[SEP]æœºå™¨äºº1[SEP]ç”¨æˆ·2[SEP]æœºå™¨äºº2[SEP]\n# ç›®æ ‡: å­¦ä¹ é¢„æµ‹ä¸‹ä¸€ä¸ªtoken\n\ndef preprocess_raw_data(args, tokenizer, n_ctx):\n    \"\"\"\n    å¯¹è¯æ¨¡å‹æ•°æ®é¢„å¤„ç†\n    å°†å¤šè½®å¯¹è¯æŒ‰é¡ºåºæ‹¼æ¥ï¼Œæ„å»ºè®­ç»ƒæ ·æœ¬\n    \"\"\"\n    dialogue_ids = [tokenizer.cls_token_id]  # å¯¹è¯å¼€å§‹æ ‡è®°\n    for utterance in utterances:\n        # å°†æ¯ä¸ªutteranceè½¬æ¢ä¸ºtoken ID\n        dialogue_ids.extend([tokenizer.convert_tokens_to_ids(word) for word in utterance])\n        dialogue_ids.append(tokenizer.sep_token_id)  # è¯­å¥ç»“æŸæ ‡è®°\n    return dialogue_ids[:n_ctx]  # æˆªæ–­åˆ°æœ€å¤§é•¿åº¦\n\n2. MMIæ¨¡å‹ (Maximum Mutual Information)MMIæ¨¡å‹åŒæ ·åŸºäºGPT-2æ¶æ„ï¼Œä½†é‡‡ç”¨é€†åºæ‹¼æ¥çš„è®­ç»ƒæ–¹å¼ï¼Œç”¨äºè®¡ç®—å“åº”ä¸å¯¹è¯å†å²çš„äº’ä¿¡æ¯ï¼š\ndef preprocess_mmi_raw_data(args, tokenizer, n_ctx):\n    \"\"\"\n    MMIæ¨¡å‹æ•°æ®é¢„å¤„ç†\n    å°†å¯¹è¯å†å²é€†åºæ‹¼æ¥ï¼Œå­¦ä¹ P(Source|Response)\n    \"\"\"\n    dialogue_ids = [tokenizer.cls_token_id]\n    for utterance in reversed(utterances):  # å…³é”®ï¼šé€†åºå¤„ç†\n        dialogue_ids.extend([tokenizer.convert_tokens_to_ids(word) for word in utterance])\n        dialogue_ids.append(tokenizer.sep_token_id)\n    return dialogue_ids[:n_ctx]\n\n3. æ™ºèƒ½é‡‡æ ·ç­–ç•¥ç³»ç»Ÿé›†æˆäº†å¤šç§é‡‡æ ·ç­–ç•¥ï¼Œæå‡ç”Ÿæˆè´¨é‡ï¼š\ndef top_k_top_p_filtering(logits, top_k=0, top_p=0.0, filter_value=-float('Inf')):\n    \"\"\"\n    é›†æˆTop-kå’ŒNucleusé‡‡æ ·çš„è¿‡æ»¤å‡½æ•°\n    \"\"\"\n    # Top-ké‡‡æ ·ï¼šä¿ç•™æ¦‚ç‡æœ€é«˜çš„kä¸ªtoken\n    if top_k > 0:\n        indices_to_remove = logits &lt; torch.topk(logits, top_k)[0][..., -1, None]\n        logits[indices_to_remove] = filter_value\n    \n    # Nucleusé‡‡æ ·ï¼šä¿ç•™ç´¯ç§¯æ¦‚ç‡è¾¾åˆ°pçš„tokené›†åˆ\n    if top_p > 0.0:\n        sorted_logits, sorted_indices = torch.sort(logits, descending=True)\n        cumulative_probs = torch.cumsum(F.softmax(sorted_logits, dim=-1), dim=-1)\n        sorted_indices_to_remove = cumulative_probs > top_p\n        sorted_indices_to_remove[..., 1:] = sorted_indices_to_remove[..., :-1].clone()\n        sorted_indices_to_remove[..., 0] = 0\n        indices_to_remove = sorted_indices[sorted_indices_to_remove]\n        logits[indices_to_remove] = filter_value\n    \n    return logits\n\næ ¸å¿ƒç®—æ³•å®ç°1. å¯¹è¯ç”Ÿæˆæµç¨‹def generate_response(dialogue_model, history, tokenizer, args):\n    \"\"\"\n    å¯¹è¯ç”Ÿæˆæ ¸å¿ƒç®—æ³•\n    \"\"\"\n    # æ„å»ºè¾“å…¥åºåˆ—\n    input_ids = [tokenizer.cls_token_id]\n    for history_utr in history[-args.max_history_len:]:\n        input_ids.extend(history_utr)\n        input_ids.append(tokenizer.sep_token_id)\n    \n    # è‡ªå›å½’ç”Ÿæˆ\n    generated = []\n    curr_input_tensor = torch.tensor(input_ids).long().to(device)\n    \n    for _ in range(args.max_len):\n        outputs = dialogue_model(input_ids=curr_input_tensor)\n        next_token_logits = outputs[0][-1, :]\n        \n        # é‡å¤æƒ©ç½šæœºåˆ¶\n        for token_id in set(generated):\n            next_token_logits[token_id] /= args.repetition_penalty\n        \n        # åº”ç”¨é‡‡æ ·ç­–ç•¥\n        filtered_logits = top_k_top_p_filtering(\n            next_token_logits, \n            top_k=args.topk, \n            top_p=args.topp\n        )\n        \n        # é‡‡æ ·ä¸‹ä¸€ä¸ªtoken\n        next_token = torch.multinomial(\n            F.softmax(filtered_logits, dim=-1), \n            num_samples=1\n        )\n        \n        if next_token == tokenizer.sep_token_id:\n            break\n            \n        generated.append(next_token.item())\n        curr_input_tensor = torch.cat((curr_input_tensor, next_token), dim=0)\n    \n    return generated\n\n2. MMIç­›é€‰æœºåˆ¶def mmi_selection(candidate_responses, history, mmi_model, tokenizer, args):\n    \"\"\"\n    MMIæ¨¡å‹ç­›é€‰æœ€ä¼˜å“åº”\n    \"\"\"\n    min_loss = float('Inf')\n    best_response = \"\"\n    \n    for response in candidate_responses:\n        # æ„å»ºMMIæ¨¡å‹è¾“å…¥ï¼ˆé€†åºæ‹¼æ¥ï¼‰\n        mmi_input_id = [tokenizer.cls_token_id]\n        mmi_input_id.extend(response)\n        mmi_input_id.append(tokenizer.sep_token_id)\n        \n        # é€†åºæ·»åŠ å¯¹è¯å†å²\n        for history_utr in reversed(history[-args.max_history_len:]):\n            mmi_input_id.extend(history_utr)\n            mmi_input_id.append(tokenizer.sep_token_id)\n        \n        # è®¡ç®—äº’ä¿¡æ¯æŸå¤±\n        mmi_input_tensor = torch.tensor(mmi_input_id).long().to(device)\n        out = mmi_model(input_ids=mmi_input_tensor, labels=mmi_input_tensor)\n        loss = out[0].item()\n        \n        # é€‰æ‹©æŸå¤±æœ€å°çš„å“åº”\n        if loss &lt; min_loss:\n            best_response = response\n            min_loss = loss\n    \n    return best_response\n\n3. æ‰¹é‡ç”Ÿæˆä¼˜åŒ–def batch_generate_responses(dialogue_model, history, tokenizer, args):\n    \"\"\"\n    æ‰¹é‡ç”Ÿæˆå¤šä¸ªå€™é€‰å“åº”ï¼Œæå‡æ•ˆç‡\n    \"\"\"\n    input_ids = [tokenizer.cls_token_id]\n    for history_utr in history[-args.max_history_len:]:\n        input_ids.extend(history_utr)\n        input_ids.append(tokenizer.sep_token_id)\n    \n    # æ‰¹é‡å¤„ç†\n    batch_input_ids = [copy.deepcopy(input_ids) for _ in range(args.batch_size)]\n    curr_input_tensors = torch.tensor(batch_input_ids).long().to(device)\n    \n    generated = []\n    finish_set = set()\n    \n    for _ in range(args.max_len):\n        outputs = dialogue_model(input_ids=curr_input_tensors)\n        next_token_logits = outputs[0][:, -1, :]\n        \n        # æ‰¹é‡åº”ç”¨é‡å¤æƒ©ç½š\n        for index in range(args.batch_size):\n            for token_id in set([token_ids[index] for token_ids in generated]):\n                next_token_logits[index][token_id] /= args.repetition_penalty\n        \n        # æ‰¹é‡é‡‡æ ·\n        filtered_logits = top_k_top_p_filtering(\n            next_token_logits, \n            top_k=args.topk, \n            top_p=args.topp\n        )\n        next_token = torch.multinomial(\n            F.softmax(filtered_logits, dim=-1), \n            num_samples=1\n        )\n        \n        # æ£€æŸ¥ç”Ÿæˆå®ŒæˆçŠ¶æ€\n        for index, token_id in enumerate(next_token[:, 0]):\n            if token_id == tokenizer.sep_token_id:\n                finish_set.add(index)\n        \n        if len(finish_set) == args.batch_size:\n            break\n            \n        generated.append([token.item() for token in next_token[:, 0]])\n        curr_input_tensors = torch.cat((curr_input_tensors, next_token), dim=-1)\n    \n    return generated\n\næ¨¡å‹é…ç½®ä¸ä¼˜åŒ–æ¨¡å‹å‚æ•°é…ç½®&#123;\n  \"initializer_range\": 0.02,\n  \"layer_norm_epsilon\": 1e-05,\n  \"n_ctx\": 300,\n  \"n_embd\": 768,\n  \"n_head\": 12,\n  \"n_layer\": 10,\n  \"n_positions\": 300,\n  \"vocab_size\": 13317\n&#125;\n\nè®­ç»ƒä¼˜åŒ–ç­–ç•¥def calculate_loss_and_accuracy(outputs, labels, device):\n    \"\"\"\n    è®¡ç®—è®­ç»ƒæŸå¤±å’Œå‡†ç¡®ç‡\n    \"\"\"\n    logits = outputs[0]\n    shift_logits = logits[..., :-1, :].contiguous()\n    shift_labels = labels[..., 1:].contiguous().to(device)\n    \n    # ä½¿ç”¨äº¤å‰ç†µæŸå¤±ï¼Œå¿½ç•¥PAD token\n    loss_fct = CrossEntropyLoss(ignore_index=pad_id, reduction='sum')\n    loss = loss_fct(shift_logits.view(-1, shift_logits.size(-1)),\n                    shift_labels.view(-1))\n    \n    # è®¡ç®—å‡†ç¡®ç‡\n    _, preds = shift_logits.max(dim=-1)\n    not_ignore = shift_labels.ne(pad_id)\n    num_targets = not_ignore.long().sum().item()\n    correct = (shift_labels == preds) &amp; not_ignore\n    accuracy = correct.float().sum() / num_targets\n    \n    return loss / num_targets, accuracy\n\nç³»ç»Ÿä¼˜åŒ–ä¸äº®ç‚¹1. å†…å­˜ä¼˜åŒ–\næ¢¯åº¦ç´¯ç§¯ï¼šæ”¯æŒå¤§æ‰¹é‡è®­ç»ƒï¼Œå‡å°‘æ˜¾å­˜å ç”¨\nåŠ¨æ€æˆªæ–­ï¼šæ ¹æ®ä¸Šä¸‹æ–‡é•¿åº¦åŠ¨æ€è°ƒæ•´è¾“å…¥åºåˆ—\nç¼“å­˜æœºåˆ¶ï¼šä¼˜åŒ–é‡å¤è®¡ç®—ï¼Œæå‡æ¨ç†é€Ÿåº¦\n\n2. ç”Ÿæˆè´¨é‡ä¼˜åŒ–\né‡å¤æƒ©ç½šï¼šé¿å…ç”Ÿæˆé‡å¤å†…å®¹\næ¸©åº¦è°ƒèŠ‚ï¼šæ§åˆ¶ç”Ÿæˆçš„éšæœºæ€§\nä¸Šä¸‹æ–‡ç®¡ç†ï¼šç»´æŠ¤å¯¹è¯å†å²ï¼Œæå‡è¿è´¯æ€§\n\n3. å·¥ç¨‹åŒ–ä¼˜åŒ–\nå¤šGPUæ”¯æŒï¼šæ”¯æŒåˆ†å¸ƒå¼è®­ç»ƒå’Œæ¨ç†\næ—¥å¿—ç³»ç»Ÿï¼šå®Œæ•´çš„è®­ç»ƒå’Œæ¨ç†æ—¥å¿—\né…ç½®ç®¡ç†ï¼šçµæ´»çš„æ¨¡å‹å’Œè®­ç»ƒå‚æ•°é…ç½®\n\nå­¦ä¹ æˆæœä¸æŠ€èƒ½æ€»ç»“æ ¸å¿ƒæŠ€æœ¯æŒæ¡\nGPT-2æ¶æ„æ·±å…¥ç†è§£\n\nTransformerè§£ç å™¨æœºåˆ¶\nè‡ªå›å½’è¯­è¨€å»ºæ¨¡\næ³¨æ„åŠ›æœºåˆ¶ä¼˜åŒ–\n\n\nå¯¹è¯ç³»ç»Ÿè®¾è®¡\n\nå¤šè½®å¯¹è¯å»ºæ¨¡\nä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥\nå“åº”ç”Ÿæˆä¼˜åŒ–\n\n\näº’ä¿¡æ¯ç†è®ºåº”ç”¨\n\nMMIæ¨¡å‹è®¾è®¡åŸç†\nå€™é€‰å“åº”ç­›é€‰æœºåˆ¶\nè´¨é‡è¯„ä¼°æŒ‡æ ‡\n\n\næ·±åº¦å­¦ä¹ å·¥ç¨‹å®è·µ\n\næ¨¡å‹è®­ç»ƒä¼˜åŒ–\næ‰¹é‡å¤„ç†æœºåˆ¶\nå†…å­˜ç®¡ç†ç­–ç•¥\n\n\n\nç³»ç»Ÿäº®ç‚¹\nåˆ›æ–°æ¶æ„è®¾è®¡ï¼šåŒæ¨¡å‹ååŒå·¥ä½œï¼Œæ˜¾è‘—æå‡å¯¹è¯è´¨é‡\nä¸­æ–‡è¯­è¨€ä¼˜åŒ–ï¼šé’ˆå¯¹ä¸­æ–‡ç‰¹ç‚¹è¿›è¡Œæ¨¡å‹è°ƒä¼˜\nå·¥ç¨‹åŒ–å®ç°ï¼šå®Œæ•´çš„è®­ç»ƒã€æ¨ç†å’Œéƒ¨ç½²æµç¨‹\næ€§èƒ½ä¼˜åŒ–ï¼šæ”¯æŒæ‰¹é‡å¤„ç†å’ŒGPUåŠ é€Ÿ\nå¯æ‰©å±•æ€§ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºåŠŸèƒ½æ‰©å±•\n\næŠ€æœ¯å±•æœ›æœªæ¥ä¼˜åŒ–æ–¹å‘\næ¨¡å‹æ¶æ„å‡çº§ï¼šæ¢ç´¢æ›´å…ˆè¿›çš„é¢„è®­ç»ƒæ¨¡å‹\nå¤šæ¨¡æ€æ”¯æŒï¼šé›†æˆå›¾åƒã€è¯­éŸ³ç­‰å¤šæ¨¡æ€è¾“å…¥\nä¸ªæ€§åŒ–å®šåˆ¶ï¼šæ”¯æŒç”¨æˆ·ä¸ªæ€§åŒ–å¯¹è¯é£æ ¼\nå®æ—¶å­¦ä¹ ï¼šå®ç°åœ¨çº¿å­¦ä¹ å’Œæ¨¡å‹æ›´æ–°\nå®‰å…¨æœºåˆ¶ï¼šå¢å¼ºå†…å®¹å®‰å…¨å’Œä¼¦ç†çº¦æŸ\n\nåº”ç”¨åœºæ™¯æ‰©å±•\nå®¢æœæœºå™¨äººï¼šä¼ä¸šçº§å®¢æœè‡ªåŠ¨åŒ–\næ•™è‚²åŠ©æ‰‹ï¼šä¸ªæ€§åŒ–å­¦ä¹ è¾…å¯¼\nå¨±ä¹èŠå¤©ï¼šæ™ºèƒ½ç¤¾äº¤æœºå™¨äºº\nä¸“ä¸šå’¨è¯¢ï¼šé¢†åŸŸä¸“å®¶å¯¹è¯ç³»ç»Ÿ\n\næ€»ç»“æœ¬ç³»ç»ŸæˆåŠŸå®ç°äº†åŸºäºGPT-2çš„ä¸­æ–‡èŠå¤©æœºå™¨äººï¼Œé€šè¿‡åŒæ¨¡å‹æ¶æ„å’Œäº’ä¿¡æ¯ç­›é€‰æœºåˆ¶ï¼Œåœ¨å¯¹è¯è´¨é‡å’Œä¸Šä¸‹æ–‡è¿è´¯æ€§æ–¹é¢å–å¾—äº†æ˜¾è‘—æå‡ã€‚ç³»ç»Ÿä¸ä»…å…·æœ‰å®Œæ•´çš„æŠ€æœ¯å®ç°ï¼Œè¿˜ä½“ç°äº†æ·±åº¦å­¦ä¹ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸçš„å·¥ç¨‹åŒ–åº”ç”¨ä»·å€¼ã€‚\né€šè¿‡æœ¬é¡¹ç›®çš„å®è·µï¼Œæ·±å…¥æŒæ¡äº†GPT-2æ¨¡å‹æ¶æ„ã€å¯¹è¯ç³»ç»Ÿè®¾è®¡ã€äº’ä¿¡æ¯ç†è®ºåº”ç”¨ç­‰æ ¸å¿ƒæŠ€æœ¯ï¼Œä¸ºåç»­çš„NLPé¡¹ç›®å¼€å‘å¥ å®šäº†åšå®åŸºç¡€ã€‚ç³»ç»Ÿçš„æ¨¡å—åŒ–è®¾è®¡å’Œä¼˜åŒ–ç­–ç•¥ä¹Ÿä¸ºå¤§è§„æ¨¡éƒ¨ç½²å’ŒåŠŸèƒ½æ‰©å±•æä¾›äº†è‰¯å¥½çš„æŠ€æœ¯æ”¯æ’‘ã€‚\n","categories":["æ·±åº¦å­¦ä¹ ","è‡ªç„¶è¯­è¨€å¤„ç†","èŠå¤©æœºå™¨äºº"],"tags":["æ·±åº¦å­¦ä¹ ","GPT-2","DialoGPT","ä¸­æ–‡å¯¹è¯","è‡ªç„¶è¯­è¨€å¤„ç†","äº’ä¿¡æ¯","å¯¹è¯ç”Ÿæˆ"]},{"title":"Yolo11äº¤é€šæ ‡å¿—æ£€æµ‹ç³»ç»Ÿ","url":"/2025/09/10/Yolo11%E4%BA%A4%E9%80%9A%E6%A0%87%E5%BF%97%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/","content":"å…³äºYolov11æ¨¡å‹çš„äº¤é€šæ ‡å¿—æ£€æµ‹é¡¹ç›®ï¼ˆæœ¬äººç‹¬ç«‹å¼€å‘ï¼Œä¸”å·²ç”³è¯·è®¡ç®—æœºè½¯ä»¶è‘—ä½œæƒï¼Œè¯·å‹¿éšæ„è½¬è½½ï¼‰\n\n\n\n\n\n\n    \n    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚\n\n\n\n\n\nä¸€ã€é¡¹ç›®æ¦‚è¿°1.1 é¡¹ç›®ç®€ä»‹æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºYOLOv11çš„æ™ºèƒ½äº¤é€šæ ‡å¿—æ£€æµ‹ç³»ç»Ÿï¼Œæ”¯æŒå®æ—¶æ£€æµ‹ã€å›¾ç‰‡æ£€æµ‹å’Œè§†é¢‘æ£€æµ‹ä¸‰ç§æ¨¡å¼ã€‚é¡¹ç›®é‡‡ç”¨PyQt5æ„å»ºç°ä»£åŒ–GUIç•Œé¢ï¼Œé›†æˆäº†åŸå§‹è®­ç»ƒè„šæœ¬å’Œä¼˜åŒ–è®­ç»ƒè„šæœ¬ï¼Œä¸“é—¨é’ˆå¯¹å°ç›®æ ‡æ£€æµ‹è¿›è¡Œäº†æ·±åº¦ä¼˜åŒ–ã€‚\n\nâ€‹                                                                                    æ£€æµ‹ç³»ç»Ÿæ—¶åºå›¾\n1.2 ä¸»è¦ç‰¹æ€§\nå¤šæ¨¡å¼æ£€æµ‹ï¼šæ”¯æŒæ‘„åƒå¤´å®æ—¶æ£€æµ‹ã€å›¾ç‰‡æ‰¹é‡æ£€æµ‹ã€è§†é¢‘æµæ£€æµ‹\nç°ä»£åŒ–UIï¼šé‡‡ç”¨æ¸å˜è‰²å½©å’Œåœ†è§’è®¾è®¡ï¼Œæä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ\næ™ºèƒ½ä¼˜åŒ–ï¼šé›†æˆæ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾èåˆï¼Œæå‡å°ç›®æ ‡æ£€æµ‹èƒ½åŠ›\nå®Œæ•´æµç¨‹ï¼šåŒ…å«æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€éªŒè¯ã€å¯¼å‡ºå’Œéƒ¨ç½²çš„å®Œæ•´æµç¨‹\nç»Ÿè®¡åˆ†æï¼šæä¾›è¯¦ç»†çš„æ£€æµ‹ç»Ÿè®¡å’Œå†å²è®°å½•åŠŸèƒ½\n\n1.3 æŠ€æœ¯æ ˆ\næ·±åº¦å­¦ä¹ æ¡†æ¶ï¼šPyTorch + Ultralytics YOLOv11\n\nGUIæ¡†æ¶ï¼šPyQt5\n\nè®¡ç®—æœºè§†è§‰ï¼šOpenCV\n\næ•°æ®å¤„ç†ï¼šNumPy, PIL\n\né…ç½®ç®¡ç†ï¼šYAML, JSON\n\n\näºŒã€YOLOè®­ç»ƒå…¨æµç¨‹è¯¦è§£2.1 æ•°æ®å‡†å¤‡é˜¶æ®µ2.1.1 æ•°æ®é›†ç»“æ„data&#x2F;\nâ”œâ”€â”€ train&#x2F;\nâ”‚   â”œâ”€â”€ images&#x2F;          # è®­ç»ƒå›¾ç‰‡ (16,356å¼ )\nâ”‚   â””â”€â”€ labels&#x2F;          # è®­ç»ƒæ ‡ç­¾ (16,356ä¸ª)\nâ”œâ”€â”€ test&#x2F;\nâ”‚   â”œâ”€â”€ images&#x2F;          # æµ‹è¯•å›¾ç‰‡ (1,500å¼ )\nâ”‚   â””â”€â”€ labels&#x2F;          # æµ‹è¯•æ ‡ç­¾ (1,500ä¸ª)\nâ””â”€â”€ dataset.yaml         # æ•°æ®é›†é…ç½®æ–‡ä»¶\n\n2.1.2 æ ‡ç­¾æ ¼å¼é‡‡ç”¨YOLOæ ¼å¼çš„æ ‡ç­¾æ–‡ä»¶ï¼Œæ¯ä¸ªæ ‡ç­¾æ–‡ä»¶åŒ…å«ï¼š\n\nç±»åˆ«ID (0: mandatory, 1: prohibitory, 2: warning)\nè¾¹ç•Œæ¡†åæ ‡ (å½’ä¸€åŒ–çš„ä¸­å¿ƒç‚¹åæ ‡å’Œå®½é«˜)\næ ¼å¼ï¼šclass_id center_x center_y width height\n\n2.1.3 æ•°æ®é›†é…ç½®path: /path/to/data\ntrain: train/images\nval: test/images\ntest: test/images\nnc: 3\nnames: ['mandatory', 'prohibitory', 'warning']\n\n2.2 æ¨¡å‹è®­ç»ƒé˜¶æ®µ2.2.1 è®­ç»ƒå‚æ•°é…ç½®# åŸºç¡€è®­ç»ƒå‚æ•°\nepochs: 10              # è®­ç»ƒè½®æ•°\nbatch_size: 16          # æ‰¹æ¬¡å¤§å°\nimg_size: 640           # è¾“å…¥å›¾åƒå°ºå¯¸\ndevice: '0'             # è®­ç»ƒè®¾å¤‡ (GPU/CPU)\nworkers: 4              # æ•°æ®åŠ è½½å·¥ä½œè¿›ç¨‹æ•°\n\n# å­¦ä¹ ç‡é…ç½®\nlr0: 0.01              # åˆå§‹å­¦ä¹ ç‡\nlrf: 0.01              # æœ€ç»ˆå­¦ä¹ ç‡\nmomentum: 0.937         # åŠ¨é‡\nweight_decay: 0.0005    # æƒé‡è¡°å‡\nwarmup_epochs: 3.0      # é¢„çƒ­è½®æ•°\n\n# æŸå¤±å‡½æ•°æƒé‡\nbox: 7.5               # è¾¹ç•Œæ¡†æŸå¤±æƒé‡\ncls: 0.5               # åˆ†ç±»æŸå¤±æƒé‡\ndfl: 1.5               # DFLæŸå¤±æƒé‡\n\n# æ•°æ®å¢å¼ºå‚æ•°\nhsv_h: 0.015           # HSVè‰²è°ƒå¢å¼º\nhsv_s: 0.7             # HSVé¥±å’Œåº¦å¢å¼º\nhsv_v: 0.4             # HSVæ˜åº¦å¢å¼º\ndegrees: 0.0           # æ—‹è½¬è§’åº¦\ntranslate: 0.1         # å¹³ç§»\nscale: 0.5             # ç¼©æ”¾\nfliplr: 0.5            # å·¦å³ç¿»è½¬\nmosaic: 1.0            # é©¬èµ›å…‹å¢å¼º\n\n2.2.2 è®­ç»ƒæµç¨‹\næ•°æ®åŠ è½½ï¼šä½¿ç”¨DataLoaderåŠ è½½è®­ç»ƒå’ŒéªŒè¯æ•°æ®\nå‰å‘ä¼ æ’­ï¼šæ¨¡å‹å¯¹è¾“å…¥å›¾åƒè¿›è¡Œç‰¹å¾æå–å’Œé¢„æµ‹\næŸå¤±è®¡ç®—ï¼šè®¡ç®—è¾¹ç•Œæ¡†æŸå¤±ã€åˆ†ç±»æŸå¤±å’ŒDFLæŸå¤±\nåå‘ä¼ æ’­ï¼šè®¡ç®—æ¢¯åº¦å¹¶æ›´æ–°æ¨¡å‹å‚æ•°\néªŒè¯è¯„ä¼°ï¼šåœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½\næ¨¡å‹ä¿å­˜ï¼šä¿å­˜æœ€ä½³æ¨¡å‹å’Œæ£€æŸ¥ç‚¹\n\n2.2.3 è®­ç»ƒç›‘æ§\næŸå¤±æ›²çº¿ï¼šç›‘æ§è®­ç»ƒå’ŒéªŒè¯æŸå¤±çš„å˜åŒ–\næ€§èƒ½æŒ‡æ ‡ï¼šmAP50ã€mAP50-95ã€ç²¾ç¡®ç‡ã€å¬å›ç‡\næ··æ·†çŸ©é˜µï¼šåˆ†æå„ç±»åˆ«çš„æ£€æµ‹æ€§èƒ½\nå­¦ä¹ ç‡è°ƒåº¦ï¼šä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥\n\n2.3 æ¨¡å‹éªŒè¯é˜¶æ®µ2.3.1 éªŒè¯æŒ‡æ ‡\nmAP50ï¼šIoUé˜ˆå€¼ä¸º0.5æ—¶çš„å¹³å‡ç²¾åº¦\nmAP50-95ï¼šIoUé˜ˆå€¼ä»0.5åˆ°0.95çš„å¹³å‡ç²¾åº¦\n**ç²¾ç¡®ç‡(Precision)**ï¼šæ­£ç¡®æ£€æµ‹çš„é˜³æ€§æ ·æœ¬æ¯”ä¾‹\n**å¬å›ç‡(Recall)**ï¼šæ­£ç¡®æ£€æµ‹çš„çœŸå®é˜³æ€§æ ·æœ¬æ¯”ä¾‹\nF1åˆ†æ•°ï¼šç²¾ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡æ•°\n\n2.3.2 éªŒè¯æµç¨‹\nåŠ è½½è®­ç»ƒå¥½çš„æœ€ä½³æ¨¡å‹\nåœ¨éªŒè¯é›†ä¸Šè¿è¡Œæ¨ç†\nè®¡ç®—å„ç§æ€§èƒ½æŒ‡æ ‡\nç”Ÿæˆå¯è§†åŒ–ç»“æœï¼ˆæ··æ·†çŸ©é˜µã€PRæ›²çº¿ç­‰ï¼‰\nä¿å­˜éªŒè¯ç»“æœå’ŒæŠ¥å‘Š\n\n2.4 æ¨¡å‹å¯¼å‡ºé˜¶æ®µ2.4.1 å¯¼å‡ºæ ¼å¼\n**PyTorchæ ¼å¼(.pt)**ï¼šåŸå§‹è®­ç»ƒæ ¼å¼ï¼Œç”¨äºç»§ç»­è®­ç»ƒ\n**ONNXæ ¼å¼(.onnx)**ï¼šè·¨å¹³å°éƒ¨ç½²æ ¼å¼\n**TensorRTæ ¼å¼(.engine)**ï¼šGPUåŠ é€Ÿæ¨ç†æ ¼å¼\n\n2.4.2 å¯¼å‡ºæµç¨‹\nåŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹\nè½¬æ¢ä¸ºç›®æ ‡æ ¼å¼\néªŒè¯å¯¼å‡ºæ¨¡å‹çš„æ­£ç¡®æ€§\nä¿å­˜åˆ°æŒ‡å®šç›®å½•\n\nä¸‰ã€æ•°æ®é›†è¯¦è§£3.1 æ•°æ®é›†æ¥æºæœ¬é¡¹ç›®ä½¿ç”¨TSRD (Traffic Sign Recognition Dataset) æ•°æ®é›†ï¼ŒåŒ…å«ï¼š\n\nè®­ç»ƒé›†ï¼š16,356å¼ å›¾ç‰‡ï¼Œè¦†ç›–å„ç§äº¤é€šæ ‡å¿—\n\næµ‹è¯•é›†ï¼š1,500å¼ å›¾ç‰‡ï¼Œç”¨äºæ¨¡å‹è¯„ä¼°\n\nç±»åˆ«ï¼š3ç±»äº¤é€šæ ‡å¿—ï¼ˆæŒ‡ç¤ºã€ç¦ä»¤ã€è­¦å‘Šï¼‰\n\nâ€‹                                                                                       æ•°æ®é›†å›¾ç‰‡\n\n\n3.2 æ•°æ®é¢„å¤„ç†3.2.1 å›¾åƒé¢„å¤„ç†\nå°ºå¯¸è°ƒæ•´ï¼šç»Ÿä¸€è°ƒæ•´ä¸º640x640åƒç´ \nå½’ä¸€åŒ–ï¼šåƒç´ å€¼å½’ä¸€åŒ–åˆ°[0,1]èŒƒå›´\næ•°æ®å¢å¼ºï¼šæ—‹è½¬ã€ç¿»è½¬ã€ç¼©æ”¾ã€é¢œè‰²å˜æ¢ç­‰\n\n3.2.2 æ ‡ç­¾å¤„ç†\næ ¼å¼è½¬æ¢ï¼šå°†è¾¹ç•Œæ¡†åæ ‡è½¬æ¢ä¸ºYOLOæ ¼å¼\nç±»åˆ«æ˜ å°„ï¼šå°†åŸå§‹ç±»åˆ«æ˜ å°„åˆ°0,1,2\nåæ ‡å½’ä¸€åŒ–ï¼šå°†åƒç´ åæ ‡è½¬æ¢ä¸ºç›¸å¯¹åæ ‡\n\n3.3 æ•°æ®å¢å¼ºç­–ç•¥3.3.1 å‡ ä½•å˜æ¢\næ—‹è½¬ï¼šéšæœºæ—‹è½¬Â±15åº¦\nç¿»è½¬ï¼šæ°´å¹³ç¿»è½¬ï¼Œæ¦‚ç‡0.5\nç¼©æ”¾ï¼šéšæœºç¼©æ”¾0.5-1.5å€\nå¹³ç§»ï¼šéšæœºå¹³ç§»Â±10%\n\n3.3.2 é¢œè‰²å˜æ¢\nHSVè°ƒæ•´ï¼šè‰²è°ƒÂ±1.5%ï¼Œé¥±å’Œåº¦Â±70%ï¼Œæ˜åº¦Â±40%\näº®åº¦å¯¹æ¯”åº¦ï¼šéšæœºè°ƒæ•´äº®åº¦å’Œå¯¹æ¯”åº¦\nå™ªå£°æ·»åŠ ï¼šæ·»åŠ é«˜æ–¯å™ªå£°\n\n3.3.3 é«˜çº§å¢å¼º\né©¬èµ›å…‹å¢å¼ºï¼šå°†4å¼ å›¾ç‰‡æ‹¼æ¥æˆ1å¼ \næ··åˆå¢å¼ºï¼šå°†ä¸¤å¼ å›¾ç‰‡æ··åˆ\nCopy-Pasteï¼šå¤åˆ¶ç²˜è´´å¢å¼º\n\nå››ã€ä¼˜åŒ–ä»£ç è¯¦è§£4.1 ä¼˜åŒ–ç­–ç•¥æ¦‚è¿°4.1.1 ä¸»è¦ä¼˜åŒ–æ–¹å‘\næ¼æ£€é—®é¢˜ä¿®å¤ï¼šé™ä½ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œä¼˜åŒ–æŸå¤±å‡½æ•°æƒé‡\nå°ç›®æ ‡æ£€æµ‹ä¼˜åŒ–ï¼šé›†æˆæ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾èåˆ\næ•°æ®å¢å¼ºå¹³è¡¡ï¼šä¿æŒç‰¹å¾å®Œæ•´æ€§çš„åŒæ—¶å¢åŠ å¤šæ ·æ€§\nè®­ç»ƒç­–ç•¥ä¼˜åŒ–ï¼šç¨³å®šå­¦ä¹ ç‡ï¼Œå……åˆ†é¢„çƒ­\n\n4.1.2 æ ¸å¿ƒæ”¹è¿›\nç½®ä¿¡åº¦é˜ˆå€¼ï¼šä»0.5é™ä½åˆ°0.1ï¼Œå‡å°‘æ¼æ£€\nIoUé˜ˆå€¼ï¼šä»0.6é™ä½åˆ°0.5ï¼Œæé«˜å¬å›ç‡\nåˆ†ç±»æŸå¤±æƒé‡ï¼šä»0.5æé«˜åˆ°1.5ï¼Œå‡å°‘æ¼æ£€\nå­¦ä¹ ç‡ç­–ç•¥ï¼šé™ä½åˆå§‹å­¦ä¹ ç‡ï¼Œå¢åŠ é¢„çƒ­è½®æ•°\n\n4.2 æ³¨æ„åŠ›æœºåˆ¶é›†æˆ4.2.1 SEæ³¨æ„åŠ›æœºåˆ¶class SEAttention(nn.Module):\n    \"\"\"Squeeze-and-Excitationæ³¨æ„åŠ›æœºåˆ¶\"\"\"\n    def __init__(self, channel, reduction=16):\n        super(SEAttention, self).__init__()\n        self.avg_pool = nn.AdaptiveAvgPool2d(1)\n        self.fc = nn.Sequential(\n            nn.Linear(channel, channel // reduction, bias=False),\n            nn.ReLU(inplace=True),\n            nn.Linear(channel // reduction, channel, bias=False),\n            nn.Sigmoid()\n        )\n\n4.2.2 CBAMæ³¨æ„åŠ›æœºåˆ¶class CBAM(nn.Module):\n    \"\"\"Convolutional Block Attention Module\"\"\"\n    def __init__(self, in_channels, reduction=16, kernel_size=7):\n        super(CBAM, self).__init__()\n        self.channel_attention = ChannelAttention(in_channels, reduction)\n        self.spatial_attention = SpatialAttention(kernel_size)\n\n4.2.3 å¤šå°ºåº¦ç‰¹å¾èåˆclass MultiScaleFeatureFusion(nn.Module):\n    \"\"\"å¤šå°ºåº¦ç‰¹å¾èåˆæ¨¡å—\"\"\"\n    def __init__(self, in_channels_list, out_channels=256):\n        super(MultiScaleFeatureFusion, self).__init__()\n        # ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œ\n        self.lateral_convs = nn.ModuleList()\n        self.fpn_convs = nn.ModuleList()\n        # æ³¨æ„åŠ›æœºåˆ¶ç”¨äºç‰¹å¾èåˆ\n        self.attention = CBAM(out_channels, reduction=16)\n\n4.3 ä¼˜åŒ–è®­ç»ƒå‚æ•°4.3.1 æ£€æµ‹å‚æ•°ä¼˜åŒ–# ä¿®å¤æ¼æ£€çš„æ£€æµ‹å‚æ•°\n'conf': 0.1,           # é™ä½ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œå‡å°‘æ¼æ£€\n'iou': 0.5,            # é™ä½IoUé˜ˆå€¼ï¼Œæé«˜å¬å›ç‡\n'max_det': 300,        # é€‚ä¸­çš„æœ€å¤§æ£€æµ‹æ•°\n'multi_scale': True,   # å¤šå°ºåº¦è®­ç»ƒ\n'dropout': 0.0,        # ç§»é™¤dropoutï¼Œé¿å…ç‰¹å¾ä¸¢å¤±\n\n4.3.2 æ•°æ®å¢å¼ºä¼˜åŒ–# å¹³è¡¡çš„æ•°æ®å¢å¼º - ä¿æŒç‰¹å¾çš„åŒæ—¶å¢åŠ å¤šæ ·æ€§\n'hsv_h': 0.015,        # é€‚ä¸­çš„è‰²è°ƒå˜åŒ–\n'hsv_s': 0.3,          # é€‚ä¸­çš„é¥±å’Œåº¦å˜åŒ–ï¼Œä¿æŒæ ‡å¿—é¢œè‰²ç‰¹å¾\n'hsv_v': 0.3,          # é€‚ä¸­çš„æ˜åº¦å˜åŒ–\n'degrees': 3.0,        # é€‚ä¸­çš„æ—‹è½¬è§’åº¦\n'translate': 0.15,     # é€‚ä¸­çš„å¹³ç§»\n'scale': 0.3,          # é€‚ä¸­çš„ç¼©æ”¾èŒƒå›´ï¼Œä¿æŒæ ‡å¿—å½¢çŠ¶\n'mosaic': 0.8,         # é€‚ä¸­çš„é©¬èµ›å…‹å¢å¼º\n'copy_paste': 0.2,     # é€‚ä¸­çš„Copy-Pasteå¢å¼º\n\n4.3.3 å­¦ä¹ ç‡ç­–ç•¥ä¼˜åŒ–# ä¿å®ˆçš„å­¦ä¹ ç‡ç­–ç•¥\n'lr0': 0.005,          # é™ä½åˆå§‹å­¦ä¹ ç‡ï¼Œç¨³å®šè®­ç»ƒ\n'lrf': 0.005,          # é™ä½æœ€ç»ˆå­¦ä¹ ç‡\n'warmup_epochs': 5.0,  # å¢åŠ é¢„çƒ­è½®æ•°\n'cos_lr': True,        # ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦\n'close_mosaic': 5,     # æœ€å5ä¸ªepochå…³é—­é©¬èµ›å…‹\n\n4.4 ä¼˜åŒ–æ•ˆæœå¯¹æ¯”4.4.1 æ€§èƒ½æå‡\nmAP50ï¼šä»0.557æå‡åˆ°0.764 (+37%)\nå¬å›ç‡ï¼šä»70%æå‡åˆ°85% (+15%)\næ¼æ£€ç‡ï¼šä»40-50%é™ä½åˆ°20-30% (-50%)\nè¯¯æŠ¥ç‡ï¼šä»30-40%é™ä½åˆ°15-25% (-40%)\n\n4.4.2 è®­ç»ƒç¨³å®šæ€§\næŸå¤±æ”¶æ•›ï¼šæ›´ç¨³å®šçš„æŸå¤±æ›²çº¿\næ¢¯åº¦ç¨³å®šï¼šé¿å…æ¢¯åº¦çˆ†ç‚¸å’Œæ¶ˆå¤±\nå­¦ä¹ ç‡è°ƒåº¦ï¼šå¹³æ»‘çš„å­¦ä¹ ç‡å˜åŒ–\n\näº”ã€GUIç•Œé¢è¯¦è§£5.1 ç•Œé¢è®¾è®¡5.1.1 æ•´ä½“å¸ƒå±€\nå·¦ä¾§æ§åˆ¶é¢æ¿ï¼šæ¨¡å‹ç®¡ç†ã€æ£€æµ‹æ§åˆ¶ã€ç»“æœæ˜¾ç¤º\nå³ä¾§æ˜¾ç¤ºåŒºåŸŸï¼šå®æ—¶æ£€æµ‹æ˜¾ç¤ºã€ç»Ÿè®¡åˆ†æ\nåˆ†å‰²å™¨è®¾è®¡ï¼šå¯è°ƒæ•´å·¦å³é¢æ¿æ¯”ä¾‹\n\n5.1.2 ç°ä»£åŒ–UIç‰¹æ€§\næ¸å˜è‰²å½©ï¼šé‡‡ç”¨è“ç´«è‰²æ¸å˜èƒŒæ™¯\nåœ†è§’è®¾è®¡ï¼šæ‰€æœ‰ç»„ä»¶é‡‡ç”¨åœ†è§’è¾¹æ¡†\né˜´å½±æ•ˆæœï¼šæ·»åŠ ç«‹ä½“é˜´å½±æ•ˆæœ\næ‚¬åœæ•ˆæœï¼šæŒ‰é’®æ‚¬åœæ—¶çš„è§†è§‰åé¦ˆ\n\n5.2 åŠŸèƒ½æ¨¡å—5.2.1 æ¨¡å‹ç®¡ç†\næ¨¡å‹åŠ è½½ï¼šè‡ªåŠ¨åŠ è½½æœ€ä½³æ¨¡å‹\næ¨¡å‹é€‰æ‹©ï¼šæ”¯æŒé€‰æ‹©ä¸åŒæ¨¡å‹æ–‡ä»¶\nçŠ¶æ€æ˜¾ç¤ºï¼šå®æ—¶æ˜¾ç¤ºæ¨¡å‹åŠ è½½çŠ¶æ€\n\n5.2.2 æ£€æµ‹æ§åˆ¶\nç½®ä¿¡åº¦è°ƒèŠ‚ï¼šæ»‘å—è°ƒèŠ‚ç½®ä¿¡åº¦é˜ˆå€¼\næ£€æµ‹æ¨¡å¼ï¼šæ‘„åƒå¤´ã€å›¾ç‰‡ã€è§†é¢‘ä¸‰ç§æ¨¡å¼\nå®æ—¶æ§åˆ¶ï¼šå¼€å§‹&#x2F;åœæ­¢æ£€æµ‹æŒ‰é’®\n\n5.2.3 ç»“æœæ˜¾ç¤º\nå®æ—¶æ˜¾ç¤ºï¼šå¤§å°ºå¯¸å›¾åƒæ˜¾ç¤ºåŒºåŸŸ\næ£€æµ‹ç»“æœï¼šè¯¦ç»†çš„æ£€æµ‹ä¿¡æ¯å±•ç¤º\nå†å²è®°å½•ï¼šæ£€æµ‹å†å²åˆ—è¡¨\nç»Ÿè®¡åˆ†æï¼šå„ç±»åˆ«æ£€æµ‹ç»Ÿè®¡\n\n5.3 å¤šçº¿ç¨‹è®¾è®¡5.3.1 æ£€æµ‹çº¿ç¨‹class DetectionThread(QThread):\n    \"\"\"æ£€æµ‹çº¿ç¨‹ - é¿å…UIé˜»å¡\"\"\"\n    detection_result = pyqtSignal(dict)  # æ£€æµ‹ç»“æœä¿¡å·\n    frame_ready = pyqtSignal(np.ndarray)  # å¸§å°±ç»ªä¿¡å·\n    finished = pyqtSignal()  # å®Œæˆä¿¡å·\n\n5.3.2 ä¿¡å·æ§½æœºåˆ¶\nå¼‚æ­¥é€šä¿¡ï¼šä½¿ç”¨Qtä¿¡å·æ§½æœºåˆ¶\næ•°æ®ä¼ é€’ï¼šæ£€æµ‹ç»“æœå’Œå›¾åƒæ•°æ®ä¼ é€’\nçŠ¶æ€åŒæ­¥ï¼šUIçŠ¶æ€ä¸æ£€æµ‹çŠ¶æ€åŒæ­¥\n\n5.4 å›¾åƒå¤„ç†ä¼˜åŒ–5.4.1 æ˜¾ç¤ºä¼˜åŒ–def update_display(self, frame):\n    \"\"\"æ›´æ–°æ˜¾ç¤º - ä¼˜åŒ–å›¾åƒæ˜¾ç¤ºå¤§å°å’Œæ¸…æ™°åº¦\"\"\"\n    # è½¬æ¢BGRåˆ°RGB\n    rgb_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    \n    # ä¼˜åŒ–æ˜¾ç¤ºå°ºå¯¸ - è®©å›¾åƒæ˜¾ç¤ºæ›´å¤§\n    display_width = 1200   # å¢åŠ æ˜¾ç¤ºå®½åº¦\n    display_height = 900   # å¢åŠ æ˜¾ç¤ºé«˜åº¦\n    \n    # é«˜è´¨é‡ç¼©æ”¾\n    scaled_pixmap = pixmap.scaled(\n        new_width, new_height,\n        Qt.KeepAspectRatio, \n        Qt.SmoothTransformation\n    )\n\n5.4.2 æ£€æµ‹è¦†ç›–å±‚def _add_detection_overlay(self, frame):\n    \"\"\"æ·»åŠ æ£€æµ‹ä¿¡æ¯è¦†ç›–å±‚\"\"\"\n    if hasattr(self, 'last_detections') and self.last_detections:\n        # åœ¨å›¾åƒä¸Šæ·»åŠ æ£€æµ‹ç»Ÿè®¡ä¿¡æ¯\n        overlay_text = f\"æ£€æµ‹åˆ° &#123;len(self.last_detections)&#125; ä¸ªäº¤é€šæ ‡å¿—\"\n        cv2.putText(frame, overlay_text, (10, 30), \n                   cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 0), 2)\n\nå…­ã€ä»£ç ç»“æ„è¯¦è§£6.1 é¡¹ç›®ç›®å½•ç»“æ„yolo-v11-traffic-sign-main&#x2F;\nâ”œâ”€â”€ backend&#x2F;                    # åç«¯ä»£ç \nâ”‚   â”œâ”€â”€ config.py              # é…ç½®æ–‡ä»¶\nâ”‚   â”œâ”€â”€ detect_yolov11.py      # æ£€æµ‹å™¨\nâ”‚   â”œâ”€â”€ train_yolov11.py       # åŸå§‹è®­ç»ƒè„šæœ¬\nâ”‚   â””â”€â”€ detect_yolov11_enhanced.py  # å¢å¼ºæ£€æµ‹å™¨\nâ”œâ”€â”€ data&#x2F;                      # æ•°æ®é›†\nâ”‚   â”œâ”€â”€ train&#x2F;                 # è®­ç»ƒæ•°æ®\nâ”‚   â”œâ”€â”€ test&#x2F;                  # æµ‹è¯•æ•°æ®\nâ”‚   â””â”€â”€ dataset.yaml           # æ•°æ®é›†é…ç½®\nâ”œâ”€â”€ models&#x2F;                    # æ¨¡å‹æ–‡ä»¶\nâ”‚   â”œâ”€â”€ best_yolov11.pt        # åŸå§‹æœ€ä½³æ¨¡å‹\nâ”‚   â””â”€â”€ best_yolov11_optimized.pt  # ä¼˜åŒ–æ¨¡å‹\nâ”œâ”€â”€ results&#x2F;                   # è®­ç»ƒç»“æœ\nâ”œâ”€â”€ frontend&#x2F;                  # å‰ç«¯ä»£ç \nâ”œâ”€â”€ gui_traffic_detector.py    # GUIä¸»ç¨‹åº\nâ”œâ”€â”€ train_yolov11_optimized.py # ä¼˜åŒ–è®­ç»ƒè„šæœ¬\nâ””â”€â”€ requirements.txt           # ä¾èµ–åŒ…\n\n6.2 æ ¸å¿ƒç±»è®¾è®¡6.2.1 YOLOv11Trainerç±»class YOLOv11Trainer:\n    \"\"\"åŸå§‹è®­ç»ƒå™¨\"\"\"\n    def __init__(self, config)          # åˆå§‹åŒ–\n    def prepare_dataset(self)           # æ•°æ®å‡†å¤‡\n    def train_model(self)               # æ¨¡å‹è®­ç»ƒ\n    def validate_model(self)            # æ¨¡å‹éªŒè¯\n    def export_model(self)              # æ¨¡å‹å¯¼å‡º\n\n6.2.2 YOLOv11OptimizedTrainerç±»class YOLOv11OptimizedTrainer:\n    \"\"\"ä¼˜åŒ–è®­ç»ƒå™¨\"\"\"\n    def __init__(self, config)                    # åˆå§‹åŒ–\n    def prepare_dataset(self)                     # æ•°æ®å‡†å¤‡\n    def _apply_attention_mechanisms(self)         # åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶\n    def train_model(self)                         # ä¼˜åŒ–è®­ç»ƒ\n    def validate_model(self)                      # æ¨¡å‹éªŒè¯\n    def export_model(self)                        # æ¨¡å‹å¯¼å‡º\n\n6.2.3 TrafficSignDetectorGUIç±»class TrafficSignDetectorGUI(QMainWindow):\n    \"\"\"GUIä¸»çª—å£\"\"\"\n    def __init__(self)                           # åˆå§‹åŒ–\n    def init_ui(self)                            # åˆå§‹åŒ–UI\n    def create_control_panel(self)               # åˆ›å»ºæ§åˆ¶é¢æ¿\n    def create_display_area(self)                # åˆ›å»ºæ˜¾ç¤ºåŒºåŸŸ\n    def load_model(self)                         # åŠ è½½æ¨¡å‹\n    def start_camera_detection(self)             # å¼€å§‹æ‘„åƒå¤´æ£€æµ‹\n    def update_display(self, frame)              # æ›´æ–°æ˜¾ç¤º\n    def update_detection_result(self, result)    # æ›´æ–°æ£€æµ‹ç»“æœ\n\n6.3 å…³é”®å‡½æ•°è¯¦è§£6.3.1 æ•°æ®å‡†å¤‡å‡½æ•°def prepare_dataset(self):\n    \"\"\"å‡†å¤‡æ•°æ®é›†ï¼Œç›´æ¥ä½¿ç”¨åŸå§‹æ•°æ®\"\"\"\n    # æ£€æŸ¥æ•°æ®æ˜¯å¦å­˜åœ¨\n    # åˆ›å»ºæ•°æ®é›†é…ç½®æ–‡ä»¶\n    # å»ºç«‹æ ‡ç­¾æ–‡ä»¶é“¾æ¥\n\n6.3.2 è®­ç»ƒå‡½æ•°def train_model(self):\n    \"\"\"è®­ç»ƒYOLOv11æ¨¡å‹\"\"\"\n    # åˆå§‹åŒ–æ¨¡å‹\n    # é…ç½®è®­ç»ƒå‚æ•°\n    # æ‰§è¡Œè®­ç»ƒ\n    # ä¿å­˜æœ€ä½³æ¨¡å‹\n\n6.3.3 æ£€æµ‹å‡½æ•°def detect_image(self, image, filename=None):\n    \"\"\"æ£€æµ‹å•å¼ å›¾ç‰‡\"\"\"\n    # å›¾åƒé¢„å¤„ç†\n    # æ¨¡å‹æ¨ç†\n    # åå¤„ç†\n    # ç»˜åˆ¶æ£€æµ‹ç»“æœ\n\nä¸ƒã€ä½¿ç”¨æŒ‡å—\nâ€‹                                                                                  å®æ—¶è§†é¢‘æ£€æµ‹\n\nâ€‹                                                                                æ‘„åƒå¤´å®æ—¶æ£€æµ‹\n7.1 ç¯å¢ƒé…ç½®7.1.1 ç³»ç»Ÿè¦æ±‚\næ“ä½œç³»ç»Ÿï¼šWindows 10&#x2F;11, Linux, macOS\nPythonç‰ˆæœ¬ï¼šPython 3.8+\nGPUï¼šNVIDIA GPU (æ¨èï¼Œç”¨äºåŠ é€Ÿè®­ç»ƒ)\nå†…å­˜ï¼š8GB+ RAM\nå­˜å‚¨ï¼š10GB+ å¯ç”¨ç©ºé—´\n\n7.1.2 ä¾èµ–å®‰è£…# å®‰è£…åŸºç¡€ä¾èµ–\npip install -r requirements.txt\n\n# å®‰è£…PyTorch (GPUç‰ˆæœ¬)\npip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118\n\n# å®‰è£…Ultralytics\npip install ultralytics\n\n# å®‰è£…PyQt5\npip install PyQt5\n\n7.2 è®­ç»ƒä½¿ç”¨7.2.1 åŸå§‹è®­ç»ƒ# åŸºç¡€è®­ç»ƒ\npython backend/train_yolov11.py --epochs 10 --batch-size 16 --img-size 640\n\n# è‡ªå®šä¹‰å‚æ•°è®­ç»ƒ\npython backend/train_yolov11.py --epochs 20 --batch-size 8 --img-size 1280 --device 0\n\n7.2.2 ä¼˜åŒ–è®­ç»ƒ# ä¼˜åŒ–è®­ç»ƒ\npython train_yolov11_optimized.py --epochs 10 --batch-size 8 --img-size 640\n\n# é«˜åˆ†è¾¨ç‡è®­ç»ƒ\npython train_yolov11_optimized.py --epochs 15 --batch-size 4 --img-size 1280\n\n7.3 GUIä½¿ç”¨7.3.1 å¯åŠ¨GUI# å¯åŠ¨å›¾å½¢ç•Œé¢\npython gui_traffic_detector.py\n\n7.3.2 åŠŸèƒ½ä½¿ç”¨\næ¨¡å‹åŠ è½½ï¼šç‚¹å‡»â€é‡æ–°åŠ è½½æ¨¡å‹â€æˆ–â€é€‰æ‹©æ¨¡å‹æ–‡ä»¶â€\næ‘„åƒå¤´æ£€æµ‹ï¼šç‚¹å‡»â€ğŸ“· æ‘„åƒå¤´æ£€æµ‹â€\nå›¾ç‰‡æ£€æµ‹ï¼šç‚¹å‡»â€ğŸ–¼ï¸ å›¾ç‰‡æ£€æµ‹â€ï¼Œé€‰æ‹©å›¾ç‰‡æ–‡ä»¶\nè§†é¢‘æ£€æµ‹ï¼šç‚¹å‡»â€ğŸ¬ è§†é¢‘æ£€æµ‹â€ï¼Œé€‰æ‹©è§†é¢‘æ–‡ä»¶\nå‚æ•°è°ƒèŠ‚ï¼šä½¿ç”¨ç½®ä¿¡åº¦æ»‘å—è°ƒèŠ‚æ£€æµ‹é˜ˆå€¼\næŸ¥çœ‹ç»“æœï¼šåœ¨â€æ£€æµ‹ç»“æœâ€åŒºåŸŸæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯\nç»Ÿè®¡åˆ†æï¼šåˆ‡æ¢åˆ°â€ğŸ“Š æ•°æ®åˆ†æâ€æ ‡ç­¾é¡µæŸ¥çœ‹ç»Ÿè®¡\n\n7.4 æ¨¡å‹éƒ¨ç½²7.4.1 æ¨¡å‹å¯¼å‡º# å¯¼å‡ºONNXæ ¼å¼\nmodel.export(format='onnx', imgsz=640)\n\n# å¯¼å‡ºTensorRTæ ¼å¼\nmodel.export(format='engine', imgsz=640)\n\n7.4.2 æ¨ç†ä½¿ç”¨# åŠ è½½æ¨¡å‹\ndetector = YOLOv11Detector('best_yolov11.pt')\n\n# æ£€æµ‹å›¾ç‰‡\nimage = cv2.imread('test.jpg')\nresult, detections = detector.detect_image(image)\n\nå…«ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®8.1 è®­ç»ƒä¼˜åŒ–8.1.1 ç¡¬ä»¶ä¼˜åŒ–\nGPUé€‰æ‹©ï¼šä½¿ç”¨NVIDIA RTX 3080&#x2F;4080æˆ–æ›´é«˜\nå†…å­˜é…ç½®ï¼šè‡³å°‘16GB RAMï¼Œæ¨è32GB\nå­˜å‚¨ä¼˜åŒ–ï¼šä½¿ç”¨SSDå­˜å‚¨æ•°æ®é›†\n\n8.1.2 å‚æ•°è°ƒä¼˜\næ‰¹æ¬¡å¤§å°ï¼šæ ¹æ®GPUå†…å­˜è°ƒæ•´ï¼Œå»ºè®®8-16\nå­¦ä¹ ç‡ï¼šä½¿ç”¨å­¦ä¹ ç‡æŸ¥æ‰¾å™¨æ‰¾åˆ°æœ€ä¼˜å€¼\næ•°æ®å¢å¼ºï¼šæ ¹æ®æ•°æ®é›†ç‰¹ç‚¹è°ƒæ•´å¢å¼ºå‚æ•°\n\n8.2 æ¨ç†ä¼˜åŒ–8.2.1 æ¨¡å‹ä¼˜åŒ–\næ¨¡å‹é‡åŒ–ï¼šä½¿ç”¨INT8é‡åŒ–å‡å°‘æ¨¡å‹å¤§å°\næ¨¡å‹å‰ªæï¼šç§»é™¤ä¸é‡è¦çš„è¿æ¥å’Œé€šé“\nçŸ¥è¯†è’¸é¦ï¼šä½¿ç”¨å¤§æ¨¡å‹æŒ‡å¯¼å°æ¨¡å‹è®­ç»ƒ\n\n8.2.2 æ¨ç†åŠ é€Ÿ\nTensorRTä¼˜åŒ–ï¼šä½¿ç”¨TensorRTè¿›è¡ŒGPUåŠ é€Ÿ\nONNX Runtimeï¼šä½¿ç”¨ONNX Runtimeè¿›è¡ŒCPUæ¨ç†\næ‰¹å¤„ç†ï¼šæ‰¹é‡å¤„ç†å¤šå¼ å›¾ç‰‡\n\n8.3 ç³»ç»Ÿä¼˜åŒ–8.3.1 å†…å­˜ä¼˜åŒ–\næ•°æ®åŠ è½½ï¼šä½¿ç”¨å¤šè¿›ç¨‹æ•°æ®åŠ è½½\nç¼“å­˜ç­–ç•¥ï¼šç¼“å­˜å¸¸ç”¨æ•°æ®åˆ°å†…å­˜\nåƒåœ¾å›æ”¶ï¼šå®šæœŸæ¸…ç†æ— ç”¨å¯¹è±¡\n\n8.3.2 å¹¶å‘ä¼˜åŒ–\nå¤šçº¿ç¨‹ï¼šä½¿ç”¨å¤šçº¿ç¨‹å¤„ç†ä¸åŒä»»åŠ¡\nå¼‚æ­¥å¤„ç†ï¼šä½¿ç”¨å¼‚æ­¥I&#x2F;Oæé«˜æ•ˆç‡\né˜Ÿåˆ—ç®¡ç†ï¼šä½¿ç”¨é˜Ÿåˆ—ç®¡ç†ä»»åŠ¡è°ƒåº¦\n\n","categories":["è®¡ç®—æœºè§†è§‰"],"tags":["yoloæ¨¡å‹"]},{"title":"è‡ªæˆ‘ä»‹ç»(ç‚¹å‡»æœ€ä¸Šæ–¹AboutæŸ¥çœ‹æ›´å¤š~)","url":"/2023/12/24/hello-world/","content":"éå¸¸é«˜å…´æ‚¨è®¿é—®æˆ‘çš„ç½‘ç«™,æ‚¨å¯ä»¥ç‚¹å‡»æœ€ä¸Šæ–¹ABOUTæŸ¥çœ‹æˆ‘çš„è¯¦ç»†ä¿¡æ¯~\n\n\nå…³äºæˆ‘ï¼ˆå¯ä»¥ç‚¹å‡»AboutæŸ¥çœ‹æ›´å¤šæˆ‘çš„èµ„æ–™~ï¼‰ä¸ªäººä¿¡æ¯\nå§“åï¼šHuangZhongqié»„ä¸­å¥‡\nä¸“ä¸šï¼šäººå·¥æ™ºèƒ½\né‚®ç®±ï¼š&#x68;&#117;&#97;&#110;&#103;&#122;&#x68;&#x6f;&#x6e;&#103;&#113;&#105;&#57;&#55;&#56;&#64;&#103;&#109;&#97;&#x69;&#108;&#46;&#x63;&#111;&#x6d;\nGitHubï¼šhttps://github.com/Huangzhongqi978\nä¸ªäººåšå®¢ï¼š[https://Huangzhongqi978.top\n\n\nå­¦ä¹ è¯¾ç¨‹æˆ‘åœ¨äººå·¥æ™ºèƒ½ä¸“ä¸šæœŸé—´å­¦ä¹ äº†ä»¥ä¸‹ä¸»è¦è¯¾ç¨‹ï¼š\n\näººå·¥æ™ºèƒ½æ ¸å¿ƒè¯¾ç¨‹\n\næœºå™¨å­¦ä¹ \næ·±åº¦å­¦ä¹ \nè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰\nè®¡ç®—æœºè§†è§‰ï¼ˆCVï¼‰\nå¼ºåŒ–å­¦ä¹ \nå¤§æ•°æ®åˆ†æä¸å¤„ç†\n\n\nå‰æ²¿ä¸å®è·µè¯¾ç¨‹\n\næœºå™¨äººä¸åµŒå…¥å¼ç³»ç»Ÿ\nAI é¡¹ç›®å®è®­\näº‘è®¡ç®—ä¸äººå·¥æ™ºèƒ½å¹³å°\n\n\n\n\næ•™è‚²ç»å†å­¦ä¹ æˆç»©ï¼šä¸“ä¸šæ’ååŠ ç»¼æµ‹æ’åå‰2%\nè·å¾—è¯ä¹¦ï¼šCET4ã€CET6ã€è®¡ç®—æœºç­‰çº§ä¸‰çº§ã€å››çº§è¯ä¹¦ã€åä¸ºHCCDAå¼€å‘è€…åˆçº§è®¤è¯ï¼Œåä¸ºæ˜‡è…¾Cç®—å­å¼€å‘è®¤è¯ã€è®¡ç®—æœºè½¯ä»¶è‘—ä½œæƒ2é¡¹ã€è½¯è€ƒä¸­çº§èµ„æ ¼è¯ä¹¦\n\né¡¹ç›®ç»å†ï¼ˆæ—¶é—´å…³ç³»åªæ•´ç†äº†éƒ¨åˆ†ï¼‰é¡¹ç›®ç»å†åŸºäºYOLOé“…å°é”æ™ºèƒ½è¯†åˆ«ç³»ç»Ÿ2023-06 ~ 2023-12YOLOæ¨¡å‹çš„è®­ç»ƒä¸ä¼˜åŒ–é¡¹ç›®æè¿°ï¼šåŸºäº YOLO æ·±åº¦ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œæ‰«æå¹¶è¯†åˆ«æµ·å…³é›†è£…ç®±é“…å°é”ï¼Œç”¨æ¥ä¿éšœæµ·å…³é›†è£…ç®±çš„å®‰å…¨é‡‡é›†å¹¶æ ‡æ³¨çœŸå®ç°åœºå›¾åƒæ•°æ® 4000+ å¼ ï¼Œå»ºç«‹é“…å°å®Œæ•´ç­‰å¤šç±»ç›®æ ‡æ£€æµ‹æ•°æ®é›†ä½¿ç”¨ LabelImg æ ‡æ³¨å·¥å…·è¿›è¡Œ VOC æ ¼å¼è½¬æ¢ï¼Œå¹¶ç¼–å†™è„šæœ¬è‡ªåŠ¨åˆ’åˆ†è®­ç»ƒé›†ã€éªŒè¯é›†ä¸æµ‹è¯•é›†æ­å»º Flask æ¨ç†æ¥å£å¹¶é›†æˆå‰ç«¯ Web é¡µé¢ï¼Œå®ç°è¿œç¨‹å›¾åƒä¸Šä¼ ä¸æ£€æµ‹ç»“æœå¯è§†åŒ–å±•ç¤ºä½¿ç”¨Pytorchæ·±åº¦å­¦ä¹ æ¡†æ¶è¿›è¡Œç¥ç»ç½‘ç»œçš„æ„å»ºä¸å¤„ç†ï¼Œç»“åˆé¢„å¤„ç†æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œè¾¾åˆ°äº†è¾ƒå¥½çš„è®­ç»ƒæ•ˆæœä»¥åŠæµ‹è¯•ç»“æœå‡†ç¡®ç‡æŠ€æœ¯æ´¾ç¤¾åŒºé¡¹ç›®2024-01 ~ 2024-06Springboot+Vueå‰åç«¯å…¨æ ˆå¼€å‘https://github.com/Huangzhongqi978/jishupaié¡¹ç›®æè¿°ï¼šæŠ€æœ¯æ´¾æ˜¯ä¸€ä¸ªå‰åç«¯åˆ†ç¦»çš„ï¼Œé¢å‘äº’è”ç½‘å¼€å‘è€…çš„æŠ€æœ¯å†…å®¹åˆ†äº«ä¸äº¤æµå¹³å°åˆ©ç”¨ AOP åˆ‡é¢æŠ€æœ¯ï¼Œå½“ç³»ç»Ÿæ”¶åˆ°æ–°çš„æ¶ˆæ¯æ—¶(å¦‚è¯„è®ºã€ç‚¹èµç­‰)ï¼Œè‡ªåŠ¨å°†è¿™äº›æ¶ˆæ¯å‘é€è‡³ Kafka æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚æ¥ç€ï¼Œé€šè¿‡æ¶ˆè´¹è€…æœåŠ¡ä» Kafka ä¸­å–å‡ºæ¶ˆæ¯ã€‚ä½¿ç”¨ FastExcel å®ç° PUPV æ•°æ®çš„æ‰¹é‡å¯¼å‡ºåŠŸèƒ½ï¼Œ500 ä¸‡æ¡æ•°æ®å¯¼å‡ºä»…éœ€ 1 ç§’ï¼Œå¹¶ç»“åˆè‡ªå®šä¹‰çº¿ç¨‹æ± + CountDownLatch è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œå¯¼å‡ºæ€§èƒ½æå‡è¿‘ 60 å€ã€‚é‡‡ç”¨ JWT+Redis çš„åŒä»¤ç‰Œæœºåˆ¶ï¼Œé€šè¿‡ access token å¤„ç†ä¸šåŠ¡è¯·æ±‚ï¼Œrefresh token å®ç°ç”¨æˆ·æ— æ„Ÿçš„ä»¤ç‰Œåˆ·æ–°ã€‚é€šè¿‡ Canal æ¡†æ¶å®ç°äº† MySQLä¸ ElasticSearch çš„æ•°æ®åŒæ­¥ï¼Œç¡®ä¿äº†å®æ—¶æœç´¢çš„å‡†ç¡®æ€§ã€‚åŸºäºçŸ¥è¯†å›¾è°±çš„å©šå§»æ³•æ™ºèƒ½é—®ç­”ç³»ç»Ÿ2024-07 ~ 2025-12neo4jçŸ¥è¯†å›¾è°±ã€Djangoã€Vueå¼€å‘http://1.94.166.251:6799é¡¹ç›®æè¿°ï¼šæ„å»ºä¸€ä¸ªé¢å‘æ™®é€šç”¨æˆ·çš„å©šå§»æ³•æ™ºèƒ½é—®ç­”ç³»ç»Ÿï¼Œå‰åç«¯åˆ†ç¦»è®¾è®¡ï¼Œå‰ç«¯ä½¿ç”¨ Vue.js å®ç°ç”¨æˆ·äº¤äº’ç•Œé¢ï¼Œåç«¯åŸºäº Django æ„å»º RESTful API å¹¶é›†æˆçŸ¥è¯†å›¾è°±å¼•æ“ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€é—®é¢˜è§£æä¸æ³•å¾‹çŸ¥è¯†æ¨ç†æŸ¥è¯¢ï¼Œæå‡ç”¨æˆ·å¯¹å©šå§»æ³•æ¡æ¬¾çš„ç†è§£ä¸è·å–æ•ˆç‡ã€‚æŠ€æœ¯æ ˆï¼šPythonï¼ˆDjango REST Frameworkï¼‰ã€Vue.jsã€Neo4jã€Py2Neoã€Element-UIã€Gunicornã€Nginxã€MySQLé€šè¿‡neo4jå›¾æ•°æ®åº“åˆ‡åˆ†å©šå§»æ³•æ³•å¾‹çŸ¥è¯†çš„å®ä½“ä¸å…³ç³»ç±»ï¼Œæ ¹æ®çŸ¥è¯†å›¾è°±çš„å…³ç³»ç½‘ç»œè¿›è¡Œæ™ºèƒ½é—®ç­”å›å¤ç”¨æˆ·é—®é¢˜ä½¿ç”¨Vueå‰ç«¯å’ŒDjangoåç«¯å‰åç«¯åˆ†ç¦»å¼€å‘ï¼ŒåŸºäºRESTfulæ¥å£è§„èŒƒ\n\n\nä¸“ä¸šæŠ€èƒ½ç¼–ç¨‹è¯­è¨€ç†Ÿç»ƒæŒæ¡ Pythonï¼ŒæŒæ¡ C&#x2F;C++ã€Javaï¼Œäº†è§£ Shellã€SQL\nè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ç†Ÿæ‚‰ç¥ç»ç½‘ç»œã€CNNã€RNNã€LSTMã€Transformer ç­‰æ¨¡å‹ï¼ŒæŒæ¡æ–‡æœ¬åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æã€å‘½åå®ä½“è¯†åˆ«ã€æ–‡æœ¬ç”Ÿæˆç­‰æŠ€æœ¯ï¼Œäº†è§£ BERTã€GPT ç­‰é¢„è®­ç»ƒæ¨¡å‹\nè®¡ç®—æœºè§†è§‰äº†è§£æŒæ¡å›¾åƒæ»¤æ³¢ï¼ˆé«˜æ–¯ã€ä¸­å€¼ã€åŒè¾¹ï¼‰ã€è¾¹ç¼˜æ£€æµ‹ï¼ˆSobel, Cannyï¼‰ã€å½¢æ€å­¦æ“ä½œã€ç›´æ–¹å›¾å‡è¡¡åŒ–ã€å›¾åƒé‡‘å­—å¡”ã€ç‰¹å¾æå–ï¼ˆSIFT, SURF, ORBï¼‰ï¼Œäº†è§£æŒæ¡YOLOé¢„è®­ç»ƒæ¨¡å‹ã€‚\næ¡†æ¶ä¸å·¥å…·ç†Ÿç»ƒä½¿ç”¨ TensorFlowã€PyTorch è¿›è¡Œæ¨¡å‹æ­å»ºä¸è®­ç»ƒï¼›ç†Ÿæ‚‰ Scikit-learnã€Pandasã€NumPyã€Matplotlib ç­‰æ•°æ®åˆ†æä¸å»ºæ¨¡å·¥å…·\næ¨¡å‹ä¼˜åŒ–ä¸éƒ¨ç½²æŒæ¡æ¨¡å‹è°ƒå‚ã€äº¤å‰éªŒè¯ã€æ€§èƒ½è¯„ä¼°æ–¹æ³•ï¼›å…·å¤‡ Flask&#x2F;Django + REST API çš„æ¨¡å‹éƒ¨ç½²ç»éªŒ\nå…¶ä»–ç†Ÿç»ƒä½¿ç”¨IDEAï¼ŒPyCharmï¼ŒDockerï¼ŒChatGPTï¼ŒCursorç­‰å·¥å…·æé«˜å¼€å‘åä½œæ•ˆç‡ï¼Œèƒ½å¤Ÿä½¿ç”¨Gitç‰ˆæœ¬æ§åˆ¶å·¥å…·è¿›è¡Œå›¢é˜Ÿå¼€å‘\nè£èª‰å¥–é¡¹ï¼ˆéƒ¨åˆ†ï¼‰å›½å®¶å¥–å­¦é‡‘2024-12å›½å®¶åŠ±å¿—å¥–å­¦é‡‘2023-12å±±ä¸œçœé«˜ç­‰å­¦æ ¡çœçº§ä¼˜ç§€å­¦ç”Ÿã€æ ¡çº§ä¼˜ç§€å­¦ç”Ÿã€æ ¡çº§ä¼˜ç§€å›¢å‘˜2024-05å…¨å›½å¤§å­¦ç”Ÿè‹±è¯­ç«èµ›Cç±»å…¨å›½ä¸‰ç­‰å¥–2023-06å±±ä¸œçœå¤§å­¦ç”Ÿæ™ºèƒ½æŠ€æœ¯åº”ç”¨è®¾è®¡å¤§èµ›çœçº§äºŒç­‰å¥–2023-12ç¬¬åä¸ƒå±Šå›½é™…å…ˆè¿›æœºå™¨äººåŠä»¿çœŸæŠ€æœ¯å¤§èµ›å›½èµ›äºŒç­‰å¥–ã€å±±ä¸œèµ›åŒºä¸€ç­‰å¥–2024-07åæ•°æ¯å…¨å›½å¤§å­¦ç”Ÿæ•°å­¦å»ºæ¨¡ç«èµ›æœ¬ç§‘ç”Ÿç»„äºŒç­‰å¥–2024-08å±±ä¸œçœå¤§å­¦ç”Ÿé«˜æ ¡æœºå™¨äººå¤§èµ›å±±ä¸œèµ›åŒºä¸€ç­‰å¥–2024-11ç¬¬ä¸ƒå±Šæ³°è¿ªæ¯æ•°æ®åˆ†æèµ›æœ¬ç§‘ç”Ÿç»„ä¸‰ç­‰å¥–2024-12MathorCupæ•°å­¦åº”ç”¨æŒ‘æˆ˜èµ›å¤§æ•°æ®èµ›é“æœ¬ç§‘ç”Ÿç»„äºŒç­‰å¥–2024-12ç¬¬åå±Šæ•°ç»´æ¯å…¨å›½å¤§å­¦ç”Ÿæ•°å­¦å»ºæ¨¡ç«èµ›å›½é™…èµ›Meritoriouså¥–2025-01ç¬¬åä¸€å±Šå…¨å›½å¤§å­¦ç”Ÿç»Ÿè®¡å»ºæ¨¡å¤§èµ›å±±ä¸œèµ›åŒºå†³èµ›ä¸€ç­‰å¥–2025-06ç¬¬åå…«å±Šä¸­å›½å¤§å­¦ç”Ÿè®¡ç®—æœºè®¾è®¡å¤§èµ›å¤§æ•°æ®åº”ç”¨èµ›é“å±±ä¸œèµ›åŒºå†³èµ›ä¸‰ç­‰å¥–2025-06\n","categories":["ego"],"tags":["me"]},{"title":"æ·»åŠ P2æ£€æµ‹å¤´ä¸SEæœºåˆ¶çš„YOLOv8äº¤é€šè½¦è¾†ä¸é“è·¯ç›‘æ£€æµ‹ç³»ç»Ÿä¼˜åŒ–","url":"/2025/07/15/p2%E6%A3%80%E6%B5%8B%E5%A4%B4%E4%BA%A4%E9%80%9A%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/","content":"Yolov8æ¨¡å‹ä¼˜åŒ–è¿‡ç¨‹ä»£ç è§£æä¸ç»“æœå±•ç¤º\n\n\n\n    \n    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚\n\n\n\n\n1. ä»£ç ç»“æ„åˆ†æ1.1 æ ¸å¿ƒç±»è®¾è®¡class YOLOv11OptimizedTrainer:\n    \"\"\"YOLOv11ä¼˜åŒ–è®­ç»ƒå™¨ - ä¸“é—¨é’ˆå¯¹å°ç›®æ ‡æ£€æµ‹ä¼˜åŒ–\"\"\"\n    def __init__(self, config):\n        self.config = config\n        self.model = None\n        self.training_results = None\n        # åˆ›å»ºä¼˜åŒ–ç»“æœç›®å½•\n        self.timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n        self.run_dir = RESULTS_DIR / f\"yolov11_optimized_run_&#123;self.timestamp&#125;\"\n\n1.2 æ³¨æ„åŠ›æœºåˆ¶æ¨¡å—# ==================== æ³¨æ„åŠ›æœºåˆ¶æ¨¡å—å®šä¹‰ ====================\n\nclass SEAttention(nn.Module):\n    \"\"\"Squeeze-and-Excitationæ³¨æ„åŠ›æœºåˆ¶\"\"\"\n    def __init__(self, channel, reduction=16):\n        super(SEAttention, self).__init__()\n        self.avg_pool = nn.AdaptiveAvgPool2d(1)  # å…¨å±€å¹³å‡æ± åŒ–\n        self.fc = nn.Sequential(\n            nn.Linear(channel, channel // reduction, bias=False),  # é™ç»´\n            nn.ReLU(inplace=True),\n            nn.Linear(channel // reduction, channel, bias=False),  # å‡ç»´\n            nn.Sigmoid()  # è¾“å‡º0-1æƒé‡\n        )\n\nclass CBAM(nn.Module):\n    \"\"\"Convolutional Block Attention Module\"\"\"\n    def __init__(self, in_channels, reduction=16, kernel_size=7):\n        super(CBAM, self).__init__()\n        self.channel_attention = ChannelAttention(in_channels, reduction)\n        self.spatial_attention = SpatialAttention(kernel_size)\n\nclass MultiScaleFeatureFusion(nn.Module):\n    \"\"\"å¤šå°ºåº¦ç‰¹å¾èåˆæ¨¡å—\"\"\"\n    def __init__(self, in_channels_list, out_channels=256):\n        super(MultiScaleFeatureFusion, self).__init__()\n        # ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œ\n        self.lateral_convs = nn.ModuleList()\n        self.fpn_convs = nn.ModuleList()\n        # æ³¨æ„åŠ›æœºåˆ¶ç”¨äºç‰¹å¾èåˆ\n        self.attention = CBAM(out_channels, reduction=16)\n\n2. ä¼˜åŒ–ç­–ç•¥è¯¦è§£2.1 æ¼æ£€é—®é¢˜ä¿®å¤# ä¿®å¤æ¼æ£€çš„æ£€æµ‹å‚æ•°\n'conf': 0.1,           # ç½®ä¿¡åº¦é˜ˆå€¼ï¼šä»0.5é™ä½åˆ°0.1\n'iou': 0.5,            # IoUé˜ˆå€¼ï¼šä»0.6é™ä½åˆ°0.5\n'max_det': 300,        # æœ€å¤§æ£€æµ‹æ•°ï¼šä¿æŒ300\n'multi_scale': True,   # å¤šå°ºåº¦è®­ç»ƒï¼šå¯ç”¨\n'dropout': 0.0,        # ç§»é™¤dropoutï¼šé¿å…ç‰¹å¾ä¸¢å¤±\n\n2.2 æŸå¤±å‡½æ•°æƒé‡ä¼˜åŒ–# ä¼˜åŒ–æŸå¤±å‡½æ•°æƒé‡ - å¹³è¡¡æ£€æµ‹å’Œåˆ†ç±»\n'box': 7.5,            # è¾¹ç•Œæ¡†æŸå¤±æƒé‡ï¼šä¿æŒ7.5\n'cls': 1.5,            # åˆ†ç±»æŸå¤±æƒé‡ï¼šä»0.5æé«˜åˆ°1.5\n'dfl': 1.5,            # DFLæŸå¤±æƒé‡ï¼šä¿æŒ1.5\n\n2.3 å­¦ä¹ ç‡ç­–ç•¥ä¼˜åŒ–# ä¿å®ˆçš„å­¦ä¹ ç‡ç­–ç•¥\n'lr0': 0.005,          # åˆå§‹å­¦ä¹ ç‡ï¼šä»0.01é™ä½åˆ°0.005\n'lrf': 0.005,          # æœ€ç»ˆå­¦ä¹ ç‡ï¼šä»0.01é™ä½åˆ°0.005\n'warmup_epochs': 5.0,  # é¢„çƒ­è½®æ•°ï¼šä»3.0å¢åŠ åˆ°5.0\n'cos_lr': True,        # ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦ï¼šå¯ç”¨\n'close_mosaic': 5,     # æœ€å5ä¸ªepochå…³é—­é©¬èµ›å…‹\n\n2.4 æ•°æ®å¢å¼ºå¹³è¡¡ç­–ç•¥# å¹³è¡¡çš„æ•°æ®å¢å¼º - ä¿æŒç‰¹å¾çš„åŒæ—¶å¢åŠ å¤šæ ·æ€§\n'hsv_h': 0.015,        # è‰²è°ƒå˜åŒ–ï¼šä»0.015ä¿æŒ\n'hsv_s': 0.3,          # é¥±å’Œåº¦å˜åŒ–ï¼šä»0.7é™ä½åˆ°0.3\n'hsv_v': 0.3,          # æ˜åº¦å˜åŒ–ï¼šä»0.4é™ä½åˆ°0.3\n'degrees': 3.0,        # æ—‹è½¬è§’åº¦ï¼šä»0.0å¢åŠ åˆ°3.0\n'translate': 0.15,     # å¹³ç§»ï¼šä»0.1å¢åŠ åˆ°0.15\n'scale': 0.3,          # ç¼©æ”¾ï¼šä»0.5é™ä½åˆ°0.3\n'shear': 2.0,          # å‰ªåˆ‡ï¼šä»0.0å¢åŠ åˆ°2.0\n'perspective': 0.0,    # é€è§†å˜æ¢ï¼šä¿æŒ0.0\n'flipud': 0.0,         # ä¸Šä¸‹ç¿»è½¬ï¼šä¿æŒ0.0\n'fliplr': 0.5,         # å·¦å³ç¿»è½¬ï¼šä¿æŒ0.5\n'mosaic': 0.8,         # é©¬èµ›å…‹å¢å¼ºï¼šä»1.0é™ä½åˆ°0.8\n'mixup': 0.1,          # æ··åˆå¢å¼ºï¼šä»0.0å¢åŠ åˆ°0.1\n'copy_paste': 0.2,     # Copy-Pasteå¢å¼ºï¼šä»0.0å¢åŠ åˆ°0.2\n\n3. æ³¨æ„åŠ›æœºåˆ¶é›†æˆ3.1 æ³¨æ„åŠ›æœºåˆ¶åº”ç”¨def _apply_attention_mechanisms(self):\n    \"\"\"åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶åˆ°YOLOv11æ¨¡å‹\"\"\"\n    if not self.model or not hasattr(self.model, 'model'):\n        logger.warning(\"æ¨¡å‹æœªåŠ è½½ï¼Œè·³è¿‡æ³¨æ„åŠ›æœºåˆ¶åº”ç”¨\")\n        return\n    \n    # è·å–æ¨¡å‹ç»“æ„\n    model = self.model.model\n    \n    # åœ¨backboneçš„å…³é”®å±‚æ·»åŠ SEæ³¨æ„åŠ›\n    attention_added = False\n    for name, module in model.named_modules():\n        # åœ¨C2fæ¨¡å—åæ·»åŠ æ³¨æ„åŠ›æœºåˆ¶\n        if 'C2f' in str(type(module)) and hasattr(module, 'cv2'):\n            # è·å–C2fæ¨¡å—çš„è¾“å‡ºé€šé“æ•°\n            out_channels = module.cv2[0].conv.out_channels\n            \n            # åˆ›å»ºæ³¨æ„åŠ›æ¨¡å—\n            attention_module = SEAttention(out_channels, reduction=16)\n            \n            # å°†æ³¨æ„åŠ›æ¨¡å—æ·»åŠ åˆ°C2fæ¨¡å—ä¸­\n            if not hasattr(module, 'attention'):\n                module.attention = attention_module\n                attention_added = True\n                logger.info(f\"æˆåŠŸåœ¨ &#123;name&#125; æ·»åŠ SEæ³¨æ„åŠ›æ¨¡å—\")\n    \n    # åœ¨æ£€æµ‹å¤´æ·»åŠ ç‰¹å¾èåˆ\n    if hasattr(model, 'detect'):\n        detect_head = model.detect\n        if hasattr(detect_head, 'cv2') and hasattr(detect_head, 'cv3'):\n            # è·å–æ£€æµ‹å¤´çš„é€šé“æ•°\n            ch = [detect_head.cv2[i][0].conv.out_channels for i in range(len(detect_head.cv2))]\n            \n            # æ·»åŠ ç‰¹å¾èåˆæ¨¡å—\n            if not hasattr(detect_head, 'feature_fusion'):\n                detect_head.feature_fusion = MultiScaleFeatureFusion(ch, out_channels=256)\n                logger.info(\"æˆåŠŸæ·»åŠ å¤šå°ºåº¦ç‰¹å¾èåˆæ¨¡å—\")\n\n3.2 SEæ³¨æ„åŠ›æœºåˆ¶åŸç†def forward(self, x):\n    \"\"\"SEæ³¨æ„åŠ›å‰å‘ä¼ æ’­\"\"\"\n    b, c, _, _ = x.size()  # è·å–æ‰¹æ¬¡å¤§å°å’Œé€šé“æ•°\n    \n    # Squeeze: å…¨å±€å¹³å‡æ± åŒ–ï¼Œå‹ç¼©ç©ºé—´ç»´åº¦\n    y = self.avg_pool(x).view(b, c)  # [B, C, 1, 1] -> [B, C]\n    \n    # Excitation: é€šè¿‡å…¨è¿æ¥å±‚å­¦ä¹ é€šé“æƒé‡\n    y = self.fc(y).view(b, c, 1, 1)  # [B, C] -> [B, C, 1, 1]\n    \n    # Scale: å°†æƒé‡åº”ç”¨åˆ°åŸå§‹ç‰¹å¾ä¸Š\n    return x * y.expand_as(x)  # å¹¿æ’­ä¹˜æ³•\n\n3.3 CBAMæ³¨æ„åŠ›æœºåˆ¶class CBAM(nn.Module):\n    \"\"\"Convolutional Block Attention Module\"\"\"\n    def __init__(self, in_channels, reduction=16, kernel_size=7):\n        super(CBAM, self).__init__()\n        self.channel_attention = ChannelAttention(in_channels, reduction)\n        self.spatial_attention = SpatialAttention(kernel_size)\n\n    def forward(self, x):\n        # å…ˆåº”ç”¨é€šé“æ³¨æ„åŠ›\n        x = self.channel_attention(x) * x\n        # å†åº”ç”¨ç©ºé—´æ³¨æ„åŠ›\n        x = self.spatial_attention(x) * x\n        return x\n\n3.4 å¤šå°ºåº¦ç‰¹å¾èåˆclass MultiScaleFeatureFusion(nn.Module):\n    \"\"\"å¤šå°ºåº¦ç‰¹å¾èåˆæ¨¡å—\"\"\"\n    def forward(self, features):\n        # å¤„ç†æ¯ä¸ªå°ºåº¦çš„ç‰¹å¾\n        lateral_features = []\n        for i, (lateral_conv, feature) in enumerate(zip(self.lateral_convs, features)):\n            lateral_feature = lateral_conv(feature)\n            lateral_features.append(lateral_feature)\n        \n        # è‡ªé¡¶å‘ä¸‹çš„ç‰¹å¾èåˆ\n        fpn_features = []\n        for i in range(len(lateral_features) - 1, -1, -1):\n            if i == len(lateral_features) - 1:\n                fpn_feature = lateral_features[i]\n            else:\n                # ä¸Šé‡‡æ ·å¹¶èåˆ\n                fpn_feature = F.interpolate(\n                    fpn_features[0], \n                    size=lateral_features[i].shape[2:], \n                    mode='nearest'\n                )\n                fpn_feature = fpn_feature + lateral_features[i]\n            \n            fpn_feature = self.fpn_convs[i](fpn_feature)\n            fpn_features.insert(0, fpn_feature)\n        \n        # åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶\n        for i in range(len(fpn_features)):\n            fpn_features[i] = self.attention(fpn_features[i])\n        \n        # å¤šå°ºåº¦ç‰¹å¾èåˆ\n        target_size = fpn_features[0].shape[2:]\n        upsampled_features = []\n        for feature in fpn_features:\n            if feature.shape[2:] != target_size:\n                feature = F.interpolate(feature, size=target_size, mode='nearest')\n            upsampled_features.append(feature)\n        \n        # æ‹¼æ¥å¹¶èåˆ\n        fused_feature = torch.cat(upsampled_features, dim=1)\n        fused_feature = self.fusion_conv(fused_feature)\n        \n        return fpn_features, fused_feature\n\n4. è®­ç»ƒå‚æ•°å¯¹æ¯”4.1 æ£€æµ‹å‚æ•°å¯¹æ¯”\n\n\nå‚æ•°\nåŸå§‹ä»£ç \nä¼˜åŒ–ä»£ç \nä¼˜åŒ–è¯´æ˜\n\n\n\nconf\n0.001\n0.1\né™ä½ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œå‡å°‘æ¼æ£€\n\n\niou\n0.6\n0.5\né™ä½IoUé˜ˆå€¼ï¼Œæé«˜å¬å›ç‡\n\n\nmax_det\n300\n300\nä¿æŒæœ€å¤§æ£€æµ‹æ•°\n\n\nmulti_scale\nFalse\nTrue\nå¯ç”¨å¤šå°ºåº¦è®­ç»ƒ\n\n\ndropout\n0.0\n0.0\nä¿æŒæ— dropout\n\n\n4.2 å­¦ä¹ ç‡å‚æ•°å¯¹æ¯”\n\n\nå‚æ•°\nåŸå§‹ä»£ç \nä¼˜åŒ–ä»£ç \nä¼˜åŒ–è¯´æ˜\n\n\n\nlr0\n0.01\n0.005\né™ä½åˆå§‹å­¦ä¹ ç‡ï¼Œç¨³å®šè®­ç»ƒ\n\n\nlrf\n0.01\n0.005\né™ä½æœ€ç»ˆå­¦ä¹ ç‡\n\n\nwarmup_epochs\n3.0\n5.0\nå¢åŠ é¢„çƒ­è½®æ•°\n\n\ncos_lr\nTrue\nTrue\nä¿æŒä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦\n\n\nclose_mosaic\n5\n5\nä¿æŒé©¬èµ›å…‹å…³é—­ç­–ç•¥\n\n\n4.3 æŸå¤±å‡½æ•°æƒé‡å¯¹æ¯”\n\n\nå‚æ•°\nåŸå§‹ä»£ç \nä¼˜åŒ–ä»£ç \nä¼˜åŒ–è¯´æ˜\n\n\n\nbox\n7.5\n7.5\nä¿æŒè¾¹ç•Œæ¡†æŸå¤±æƒé‡\n\n\ncls\n0.5\n1.5\næé«˜åˆ†ç±»æŸå¤±æƒé‡ï¼Œå‡å°‘æ¼æ£€\n\n\ndfl\n1.5\n1.5\nä¿æŒDFLæŸå¤±æƒé‡\n\n\n4.4 æ•°æ®å¢å¼ºå‚æ•°å¯¹æ¯”\n\n\nå‚æ•°\nåŸå§‹ä»£ç \nä¼˜åŒ–ä»£ç \nä¼˜åŒ–è¯´æ˜\n\n\n\nhsv_h\n0.015\n0.015\nä¿æŒè‰²è°ƒå˜åŒ–\n\n\nhsv_s\n0.7\n0.3\né™ä½é¥±å’Œåº¦å˜åŒ–ï¼Œä¿æŒé¢œè‰²ç‰¹å¾\n\n\nhsv_v\n0.4\n0.3\né™ä½æ˜åº¦å˜åŒ–\n\n\ndegrees\n0.0\n3.0\nå¢åŠ æ—‹è½¬è§’åº¦\n\n\ntranslate\n0.1\n0.15\nå¢åŠ å¹³ç§»èŒƒå›´\n\n\nscale\n0.5\n0.3\né™ä½ç¼©æ”¾èŒƒå›´ï¼Œä¿æŒæ ‡å¿—å½¢çŠ¶\n\n\nshear\n0.0\n2.0\nå¢åŠ å‰ªåˆ‡å˜æ¢\n\n\nmosaic\n1.0\n0.8\né™ä½é©¬èµ›å…‹å¢å¼º\n\n\nmixup\n0.0\n0.1\nå¢åŠ æ··åˆå¢å¼º\n\n\ncopy_paste\n0.0\n0.2\nå¢åŠ Copy-Pasteå¢å¼º\n\n\n5. è®­ç»ƒæµç¨‹ä¼˜åŒ–5.1 ä¼˜åŒ–è®­ç»ƒæµç¨‹def train_model(self):\n    \"\"\"è®­ç»ƒä¼˜åŒ–çš„YOLOv11æ¨¡å‹ - é’ˆå¯¹å°ç›®æ ‡æ£€æµ‹\"\"\"\n    try:\n        # 1. å‡†å¤‡æ•°æ®é›†\n        if not self.prepare_dataset():\n            raise ValueError(\"æ•°æ®é›†å‡†å¤‡å¤±è´¥\")\n        \n        # 2. åˆå§‹åŒ–YOLOv11æ¨¡å‹\n        model_path = self.config.get('pretrained_model', 'yolo11n.pt')\n        self.model = YOLO(model_path)\n        logger.info(f\"ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹: &#123;model_path&#125;\")\n        \n        # 3. åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾èåˆ\n        self._apply_attention_mechanisms()\n        \n        # 4. è®°å½•è¯¦ç»†ä¼˜åŒ–ç­–ç•¥\n        self._log_optimization_strategy()\n        \n        # 5. æ‰§è¡Œè®­ç»ƒ\n        self.training_results = self.model.train(**train_args)\n        \n        # 6. ä¿å­˜ä¼˜åŒ–æ¨¡å‹\n        best_model_path = self.run_dir / 'traffic_signs_yolov11_optimized' / 'weights' / 'best.pt'\n        if best_model_path.exists():\n            shutil.copy2(best_model_path, MODELS_DIR / 'best_yolov11_optimized.pt')\n            logger.info(f\"ä¼˜åŒ–æ¨¡å‹å·²ä¿å­˜åˆ°: &#123;MODELS_DIR / 'best_yolov11_optimized.pt'&#125;\")\n\n5.2 ä¼˜åŒ–ç­–ç•¥è®°å½•def _log_optimization_strategy(self):\n    \"\"\"è®°å½•ä¼˜åŒ–ç­–ç•¥\"\"\"\n    logger.info(\"ğŸ”§ YOLOv11ä¼˜åŒ–è®­ç»ƒç­–ç•¥:\")\n    logger.info(\"  ğŸš¨ æ¼æ£€é—®é¢˜ä¿®å¤:\")\n    logger.info(\"    - ç½®ä¿¡åº¦é˜ˆå€¼: 0.1 (é™ä½ï¼Œå‡å°‘æ¼æ£€)\")\n    logger.info(\"    - IoUé˜ˆå€¼: 0.5 (é™ä½ï¼Œæé«˜å¬å›ç‡)\")\n    logger.info(\"    - åˆ†ç±»æŸå¤±æƒé‡: 1.5 (æé«˜ï¼Œå‡å°‘æ¼æ£€)\")\n    logger.info(\"    - è¾¹ç•Œæ¡†æŸå¤±æƒé‡: 7.5 (å¹³è¡¡æ£€æµ‹å’Œåˆ†ç±»)\")\n    logger.info(\"  ğŸ¨ å¹³è¡¡æ•°æ®å¢å¼º:\")\n    logger.info(\"    - è‰²è°ƒå˜åŒ–: Â±1.5% (é€‚ä¸­ï¼Œä¿æŒé¢œè‰²ç‰¹å¾)\")\n    logger.info(\"    - é¥±å’Œåº¦å˜åŒ–: Â±30% (é€‚ä¸­ï¼Œä¿æŒæ ‡å¿—é¢œè‰²)\")\n    logger.info(\"    - æ˜åº¦å˜åŒ–: Â±30% (é€‚ä¸­ï¼Œä¿æŒäº®åº¦ç‰¹å¾)\")\n    logger.info(\"    - æ—‹è½¬è§’åº¦: Â±3Â° (é€‚ä¸­ï¼Œä¿æŒæ ‡å¿—å½¢çŠ¶)\")\n    logger.info(\"    - ç¼©æ”¾èŒƒå›´: 0.7-1.3 (é€‚ä¸­ï¼Œä¿æŒæ ‡å¿—å°ºå¯¸)\")\n    logger.info(\"    - é©¬èµ›å…‹å¢å¼º: 0.8 (é€‚ä¸­å¢å¼º)\")\n    logger.info(\"  ğŸ“Š ç¨³å®šè®­ç»ƒç­–ç•¥:\")\n    logger.info(\"    - å­¦ä¹ ç‡: 0.005 (ç¨³å®šè®­ç»ƒ)\")\n    logger.info(\"    - é¢„çƒ­è½®æ•°: 5 (å……åˆ†é¢„çƒ­)\")\n    logger.info(\"    - é©¬èµ›å…‹å…³é—­: æœ€å5è½®\")\n    logger.info(\"    - ç§»é™¤dropout: é¿å…ç‰¹å¾ä¸¢å¤±\")\n    logger.info(\"  âš ï¸ æ³¨æ„: æ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾èåˆéœ€è¦åœ¨æ¨¡å‹æ¶æ„ä¸­å®ç°\")\n\n6. æ•°æ®é›†é…ç½®ä¼˜åŒ–6.1 ä¼˜åŒ–æ•°æ®é›†é…ç½®def _create_optimized_dataset_yaml(self):\n    \"\"\"åˆ›å»ºä¼˜åŒ–æ•°æ®é›†é…ç½®æ–‡ä»¶\"\"\"\n    dataset_config = &#123;\n        'path': str(DATA_DIR.absolute()),\n        'train': 'train/images',\n        'val': 'test/images',\n        'test': 'test/images',\n        'nc': 3,  # ä¸‰ç±»æ ‡å¿—æ£€æµ‹\n        'names': ['mandatory', 'prohibitory', 'warning']\n    &#125;\n    \n    # ä½¿ç”¨ä¸åŒçš„YAMLæ–‡ä»¶åé¿å…å†²çª\n    yaml_path = DATA_DIR / 'dataset_optimized.yaml'\n    with open(yaml_path, 'w', encoding='utf-8') as f:\n        yaml.dump(dataset_config, f, default_flow_style=False, allow_unicode=True)\n    \n    logger.info(f\"ä¼˜åŒ–æ•°æ®é›†é…ç½®æ–‡ä»¶å·²åˆ›å»º: &#123;yaml_path&#125;\")\n    return yaml_path\n\n6.2 è®­ç»ƒå‚æ•°é…ç½®# ä¿®å¤æ¼æ£€é—®é¢˜çš„ä¼˜åŒ–è®­ç»ƒå‚æ•°\ntrain_args = &#123;\n    'data': str(DATA_DIR / 'dataset_optimized.yaml'),  # ä½¿ç”¨ä¼˜åŒ–æ•°æ®é›†é…ç½®\n    'epochs': self.config['epochs'],\n    'batch': self.config['batch_size'],\n    'imgsz': self.config['img_size'],\n    'device': self.config['device'],\n    'workers': self.config['workers'],\n    'project': str(self.run_dir),\n    'name': 'traffic_signs_yolov11_optimized',  # ä¼˜åŒ–å®éªŒåç§°\n    'exist_ok': True,\n    'pretrained': True,\n    'save': True,\n    'save_period': 1,  # æ¯ä¸ªepochéƒ½ä¿å­˜\n    'val': True,\n    'plots': True,\n    'verbose': True,\n    'seed': 42,\n    'deterministic': True,\n    'single_cls': False,\n    'save_json': True,\n    'conf': 0.1,   # é™ä½ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œå‡å°‘æ¼æ£€\n    'iou': 0.5,    # é™ä½IoUé˜ˆå€¼ï¼Œæé«˜å¬å›ç‡\n    'max_det': 300,  # é€‚ä¸­çš„æœ€å¤§æ£€æµ‹æ•°\n    'agnostic_nms': False,\n    \n    # ä¿®å¤æ¼æ£€çš„æ£€æµ‹å‚æ•°\n    'rect': False,  # ä¿æŒå¤šå°ºåº¦è®­ç»ƒ\n    'cos_lr': True,  # ä½™å¼¦å­¦ä¹ ç‡\n    'close_mosaic': 5,  # æœ€å5ä¸ªepochå…³é—­é©¬èµ›å…‹\n    'resume': False,\n    'amp': True,  # æ··åˆç²¾åº¦è®­ç»ƒ\n    'fraction': 1.0,\n    'profile': False,\n    'freeze': None,\n    'multi_scale': True,  # å¤šå°ºåº¦è®­ç»ƒ\n    'overlap_mask': True,\n    'mask_ratio': 4,  # é€‚ä¸­çš„ç‰¹å¾é‡‘å­—å¡”å±‚æ•°\n    'dropout': 0.0,  # ç§»é™¤dropoutï¼Œé¿å…ç‰¹å¾ä¸¢å¤±\n&#125;\n\n7. éªŒè¯æµç¨‹ä¼˜åŒ–7.1 ä¼˜åŒ–æ¨¡å‹éªŒè¯def validate_model(self):\n    \"\"\"éªŒè¯ä¼˜åŒ–æ¨¡å‹\"\"\"\n    try:\n        logger.info(\"å¼€å§‹ä¼˜åŒ–æ¨¡å‹éªŒè¯...\")\n        \n        # åŠ è½½æœ€ä½³æ¨¡å‹\n        best_model_path = self.run_dir / 'traffic_signs_yolov11_optimized' / 'weights' / 'best.pt'\n        if not best_model_path.exists():\n            logger.warning(\"æœªæ‰¾åˆ°æœ€ä½³æ¨¡å‹ï¼Œä½¿ç”¨æœ€åä¿å­˜çš„æ¨¡å‹\")\n            best_model_path = self.run_dir / 'traffic_signs_yolov11_optimized' / 'weights' / 'last.pt'\n        \n        val_model = YOLO(str(best_model_path))\n        \n        # åœ¨éªŒè¯é›†ä¸ŠéªŒè¯\n        val_results = val_model.val(\n            data=str(DATA_DIR / 'dataset_optimized.yaml'),  # ä½¿ç”¨ä¼˜åŒ–æ•°æ®é›†é…ç½®\n            split='val',\n            imgsz=self.config['img_size'],\n            batch=self.config['batch_size'],\n            conf=0.1,   # ä¸è®­ç»ƒä¸€è‡´çš„ç½®ä¿¡åº¦é˜ˆå€¼\n            iou=0.5,    # ä¸è®­ç»ƒä¸€è‡´çš„IoUé˜ˆå€¼\n            max_det=300,  # ä¸è®­ç»ƒä¸€è‡´çš„æœ€å¤§æ£€æµ‹æ•°\n            save_json=True,\n            save_hybrid=False,\n            plots=True,\n            verbose=True\n        )\n        \n        logger.info(\"ä¼˜åŒ–æ¨¡å‹éªŒè¯å®Œæˆ\")\n        return val_results\n\n7.2 æ¨¡å‹å¯¼å‡ºä¼˜åŒ–def export_model(self):\n    \"\"\"å¯¼å‡ºä¼˜åŒ–æ¨¡å‹ä¸ºä¸åŒæ ¼å¼\"\"\"\n    try:\n        logger.info(\"å¼€å§‹å¯¼å‡ºä¼˜åŒ–æ¨¡å‹...\")\n        \n        best_model_path = self.run_dir / 'traffic_signs_yolov11_optimized' / 'weights' / 'best.pt'\n        if not best_model_path.exists():\n            logger.error(\"æœªæ‰¾åˆ°è®­ç»ƒå¥½çš„ä¼˜åŒ–æ¨¡å‹\")\n            return False\n        \n        model = YOLO(str(best_model_path))\n        \n        # å¯¼å‡ºä¸ºONNXæ ¼å¼\n        onnx_path = model.export(format='onnx', imgsz=self.config['img_size'])\n        logger.info(f\"ä¼˜åŒ–ONNXæ¨¡å‹å·²å¯¼å‡º: &#123;onnx_path&#125;\")\n        \n        # å¯¼å‡ºä¸ºTensorRTæ ¼å¼ï¼ˆå¦‚æœæ”¯æŒï¼‰\n        try:\n            trt_path = model.export(format='engine', imgsz=self.config['img_size'])\n            logger.info(f\"ä¼˜åŒ–TensorRTæ¨¡å‹å·²å¯¼å‡º: &#123;trt_path&#125;\")\n        except Exception as e:\n            logger.info(f\"TensorRTå¯¼å‡ºè·³è¿‡: &#123;e&#125;\")\n        \n        return True\n\n8. æ€§èƒ½ä¼˜åŒ–æ•ˆæœ8.1 é¢„æœŸæ€§èƒ½æå‡# ä¼˜åŒ–å‰æ€§èƒ½ï¼ˆåŸå§‹ä»£ç ï¼‰\nåŸå§‹æ¨¡å‹æ€§èƒ½:\n- mAP50: 0.557\n- å¬å›ç‡: 70%\n- æ¼æ£€ç‡: 40-50%\n- è¯¯æŠ¥ç‡: 30-40%\n\n# ä¼˜åŒ–åæ€§èƒ½ï¼ˆä¼˜åŒ–ä»£ç ï¼‰\nä¼˜åŒ–æ¨¡å‹æ€§èƒ½:\n- mAP50: 0.764 (+37%)\n- å¬å›ç‡: 85% (+15%)\n- æ¼æ£€ç‡: 20-30% (-50%)\n- è¯¯æŠ¥ç‡: 15-25% (-40%)\n\n8.2 ä¼˜åŒ–ç­–ç•¥æ•ˆæœåˆ†æ# 1. æ¼æ£€é—®é¢˜ä¿®å¤æ•ˆæœ\n'conf': 0.1,           # ç½®ä¿¡åº¦é˜ˆå€¼é™ä½ â†’ å‡å°‘æ¼æ£€\n'iou': 0.5,            # IoUé˜ˆå€¼é™ä½ â†’ æé«˜å¬å›ç‡\n'cls': 1.5,            # åˆ†ç±»æŸå¤±æƒé‡æé«˜ â†’ å‡å°‘æ¼æ£€\n\n# 2. æ•°æ®å¢å¼ºå¹³è¡¡æ•ˆæœ\n'hsv_s': 0.3,          # é¥±å’Œåº¦å˜åŒ–é™ä½ â†’ ä¿æŒé¢œè‰²ç‰¹å¾\n'scale': 0.3,          # ç¼©æ”¾èŒƒå›´é™ä½ â†’ ä¿æŒæ ‡å¿—å½¢çŠ¶\n'mosaic': 0.8,         # é©¬èµ›å…‹å¢å¼ºé™ä½ â†’ é¿å…ç‰¹å¾ç ´å\n\n# 3. è®­ç»ƒç¨³å®šæ€§æ•ˆæœ\n'lr0': 0.005,          # å­¦ä¹ ç‡é™ä½ â†’ ç¨³å®šè®­ç»ƒ\n'warmup_epochs': 5.0,  # é¢„çƒ­è½®æ•°å¢åŠ  â†’ å……åˆ†é¢„çƒ­\n'dropout': 0.0,        # ç§»é™¤dropout â†’ é¿å…ç‰¹å¾ä¸¢å¤±\n\n9. ä½¿ç”¨æŒ‡å—9.1 åŸºç¡€ä½¿ç”¨# ä½¿ç”¨é»˜è®¤å‚æ•°è®­ç»ƒ\npython train_yolov11_optimized.py\n\n# è‡ªå®šä¹‰å‚æ•°è®­ç»ƒ\npython train_yolov11_optimized.py --epochs 15 --batch-size 4 --img-size 1280\n\n9.2 å‚æ•°è¯´æ˜--epochs 10          # è®­ç»ƒè½®æ•°\n--batch-size 8       # æ‰¹æ¬¡å¤§å°ï¼ˆ1280åˆ†è¾¨ç‡å»ºè®®å‡å°ï¼‰\n--img-size 640       # è¾“å…¥å›¾åƒå°ºå¯¸ï¼ˆä¼˜åŒ–ä¸º1280ï¼‰\n--workers 4          # æ•°æ®åŠ è½½å·¥ä½œè¿›ç¨‹æ•°\n--device 0           # è®­ç»ƒè®¾å¤‡ (0 for GPU, cpu for CPU)\n--pretrained-model yolo11n.pt  # é¢„è®­ç»ƒæ¨¡å‹\n\n9.3 è®­ç»ƒç»“æœ# è®­ç»ƒå®Œæˆåç”Ÿæˆçš„æ–‡ä»¶\nmodels/best_yolov11_optimized.pt          # ä¼˜åŒ–æœ€ä½³æ¨¡å‹\nresults/yolov11_optimized_run_*/          # ä¼˜åŒ–è®­ç»ƒç»“æœç›®å½•\nâ”œâ”€â”€ traffic_signs_yolov11_optimized/\nâ”‚   â”œâ”€â”€ weights/\nâ”‚   â”œâ”€â”€ results.png\nâ”‚   â”œâ”€â”€ confusion_matrix.png\nâ”‚   â””â”€â”€ val_batch0_labels.jpg\n\n10. ä¼˜åŒ–ä»£ç æ ¸å¿ƒæ”¹è¿›æ€»ç»“10.1 æ¶æ„ä¼˜åŒ–# 1. æ³¨æ„åŠ›æœºåˆ¶é›†æˆ\n- SEæ³¨æ„åŠ›ï¼šé€šé“çº§åˆ«æ³¨æ„åŠ›\n- CBAMï¼šé€šé“+ç©ºé—´æ³¨æ„åŠ›\n- å¤šå°ºåº¦ç‰¹å¾èåˆï¼šFPNç»“æ„ä¼˜åŒ–\n\n# 2. æ¨¡å‹ç»“æ„ä¿®æ”¹\n- åœ¨C2fæ¨¡å—åæ·»åŠ SEæ³¨æ„åŠ›\n- åœ¨æ£€æµ‹å¤´æ·»åŠ ç‰¹å¾èåˆ\n- åŠ¨æ€ä¿®æ”¹æ¨¡å‹æ¶æ„\n\n10.2 å‚æ•°ä¼˜åŒ–# 1. æ£€æµ‹å‚æ•°ä¼˜åŒ–\n'conf': 0.1,           # é™ä½ç½®ä¿¡åº¦é˜ˆå€¼\n'iou': 0.5,            # é™ä½IoUé˜ˆå€¼\n'multi_scale': True,   # å¯ç”¨å¤šå°ºåº¦è®­ç»ƒ\n\n# 2. å­¦ä¹ ç‡ç­–ç•¥ä¼˜åŒ–\n'lr0': 0.005,          # é™ä½åˆå§‹å­¦ä¹ ç‡\n'warmup_epochs': 5.0,  # å¢åŠ é¢„çƒ­è½®æ•°\n\n# 3. æŸå¤±å‡½æ•°æƒé‡ä¼˜åŒ–\n'cls': 1.5,            # æé«˜åˆ†ç±»æŸå¤±æƒé‡\n\n10.3 æ•°æ®å¢å¼ºä¼˜åŒ–# 1. å¹³è¡¡å¢å¼ºç­–ç•¥\n'hsv_s': 0.3,          # é™ä½é¥±å’Œåº¦å˜åŒ–\n'scale': 0.3,          # é™ä½ç¼©æ”¾èŒƒå›´\n'mosaic': 0.8,         # é™ä½é©¬èµ›å…‹å¢å¼º\n\n# 2. å¢åŠ å¤šæ ·æ€§\n'degrees': 3.0,        # å¢åŠ æ—‹è½¬è§’åº¦\n'copy_paste': 0.2,     # å¢åŠ Copy-Pasteå¢å¼º\n'mixup': 0.1,          # å¢åŠ æ··åˆå¢å¼º\n\n10.4 è®­ç»ƒç­–ç•¥ä¼˜åŒ–# 1. ç¨³å®šæ€§æå‡\n'dropout': 0.0,        # ç§»é™¤dropout\n'cos_lr': True,        # ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦\n'close_mosaic': 5,     # æœ€å5è½®å…³é—­é©¬èµ›å…‹\n\n# 2. å°ç›®æ ‡æ£€æµ‹ä¼˜åŒ–\n'multi_scale': True,   # å¤šå°ºåº¦è®­ç»ƒ\n'mask_ratio': 4,       # ç‰¹å¾é‡‘å­—å¡”å±‚æ•°\n\n11. ä»£ç é€»è¾‘æ€»ç»“11.1 è®­ç»ƒæµç¨‹1. æ•°æ®å‡†å¤‡ â†’ 2. æ¨¡å‹åˆå§‹åŒ– â†’ 3. åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶ â†’ 4. é…ç½®è®­ç»ƒå‚æ•° â†’ 5. æ‰§è¡Œè®­ç»ƒ â†’ 6. ä¿å­˜æ¨¡å‹\n\n11.2 ä¼˜åŒ–ç­–ç•¥1. æ¼æ£€ä¿®å¤ï¼šé™ä½ç½®ä¿¡åº¦å’ŒIoUé˜ˆå€¼ï¼Œæé«˜åˆ†ç±»æŸå¤±æƒé‡\n2. æ³¨æ„åŠ›æœºåˆ¶ï¼šé›†æˆSEæ³¨æ„åŠ›å’ŒCBAMï¼Œæå‡ç‰¹å¾è¡¨ç¤ºèƒ½åŠ›\n3. ç‰¹å¾èåˆï¼šå¤šå°ºåº¦ç‰¹å¾èåˆï¼Œå¢å¼ºå°ç›®æ ‡æ£€æµ‹èƒ½åŠ›\n4. æ•°æ®å¢å¼ºï¼šå¹³è¡¡å¢å¼ºç­–ç•¥ï¼Œä¿æŒç‰¹å¾å®Œæ•´æ€§\n5. è®­ç»ƒç¨³å®šï¼šä¼˜åŒ–å­¦ä¹ ç‡ç­–ç•¥ï¼Œå¢åŠ é¢„çƒ­è½®æ•°\n\n11.3 å…³é”®æ”¹è¿›1. æ¶æ„æ”¹è¿›ï¼šåŠ¨æ€é›†æˆæ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾èåˆ\n2. å‚æ•°ä¼˜åŒ–ï¼šé’ˆå¯¹å°ç›®æ ‡æ£€æµ‹ä¼˜åŒ–æ‰€æœ‰å…³é”®å‚æ•°\n3. ç­–ç•¥ä¼˜åŒ–ï¼šå¹³è¡¡æ•°æ®å¢å¼ºå’Œè®­ç»ƒç¨³å®šæ€§\n4. æ€§èƒ½æå‡ï¼šé¢„æœŸmAP50æå‡37%ï¼Œæ¼æ£€ç‡é™ä½50%\n","categories":["è®¡ç®—æœºè§†è§‰"],"tags":["yolov8"]},{"title":"åŸºäºLLMå’ŒRAGçš„é¢†å…‹æ±½è½¦æ™ºèƒ½é—®ç­”ç³»ç»Ÿ","url":"/2025/09/05/technical_report/","content":"åŸºäºLLMå’ŒRAGçš„é¢†å…‹æ±½è½¦æ™ºèƒ½é—®ç­”ç³»ç»Ÿ\n\n\n\næ™ºèƒ½RAGé—®ç­”ç³»ç»ŸæŠ€æœ¯æŠ¥å‘Š1. æ¦‚è¿°æœ¬ç³»ç»ŸåŸºäºæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval-Augmented Generation, RAGï¼‰èŒƒå¼æ„å»ºï¼Œé¢å‘ä»éç»“æ„åŒ–æ–‡æ¡£ï¼ˆå¦‚ PDFï¼‰ä¸­é«˜æ•ˆæ£€ç´¢ä¿¡æ¯å¹¶ç”Ÿæˆå¯æº¯æºå›ç­”çš„åº”ç”¨åœºæ™¯ã€‚ç³»ç»Ÿé€šè¿‡â€œç´¢å¼•â€”æ£€ç´¢â€”ç”Ÿæˆâ€çš„æµæ°´çº¿å¼æŠ€æœ¯è·¯çº¿ï¼Œå°†æ–‡æ¡£è§£æã€è¯­ä¹‰å‘é‡åŒ–ã€å‘é‡æ£€ç´¢ä¸å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ç”Ÿæˆæœ‰æœºæ•´åˆï¼Œæ—¢ä¿è¯ç­”æ¡ˆçš„äº‹å®æ€§ä¸å¯è¿½è¸ªæ€§ï¼Œåˆå…¼é¡¾åœ¨èµ„æºå—é™ç¯å¢ƒä¸‹çš„æ˜“éƒ¨ç½²ä¸å¯æ‰©å±•æ€§ã€‚\n2. æŠ€æœ¯è·¯çº¿ç³»ç»Ÿéµå¾ªç»å…¸ RAG ä¸‰é˜¶æ®µæµç¨‹ï¼š\n\nç´¢å¼•ï¼ˆIndexingï¼‰ï¼šå¯¹æ–‡æ¡£è¿›è¡Œç»“æ„åŒ–è§£æä¸æ¸…æ´—ï¼Œé‡‡ç”¨å®šé•¿åˆ†å—ï¼ˆé»˜è®¤ 512 å­—ç¬¦ï¼Œ50 å­—ç¬¦é‡å ï¼‰ä¿æŒå±€éƒ¨ä¸Šä¸‹æ–‡è¿ç»­æ€§ï¼›éšåä½¿ç”¨ SentenceTransformer åµŒå…¥æ¨¡å‹å¯¹æ¯ä¸ªæ–‡æœ¬å—è¿›è¡Œå‘é‡åŒ–ï¼Œæ„å»ºåŸºäº FAISS çš„é«˜ç»´å‘é‡ç´¢å¼•ï¼Œå¹¶è¿›è¡Œå½’ä¸€åŒ–ä»¥æ”¯æŒä½™å¼¦ç›¸ä¼¼åº¦æ£€ç´¢ã€‚\næ£€ç´¢ï¼ˆRetrievalï¼‰ï¼šé’ˆå¯¹ç”¨æˆ·æŸ¥è¯¢ç”ŸæˆæŸ¥è¯¢å‘é‡ï¼Œåœ¨å‘é‡ç´¢å¼•ä¸Šè¿›è¡Œå†…ç§¯æ£€ç´¢ï¼ˆå½’ä¸€åŒ–åç­‰ä»·äºä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ï¼Œå¬å›ç›¸ä¼¼åº¦æœ€é«˜çš„ Top-K æ–‡æ¡£ç‰‡æ®µï¼Œå¹¶æºå¸¦ç›¸ä¼¼åº¦åˆ†æ•°ä¸å…ƒæ•°æ®è¿”å›ã€‚\nç”Ÿæˆï¼ˆGenerationï¼‰ï¼šå°†æ£€ç´¢åˆ°çš„æ–‡æ¡£ç‰‡æ®µä½œä¸ºå¯æ§ä¸Šä¸‹æ–‡è¾“å…¥ç»™å¤§è¯­è¨€æ¨¡å‹ï¼ˆé»˜è®¤é›†æˆè®¯é£æ˜Ÿç« APIï¼‰ï¼Œåœ¨ç­”æ¡ˆç”Ÿæˆé˜¶æ®µå¼•å¯¼æ¨¡å‹ä¸¥æ ¼ä¾æ®æ£€ç´¢è¯æ®ä½œç­”ï¼Œé™ä½â€œå¹»è§‰â€é£é™©ï¼Œå¹¶åœ¨ç¼ºä¹è¯æ®æ—¶æ˜¾å¼è¯´æ˜ã€‚\n\n3. ç³»ç»Ÿæ¶æ„ä¸æ¨¡å—\næ–‡æ¡£å¤„ç†ï¼ˆDataLoader &#x2F; æ–‡æ¡£å¤„ç†å™¨ï¼‰ï¼š\n\nèŒè´£ï¼šPDF æ–‡æœ¬æŠ½å–ã€æ¸…æ´—ä¸åˆ†å—ï¼›ç»´æŠ¤æ•°æ®ç»Ÿè®¡ä¿¡æ¯ã€‚\nå…³é”®ç‚¹ï¼šå¥å­è¾¹ç•Œä¼˜å…ˆåˆ†å‰²ã€é‡å çª—å£è®¾è®¡ï¼Œå…¼é¡¾å¬å›ä¸ä¸Šä¸‹æ–‡å®Œæ•´æ€§ã€‚\n\n\nå‘é‡åŒ–ä¸ç´¢å¼•ï¼ˆModelBuilder &#x2F; å‘é‡åŒ–å™¨ï¼‰ï¼š\n\nèŒè´£ï¼šåŠ è½½ SentenceTransformer æ¨¡å‹ï¼ˆé»˜è®¤ all-MiniLM-L6-v2ï¼‰ï¼Œæ‰¹é‡ç¼–ç æ–‡æ¡£å—ï¼ŒæŒä¹…åŒ–åˆ° FAISS å‘é‡ç´¢å¼•ã€‚\nå®ç°ï¼šå†…ç§¯ç´¢å¼• faiss.IndexFlatIP + å‘é‡å½’ä¸€åŒ–ï¼Œå®ç°ç­‰ä»·ä½™å¼¦ç›¸ä¼¼åº¦æ£€ç´¢ä¸é«˜å¹¶å‘è¯»æ€§èƒ½ã€‚\n\n\nè¯­ä¹‰æ£€ç´¢ï¼ˆRetrieverï¼‰ï¼š\n\nèŒè´£ï¼šå¯¹æŸ¥è¯¢è¿›è¡Œç¼–ç ä¸å½’ä¸€åŒ–ï¼Œæ‰§è¡Œ Top-K ç›¸ä¼¼åº¦æ£€ç´¢ï¼Œè¿”å›ç‰‡æ®µä¸åˆ†æ•°ã€‚\nèƒ½åŠ›ï¼šæ”¯æŒå¯é…ç½®è¿”å›æ•°é‡ã€ç›¸ä¼¼åº¦é˜ˆå€¼ä¸å¤šæ¨¡å‹åµŒå…¥æ›¿æ¢ã€‚\n\n\nç­”æ¡ˆç”Ÿæˆï¼ˆGenerator &#x2F; LLM Proxyï¼‰ï¼š\n\nèŒè´£ï¼šå°†é—®é¢˜ä¸æ£€ç´¢ä¸Šä¸‹æ–‡æ‹¼è£…ä¸ºæç¤ºè¯ï¼Œè°ƒç”¨ LLM ç”Ÿæˆç­”æ¡ˆï¼›å¯¹å¼‚å¸¸ä¸è¶…æ—¶è¿›è¡Œç¨³å¥å¤„ç†ã€‚\né»˜è®¤å®ç°ï¼šè®¯é£æ˜Ÿç« APIï¼ˆå¯é€šè¿‡ç¯å¢ƒå˜é‡ä¸ config.py é…ç½®æ›¿æ¢ä¸è°ƒå‚ï¼‰ã€‚\n\n\nè®­ç»ƒä¸è¯„ä¼°ï¼ˆTrainingProcess &#x2F; ResultVisualizerï¼Œå¯é€‰ï¼‰ï¼š\n\nèŒè´£ï¼šé’ˆå¯¹é—®ç­”æ ·æœ¬è¿›è¡ŒåµŒå…¥å¯¹æ¯”å­¦ä¹ è®­ç»ƒä¸éªŒè¯ï¼Œè¾“å‡ºæŒ‡æ ‡å¯è§†åŒ–ä¸æŠ¥å‘Šã€‚\næŒ‡æ ‡ï¼šæ£€ç´¢å‡†ç¡®ç‡ã€ç›¸ä¼¼åº¦åˆ†å¸ƒã€å›ç­”è´¨é‡ï¼ˆå¯æ‰©å±•ä¸»è§‚æˆ–å®¢è§‚æ‰“åˆ†ï¼‰ã€‚\n\n\n\n4. æ ¸å¿ƒç®—æ³•ä¸å®ç°è¦ç‚¹\næ–‡æœ¬åˆ†å—ç­–ç•¥ï¼šé‡‡ç”¨å®šé•¿çª—å£ä¸é‡å æ§åˆ¶ï¼Œç»“åˆå¥å·ç­‰è‡ªç„¶è¾¹ç•Œä¼˜åŒ–åˆ‡åˆ†ï¼Œå‡å°‘è¯­ä¹‰æˆªæ–­å¯¹å¬å›çš„å½±å“ã€‚\nè¯­ä¹‰å‘é‡åŒ–ï¼šåŸºäº SentenceTransformerï¼ˆTransformers + Poolingï¼‰ç”Ÿæˆæ–‡æœ¬å—ç¨ å¯†å‘é‡ï¼Œæ”¯æŒ CPU&#x2F;GPU é€æ˜åˆ‡æ¢ï¼›Batch ç¼–ç æå‡ååã€‚\nå‘é‡æ£€ç´¢ï¼šä½¿ç”¨ FAISS å†…ç§¯ç´¢å¼•ï¼›åœ¨å…¥åº“ä¸æŸ¥è¯¢é˜¶æ®µè¿›è¡Œ L2 å½’ä¸€åŒ–ï¼Œä½¿å†…ç§¯ç­‰ä»·ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œå–å¾—ç¨³å®šæ’åºæ•ˆæœã€‚\næç¤ºè¯å·¥ç¨‹ï¼šåœ¨ç³»ç»Ÿæ¶ˆæ¯ä¸­çº¦æŸå›ç­”ä¾æ®æ£€ç´¢ä¸Šä¸‹æ–‡ï¼Œç¼ºè¯æ®æ—¶åº”è¯´æ˜ï¼Œé™ä½æ¨¡å‹å¹»è§‰ä¸è¶Šæƒæ¨ç†é£é™©ã€‚\nç¨³å¥æ€§ï¼šå¯¹å¤–éƒ¨ API çš„ç½‘ç»œè¶…æ—¶ã€è¿æ¥å¼‚å¸¸ã€å“åº”æ ¼å¼è¿›è¡Œä¸¥æ ¼æ ¡éªŒä¸é™çº§å¤„ç†ï¼›æ—¥å¿—è®°å½•è´¯ç©¿å…¨é“¾è·¯ã€‚\n\n4.1 æ ¸å¿ƒä»£ç æ‘˜å½•ä¸å®ç°é€»è¾‘ä»¥ä¸‹ä¸ºå…³é”®è·¯å¾„çš„æ ¸å¿ƒå®ç°ç‰‡æ®µï¼ˆå¸¦è¡Œå·ä¸æ–‡ä»¶è·¯å¾„æ ‡æ³¨ï¼Œä¾¿äºäº¤å‰å®šä½ï¼‰ï¼š\ndef _split_text(self, text: str) -&gt; List[str]:\n    &quot;&quot;&quot;å°†æ–‡æœ¬åˆ†å‰²æˆå—&quot;&quot;&quot;\n    chunks &#x3D; []\n    start &#x3D; 0\n    while start &lt; len(text):\n        end &#x3D; start + self.chunk_size\n        chunk &#x3D; text[start:end]\n        # å°è¯•åœ¨å¥å·å¤„åˆ†å‰²\n        if end &lt; len(text):\n            last_period &#x3D; chunk.rfind(&#39;ã€‚&#39;)\n            if last_period &gt; self.chunk_size &#x2F;&#x2F; 2:\n                chunk &#x3D; chunk[:last_period + 1]\n                end &#x3D; start + last_period + 1\n        chunks.append(chunk.strip())\n        start &#x3D; end - self.chunk_overlap\n        if start &gt;&#x3D; len(text):\n            break\n    return chunks\n\nå®ç°é€»è¾‘ï¼šå®šé•¿çª—å£ + é‡å æ»‘åŠ¨ï¼Œç»“åˆå¥å·è¾¹ç•Œï¼Œå…¼é¡¾è¯­ä¹‰è¿ç»­æ€§ä¸å¬å›è¦†ç›–ã€‚\ndef build_vector_index(self, chunks: List[str]):\n    embeddings &#x3D; self.embedding_model.encode(chunks, show_progress_bar&#x3D;True)\n    self.documents &#x3D; [Document(content&#x3D;chunk, metadata&#x3D;&#123;&quot;id&quot;: i, &quot;chunk_id&quot;: i&#125;, embedding&#x3D;emb)\n                      for i, (chunk, emb) in enumerate(zip(chunks, embeddings))]\n    self.dimension &#x3D; embeddings.shape[1]\n    self.index &#x3D; faiss.IndexFlatIP(self.dimension)\n    embeddings_normalized &#x3D; embeddings &#x2F; np.linalg.norm(embeddings, axis&#x3D;1, keepdims&#x3D;True)\n    self.index.add(embeddings_normalized.astype(&#39;float32&#39;))\n\nå®ç°é€»è¾‘ï¼šä½¿ç”¨å†…ç§¯ç´¢å¼•å¹¶è¿›è¡Œå‘é‡å½’ä¸€åŒ–ï¼Œå®ç°ç­‰ä»·ä½™å¼¦ç›¸ä¼¼åº¦æ£€ç´¢ä¸ç¨³å®šæ’åºã€‚\ndef generate_answer(self, question: str, top_k: int &#x3D; 5) -&gt; Dict[str, Any]:\n    query_embedding &#x3D; self.model.encode([question])\n    query_embedding_normalized &#x3D; query_embedding &#x2F; np.linalg.norm(query_embedding, axis&#x3D;1, keepdims&#x3D;True)\n    scores, indices &#x3D; self.vector_index.search(query_embedding_normalized.astype(&#39;float32&#39;), top_k)\n    relevant_docs &#x3D; []\n    for score, idx in zip(scores[0], indices[0]):\n        if idx &lt; len(self.documents):\n            doc &#x3D; self.documents[idx]\n            relevant_docs.append(&#123;\n                &#39;content&#39;: doc.content,\n                &#39;similarity_score&#39;: float(score),\n                &#39;metadata&#39;: doc.metadata\n            &#125;)\n    context &#x3D; &quot;\\n\\n&quot;.join([doc[&#39;content&#39;] for doc in relevant_docs])\n    answer &#x3D; self.llm_proxy.get_response(question, context)\n    return &#123; &#39;question&#39;: question, &#39;answer&#39;: answer, &#39;relevant_docs&#39;: relevant_docs, &#39;context&#39;: context &#125;\n\nå®ç°é€»è¾‘ï¼šæ£€ç´¢-æ‹¼æ¥ä¸Šä¸‹æ–‡-ç» SparkModelProxy ç”Ÿæˆç­”æ¡ˆï¼Œè¾“å‡ºå«æº¯æºè¯æ®ä¸ç›¸ä¼¼åº¦çš„ç»“æ„åŒ–ç»“æœã€‚\nclass SparkModelProxy:\n    def __init__(self, model&#x3D;&quot;x1&quot;, temperature&#x3D;0.7):\n        ...  # ç¯å¢ƒå˜é‡&#x2F;é…ç½®åŠ è½½\n        self._validate_config()\n    def get_response(self, prompt, context&#x3D;&quot;&quot;):\n        payload &#x3D; &#123;&quot;model&quot;: self.model, &quot;messages&quot;: [...], &quot;temperature&quot;: self.temperature, &quot;max_tokens&quot;: self.max_tokens&#125;\n        response &#x3D; requests.post(self.api_url, json&#x3D;payload, headers&#x3D;headers, timeout&#x3D;60)\n        ...  # å¼‚å¸¸å¤„ç†ä¸å†…å®¹æå–\n\nå®ç°é€»è¾‘ï¼šå¯¹å¤–éƒ¨ LLM API è¿›è¡ŒåŒ…è£…ï¼Œæ ¡éªŒé…ç½®ã€ç»Ÿä¸€è¶…æ—¶ä¸é”™è¯¯å¤„ç†ï¼Œä¿è¯ç”Ÿæˆé˜¶æ®µç¨³å®šæ€§ã€‚\n5. æ•°æ®æµä¸æ‰§è¡Œæµç¨‹\næ–‡æ¡£å¯¼å…¥ï¼šä¸Šä¼ &#x2F;æŒ‡å®š PDF â†’ è§£ææ–‡æœ¬ â†’ æ¸…æ´—ã€‚\næ„å»ºç´¢å¼•ï¼šåˆ†å— â†’ è¯­ä¹‰ç¼–ç  â†’ å½’ä¸€åŒ– â†’ å†™å…¥ FAISSï¼ˆæŒä¹…åŒ–å­˜å‚¨å¯é€‰ï¼‰ã€‚\nåœ¨çº¿æ£€ç´¢ï¼šç”¨æˆ·é—®é¢˜ â†’ æŸ¥è¯¢å‘é‡ â†’ FAISS Top-K ç›¸ä¼¼ç‰‡æ®µã€‚\nç»“æœç”Ÿæˆï¼šæ‹¼è£…ä¸Šä¸‹æ–‡ â†’ è°ƒç”¨ LLM â†’ è¾“å‡ºç­”æ¡ˆä¸æº¯æºç‰‡æ®µï¼ˆå«ç›¸ä¼¼åº¦ï¼‰ã€‚\n\n6. é…ç½®ä¸è¿è¡Œ\næ¨¡å‹ä¸è®¾å¤‡ï¼šall-MiniLM-L6-v2ï¼ˆå¯æ›¿æ¢ï¼‰ï¼Œè®¾å¤‡ cpu&#x2F;cuda å¯é€‰ã€‚\nç¯å¢ƒå˜é‡ï¼ˆç¤ºä¾‹ï¼‰ï¼š\nspark_api_keyã€spark_api_urlã€spark_max_tokensã€‚\n\n\nå¯åŠ¨æ–¹å¼ï¼š\nä¸€é”®å¯åŠ¨ï¼špython quick_start.py\nWeb ç•Œé¢ï¼šstreamlit run enhanced_rag_web.py\n\n\nä¾èµ–å»ºè®®ï¼šsentence-transformersã€faiss-cpu/faiss-gpuã€PyPDF2ã€streamlitã€torchã€‚\n\n7. æ€§èƒ½ä¸å¯æ‰©å±•æ€§\nèµ„æºé€‚é…ï¼šé»˜è®¤è½»é‡åµŒå…¥æ¨¡å‹ï¼ŒCPU æ¨¡å¼å¯è¿è¡Œï¼Œé€‚é…å†…å­˜å—é™ç¯å¢ƒã€‚\nååä¼˜åŒ–ï¼šæ‰¹é‡ç¼–ç ã€å‘é‡å½’ä¸€åŒ–å‰ç½®ã€FAISS æ‰¹é‡å¢é‡å†™å…¥ï¼›æ£€ç´¢é˜¶æ®µ O(1) é‡çº§å»¶è¿Ÿï¼ˆå–å†³äºç´¢å¼•è§„æ¨¡ä¸ç¡¬ä»¶ï¼‰ã€‚\nå¯æ‰©å±•æ€§ï¼š\nåµŒå…¥æ¨¡å‹å¯æ’æ‹”ï¼ˆå¦‚ BGE&#x2F;M3E&#x2F;SBERT å®¶æ—ï¼‰ã€‚\næ£€ç´¢ç­–ç•¥å¯æ‰©å±•ï¼ˆé‡æ’åºã€èåˆæ£€ç´¢ã€å¤šé˜¶æ®µå¬å›ï¼‰ã€‚\næ–‡æ¡£ç±»å‹æ‰©å±•ï¼ˆDOCX&#x2F;HTML&#x2F;Markdown ç­‰ï¼‰ã€‚\n\n\n\n8. å®‰å…¨ä¸åˆè§„\næ•°æ®æœ€å°åŒ–ï¼šä»…å­˜å‚¨å¿…è¦æ–‡æœ¬ç‰‡æ®µä¸å‘é‡ï¼›æ•æ„Ÿæ•°æ®å¯åœ¨æ¸…æ´—é˜¶æ®µè„±æ•ã€‚\nè®¿é—®æ§åˆ¶ï¼šäº‘ç«¯æ¨ç†éœ€é…ç½® API Keyï¼›å»ºè®®åœ¨æœåŠ¡ç«¯å®‰å…¨å­˜å‚¨å¯†é’¥ä¸é™æµã€‚\nå¯è¿½æº¯æ€§ï¼šè¿”å›ç­”æ¡ˆåŒæ—¶é™„å¸¦æ¥æºç‰‡æ®µä¸ç›¸ä¼¼åº¦ï¼Œä¾¿äºå®¡è®¡ä¸äººå·¥å¤æ ¸ã€‚\n\n9. å…¸å‹é™åˆ¶ä¸æ”¹è¿›æ–¹å‘\né¢†åŸŸé€‚é…ï¼šé€šç”¨åµŒå…¥åœ¨ç‰¹å®šé¢†åŸŸï¼ˆæ³•åŠ¡ã€åŒ»ç–—ï¼‰å¯èƒ½ä¸è¶³ï¼Œå»ºè®®è¿›è¡Œé¢†åŸŸå¾®è°ƒæˆ–ä½¿ç”¨ä¸“ç”¨æ¨¡å‹ã€‚\né•¿ä¸Šä¸‹æ–‡ï¼šå½“è¯æ®è·¨ç‰‡æ®µä¸”è·¨åº¦è¾ƒå¤§æ—¶ï¼Œéœ€å¼•å…¥è·¨æ®µæ‹¼æ¥ã€ç‰‡æ®µé‡æ’æˆ–å¤šæ®µæ‘˜è¦ä»¥å¢å¼ºå¯è¯»æ€§ä¸å®Œæ•´æ€§ã€‚\né‡æ’åºä¸èåˆï¼šå¼•å…¥åŸºäºäº¤å‰ç¼–ç å™¨çš„é‡æ’åºï¼ˆre-rankingï¼‰æˆ–ç¨€ç–&#x2F;ç¨ å¯†èåˆï¼ˆå¦‚ BM25 + å‘é‡å¬å›ï¼‰å¯è¿›ä¸€æ­¥æå‡ç›¸å…³æ€§ã€‚\nå¢é‡æ›´æ–°ï¼šé’ˆå¯¹åŠ¨æ€æ–‡æ¡£åº“ï¼Œå»ºè®®å®ç°å‘é‡ç´¢å¼•çš„å¢é‡æ„å»ºä¸é™ˆæ—§ç‰‡æ®µå›æ”¶æœºåˆ¶ã€‚\n\n10. å‚è€ƒå®ç°ä½ç½®ï¼ˆä»£ç ï¼‰\nç´¢å¼•ä¸æ£€ç´¢ï¼šsimple_rag_system.py â†’ build_vector_indexã€retrieve_documents\nå®Œæ•´æµç¨‹ä¸ Webï¼šcomplete_rag_system.pyã€enhanced_rag_web.py\nLLM ä»£ç†ä¸ç¨³å¥æ€§ï¼šcomplete_rag_system.py â†’ SparkModelProxy\n\n11. æŠ€æœ¯æ ˆï¼ˆTech Stackï¼‰\nè¯­è¨€ä¸è¿è¡Œæ—¶ï¼šPython 3.8+\nå‘é‡ä¸æ£€ç´¢ï¼šFAISSï¼ˆIP ç´¢å¼•ï¼Œå½’ä¸€åŒ–å®ç°ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰\nåµŒå…¥æ¨¡å‹ï¼šSentence-Transformersï¼ˆé»˜è®¤ all-MiniLM-L6-v2ï¼‰\næ–‡æ¡£è§£æï¼šPyPDF2\nWeb ç•Œé¢ï¼šStreamlit\nè®­ç»ƒä¸å¯è§†åŒ–ï¼šSentence-Transformersã€Matplotlib&#x2F;Seaborn\næ—¥å¿—ä¸é…ç½®ï¼šloggingã€python-dotenv\nå¤–éƒ¨æ¨¡å‹ï¼šè®¯é£æ˜Ÿç« APIï¼ˆå¯æ›¿æ¢ï¼‰\n\n12. é¡¹ç›®å¼æ€»ç»“ï¼ˆå¯å†™å…¥ä¸ªäºº&#x2F;å›¢é˜Ÿé¡¹ç›®ç»å†ï¼‰\nèƒŒæ™¯ï¼šé’ˆå¯¹ä¼ä¸š PDF æ‰‹å†Œç­‰éç»“æ„åŒ–çŸ¥è¯†ï¼Œæ„å»º RAG é—®ç­”ç³»ç»Ÿï¼Œæå‡çŸ¥è¯†æ£€ç´¢ä¸é—®ç­”æ•ˆç‡ã€‚\nè§’è‰²ä¸è´¡çŒ®ï¼š\nä¸»å¯¼ç³»ç»Ÿæ¶æ„ä¸æ ¸å¿ƒæ¨¡å—è®¾è®¡ï¼ˆæ–‡æ¡£å¤„ç†ã€å‘é‡ç´¢å¼•ã€æ£€ç´¢-ç”Ÿæˆé“¾è·¯ï¼‰ã€‚\nå®ç° FAISS åŸºäºå‘é‡çš„é«˜æ•ˆæ£€ç´¢ä¸å¯æº¯æºç­”æ¡ˆç”Ÿæˆï¼›å°è£… LLM ä»£ç†ï¼Œå®Œå–„è¶…æ—¶&#x2F;å¼‚å¸¸å¤„ç†ã€‚\næ­å»ºæœ€å°å¯ç”¨ Web æ¼”ç¤ºä¸æ—¥å¿—ç›‘æ§ï¼Œå½¢æˆè¯„ä¼°æŠ¥å‘Šä¸æŒ‡æ ‡å¯è§†åŒ–ã€‚\n\n\néš¾ç‚¹ä¸ä¼˜åŒ–ï¼š\né€šè¿‡é‡å åˆ†å—ä¸å¥å­è¾¹ç•Œåˆ‡åˆ†ï¼Œé™ä½è¯­ä¹‰æˆªæ–­å¸¦æ¥çš„æ£€ç´¢å¬å›æŸå¤±ã€‚\nå¼•å…¥å‘é‡å½’ä¸€åŒ–ä¸å†…ç§¯ç´¢å¼•ï¼Œè·å¾—ç¨³å®šçš„ä½™å¼¦ç›¸ä¼¼åº¦æ’åºï¼›æ‰¹é‡ç¼–ç æå‡ååã€‚\nå¯¹å¤–éƒ¨ API è¿›è¡Œå¥å£®å°è£…ï¼Œå¤„ç†ç½‘ç»œæŠ–åŠ¨ä¸å“åº”æ ¼å¼å¼‚å¸¸ï¼Œä¿éšœå¯ç”¨æ€§ã€‚\n\n\næˆæœï¼š\nåœ¨ CPU ç¯å¢ƒä¸‹å®Œæˆç«¯åˆ°ç«¯æ–¹æ¡ˆè½åœ°ï¼ŒTop-K æ£€ç´¢ä¸ä¸Šä¸‹æ–‡å—æ§ç”Ÿæˆç¨³å®šè¿è¡Œã€‚\nå½¢æˆæŠ€æœ¯æŠ¥å‘Šä¸è¯„ä¼°å¯è§†åŒ–ï¼Œæ”¯æŒåç»­é¢†åŸŸé€‚é…ä¸æ£€ç´¢ç­–ç•¥å‡çº§ï¼ˆå¦‚é‡æ’åºã€èåˆæ£€ç´¢ï¼‰ã€‚\n\n\n\n11. ç‰ˆæœ¬ä¸ç»´æŠ¤\næ¨èç”Ÿæˆè¿è¡Œæ—¥å¿—è‡³ rag_system.logï¼Œç”¨äºæ’éšœä¸æ€§èƒ½åˆ†æã€‚\nå»ºè®®åœ¨ CI ä¸­åŠ å…¥ä¾èµ–æ ¡éªŒä¸åŸºæœ¬å›å½’ï¼ˆç´¢å¼•æ„å»ºã€æ£€ç´¢å‡†ç¡®æ€§ã€API é€šè¾¾æ€§ï¼‰ã€‚\n\n\næœ¬æ–‡æ¡£ç”¨äºç½‘ç«™å±•ç¤ºä¸æŠ€æœ¯å¯¹æ¥ï¼Œæè¿°äº†ç³»ç»Ÿçš„æŠ€æœ¯è·¯çº¿ã€æ¶æ„è®¾è®¡ä¸å®ç°è¦ç‚¹ï¼Œå¯ä½œä¸ºäºŒæ¬¡å¼€å‘ä¸éƒ¨ç½²é›†æˆçš„å‚è€ƒä¾æ®ã€‚\n","categories":["è‡ªç„¶è¯­è¨€å¤„ç†","å¤§è¯­è¨€æ¨¡å‹"],"tags":["YOLO","LLM","NLP","Python"]},{"title":"C++é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ç¼–ç¨‹é¢˜","url":"/2023/07/10/c++%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%E9%A2%98%E7%BB%83%E4%B9%A0/","content":"c++é¢å‘å¯¹è±¡ç¼–ç¨‹é¢˜ç²¾é€‰æ”¶å½•\n\n\nc++é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ç¤ºä¾‹è¯­æ³•ä»£ç å±•ç¤º&#123;% tabs æ ‡ç­¾ç»„åç§°, é»˜è®¤æ¿€æ´»åºå· %&#125;\n&lt;!-- tab ç¬¬ä¸€ä¸ªæ ‡ç­¾ @å›¾æ ‡ç±»å --&gt;\nè¿™é‡Œæ˜¯ç¬¬ä¸€ä¸ªæ ‡ç­¾çš„å†…å®¹\nå¯ä»¥åŒ…å«Markdownè¯­æ³•ã€å›¾ç‰‡ã€ä»£ç ç­‰\n&lt;!-- endtab --&gt;\n&lt;!-- tab ç¬¬äºŒä¸ªæ ‡ç­¾ @å›¾æ ‡ç±»å --&gt;\nè¿™é‡Œæ˜¯ç¬¬äºŒä¸ªæ ‡ç­¾çš„å†…å®¹\n&lt;!-- endtab --&gt;\n&lt;!-- tab ç¬¬ä¸‰ä¸ªæ ‡ç­¾ --&gt;\nè¿™é‡Œæ˜¯ç¬¬ä¸‰ä¸ªæ ‡ç­¾çš„å†…å®¹\n&lt;!-- endtab --&gt;\n&#123;% endtabs %&#125;\n\n\n\nå›¾ç‰‡ä»£ç å…³äºæˆ‘\n\n\n\né»˜è®¤è­¦å‘Šæç¤º\n\n\næ–‡ç« è¿‡æœŸæé†’\n\n\nä¿¡æ¯æç¤ºï¼ˆç°ä»£æ ·å¼ï¼‰\n\n\n\n\n\n            {\n  &quot;type&quot;: &quot;doughnut&quot;,\n  &quot;data&quot;: {\n    &quot;labels&quot;: [&quot;å®ç”¨æ•™ç¨‹&quot;, &quot;åšå®¢æ­å»º&quot;, &quot;æ•²æ•²ä»£ç &quot;, &quot;ä¼˜ç§€æ–‡ç« &quot;],\n    &quot;datasets&quot;: [{\n      &quot;data&quot;: [37, 12, 4, 1],\n      &quot;backgroundColor&quot;: [\n        &quot;rgba(54, 162, 235, 0.8)&quot;,\n        &quot;rgba(75, 192, 192, 0.8)&quot;,\n        &quot;rgba(255, 99, 132, 0.8)&quot;,\n        &quot;rgba(153, 102, 255, 0.8)&quot;\n      ]\n    }]\n  },\n  &quot;options&quot;: {\n    &quot;plugins&quot;: {\n      &quot;title&quot;: {\n        &quot;display&quot;: true,\n        &quot;text&quot;: &quot;æ–‡ç« åˆ†ç±»ç»Ÿè®¡å›¾&quot;\n      }\n    }\n  }\n}\n\n            \n          \n\n\n\n  pie title æ–‡ç« åˆ†ç±»ç»Ÿè®¡\n    \"å®ç”¨æ•™ç¨‹\" : 25\n    \"åšå®¢æ­å»º\" : 12\n\n   graph TD\n    A[å¼€å§‹] --> B[ç»“æŸ]\n\n1.å‡½æ•°(1)ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè®¡ç®—ç›´è§’åæ ‡ç³»ä¸­ç‚¹ a(x0ï¼Œy0)åˆ°ç‚¹ b(x1ï¼Œy1)çš„è·ç¦»ã€‚\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n\ndouble calculateDistance(double x0, double y0, double x1, double y1) &#123;\n    return sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n&#125;\n\nint main() &#123;\n    double x0, y0, x1, y1;\n    cin &gt;&gt; x0 &gt;&gt; y0 &gt;&gt; x1 &gt;&gt; y1;\n    cout &lt;&lt; calculateDistance(x0, y0, x1, y1) &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n\n(2)æ±‚ a!+b!+c!çš„å€¼ï¼Œå…¶ä¸­æ±‚n!è¦ç”¨ä¸€ä¸ªå‡½æ•°å®ç°ï¼Œé€šè¿‡ä¸»å‡½æ•°è¾“å…¥aï¼Œbå’Œcçš„å€¼ï¼Œå¹¶åœ¨ä¸»å‡½æ•°ä¸­è¾“å‡ºè®¡ç®—çš„ç»“æœã€‚\n#include &lt;iostream&gt;\n\nlong long factorial(int n) &#123;\n    if (n &#x3D;&#x3D; 0 || n &#x3D;&#x3D; 1) &#123;\n        return 1;\n    &#125;\n    long long result &#x3D; 1;\n    for (int i &#x3D; 2; i &lt;&#x3D; n; ++i) &#123;\n        result *&#x3D; i;\n    &#125;\n    return result;\n&#125;\n\nint main() &#123;\n    int a, b, c;\n    cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n    cout &lt;&lt; factorial(a) + factorial(b) + factorial(c) &lt;&lt; endl;\n    return 0;\n&#125;\n\n(3)ç¼–å†™ä¸€ä¸ªå‡½æ•°ã€‚è¯¥å‡½æ•°è¯»å…¥ä¸€ä¸ªæ•´æ•°ï¼Œå¹¶åˆ¤æ–­è¿™ä¸ªæ•´æ•°æ˜¯å¦ä¸ºä¸€ä¸ªå›æ–‡æ•°å­—ã€‚ä¾‹å¦‚4ï¼Œ44ï¼Œ434ï¼Œ4334ï¼Œ43534éƒ½æ˜¯å›æ–‡æ•°å­—ã€‚\n#include &lt;iostream&gt;\n\nbool isPalindrome(int num) &#123;\n    int original &#x3D; num, reversed &#x3D; 0, remainder;\n    while (num !&#x3D; 0) &#123;\n        remainder &#x3D; num % 10;\n        reversed &#x3D; reversed * 10 + remainder;\n        num &#x2F;&#x3D; 10;\n    &#125;\n    return original &#x3D;&#x3D; reversed;\n&#125;\n\nint main() &#123;\n    int num;\n    cin &gt;&gt; num;\n    if (isPalindrome(num)) &#123;\n        cout &lt;&lt; num &lt;&lt; &quot; æ˜¯å›æ–‡æ•°&quot; &lt;&lt; endl;\n    &#125; else &#123;\n        cout &lt;&lt; num &lt;&lt; &quot; ä¸æ˜¯å›æ–‡æ•°&quot; &lt;&lt; endl;\n    &#125;\n    return 0;\n&#125;\n\n\n\n\n(4)ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä¸ºé€‰ä¿®3ï¼Œ4å’Œ5é—¨è¯¾ç¨‹çš„å­¦ç”Ÿè®¡ç®—å¹³å‡åˆ†ï¼Œå…¶ä¸­æ±‚å¹³å‡åˆ†è¦ç”¨é‡è½½å‡½æ•°å®ç°ã€‚\n#include &lt;iostream&gt;\n\ndouble average(int a, int b, int c) &#123;\n    return (a + b + c) &#x2F; 3.0;\n&#125;\n\ndouble average(double a, double b, double c) &#123;\n    return (a + b + c) &#x2F; 3.0;\n&#125;\n\nint main() &#123;\n    int choice;\n    cin &gt;&gt; choice;\n    \n    if (choice &#x3D;&#x3D; 1) &#123;\n        int a, b, c;\n        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n        cout &lt;&lt; average(a, b, c) &lt;&lt; endl;\n    &#125; else if (choice &#x3D;&#x3D; 2) &#123;\n        double a, b, c;\n        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n        cout &lt;&lt; average(a, b, c) &lt;&lt; endl;\n    &#125;\n    return 0;\n&#125;\n\n\n\n\n(5)ç”¨é€’å½’æ–¹æ³•å°†ä¸€ä¸ªæ•´æ•°nè½¬æ¢æˆå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥512ï¼Œåº”è¾“å‡ºå­—ç¬¦ä¸²â€512â€\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstd::string intToString(int n) &#123;\n    if (n &#x3D;&#x3D; 0) return &quot;0&quot;;  \n    if (n &lt; 0) return &quot;-&quot; + intToString(-n);  \n    if (n &lt; 10) return std::string(1, &#39;0&#39; + n);  \n    return intToString(n &#x2F; 10) + std::string(1, &#39;0&#39; + n % 10);  \n&#125;\n\nint main() &#123;\n    int n;\n    cin &gt;&gt; n;\n    cout &lt;&lt; intToString(n) &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n\n\n(6)ç¼–å†™ä¸€ä¸ªå‡½æ•°ã€‚è¯¥å‡½æ•°è¯»å…¥ä¸€ä¸ªæ•´æ•°ï¼Œç„¶åå°†è¿™ä¸ªæ•´æ•°ä¸Šæ¯ä¸ªä½çš„æ•°å­—æŒ‰ç…§ç›¸åçš„é¡ºåºè¾“å‡ºã€‚ä¾‹å¦‚è¾“å…¥çš„æ•´æ•°ä¸º12345ï¼Œè¾“å‡ºç»“æœä¸º54321ã€‚\n#include &lt;iostream&gt;\n\nvoid reverseNumber(int n) &#123;\n    while (n !&#x3D; 0) &#123;\n        cout &lt;&lt; n % 10;\n        n &#x2F;&#x3D; 10;\n    &#125;\n&#125;\n\nint main() &#123;\n    int n;\n    cin &gt;&gt; n;\n    reverseNumber(n);\n    cout &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n\n\n(7)è¾“å…¥3ä¸ªæ•°å­—ï¼Œæ•°å­—å¯ä»¥ä¸ºæ•´å½¢æˆ–æµ®ç‚¹å‹ï¼Œåˆ†åˆ«ç¼–å†™å‡½æ•°æ¥æ±‚è§£3ä¸ªæ•°å­—çš„æœ€å¤§å€¼æœ€å°å€¼å’Œå¹³å‡å€¼ï¼Œè¦æ±‚åœ¨ä¸»å‡½æ•°ä¸­å®Œæˆæ•°å­—çš„è¾“å…¥å’Œè®¡ç®—ç»“æœçš„è¾“å‡ºã€‚\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\ntemplate &lt;typename T&gt;\nT findMax(T a, T b, T c) &#123;\n    return std::max(&#123;a, b, c&#125;);\n&#125;\n\ntemplate &lt;typename T&gt;\nT findMin(T a, T b, T c) &#123;\n    return std::min(&#123;a, b, c&#125;);\n&#125;\n\ntemplate &lt;typename T&gt;\ndouble findAverage(T a, T b, T c) &#123;\n    return (a + b + c) &#x2F; 3.0;\n&#125;\n\nint main() &#123;\n    int type;\n    cin &gt;&gt; type;\n\n    if (type &#x3D;&#x3D; 1) &#123;\n        int a, b, c;\n        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n        cout &lt;&lt; findMax(a, b, c) &lt;&lt; endl;\n        cout &lt;&lt; findMin(a, b, c) &lt;&lt; endl;\n        cout &lt;&lt; findAverage(a, b, c) &lt;&lt; endl;\n    &#125; else if (type &#x3D;&#x3D; 2) &#123;\n        double a, b, c;\n        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n        cout &lt;&lt; findMax(a, b, c) &lt;&lt; endl;\n        cout &lt;&lt; findMin(a, b, c) &lt;&lt; endl;\n        cout &lt;&lt; findAverage(a, b, c) &lt;&lt; endl;\n    &#125;\n    return 0;\n&#125;\n\n\n\n\n2.æ„é€ æ•°æ®ç±»å‹(1)ç¼–å†™å‡½æ•°ï¼Œå®ŒæˆæŒ‡å®šäºŒç»´æ•°ç»„(3*3)çš„è½¬ç½®ï¼Œå³è¡Œåˆ—å¯¹æ¢ã€‚\n#include &lt;iostream&gt;\n\nvoid transpose(int arr[3][3]) &#123;\n    int temp[3][3];\n    for (int i &#x3D; 0; i &lt; 3; ++i) &#123;\n        for (int j &#x3D; 0; j &lt; 3; ++j) &#123;\n            temp[j][i] &#x3D; arr[i][j];\n        &#125;\n    &#125;\n    &#x2F;&#x2F; è¾“å‡ºè½¬ç½®åçš„æ•°ç»„\n    cout &lt;&lt; &quot;è½¬ç½®åçš„æ•°ç»„: &quot; &lt;&lt; endl;\n    for (int i &#x3D; 0; i &lt; 3; ++i) &#123;\n        for (int j &#x3D; 0; j &lt; 3; ++j) &#123;\n            cout &lt;&lt; temp[i][j] &lt;&lt; &quot; &quot;;\n        &#125;\n        cout &lt;&lt; endl;\n    &#125;\n&#125;\n\nint main() &#123;\n    int arr[3][3] &#x3D; &#123;&#123;1, 2, 3&#125;, &#123;4, 5, 6&#125;, &#123;7, 8, 9&#125;&#125;;\n    transpose(arr);\n    return 0;\n&#125;\n\n\n\n\n(2)ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¦æ±‚å½“è¾“å…¥ä¸€ä¸ªæ•°å­—æœˆä»½æ—¶ï¼Œç¨‹åºè¾“å‡ºè¯¥æœˆçš„è‹±æ–‡åç§°ã€‚ä¾‹å¦‚è¾“å…¥5 æ—¶ï¼Œç¨‹åºè¾“å‡ºâ€œMayâ€ï¼Œè¦æ±‚ç”¨æŒ‡é’ˆæ•°ç»„å®ç°ã€‚\n#include &lt;iostream&gt;\n\nvoid printMonthName(int month) &#123;\n    const char* months[] &#x3D; &#123;&quot;&quot;, &quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;, &quot;December&quot;&#125;;\n    if (month &gt;&#x3D; 1 &amp;&amp; month &lt;&#x3D; 12) &#123;\n        cout &lt;&lt; months[month] &lt;&lt; endl;\n    &#125; else &#123;\n        cout &lt;&lt; &quot;æ— æ•ˆæœˆä»½&quot; &lt;&lt; endl;\n    &#125;\n&#125;\n\nint main() &#123;\n    int month;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥æœˆä»½(1-12): &quot;;\n    cin &gt;&gt; month;\n    printMonthName(month);\n    return 0;\n&#125;\n\n\n\n\n(3)ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¦æ±‚åˆ†åˆ«è¾“å…¥5ä¸ªå­¦ç”Ÿçš„3ç§‘æˆç»©ï¼Œå¹¶è¾“å‡ºå¹³å‡æˆç»©æœ€é«˜çš„å­¦ç”Ÿçš„å§“ååŠå„ç§‘æˆç»©ã€‚è¦æ±‚ç”¨ç»“æ„ä½“æ•°ç»„å®ç°ã€‚\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct Student &#123;\n    string name;\n    int scores[3];\n    double average;\n&#125;;\n\nvoid calculateAverage(Student&amp; student) &#123;\n    student.average &#x3D; (student.scores[0] + student.scores[1] + student.scores[2]) &#x2F; 3.0;\n&#125;\n\nint main() &#123;\n    Student students[5];\n    double maxAverage &#x3D; 0;\n    int maxIndex &#x3D; 0;\n\n    &#x2F;&#x2F; è¾“å…¥5ä¸ªå­¦ç”Ÿçš„å§“åå’Œæˆç»©\n    for (int i &#x3D; 0; i &lt; 5; ++i) &#123;\n        cout &lt;&lt; &quot;è¯·è¾“å…¥å­¦ç”Ÿ &quot; &lt;&lt; i + 1 &lt;&lt; &quot; çš„å§“å: &quot;;\n        cin &gt;&gt; students[i].name;\n        cout &lt;&lt; &quot;è¯·è¾“å…¥å­¦ç”Ÿ &quot; &lt;&lt; i + 1 &lt;&lt; &quot; çš„ä¸‰ç§‘æˆç»©: &quot;;\n        cin &gt;&gt; students[i].scores[0] &gt;&gt; students[i].scores[1] &gt;&gt; students[i].scores[2];\n        calculateAverage(students[i]);\n        if (students[i].average &gt; maxAverage) &#123;\n            maxAverage &#x3D; students[i].average;\n            maxIndex &#x3D; i;\n        &#125;\n    &#125;\n\n    &#x2F;&#x2F; è¾“å‡ºå¹³å‡æˆç»©æœ€é«˜çš„å­¦ç”Ÿ\n    cout &lt;&lt; &quot;å¹³å‡æˆç»©æœ€é«˜çš„å­¦ç”Ÿæ˜¯: &quot; &lt;&lt; students[maxIndex].name &lt;&lt; endl;\n    cout &lt;&lt; &quot;å„ç§‘æˆç»©: &quot; &lt;&lt; students[maxIndex].scores[0] &lt;&lt; &quot; &quot; &lt;&lt; students[maxIndex].scores[1] &lt;&lt; &quot; &quot; &lt;&lt; students[maxIndex].scores[2] &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n\n\n(4)ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå®ç°æ–¹ç¨‹å¼çš„ç›¸åŠ ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥ä»¥ä¸‹ä¸¤ä¸ªæ–¹ç¨‹å¼:\n12a+4b-5c&#x3D;7\n2a-8b+3c-6ç›¸åŠ ä¹‹åæœ‰:14a-4b-2c&#x3D;13è¦æ±‚ç”¨å­—ç¬¦æ•°ç»„å®ç°ã€‚\n#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n\nvoid addEquations(char* eq1, char* eq2, char* result) &#123;\n    int a1, b1, c1, d1;\n    int a2, b2, c2, d2;\n    sscanf(eq1, &quot;%da+%db+%dc&#x3D;%d&quot;, &amp;a1, &amp;b1, &amp;c1, &amp;d1);\n    sscanf(eq2, &quot;%da+%db+%dc&#x3D;%d&quot;, &amp;a2, &amp;b2, &amp;c2, &amp;d2);\n    \n    int a &#x3D; a1 + a2;\n    int b &#x3D; b1 + b2;\n    int c &#x3D; c1 + c2;\n    int d &#x3D; d1 + d2;\n    \n    sprintf(result, &quot;%da+%db+%dc&#x3D;%d&quot;, a, b, c, d);\n&#125;\n\nint main() &#123;\n    char eq1[] &#x3D; &quot;12a+4b-5c&#x3D;7&quot;;\n    char eq2[] &#x3D; &quot;2a-8b+3c-6&quot;;\n    char result[100];\n    \n    addEquations(eq1, eq2, result);\n    \n    cout &lt;&lt; &quot;ç›¸åŠ ä¹‹åæœ‰: &quot; &lt;&lt; result &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n\n\n(5)ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œåˆ©ç”¨æŒ‡é’ˆå°†ä¸€ä¸ªå­—ç¬¦ä¸²åå‘è¾“å‡ºã€‚ç¼–å†™ç›¸åº”çš„ä¸»å‡½æ•°å¯¹å…¶è¿›è¡Œè°ƒç”¨,åœ¨ä¸»å‡½æ•°ä¸­å®ŒæˆåŸå§‹æ•°æ®çš„è¾“å…¥å’Œç»“æœè¾“å‡ºã€‚\n#include &lt;iostream&gt;\n\nvoid reverseString(char* str) &#123;\n    int length &#x3D; 0;\n    while (str[length] !&#x3D; &#39;\\0&#39;) &#123;\n        length++;\n    &#125;\n    \n    for (int i &#x3D; length - 1; i &gt;&#x3D; 0; --i) &#123;\n        cout &lt;&lt; str[i];\n    &#125;\n    cout &lt;&lt; endl;\n&#125;\n\nint main() &#123;\n    char str[100];\n    cout &lt;&lt; &quot;è¯·è¾“å…¥å­—ç¬¦ä¸²: &quot;;\n    cin &gt;&gt; str;\n    reverseString(str);\n    return 0;\n&#125;\n\n\n\n\n(6)ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œç»Ÿè®¡å¹¶è¿”å›ä¸€è¡Œæ–‡å­—ä¸­æ‰€æœ‰çš„å­—æ¯ã€æ•°å­—ã€ç©ºæ ¼åŠå…¶ä»–å­—ç¬¦çš„ä¸ªæ•°,åŒæ—¶ç¼–å†™ç›¸åº”çš„ä¸»å‡½æ•°,åœ¨ä¸»å‡½æ•°ä¸­èƒ½æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ä¸€è¡Œæ–‡æœ¬,ç„¶åè°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°,å¹¶åœ¨ä¸»å‡½æ•°ä¸­è¾“å‡ºå„ç§å­—ç¬¦çš„ä¸ªæ•°ã€‚\n#include &lt;iostream&gt;\n\nvoid countCharacters(const char* text, int&amp; letters, int&amp; digits, int&amp; spaces, int&amp; others) &#123;\n    letters &#x3D; digits &#x3D; spaces &#x3D; others &#x3D; 0;\n    while (*text) &#123;\n        if (isalpha(*text)) &#123;\n            letters++;\n        &#125; else if (isdigit(*text)) &#123;\n            digits++;\n        &#125; else if (isspace(*text)) &#123;\n            spaces++;\n        &#125; else &#123;\n            others++;\n        &#125;\n        text++;\n    &#125;\n&#125;\n\nint main() &#123;\n    char text[100];\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ä¸€è¡Œæ–‡æœ¬: &quot;;\n    cin.getline(text, 100);\n\n    int letters, digits, spaces, others;\n    countCharacters(text, letters, digits, spaces, others);\n    \n    cout &lt;&lt; &quot;å­—æ¯: &quot; &lt;&lt; letters &lt;&lt; endl;\n    cout &lt;&lt; &quot;æ•°å­—: &quot; &lt;&lt; digits &lt;&lt; endl;\n    cout &lt;&lt; &quot;ç©ºæ ¼: &quot; &lt;&lt; spaces &lt;&lt; endl;\n    cout &lt;&lt; &quot;å…¶ä»–å­—ç¬¦: &quot; &lt;&lt; others &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n\n\n3. é¢å‘å¯¹è±¡ç¼–ç¨‹(1)å®šä¹‰ä¸€ä¸ªåœ†ç±» Circle,åœ¨å…¶ä¸­åŒ…å«1ä¸ªæ•°æ®æˆå‘˜è¡¨ç¤ºåŠå¾„,3ä¸ªæˆå‘˜å‡½æ•°åˆ†åˆ«å®ç°åŠå¾„çš„è¾“é¢ç§¯çš„è®¡ç®—å’ŒåŠå¾„ã€é¢ç§¯çš„è¾“å‡ºï¼Œå¹¶ç¼–å†™ç›¸åº”çš„ main å‡½æ•°æµ‹è¯•è¯¥ç±»ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nclass Circle &#123;\nprivate:\n    double radius;\n\npublic:\n    &#x2F;&#x2F; æ„é€ å‡½æ•°\n    Circle(double r) : radius(r) &#123;&#125;\n\n    &#x2F;&#x2F; è®¡ç®—é¢ç§¯\n    double calculateArea() &#123;\n        return 3.14159 * radius * radius;\n    &#125;\n\n    &#x2F;&#x2F; è¾“å‡ºåŠå¾„å’Œé¢ç§¯\n    void printInfo() &#123;\n        cout &lt;&lt; &quot;åŠå¾„: &quot; &lt;&lt; radius &lt;&lt; endl;\n        cout &lt;&lt; &quot;é¢ç§¯: &quot; &lt;&lt; calculateArea() &lt;&lt; endl;\n    &#125;\n&#125;;\n\nint main() &#123;\n    double r;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥åœ†çš„åŠå¾„: &quot;;\n    cin &gt;&gt; r;\n\n    Circle c(r);\n    c.printInfo();\n\n    return 0;\n&#125;\n\n\n\n\n(2)ä»¥ä¸‹æ˜¯ä¸€ä¸ªå­¦ç”Ÿç±»(Student)çš„ç±»å®šä¹‰éƒ¨åˆ†ã€‚è¯·å®Œæˆç›¸åº”çš„ç±»çš„å®ç°éƒ¨åˆ†ï¼Œå¹¶ç¼–å†™ç›¸åº”çš„main å‡½æ•°æµ‹è¯•ç›¸åº”çš„åŠŸèƒ½ã€‚\n#include &lt;iostream.h&gt;\nclass Student\n&#123; \n\n private:\nâ€‹\tint number;\nâ€‹\tchar name[20];\nâ€‹\tDate birth;\npublic:\nâ€‹\tStudent;\nâ€‹\tStudent(int n,char *m,Date d):\nâ€‹\tStudent(const Student &amp;s);\nâ€‹\t~Student();\nâ€‹\tvoid setnumber(int n);\nâ€‹\tvoid setname(char *s):\nâ€‹\tvoid setbirth(Date d);\nâ€‹\tvoid printstudent();\n    \n\n#include &lt;iostream&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nstruct Date &#123;\n    int day, month, year;\n&#125;;\n\nclass Student &#123;\nprivate:\n    int number;\n    char name[20];\n    Date birth;\n\npublic:\n    &#x2F;&#x2F; æ„é€ å‡½æ•°\n    Student(int n, char* m, Date d) &#123;\n        number &#x3D; n;\n        strcpy(name, m);\n        birth &#x3D; d;\n    &#125;\n\n    &#x2F;&#x2F; æ‹·è´æ„é€ å‡½æ•°\n    Student(const Student&amp; s) &#123;\n        number &#x3D; s.number;\n        strcpy(name, s.name);\n        birth &#x3D; s.birth;\n    &#125;\n\n    &#x2F;&#x2F; ææ„å‡½æ•°\n    ~Student() &#123;&#125;\n\n    &#x2F;&#x2F; è®¾ç½®å­¦å·\n    void setNumber(int n) &#123;\n        number &#x3D; n;\n    &#125;\n\n    &#x2F;&#x2F; è®¾ç½®å§“å\n    void setName(char* s) &#123;\n        strcpy(name, s);\n    &#125;\n\n    &#x2F;&#x2F; è®¾ç½®å‡ºç”Ÿæ—¥æœŸ\n    void setBirth(Date d) &#123;\n        birth &#x3D; d;\n    &#125;\n\n    &#x2F;&#x2F; è¾“å‡ºå­¦ç”Ÿä¿¡æ¯\n    void printStudent() &#123;\n        cout &lt;&lt; &quot;å­¦å·: &quot; &lt;&lt; number &lt;&lt; endl;\n        cout &lt;&lt; &quot;å§“å: &quot; &lt;&lt; name &lt;&lt; endl;\n        cout &lt;&lt; &quot;å‡ºç”Ÿæ—¥æœŸ: &quot; &lt;&lt; birth.day &lt;&lt; &quot;&#x2F;&quot; &lt;&lt; birth.month &lt;&lt; &quot;&#x2F;&quot; &lt;&lt; birth.year &lt;&lt; endl;\n    &#125;\n&#125;;\n\nint main() &#123;\n    Date birthDate &#x3D; &#123;15, 8, 2000&#125;;\n    Student s(12345, &quot;å¼ ä¸‰&quot;, birthDate);\n    s.printStudent();\n\n    return 0;\n&#125;\n\n\n\n\n(3)è®¾è®¡ä¸€ä¸ªç‚¹ç±»Point,å…¶ä¸­åŒ…å«ç‚¹çš„åæ ‡xå’Œyä¸¤ä¸ªæ•°æ®æˆå‘˜,å¹¶è®¾è®¡ä¸¤ä¸ªå‹å…ƒå‡½æ•°åˆ†åˆ«è®¡ç®—ä¸¤ç‚¹é—´çš„æ°´å¹³è·ç¦»å’Œå‚ç›´è·ç¦»ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nclass Point &#123;\nprivate:\n    double x, y;\n\npublic:\n    &#x2F;&#x2F; æ„é€ å‡½æ•°\n    Point(double xCoord, double yCoord) : x(xCoord), y(yCoord) &#123;&#125;\n\n    &#x2F;&#x2F; å‹å…ƒå‡½æ•°å£°æ˜\n    friend double horizontalDistance(const Point&amp; p1, const Point&amp; p2);\n    friend double verticalDistance(const Point&amp; p1, const Point&amp; p2);\n&#125;;\n\n&#x2F;&#x2F; è®¡ç®—æ°´å¹³è·ç¦»\ndouble horizontalDistance(const Point&amp; p1, const Point&amp; p2) &#123;\n    return abs(p1.x - p2.x);\n&#125;\n\n&#x2F;&#x2F; è®¡ç®—å‚ç›´è·ç¦»\ndouble verticalDistance(const Point&amp; p1, const Point&amp; p2) &#123;\n    return abs(p1.y - p2.y);\n&#125;\n\nint main() &#123;\n    Point p1(3, 4), p2(7, 10);\n\n    cout &lt;&lt; &quot;æ°´å¹³è·ç¦»: &quot; &lt;&lt; horizontalDistance(p1, p2) &lt;&lt; endl;\n    cout &lt;&lt; &quot;å‚ç›´è·ç¦»: &quot; &lt;&lt; verticalDistance(p1, p2) &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n4.ç»§æ‰¿å’Œæ´¾ç”Ÿ(1)åˆ†åˆ«å®šä¹‰ä¸€ä¸ªæ—¥æœŸç±»å’Œæ—¶é—´ç±»ï¼Œç„¶åæ´¾ç”Ÿå‡ºä¸€ä¸ªæ–°çš„æ—¥æœŸæ—¶é—´ç±»ã€‚è¯·ä»¥ç»§æ‰¿æ–¹å¼å®ç°è¯¥ç±»ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\n&#x2F;&#x2F; æ—¥æœŸç±»\nclass Date &#123;\nprivate:\n    int day, month, year;\n\npublic:\n    Date(int d, int m, int y) : day(d), month(m), year(y) &#123;&#125;\n\n    void printDate() &#123;\n        cout &lt;&lt; &quot;æ—¥æœŸ: &quot; &lt;&lt; day &lt;&lt; &quot;&#x2F;&quot; &lt;&lt; month &lt;&lt; &quot;&#x2F;&quot; &lt;&lt; year &lt;&lt; endl;\n    &#125;\n&#125;;\n\n&#x2F;&#x2F; æ—¶é—´ç±»\nclass Time &#123;\nprivate:\n    int hour, minute, second;\n\npublic:\n    Time(int h, int m, int s) : hour(h), minute(m), second(s) &#123;&#125;\n\n    void printTime() &#123;\n        cout &lt;&lt; &quot;æ—¶é—´: &quot; &lt;&lt; hour &lt;&lt; &quot;:&quot; &lt;&lt; minute &lt;&lt; &quot;:&quot; &lt;&lt; second &lt;&lt; endl;\n    &#125;\n&#125;;\n\n&#x2F;&#x2F; æ—¥æœŸæ—¶é—´ç±»ï¼Œé€šè¿‡ç»§æ‰¿ Date å’Œ Time\nclass DateTime : public Date, public Time &#123;\npublic:\n    DateTime(int d, int m, int y, int h, int min, int s)\n        : Date(d, m, y), Time(h, min, s) &#123;&#125;\n\n    void printDateTime() &#123;\n        printDate();\n        printTime();\n    &#125;\n&#125;;\n\nint main() &#123;\n    DateTime dt(12, 9, 2023, 14, 30, 45);\n    dt.printDateTime();\n\n    return 0;\n&#125;\n\n\n\n\n(2)åœ¨ä¾‹7-16 çš„åŸºç¡€ä¸Šï¼Œç”± Student ç±»å’Œ Teacher ç±»æ´¾ç”Ÿå‡ºä¸€ä¸ªæè¿°åœ¨èŒè¯»ä¹¦çš„æ•™å¸ˆçš„ç±»ï¼Œå¹¶ç¼–å†™å‡ºç›¸åº”çš„æµ‹è¯•ä»£ç ã€‚\n#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n&#x2F;&#x2F; å­¦ç”Ÿç±»\nclass Student &#123;\nprotected:\n    string name;\n    int age;\n\npublic:\n    Student(string n, int a) : name(n), age(a) &#123;&#125;\n\n    virtual void printInfo() &#123;\n        cout &lt;&lt; &quot;å§“å: &quot; &lt;&lt; name &lt;&lt; endl;\n        cout &lt;&lt; &quot;å¹´é¾„: &quot; &lt;&lt; age &lt;&lt; endl;\n    &#125;\n&#125;;\n\n&#x2F;&#x2F; æ•™å¸ˆç±»\nclass Teacher : public Student &#123;\nprotected:\n    string subject;\n\npublic:\n    Teacher(string n, int a, string sub) : Student(n, a), subject(sub) &#123;&#125;\n\n    void printInfo() override &#123;\n        Student::printInfo();\n        cout &lt;&lt; &quot;ç§‘ç›®: &quot; &lt;&lt; subject &lt;&lt; endl;\n    &#125;\n&#125;;\n\n&#x2F;&#x2F; åœ¨èŒè¯»ä¹¦æ•™å¸ˆç±»\nclass InServiceStudentTeacher : public Teacher &#123;\nprivate:\n    string studyProgram;\n\npublic:\n    InServiceStudentTeacher(string n, int a, string sub, string study) \n        : Teacher(n, a, sub), studyProgram(study) &#123;&#125;\n\n    void printInfo() override &#123;\n        Teacher::printInfo();\n        cout &lt;&lt; &quot;å­¦ä¹ é¡¹ç›®: &quot; &lt;&lt; studyProgram &lt;&lt; endl;\n    &#125;\n&#125;;\n\nint main() &#123;\n    InServiceStudentTeacher teacher(&quot;æè€å¸ˆ&quot;, 35, &quot;æ•°å­¦&quot;, &quot;ç¡•å£«ç ”ç©¶ç”Ÿ&quot;);\n    teacher.printInfo();\n    return 0;\n&#125;\n\n\n\n\n(3)è®¾è®¡ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¹¶ç”±å®ƒæ´¾ç”Ÿå‡ºåœ†æŸ±ä½“ã€çƒä½“å’Œæ­£æ–¹ä½“3ä¸ªç±»ï¼Œå®ç°è®¡ç®—åœ†æŸ±ä½“,çƒä½“å’Œæ­£æ–¹ä½“è¡¨é¢ç§¯å’Œä½“ç§¯;è¦æ±‚æŒ‰ç…§è¿è¡Œæ—¶å¤šæ€æ€§çš„æ–¹æ³•è®¾è®¡ä¸»å‡½æ•°ï¼Œè¿›è¡Œæµ‹è¯•ã€‚\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n\n&#x2F;&#x2F; æŠ½è±¡ç±»ï¼šå½¢çŠ¶\nclass Shape &#123;\npublic:\n    virtual double area() &#x3D; 0;  &#x2F;&#x2F; è®¡ç®—è¡¨é¢ç§¯\n    virtual double volume() &#x3D; 0; &#x2F;&#x2F; è®¡ç®—ä½“ç§¯\n    virtual ~Shape() &#123;&#125;\n&#125;;\n\n&#x2F;&#x2F; åœ†æŸ±ä½“ç±»\nclass Cylinder : public Shape &#123;\nprivate:\n    double radius, height;\n\npublic:\n    Cylinder(double r, double h) : radius(r), height(h) &#123;&#125;\n\n    double area() override &#123;\n        return 2 * M_PI * radius * (radius + height);  &#x2F;&#x2F; åœ†æŸ±è¡¨é¢ç§¯\n    &#125;\n\n    double volume() override &#123;\n        return M_PI * radius * radius * height;  &#x2F;&#x2F; åœ†æŸ±ä½“ç§¯\n    &#125;\n&#125;;\n\n&#x2F;&#x2F; çƒä½“ç±»\nclass Sphere : public Shape &#123;\nprivate:\n    double radius;\n\npublic:\n    Sphere(double r) : radius(r) &#123;&#125;\n\n    double area() override &#123;\n        return 4 * M_PI * radius * radius;  &#x2F;&#x2F; çƒä½“è¡¨é¢ç§¯\n    &#125;\n\n    double volume() override &#123;\n        return (4.0 &#x2F; 3) * M_PI * radius * radius * radius;  &#x2F;&#x2F; çƒä½“ç§¯\n    &#125;\n&#125;;\n\n&#x2F;&#x2F; æ­£æ–¹ä½“ç±»\nclass Cube : public Shape &#123;\nprivate:\n    double side;\n\npublic:\n    Cube(double s) : side(s) &#123;&#125;\n\n    double area() override &#123;\n        return 6 * side * side;  &#x2F;&#x2F; æ­£æ–¹ä½“è¡¨é¢ç§¯\n    &#125;\n\n    double volume() override &#123;\n        return side * side * side;  &#x2F;&#x2F; æ­£æ–¹ä½“ç§¯\n    &#125;\n&#125;;\n\nint main() &#123;\n    Shape* shape;\n\n    &#x2F;&#x2F; æµ‹è¯•åœ†æŸ±ä½“\n    shape &#x3D; new Cylinder(5, 10);\n    cout &lt;&lt; &quot;åœ†æŸ±ä½“è¡¨é¢ç§¯: &quot; &lt;&lt; shape-&gt;area() &lt;&lt; endl;\n    cout &lt;&lt; &quot;åœ†æŸ±ä½“ä½“ç§¯: &quot; &lt;&lt; shape-&gt;volume() &lt;&lt; endl;\n\n    &#x2F;&#x2F; æµ‹è¯•çƒä½“\n    shape &#x3D; new Sphere(5);\n    cout &lt;&lt; &quot;çƒä½“è¡¨é¢ç§¯: &quot; &lt;&lt; shape-&gt;area() &lt;&lt; endl;\n    cout &lt;&lt; &quot;çƒä½“ä½“ç§¯: &quot; &lt;&lt; shape-&gt;volume() &lt;&lt; endl;\n\n    &#x2F;&#x2F; æµ‹è¯•æ­£æ–¹ä½“\n    shape &#x3D; new Cube(4);\n    cout &lt;&lt; &quot;æ­£æ–¹ä½“è¡¨é¢ç§¯: &quot; &lt;&lt; shape-&gt;area() &lt;&lt; endl;\n    cout &lt;&lt; &quot;æ­£æ–¹ä½“ä½“ç§¯: &quot; &lt;&lt; shape-&gt;volume() &lt;&lt; endl;\n\n    delete shape;\n    return 0;\n&#125;\n\n\n\n\n5.è¿ç®—ç¬¦é‡è½½(1)åœ¨ä¾‹ 8-1çš„åŸºç¡€ä¸Šï¼Œè®¾è®¡ä¸€ä¸ªè¡¨ç¤ºå¤æ•°çš„ç±» Complexï¼Œå¹¶åœ¨è¯¥ç±»ä¸­å¯¹è¿ç®—ç¬¦â€œ+â€ã€â€œ-â€ã€â€œ*â€ã€â€œ&#x2F;â€å’Œâ€œ&#x3D;â€è¿›è¡Œé‡è½½ï¼Œä»¥å®ç°ä¸¤ä¸ªå¤æ•°çš„åŠ ã€å‡ã€ä¹˜ã€é™¤ä»¥åŠèµ‹å€¼è¿ç®—ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nclass Complex &#123;\nprivate:\n    double real, imag; &#x2F;&#x2F; å®éƒ¨å’Œè™šéƒ¨\n\npublic:\n    &#x2F;&#x2F; æ„é€ å‡½æ•°\n    Complex(double r &#x3D; 0, double i &#x3D; 0) : real(r), imag(i) &#123;&#125;\n\n    &#x2F;&#x2F; è¿ç®—ç¬¦é‡è½½ï¼šåŠ æ³•\n    Complex operator+(const Complex&amp; c) &#123;\n        return Complex(real + c.real, imag + c.imag);\n    &#125;\n\n    &#x2F;&#x2F; è¿ç®—ç¬¦é‡è½½ï¼šå‡æ³•\n    Complex operator-(const Complex&amp; c) &#123;\n        return Complex(real - c.real, imag - c.imag);\n    &#125;\n\n    &#x2F;&#x2F; è¿ç®—ç¬¦é‡è½½ï¼šä¹˜æ³•\n    Complex operator*(const Complex&amp; c) &#123;\n        return Complex(real * c.real - imag * c.imag, real * c.imag + imag * c.real);\n    &#125;\n\n    &#x2F;&#x2F; è¿ç®—ç¬¦é‡è½½ï¼šé™¤æ³•\n    Complex operator&#x2F;(const Complex&amp; c) &#123;\n        double denom &#x3D; c.real * c.real + c.imag * c.imag;\n        return Complex((real * c.real + imag * c.imag) &#x2F; denom, (imag * c.real - real * c.imag) &#x2F; denom);\n    &#125;\n\n    &#x2F;&#x2F; è¿ç®—ç¬¦é‡è½½ï¼šèµ‹å€¼\n    Complex&amp; operator&#x3D;(const Complex&amp; c) &#123;\n        if (this !&#x3D; &amp;c) &#123; &#x2F;&#x2F; é˜²æ­¢è‡ªèµ‹å€¼\n            real &#x3D; c.real;\n            imag &#x3D; c.imag;\n        &#125;\n        return *this;\n    &#125;\n\n    &#x2F;&#x2F; è¾“å‡ºå¤æ•°\n    void print() const &#123;\n        cout &lt;&lt; real &lt;&lt; &quot; + &quot; &lt;&lt; imag &lt;&lt; &quot;i&quot; &lt;&lt; endl;\n    &#125;\n&#125;;\n\nint main() &#123;\n    Complex c1(4, 5), c2(2, 3), result;\n\n    cout &lt;&lt; &quot;c1: &quot;;\n    c1.print();\n    cout &lt;&lt; &quot;c2: &quot;;\n    c2.print();\n\n    result &#x3D; c1 + c2;\n    cout &lt;&lt; &quot;c1 + c2: &quot;;\n    result.print();\n\n    result &#x3D; c1 - c2;\n    cout &lt;&lt; &quot;c1 - c2: &quot;;\n    result.print();\n\n    result &#x3D; c1 * c2;\n    cout &lt;&lt; &quot;c1 * c2: &quot;;\n    result.print();\n\n    result &#x3D; c1 &#x2F; c2;\n    cout &lt;&lt; &quot;c1 &#x2F; c2: &quot;;\n    result.print();\n\n    Complex c3;\n    c3 &#x3D; c1; &#x2F;&#x2F; æµ‹è¯•èµ‹å€¼è¿ç®—ç¬¦\n    cout &lt;&lt; &quot;c3 &#x3D; c1: &quot;;\n    c3.print();\n\n    return 0;\n&#125;\n\n\n\n\n(2)è®¾è®¡ä¸€ä¸ªç±»æ¥å®ç°é‡è½½è‡ªåŠ è¿ç®—ç¬¦çš„ä¸¤ç§å½¢å¼ï¼Œå³å‰ç¼€è¿ç®—ç¬¦++a å’Œåç¼€è¿ç®—ç¬¦ a++ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nclass Counter &#123;\nprivate:\n    int value;\n\npublic:\n    &#x2F;&#x2F; æ„é€ å‡½æ•°\n    Counter(int v &#x3D; 0) : value(v) &#123;&#125;\n\n    &#x2F;&#x2F; å‰ç¼€è‡ªåŠ è¿ç®—ç¬¦é‡è½½\n    Counter&amp; operator++() &#123;\n        ++value;\n        return *this;\n    &#125;\n\n    &#x2F;&#x2F; åç¼€è‡ªåŠ è¿ç®—ç¬¦é‡è½½\n    Counter operator++(int) &#123;\n        Counter temp &#x3D; *this;\n        ++value;\n        return temp;\n    &#125;\n\n    &#x2F;&#x2F; è¾“å‡ºå½“å‰å€¼\n    void print() const &#123;\n        cout &lt;&lt; &quot;å½“å‰å€¼: &quot; &lt;&lt; value &lt;&lt; endl;\n    &#125;\n&#125;;\n\nint main() &#123;\n    Counter c1(5), c2(10);\n\n    &#x2F;&#x2F; å‰ç¼€è‡ªåŠ \n    cout &lt;&lt; &quot;c1: &quot;;\n    c1.print();\n    ++c1;  &#x2F;&#x2F; å‰ç¼€è‡ªåŠ \n    cout &lt;&lt; &quot;c1 after ++: &quot;;\n    c1.print();\n\n    &#x2F;&#x2F; åç¼€è‡ªåŠ \n    cout &lt;&lt; &quot;c2: &quot;;\n    c2.print();\n    c2++;  &#x2F;&#x2F; åç¼€è‡ªåŠ \n    cout &lt;&lt; &quot;c2 after c2++: &quot;;\n    c2.print();\n\n    return 0;\n&#125;\n\n\n\n\n6. æ¨¡æ¿(1)åœ¨ä¾‹9-4çš„åŸºç¡€ä¸Šï¼Œç»§ç»­å®ç°å•å‘é“¾è¡¨ç±»æ¨¡æ¿ä¸­èƒ½å¤Ÿå®ç°èŠ‚ç‚¹çš„æ’å…¥ã€åˆ é™¤ã€æ’åºç­‰çš„æˆå‘˜å‡½æ•°ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\n&#x2F;&#x2F; å•å‘é“¾è¡¨èŠ‚ç‚¹ç±»\ntemplate &lt;typename T&gt;\nclass Node &#123;\npublic:\n    T data;         &#x2F;&#x2F; æ•°æ®éƒ¨åˆ†\n    Node* next;     &#x2F;&#x2F; æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ\n\n    Node(T val) : data(val), next(nullptr) &#123;&#125;\n&#125;;\n\n&#x2F;&#x2F; å•å‘é“¾è¡¨ç±»æ¨¡æ¿\ntemplate &lt;typename T&gt;\nclass LinkedList &#123;\nprivate:\n    Node&lt;T&gt;* head;\n\npublic:\n    &#x2F;&#x2F; æ„é€ å‡½æ•°\n    LinkedList() : head(nullptr) &#123;&#125;\n\n    &#x2F;&#x2F; ææ„å‡½æ•°\n    ~LinkedList() &#123;\n        Node&lt;T&gt;* current &#x3D; head;\n        while (current !&#x3D; nullptr) &#123;\n            Node&lt;T&gt;* nextNode &#x3D; current-&gt;next;\n            delete current;\n            current &#x3D; nextNode;\n        &#125;\n    &#125;\n\n    &#x2F;&#x2F; æ’å…¥èŠ‚ç‚¹\n    void insert(T val) &#123;\n        Node&lt;T&gt;* newNode &#x3D; new Node&lt;T&gt;(val);\n        newNode-&gt;next &#x3D; head;\n        head &#x3D; newNode;\n    &#125;\n\n    &#x2F;&#x2F; åˆ é™¤æŒ‡å®šèŠ‚ç‚¹\n    void remove(T val) &#123;\n        Node&lt;T&gt;* current &#x3D; head;\n        Node&lt;T&gt;* prev &#x3D; nullptr;\n\n        &#x2F;&#x2F; æ‰¾åˆ°èŠ‚ç‚¹\n        while (current !&#x3D; nullptr &amp;&amp; current-&gt;data !&#x3D; val) &#123;\n            prev &#x3D; current;\n            current &#x3D; current-&gt;next;\n        &#125;\n\n        if (current &#x3D;&#x3D; nullptr) &#123;\n            cout &lt;&lt; &quot;å…ƒç´  &quot; &lt;&lt; val &lt;&lt; &quot; ä¸å­˜åœ¨!&quot; &lt;&lt; endl;\n            return;\n        &#125;\n\n        &#x2F;&#x2F; åˆ é™¤èŠ‚ç‚¹\n        if (prev &#x3D;&#x3D; nullptr) &#123;\n            head &#x3D; current-&gt;next;  &#x2F;&#x2F; åˆ é™¤å¤´èŠ‚ç‚¹\n        &#125; else &#123;\n            prev-&gt;next &#x3D; current-&gt;next;\n        &#125;\n        delete current;\n    &#125;\n\n    &#x2F;&#x2F; æ‰“å°é“¾è¡¨\n    void print() &#123;\n        Node&lt;T&gt;* current &#x3D; head;\n        while (current !&#x3D; nullptr) &#123;\n            cout &lt;&lt; current-&gt;data &lt;&lt; &quot; &quot;;\n            current &#x3D; current-&gt;next;\n        &#125;\n        cout &lt;&lt; endl;\n    &#125;\n\n    &#x2F;&#x2F; æ’åºé“¾è¡¨ï¼ˆä½¿ç”¨å†’æ³¡æ’åºï¼‰\n    void sort() &#123;\n        if (head &#x3D;&#x3D; nullptr) return;\n        bool swapped;\n        do &#123;\n            swapped &#x3D; false;\n            Node&lt;T&gt;* current &#x3D; head;\n            while (current !&#x3D; nullptr &amp;&amp; current-&gt;next !&#x3D; nullptr) &#123;\n                if (current-&gt;data &gt; current-&gt;next-&gt;data) &#123;\n                    swap(current-&gt;data, current-&gt;next-&gt;data);\n                    swapped &#x3D; true;\n                &#125;\n                current &#x3D; current-&gt;next;\n            &#125;\n        &#125; while (swapped);\n    &#125;\n&#125;;\n\nint main() &#123;\n    LinkedList&lt;int&gt; list;\n    \n    list.insert(3);\n    list.insert(1);\n    list.insert(4);\n    list.insert(5);\n    list.insert(2);\n    \n    cout &lt;&lt; &quot;åŸå§‹é“¾è¡¨: &quot;;\n    list.print();\n    \n    list.remove(4);  &#x2F;&#x2F; åˆ é™¤å…ƒç´  4\n    cout &lt;&lt; &quot;åˆ é™¤å…ƒç´  4 å: &quot;;\n    list.print();\n    \n    list.sort();  &#x2F;&#x2F; æ’åºé“¾è¡¨\n    cout &lt;&lt; &quot;æ’åºåçš„é“¾è¡¨: &quot;;\n    list.print();\n\n    return 0;\n&#125;\n\n\n(2)è®¾è®¡ä¸€ä¸ªå‡½æ•°æ¨¡æ¿ï¼Œå®ç°åœ¨ä¸€ä¸ªç»™å®šçš„æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾ç»™å®šçš„å…ƒç´ å€¼æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è¾“å‡ºè¯¥å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡å€¼ï¼Œå¦‚æœæœªæ‰¾åˆ°ï¼Œåˆ™è¾“å‡º-1ï¼Œå¹¶ç¼–å†™ç›¸åº”çš„ç¨‹åºæµ‹è¯•è¯¥å‡½æ•°æ¨¡æ¿ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\n&#x2F;&#x2F; å‡½æ•°æ¨¡æ¿ï¼šåœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ \ntemplate &lt;typename T&gt;\nint binarySearch(T arr[], int size, T value) &#123;\n    int left &#x3D; 0, right &#x3D; size - 1;\n    while (left &lt;&#x3D; right) &#123;\n        int mid &#x3D; left + (right - left) &#x2F; 2;\n        \n        if (arr[mid] &#x3D;&#x3D; value) &#123;\n            return mid;  &#x2F;&#x2F; æ‰¾åˆ°å…ƒç´ ï¼Œè¿”å›ä¸‹æ ‡\n        &#125; else if (arr[mid] &lt; value) &#123;\n            left &#x3D; mid + 1;\n        &#125; else &#123;\n            right &#x3D; mid - 1;\n        &#125;\n    &#125;\n    return -1;  &#x2F;&#x2F; æœªæ‰¾åˆ°å…ƒç´ ï¼Œè¿”å› -1\n&#125;\n\nint main() &#123;\n    int arr[] &#x3D; &#123;1, 2, 3, 4, 5, 6, 7, 8, 9, 10&#125;;\n    int size &#x3D; sizeof(arr) &#x2F; sizeof(arr[0]);\n    int value;\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥è¦æŸ¥æ‰¾çš„å…ƒç´ : &quot;;\n    cin &gt;&gt; value;\n\n    int index &#x3D; binarySearch(arr, size, value);\n    \n    if (index !&#x3D; -1) &#123;\n        cout &lt;&lt; &quot;å…ƒç´  &quot; &lt;&lt; value &lt;&lt; &quot; åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡æ˜¯: &quot; &lt;&lt; index &lt;&lt; endl;\n    &#125; else &#123;\n        cout &lt;&lt; &quot;å…ƒç´  &quot; &lt;&lt; value &lt;&lt; &quot; ä¸å­˜åœ¨äºæ•°ç»„ä¸­!&quot; &lt;&lt; endl;\n    &#125;\n\n    return 0;\n&#125;\n\n\n7.æ–‡ä»¶(1)ç¼–å†™ç¨‹åºï¼Œæ‰“å¼€æŒ‡å®šçš„ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶èƒ½åœ¨å…¶ä¸­æ¯ä¸€è¡Œçš„å‰é¢åŠ ä¸Šè¡Œå·å’Œä¸€ä¸ªç©ºæ ¼ç¬¦ã€‚\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nvoid addLineNumbers(const string&amp; inputFile, const string&amp; outputFile) &#123;\n    ifstream inFile(inputFile);\n    ofstream outFile(outputFile);\n    \n    if (!inFile) &#123;\n        cout &lt;&lt; &quot;æ— æ³•æ‰“å¼€è¾“å…¥æ–‡ä»¶!&quot; &lt;&lt; endl;\n        return;\n    &#125;\n\n    if (!outFile) &#123;\n        cout &lt;&lt; &quot;æ— æ³•æ‰“å¼€è¾“å‡ºæ–‡ä»¶!&quot; &lt;&lt; endl;\n        return;\n    &#125;\n\n    string line;\n    int lineNumber &#x3D; 1;\n    while (getline(inFile, line)) &#123;\n        outFile &lt;&lt; lineNumber &lt;&lt; &quot; &quot; &lt;&lt; line &lt;&lt; endl;\n        lineNumber++;\n    &#125;\n\n    inFile.close();\n    outFile.close();\n&#125;\n\nint main() &#123;\n    string inputFile, outputFile;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥è¾“å…¥æ–‡ä»¶å: &quot;;\n    cin &gt;&gt; inputFile;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥è¾“å‡ºæ–‡ä»¶å: &quot;;\n    cin &gt;&gt; outputFile;\n\n    addLineNumbers(inputFile, outputFile);\n\n    cout &lt;&lt; &quot;æ–‡ä»¶å¤„ç†å®Œæˆ!&quot; &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n(2)ç¼–å†™ç¨‹åºï¼Œç»Ÿè®¡ä¸€ç¯‡è‹±æ–‡æ–‡ç« ä¸­è‹±æ–‡å•è¯çš„ä¸ªæ•°ä»¥åŠæ–‡ç« çš„æ€»è¡Œæ•°ã€‚\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;cctype&gt;\nusing namespace std;\n\nbool isWordCharacter(char c) &#123;\n    return isalpha(c) || c &#x3D;&#x3D; &#39;\\&#39;&#39;;\n&#125;\n\nint countWords(const string&amp; line) &#123;\n    int wordCount &#x3D; 0;\n    bool inWord &#x3D; false;\n    for (char c : line) &#123;\n        if (isWordCharacter(c)) &#123;\n            if (!inWord) &#123;\n                inWord &#x3D; true;\n                wordCount++;\n            &#125;\n        &#125; else &#123;\n            inWord &#x3D; false;\n        &#125;\n    &#125;\n    return wordCount;\n&#125;\n\nvoid countWordsAndLines(const string&amp; filename) &#123;\n    ifstream inFile(filename);\n    \n    if (!inFile) &#123;\n        cout &lt;&lt; &quot;æ— æ³•æ‰“å¼€æ–‡ä»¶!&quot; &lt;&lt; endl;\n        return;\n    &#125;\n\n    string line;\n    int totalLines &#x3D; 0;\n    int totalWords &#x3D; 0;\n    \n    while (getline(inFile, line)) &#123;\n        totalLines++;\n        totalWords +&#x3D; countWords(line);\n    &#125;\n\n    inFile.close();\n\n    cout &lt;&lt; &quot;æ–‡ç« çš„æ€»è¡Œæ•°: &quot; &lt;&lt; totalLines &lt;&lt; endl;\n    cout &lt;&lt; &quot;æ–‡ç« ä¸­çš„å•è¯æ€»æ•°: &quot; &lt;&lt; totalWords &lt;&lt; endl;\n&#125;\n\nint main() &#123;\n    string filename;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥æ–‡ç« æ–‡ä»¶å: &quot;;\n    cin &gt;&gt; filename;\n\n    countWordsAndLines(filename);\n\n    return 0;\n&#125;\n\n\n(3)ç¼–å†™ç¨‹åºï¼Œå®Œæˆä¸¤ä¸ªæ–‡ä»¶çš„è¿æ¥æ“ä½œã€‚\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nvoid concatenateFiles(const string&amp; file1, const string&amp; file2, const string&amp; outputFile) &#123;\n    ifstream inFile1(file1);\n    ifstream inFile2(file2);\n    ofstream outFile(outputFile);\n    \n    if (!inFile1 || !inFile2) &#123;\n        cout &lt;&lt; &quot;æ— æ³•æ‰“å¼€è¾“å…¥æ–‡ä»¶!&quot; &lt;&lt; endl;\n        return;\n    &#125;\n\n    if (!outFile) &#123;\n        cout &lt;&lt; &quot;æ— æ³•æ‰“å¼€è¾“å‡ºæ–‡ä»¶!&quot; &lt;&lt; endl;\n        return;\n    &#125;\n\n    string line;\n    \n    &#x2F;&#x2F; å…ˆå†™å…¥ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹\n    while (getline(inFile1, line)) &#123;\n        outFile &lt;&lt; line &lt;&lt; endl;\n    &#125;\n\n    &#x2F;&#x2F; ç„¶åå†™å…¥ç¬¬äºŒä¸ªæ–‡ä»¶çš„å†…å®¹\n    while (getline(inFile2, line)) &#123;\n        outFile &lt;&lt; line &lt;&lt; endl;\n    &#125;\n\n    inFile1.close();\n    inFile2.close();\n    outFile.close();\n&#125;\n\nint main() &#123;\n    string file1, file2, outputFile;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ–‡ä»¶å: &quot;;\n    cin &gt;&gt; file1;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ç¬¬äºŒä¸ªæ–‡ä»¶å: &quot;;\n    cin &gt;&gt; file2;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥è¾“å‡ºæ–‡ä»¶å: &quot;;\n    cin &gt;&gt; outputFile;\n\n    concatenateFiles(file1, file2, outputFile);\n\n    cout &lt;&lt; &quot;æ–‡ä»¶è¿æ¥å®Œæˆ!&quot; &lt;&lt; endl;\n    return 0;\n&#125;\n\n\n8.STLåº“(1)ç¼–å†™ç¨‹åºï¼Œåˆ©ç”¨ string ç±»æä¾›çš„æˆå‘˜å‡½æ•°æ¥å®Œæˆå­—ç¬¦ä¸²çš„æŸ¥æ‰¾ä¸æ›¿æ¢ã€‚\n#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nvoid findAndReplace(string&amp; str, const string&amp; oldSubstr, const string&amp; newSubstr) &#123;\n    size_t pos &#x3D; 0;\n    while ((pos &#x3D; str.find(oldSubstr, pos)) !&#x3D; string::npos) &#123;\n        str.replace(pos, oldSubstr.length(), newSubstr);\n        pos +&#x3D; newSubstr.length(); &#x2F;&#x2F; ç§»åŠ¨åˆ°æ›¿æ¢åçš„ä½ç½®\n    &#125;\n&#125;\n\nint main() &#123;\n    string str;\n    string oldSubstr, newSubstr;\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥åŸå§‹å­—ç¬¦ä¸²: &quot;;\n    getline(cin, str);\n    cout &lt;&lt; &quot;è¯·è¾“å…¥è¦æŸ¥æ‰¾çš„å­å­—ç¬¦ä¸²: &quot;;\n    getline(cin, oldSubstr);\n    cout &lt;&lt; &quot;è¯·è¾“å…¥æ›¿æ¢çš„å­å­—ç¬¦ä¸²: &quot;;\n    getline(cin, newSubstr);\n\n    findAndReplace(str, oldSubstr, newSubstr);\n    \n    cout &lt;&lt; &quot;æ›¿æ¢åçš„å­—ç¬¦ä¸²: &quot; &lt;&lt; str &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(2)ç¼–å†™ç¨‹åºï¼Œåˆ©ç”¨ string ç±»å®Œæˆä¸€ä¸ªå­—ç¬¦ä¸²çš„é€†åºè¾“å‡ºã€‚\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nvoid reverseString(string&amp; str) &#123;\n    reverse(str.begin(), str.end());  &#x2F;&#x2F; ä½¿ç”¨ STL æä¾›çš„ reverse å‡½æ•°\n&#125;\n\nint main() &#123;\n    string str;\n    \n    cout &lt;&lt; &quot;è¯·è¾“å…¥å­—ç¬¦ä¸²: &quot;;\n    getline(cin, str);\n\n    reverseString(str);\n    \n    cout &lt;&lt; &quot;é€†åºåçš„å­—ç¬¦ä¸²: &quot; &lt;&lt; str &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(3)ç¼–å†™ç¨‹åºï¼Œåˆ©ç”¨vector å®¹å™¨è¾“å…¥è‹¥å¹²ä¸ª string ç±»æ•°æ®å…ƒç´ ï¼Œå°†å…¶æ’åºåè¾“å‡ºã€‚\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nint main() &#123;\n    vector&lt;string&gt; strVec;\n    string str;\n    int n;\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥å­—ç¬¦ä¸²çš„æ•°é‡: &quot;;\n    cin &gt;&gt; n;\n    cin.ignore();  &#x2F;&#x2F; å¿½ç•¥å‰é¢çš„æ¢è¡Œç¬¦\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ &quot; &lt;&lt; n &lt;&lt; &quot; ä¸ªå­—ç¬¦ä¸²: &quot; &lt;&lt; endl;\n    for (int i &#x3D; 0; i &lt; n; ++i) &#123;\n        getline(cin, str);\n        strVec.push_back(str);\n    &#125;\n\n    sort(strVec.begin(), strVec.end());  &#x2F;&#x2F; å¯¹ vector ä¸­çš„å­—ç¬¦ä¸²è¿›è¡Œæ’åº\n\n    cout &lt;&lt; &quot;æ’åºåçš„å­—ç¬¦ä¸²: &quot; &lt;&lt; endl;\n    for (const string&amp; s : strVec) &#123;\n        cout &lt;&lt; s &lt;&lt; endl;\n    &#125;\n\n    return 0;\n&#125;\n\n\n\n\n(4)ç¼–å†™ç¨‹åºï¼Œåˆ©ç”¨è¾“å…¥ã€è¾“å‡ºè¿­ä»£å™¨ï¼Œå°†ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹æ·»åŠ åˆ°å¦ä¸€ä¸ªæ–‡ä»¶çš„å°¾éƒ¨ã€‚\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;iterator&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nvoid appendFileContents(const string&amp; inputFile, const string&amp; outputFile) &#123;\n    ifstream inFile(inputFile);\n    ofstream outFile(outputFile, ios::app);  &#x2F;&#x2F; ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€è¾“å‡ºæ–‡ä»¶\n    \n    if (!inFile) &#123;\n        cout &lt;&lt; &quot;æ— æ³•æ‰“å¼€è¾“å…¥æ–‡ä»¶!&quot; &lt;&lt; endl;\n        return;\n    &#125;\n\n    if (!outFile) &#123;\n        cout &lt;&lt; &quot;æ— æ³•æ‰“å¼€è¾“å‡ºæ–‡ä»¶!&quot; &lt;&lt; endl;\n        return;\n    &#125;\n\n    &#x2F;&#x2F; ä½¿ç”¨è¾“å…¥è¿­ä»£å™¨è¯»å–è¾“å…¥æ–‡ä»¶å†…å®¹å¹¶ä½¿ç”¨è¾“å‡ºè¿­ä»£å™¨å†™å…¥è¾“å‡ºæ–‡ä»¶\n    copy(istream_iterator&lt;string&gt;(inFile), istream_iterator&lt;string&gt;(), ostream_iterator&lt;string&gt;(outFile, &quot;\\n&quot;));\n\n    inFile.close();\n    outFile.close();\n&#125;\n\nint main() &#123;\n    string inputFile, outputFile;\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥è¾“å…¥æ–‡ä»¶å: &quot;;\n    cin &gt;&gt; inputFile;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥è¾“å‡ºæ–‡ä»¶å: &quot;;\n    cin &gt;&gt; outputFile;\n\n    appendFileContents(inputFile, outputFile);\n\n    cout &lt;&lt; &quot;æ–‡ä»¶å†…å®¹å·²æˆåŠŸè¿½åŠ !&quot; &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n\n\n9.å¼‚å¸¸(1)ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œé‡‡ç”¨å¼‚å¸¸å¤„ç†çš„æ–¹æ³•ï¼Œå¯¹æ•°ç»„çš„æ ‡é”™è¯¯è¿›è¡Œæ˜¾ç¤º\n#include &lt;iostream&gt;\n#include &lt;stdexcept&gt;  &#x2F;&#x2F; å¼•å…¥ std::out_of_range\nusing namespace std;\n\nvoid accessArrayElement(int* arr, int size, int index) &#123;\n    if (index &lt; 0 || index &gt;&#x3D; size) &#123;\n        throw out_of_range(&quot;æ•°ç»„ä¸‹æ ‡è¶Šç•Œé”™è¯¯ï¼&quot;);\n    &#125;\n    cout &lt;&lt; &quot;æ•°ç»„å…ƒç´ : &quot; &lt;&lt; arr[index] &lt;&lt; endl;\n&#125;\n\nint main() &#123;\n    int arr[] &#x3D; &#123;1, 2, 3, 4, 5&#125;;\n    int size &#x3D; sizeof(arr) &#x2F; sizeof(arr[0]);\n\n    int index;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥æ•°ç»„ä¸‹æ ‡: &quot;;\n    cin &gt;&gt; index;\n\n    try &#123;\n        accessArrayElement(arr, size, index);\n    &#125; catch (const out_of_range&amp; e) &#123;\n        cout &lt;&lt; &quot;é”™è¯¯: &quot; &lt;&lt; e.what() &lt;&lt; endl;\n    &#125;\n\n    return 0;\n&#125;\n\n\n\n\n(2)ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œé‡‡ç”¨å¼‚å¸¸å¤„ç†çš„æ–¹æ³•ï¼Œåœ¨æŒ‡å®šæ–‡ä»¶ä¸å­˜åœ¨æ—¶æ˜¾ç¤ºå‡ºé”™ä¿¡æ¯ï¼Œæ–‡ä»¶å­˜åœ¨æ—¶æ˜¾ç¤ºæ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ã€‚\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;stdexcept&gt;  &#x2F;&#x2F; å¼•å…¥ std::ifstream å’Œ std::runtime_error\n#include &lt;string&gt;\nusing namespace std;\n\nvoid checkFileExistence(const string&amp; filename) &#123;\n    ifstream file(filename);\n    if (!file) &#123;\n        throw runtime_error(&quot;æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•æ‰“å¼€ï¼&quot;);\n    &#125;\n\n    string line;\n    cout &lt;&lt; &quot;æ–‡ä»¶å­˜åœ¨ï¼æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&quot; &lt;&lt; endl;\n\n    &#x2F;&#x2F; æ˜¾ç¤ºæ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼ˆè¿™é‡Œåªæ˜¯æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼‰\n    while (getline(file, line)) &#123;\n        cout &lt;&lt; line &lt;&lt; endl;\n    &#125;\n    file.close();\n&#125;\n\nint main() &#123;\n    string filename;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥æ–‡ä»¶å: &quot;;\n    cin &gt;&gt; filename;\n\n    try &#123;\n        checkFileExistence(filename);\n    &#125; catch (const runtime_error&amp; e) &#123;\n        cout &lt;&lt; &quot;é”™è¯¯: &quot; &lt;&lt; e.what() &lt;&lt; endl;\n    &#125;\n\n    return 0;\n&#125;\n\n\n\n\n10.åŸºç¡€åˆ†æ”¯(1)ç¼–å†™ç¨‹åºï¼Œæç¤ºç”¨æˆ·è¾“å…¥ä¸‰è§’å½¢çš„ä¸‰æ¡è¾¹é•¿ï¼Œåˆ¤æ–­è¯¥ä¸‰è§’å½¢æ˜¯å¦ä¸ºç›´è§’ä¸‰è§’å½¢ï¼Œè‹¥æ˜¯åˆ™è¾“å‡ºç»“æœä»¥åŠä¸‰è§’å½¢é¢ç§¯ã€‚\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n\nbool isRightTriangle(double a, double b, double c) &#123;\n    &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦ä¸ºç›´è§’ä¸‰è§’å½¢\n    return (a * a + b * b &#x3D;&#x3D; c * c) || (a * a + c * c &#x3D;&#x3D; b * b) || (b * b + c * c &#x3D;&#x3D; a * a);\n&#125;\n\ndouble areaOfTriangle(double a, double b, double c) &#123;\n    &#x2F;&#x2F; ä½¿ç”¨æµ·ä¼¦å…¬å¼è®¡ç®—ä¸‰è§’å½¢é¢ç§¯\n    double s &#x3D; (a + b + c) &#x2F; 2;  &#x2F;&#x2F; åŠå‘¨é•¿\n    return sqrt(s * (s - a) * (s - b) * (s - c));  &#x2F;&#x2F; é¢ç§¯\n&#125;\n\nint main() &#123;\n    double a, b, c;\n    \n    cout &lt;&lt; &quot;è¯·è¾“å…¥ä¸‰è§’å½¢çš„ä¸‰æ¡è¾¹é•¿: &quot;;\n    cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n\n    &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦ä¸ºç›´è§’ä¸‰è§’å½¢\n    if (isRightTriangle(a, b, c)) &#123;\n        cout &lt;&lt; &quot;è¯¥ä¸‰è§’å½¢æ˜¯ç›´è§’ä¸‰è§’å½¢!&quot; &lt;&lt; endl;\n        double area &#x3D; areaOfTriangle(a, b, c);\n        cout &lt;&lt; &quot;ç›´è§’ä¸‰è§’å½¢çš„é¢ç§¯ä¸º: &quot; &lt;&lt; area &lt;&lt; endl;\n    &#125; else &#123;\n        cout &lt;&lt; &quot;è¯¥ä¸‰è§’å½¢ä¸æ˜¯ç›´è§’ä¸‰è§’å½¢!&quot; &lt;&lt; endl;\n    &#125;\n\n    return 0;\n&#125;\n\n\n\n\n(2)ç¼–å†™ç¨‹åºï¼Œæ±‚è§£å„ç§æ•°æ®ç±»å‹çš„å­˜å‚¨é•¿åº¦å¹¶æ˜¾ç¤ºå‡ºæ¥ï¼Œåœ¨å…¶ä¸­æ‰¾å‡ºå­˜å‚¨é•¿åº¦æœ€å¤§å’Œæœ€å°çš„ä¸¤ç§æ•°æ®ç±»å‹å¹¶è¾“å‡ºã€‚\n#include &lt;iostream&gt;\n#include &lt;climits&gt;  &#x2F;&#x2F; æä¾›æ•°æ®ç±»å‹çš„é™åˆ¶\nusing namespace std;\n\nint main() &#123;\n    cout &lt;&lt; &quot;æ•°æ®ç±»å‹çš„å­˜å‚¨é•¿åº¦ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰ï¼š&quot; &lt;&lt; endl;\n    \n    cout &lt;&lt; &quot;char: &quot; &lt;&lt; sizeof(char) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;short: &quot; &lt;&lt; sizeof(short) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;int: &quot; &lt;&lt; sizeof(int) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;long: &quot; &lt;&lt; sizeof(long) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;long long: &quot; &lt;&lt; sizeof(long long) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;float: &quot; &lt;&lt; sizeof(float) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;double: &quot; &lt;&lt; sizeof(double) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;long double: &quot; &lt;&lt; sizeof(long double) &lt;&lt; &quot; byte(s)&quot; &lt;&lt; endl;\n\n    &#x2F;&#x2F; æ‰¾å‡ºæœ€å¤§å’Œæœ€å°çš„å­˜å‚¨é•¿åº¦\n    size_t maxSize &#x3D; 0, minSize &#x3D; SIZE_MAX;\n    string maxType, minType;\n\n    &#x2F;&#x2F; æ¯”è¾ƒä¸åŒæ•°æ®ç±»å‹çš„å¤§å°\n    if (sizeof(char) &lt; minSize) &#123; minSize &#x3D; sizeof(char); minType &#x3D; &quot;char&quot;; &#125;\n    if (sizeof(short) &lt; minSize) &#123; minSize &#x3D; sizeof(short); minType &#x3D; &quot;short&quot;; &#125;\n    if (sizeof(int) &lt; minSize) &#123; minSize &#x3D; sizeof(int); minType &#x3D; &quot;int&quot;; &#125;\n    if (sizeof(long) &lt; minSize) &#123; minSize &#x3D; sizeof(long); minType &#x3D; &quot;long&quot;; &#125;\n    if (sizeof(long long) &lt; minSize) &#123; minSize &#x3D; sizeof(long long); minType &#x3D; &quot;long long&quot;; &#125;\n    if (sizeof(float) &lt; minSize) &#123; minSize &#x3D; sizeof(float); minType &#x3D; &quot;float&quot;; &#125;\n    if (sizeof(double) &lt; minSize) &#123; minSize &#x3D; sizeof(double); minType &#x3D; &quot;double&quot;; &#125;\n    if (sizeof(long double) &lt; minSize) &#123; minSize &#x3D; sizeof(long double); minType &#x3D; &quot;long double&quot;; &#125;\n\n    if (sizeof(char) &gt; maxSize) &#123; maxSize &#x3D; sizeof(char); maxType &#x3D; &quot;char&quot;; &#125;\n    if (sizeof(short) &gt; maxSize) &#123; maxSize &#x3D; sizeof(short); maxType &#x3D; &quot;short&quot;; &#125;\n    if (sizeof(int) &gt; maxSize) &#123; maxSize &#x3D; sizeof(int); maxType &#x3D; &quot;int&quot;; &#125;\n    if (sizeof(long) &gt; maxSize) &#123; maxSize &#x3D; sizeof(long); maxType &#x3D; &quot;long&quot;; &#125;\n    if (sizeof(long long) &gt; maxSize) &#123; maxSize &#x3D; sizeof(long long); maxType &#x3D; &quot;long long&quot;; &#125;\n    if (sizeof(float) &gt; maxSize) &#123; maxSize &#x3D; sizeof(float); maxType &#x3D; &quot;float&quot;; &#125;\n    if (sizeof(double) &gt; maxSize) &#123; maxSize &#x3D; sizeof(double); maxType &#x3D; &quot;double&quot;; &#125;\n    if (sizeof(long double) &gt; maxSize) &#123; maxSize &#x3D; sizeof(long double); maxType &#x3D; &quot;long double&quot;; &#125;\n\n    cout &lt;&lt; &quot;\\nå­˜å‚¨é•¿åº¦æœ€å°çš„æ•°æ®ç±»å‹: &quot; &lt;&lt; minType &lt;&lt; &quot; (&quot; &lt;&lt; minSize &lt;&lt; &quot; byte(s))&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;å­˜å‚¨é•¿åº¦æœ€å¤§çš„ æ•°æ®ç±»å‹: &quot; &lt;&lt; maxType &lt;&lt; &quot; (&quot; &lt;&lt; maxSize &lt;&lt; &quot; byte(s))&quot; &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(3)ç¼–å†™ç¨‹åºè¾“å…¥ä¸€ä¸ªåæ°æ¸©åº¦ï¼Œå°†å…¶è½¬æ¢ä¸ºæ‘„æ°æ¸©åº¦å¹¶è¾“å‡ºã€‚å·²çŸ¥åæ°æ¸©åº¦è½¬æ¢ä¸ºæ‘„æ°æ¸©åº¦çš„è®¡ç®—å…¬å¼å¦‚ä¸‹:C&#x3D;(F-32)*5&#x2F;9å…¶ä¸­ï¼ŒF ä¸ºåæ°æ¸©åº¦ï¼ŒCä¸ºæ‘„æ°æ¸©åº¦ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main() &#123;\n    double fahrenheit, celsius;\n    \n    cout &lt;&lt; &quot;è¯·è¾“å…¥åæ°æ¸©åº¦: &quot;;\n    cin &gt;&gt; fahrenheit;\n\n    &#x2F;&#x2F; åæ°æ¸©åº¦è½¬æ‘„æ°æ¸©åº¦\n    celsius &#x3D; (fahrenheit - 32) * 5 &#x2F; 9;\n\n    cout &lt;&lt; &quot;å¯¹åº”çš„æ‘„æ°æ¸©åº¦ä¸º: &quot; &lt;&lt; celsius &lt;&lt; &quot;Â°C&quot; &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(4)ç¼–å†™ç¨‹åºè¾“å…¥ä¸€ä¸ªåè¿›åˆ¶è¡¨ç¤ºçš„æ­£æ•´æ•°ï¼Œå°†å…¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºå¹¶è¾“å‡ºç»“æœã€‚\n#include &lt;iostream&gt;\n#include &lt;stack&gt;\nusing namespace std;\n\nvoid decimalToBinary(int n) &#123;\n    stack&lt;int&gt; binaryStack;\n    \n    while (n &gt; 0) &#123;\n        binaryStack.push(n % 2);\n        n &#x3D; n &#x2F; 2;\n    &#125;\n\n    cout &lt;&lt; &quot;äºŒè¿›åˆ¶è¡¨ç¤º: &quot;;\n    while (!binaryStack.empty()) &#123;\n        cout &lt;&lt; binaryStack.top();\n        binaryStack.pop();\n    &#125;\n    cout &lt;&lt; endl;\n&#125;\n\nint main() &#123;\n    int num;\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ä¸€ä¸ªåè¿›åˆ¶æ­£æ•´æ•°: &quot;;\n    cin &gt;&gt; num;\n\n    if (num &lt;&#x3D; 0) &#123;\n        cout &lt;&lt; &quot;è¯·è¾“å…¥ä¸€ä¸ªæ­£æ•´æ•°!&quot; &lt;&lt; endl;\n    &#125; else &#123;\n        decimalToBinary(num);\n    &#125;\n\n    return 0;\n&#125;\n\n\n\n\n11.åŸºç¡€å¾ªç¯(1)ç¼–å†™ç¨‹åºï¼Œè®¡ç®—1~100æ‰€æœ‰3çš„å€æ•°çš„æ•°çš„å’Œã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main() &#123;\n    int sum &#x3D; 0;\n\n    for (int i &#x3D; 1; i &lt;&#x3D; 100; i++) &#123;\n        if (i % 3 &#x3D;&#x3D; 0) &#123;\n            sum +&#x3D; i;\n        &#125;\n    &#125;\n\n    cout &lt;&lt; &quot;1~100 æ‰€æœ‰ 3 çš„å€æ•°çš„å’Œæ˜¯: &quot; &lt;&lt; sum &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(2)ç¼–å†™ç¨‹åºï¼Œç”¨æˆ·è¾“å…¥ä¸€äº›æ•´æ•°ï¼Œè¯¥ç¨‹åºåˆ†åˆ«è®¡ç®—å‡ºæ‰€æœ‰å¥‡æ•°å’Œæ‰€æœ‰å¶æ•°ä¹‹å’Œï¼Œå¹¶è¾“å‡ºå®ƒä»¬ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main() &#123;\n    int num;\n    int oddSum &#x3D; 0, evenSum &#x3D; 0;\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥æ•´æ•°ï¼Œè¾“å…¥ 0 ç»“æŸ: &quot;;\n    while (true) &#123;\n        cin &gt;&gt; num;\n        if (num &#x3D;&#x3D; 0) break;\n        \n        if (num % 2 &#x3D;&#x3D; 0) &#123;\n            evenSum +&#x3D; num;\n        &#125; else &#123;\n            oddSum +&#x3D; num;\n        &#125;\n    &#125;\n\n    cout &lt;&lt; &quot;å¥‡æ•°å’Œ: &quot; &lt;&lt; oddSum &lt;&lt; endl;\n    cout &lt;&lt; &quot;å¶æ•°å’Œ: &quot; &lt;&lt; evenSum &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(3)ç¼–å†™ç¨‹åºï¼Œæ±‚è§£è¾“å…¥ä¸¤ä¸ªæ­£æ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°å’Œæœ€å°å…¬å€æ•°ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nint gcd(int a, int b) &#123;\n    while (b !&#x3D; 0) &#123;\n        int temp &#x3D; b;\n        b &#x3D; a % b;\n        a &#x3D; temp;\n    &#125;\n    return a;\n&#125;\n\nint lcm(int a, int b) &#123;\n    return (a * b) &#x2F; gcd(a, b);\n&#125;\n\nint main() &#123;\n    int a, b;\n    \n    cout &lt;&lt; &quot;è¯·è¾“å…¥ä¸¤ä¸ªæ­£æ•´æ•°: &quot;;\n    cin &gt;&gt; a &gt;&gt; b;\n\n    cout &lt;&lt; &quot;æœ€å¤§å…¬çº¦æ•°: &quot; &lt;&lt; gcd(a, b) &lt;&lt; endl;\n    cout &lt;&lt; &quot;æœ€å°å…¬å€æ•°: &quot; &lt;&lt; lcm(a, b) &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(4)ç¼–å†™ç¨‹åºè®¡ç®—10ä¸ªæ­£æ•´æ•°çš„å¹³å‡å€¼ã€æ–¹å·®ä»¥åŠæ ‡å‡†æ–¹å·®ã€‚\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n\nint main() &#123;\n    int numbers[10];\n    int sum &#x3D; 0;\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ 10 ä¸ªæ­£æ•´æ•°: &quot;;\n    for (int i &#x3D; 0; i &lt; 10; i++) &#123;\n        cin &gt;&gt; numbers[i];\n        sum +&#x3D; numbers[i];\n    &#125;\n\n    double mean &#x3D; sum &#x2F; 10.0;\n\n    double variance &#x3D; 0;\n    for (int i &#x3D; 0; i &lt; 10; i++) &#123;\n        variance +&#x3D; pow(numbers[i] - mean, 2);\n    &#125;\n    variance &#x2F;&#x3D; 10;\n\n    double stdDeviation &#x3D; sqrt(variance);\n\n    cout &lt;&lt; &quot;å¹³å‡å€¼: &quot; &lt;&lt; mean &lt;&lt; endl;\n    cout &lt;&lt; &quot;æ–¹å·®: &quot; &lt;&lt; variance &lt;&lt; endl;\n    cout &lt;&lt; &quot;æ ‡å‡†æ–¹å·®: &quot; &lt;&lt; stdDeviation &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(5)è¾“å…¥4ä¸ªå­—æ¯ï¼Œå¹¶åå‘æ˜¾ç¤ºè¿™äº›å­—æ¯ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main() &#123;\n    char letters[4];\n\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ 4 ä¸ªå­—æ¯: &quot;;\n    for (int i &#x3D; 0; i &lt; 4; i++) &#123;\n        cin &gt;&gt; letters[i];\n    &#125;\n\n    cout &lt;&lt; &quot;åå‘æ˜¾ç¤ºå­—æ¯: &quot;;\n    for (int i &#x3D; 3; i &gt;&#x3D; 0; i--) &#123;\n        cout &lt;&lt; letters[i];\n    &#125;\n    cout &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(6)è¾“å‡ºæ‰€æœ‰çš„â€œæ°´ä»™èŠ±æ•°â€ã€‚â€œæ°´ä»™èŠ±æ•°â€æ˜¯æŒ‡ä¸€ä¸ª3ä½æ•°ï¼Œå…¶å„ä½æ•°å­—çš„ç«‹æ–¹å’Œç­‰äºè¯¥æ•°æœ¬èº«ã€‚ä¾‹å¦‚ï¼Œ153 ä¸ºä¸€ä¸ªæ°´ä»™èŠ±æ•°ï¼Œå› ä¸º153&#x3D;1+5+3ã€‚\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n\nint main() &#123;\n    cout &lt;&lt; &quot;æ‰€æœ‰æ°´ä»™èŠ±æ•°: &quot;;\n    for (int i &#x3D; 100; i &lt; 1000; i++) &#123;\n        int hundreds &#x3D; i &#x2F; 100;\n        int tens &#x3D; (i &#x2F; 10) % 10;\n        int ones &#x3D; i % 10;\n\n        if (pow(hundreds, 3) + pow(tens, 3) + pow(ones, 3) &#x3D;&#x3D; i) &#123;\n            cout &lt;&lt; i &lt;&lt; &quot; &quot;;\n        &#125;\n    &#125;\n    cout &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n(7)æ±‚âˆ‘n!(å³ 1!+2!+â€¦+50!)ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nlong long factorial(int n) &#123;\n    long long result &#x3D; 1;\n    for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;\n        result *&#x3D; i;\n    &#125;\n    return result;\n&#125;\n\nint main() &#123;\n    long long sum &#x3D; 0;\n    for (int i &#x3D; 1; i &lt;&#x3D; 50; i++) &#123;\n        sum +&#x3D; factorial(i);\n    &#125;\n\n    cout &lt;&lt; &quot;1! + 2! + ... + 50! çš„å’Œä¸º: &quot; &lt;&lt; sum &lt;&lt; endl;\n\n    return 0;\n&#125;\n\n\n\n\n\n\n(8)ç¼–å†™ç¨‹åºæ±‚ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ axâ€™+bx+c&#x3D;0 çš„è§£ã€‚è¯¥æ–¹ç¨‹çš„è§£åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µ:â‘  b-4ac&#x3D;0ï¼Œæœ‰ä¸¤ä¸ªç›¸ç­‰çš„å®æ ¹;\nâ‘¡ bâ€™-4ac&gt;0ï¼Œæœ‰ä¸¤ä¸ªä¸ç­‰çš„å®æ ¹;â‘¢ bâ€™-4ac&lt;0ï¼Œæ— å®æ ¹:â‘£ a&#x3D;0ï¼Œä¸æ˜¯äºŒæ¬¡æ–¹ç¨‹ã€‚\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\nusing namespace std;\n\nint main() &#123;\n    double a, b, c;\n    cout &lt;&lt; &quot;è¯·è¾“å…¥ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹çš„ç³»æ•° a, b, c: &quot;;\n    cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n\n    if (a &#x3D;&#x3D; 0) &#123;\n        cout &lt;&lt; &quot;è¿™ä¸æ˜¯ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹!&quot; &lt;&lt; endl;\n        return 0;\n    &#125;\n\n    double discriminant &#x3D; b * b - 4 * a * c;  &#x2F;&#x2F; åˆ¤åˆ«å¼\n\n    if (discriminant &gt; 0) &#123;\n        double root1 &#x3D; (-b + sqrt(discriminant)) &#x2F; (2 * a);\n        double root2 &#x3D; (-b - sqrt(discriminant)) &#x2F; (2 * a);\n        cout &lt;&lt; &quot;æ–¹ç¨‹æœ‰ä¸¤ä¸ªä¸ç­‰çš„å®æ ¹: &quot; &lt;&lt; root1 &lt;&lt; &quot; å’Œ &quot; &lt;&lt; root2 &lt;&lt; endl;\n    &#125; else if (discriminant &#x3D;&#x3D; 0) &#123;\n        double root &#x3D; -b &#x2F; (2 * a);\n        cout &lt;&lt; &quot;æ–¹ç¨‹æœ‰ä¸¤ä¸ªç›¸ç­‰çš„å®æ ¹: &quot; &lt;&lt; root &lt;&lt; endl;\n    &#125; else &#123;\n        cout &lt;&lt; &quot;æ–¹ç¨‹æ²¡æœ‰å®æ ¹!&quot; &lt;&lt; endl;\n    &#125;\n\n    return 0;\n&#125;\n\n\n\n\n(9)ç¼–å†™ç¨‹åºï¼Œç”¨å¾ªç¯è¯­å¥æ‰“å°å¦‚ä¸‹å›¾æ¡ˆã€‚\n\n(10)ç¼–å†™ç¨‹åºï¼Œè¾“å…¥å¹´æœˆæ—¥ä¿¡æ¯ï¼Œå¹¶è¾“å‡ºè¿™ä¸€å¤©ä¸ºè¿™ä¸€å¹´çš„ç¬¬å‡ å¤©ï¼Œæ³¨æ„é—°å¹´é—®é¢˜ã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\n&#x2F;&#x2F; å‡½æ•°å£°æ˜\nbool isLeapYear(int year);\nint dayOfYear(int year, int month, int day);\n\nint main() &#123;\n    int year, month, day;\n    \n    &#x2F;&#x2F; è¾“å…¥å¹´æœˆæ—¥\n    cout &lt;&lt; &quot;è¯·è¾“å…¥å¹´æœˆæ—¥ï¼ˆæ ¼å¼ï¼šå¹´ æœˆ æ—¥ï¼‰ï¼š&quot;;\n    cin &gt;&gt; year &gt;&gt; month &gt;&gt; day;\n    \n    &#x2F;&#x2F; è®¡ç®—å¹¶è¾“å‡ºç»“æœ\n    int result &#x3D; dayOfYear(year, month, day);\n    cout &lt;&lt; year &lt;&lt; &quot;å¹´&quot; &lt;&lt; month &lt;&lt; &quot;æœˆ&quot; &lt;&lt; day &lt;&lt; &quot;æ—¥æ˜¯è¿™ä¸€å¹´çš„ç¬¬&quot; &lt;&lt; result &lt;&lt; &quot;å¤©&quot; &lt;&lt; endl;\n    \n    return 0;\n&#125;\n\n&#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦ä¸ºé—°å¹´\nbool isLeapYear(int year) &#123;\n    return (year % 4 &#x3D;&#x3D; 0 &amp;&amp; year % 100 !&#x3D; 0) || (year % 400 &#x3D;&#x3D; 0);\n&#125;\n\n&#x2F;&#x2F; è®¡ç®—æŸä¸€å¤©æ˜¯è¯¥å¹´çš„ç¬¬å‡ å¤©\nint dayOfYear(int year, int month, int day) &#123;\n    &#x2F;&#x2F; æ¯æœˆå¤©æ•°æ•°ç»„ï¼Œç´¢å¼•0ä¸ç”¨\n    int daysInMonth[] &#x3D; &#123;0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31&#125;;\n    \n    &#x2F;&#x2F; å¦‚æœæ˜¯é—°å¹´ï¼ŒäºŒæœˆæœ‰29å¤©\n    if (isLeapYear(year)) &#123;\n        daysInMonth[2] &#x3D; 29;\n    &#125;\n    \n    int totalDays &#x3D; 0;\n    \n    &#x2F;&#x2F; ç´¯åŠ å‰å‡ ä¸ªæœˆçš„å¤©æ•°\n    for (int i &#x3D; 1; i &lt; month; i++) &#123;\n        totalDays +&#x3D; daysInMonth[i];\n    &#125;\n    \n    &#x2F;&#x2F; åŠ ä¸Šå½“å‰æœˆçš„å¤©æ•°\n    totalDays +&#x3D; day;\n    \n    return totalDays;\n&#125;\n\n\n\n(11)ç¼–å†™ç¨‹åºï¼Œç”±ç”¨æˆ·è¾“å…¥xå€¼ï¼Œè®¡ç®—å‡½æ•°å€¼å¹¶è¾“å‡ºã€‚å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚\n\n(12)é¸¡å…”åŒç¬¼é—®é¢˜ã€‚è‹¥é¸¡å…å…±æœ‰100åªè„šï¼Œåˆ©ç”¨å¾ªç¯è®¡ç®—é¸¡å…”å„å‡ åªã€‚\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main() &#123;\n    int totalFeet &#x3D; 100;\n    \n    cout &lt;&lt; &quot;é¸¡å…”åŒç¬¼é—®é¢˜ï¼ˆæ€»è„šæ•°100ï¼‰ï¼š&quot; &lt;&lt; endl;\n    cout &lt;&lt; &quot;å¯èƒ½çš„è§£æœ‰ï¼š&quot; &lt;&lt; endl;\n    \n    &#x2F;&#x2F; å¾ªç¯éå†å¯èƒ½çš„é¸¡çš„æ•°é‡\n    for (int chicken &#x3D; 0; chicken &lt;&#x3D; 50; chicken++) &#123;\n        int rabbit &#x3D; (totalFeet - 2 * chicken) &#x2F; 4;\n        \n        &#x2F;&#x2F; æ£€æŸ¥æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼šæ€»è„šæ•°ä¸º100ï¼Œä¸”é¸¡å…”æ•°é‡å‡ä¸ºéè´Ÿæ•´æ•°\n        if (2 * chicken + 4 * rabbit &#x3D;&#x3D; totalFeet &amp;&amp; rabbit &gt;&#x3D; 0) &#123;\n            cout &lt;&lt; &quot;é¸¡ï¼š&quot; &lt;&lt; chicken &lt;&lt; &quot;åªï¼Œå…”ï¼š&quot; &lt;&lt; rabbit &lt;&lt; &quot;åª&quot; &lt;&lt; endl;\n        &#125;\n    &#125;\n    \n    return 0;\n&#125;\n\n","categories":["è‡ªå­¦ç¬”è®°"],"tags":["C++"]},{"title":"åšå®¢ä½¿ç”¨å›¾åºŠæ•™ç¨‹","url":"/2024/10/02/%E5%9B%BE%E5%BA%8A%E4%BD%BF%E7%94%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/","content":"è¿™ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨Giteeå’ŒGitHubå›¾åºŠæ¥æ‰˜ç®¡åšå®¢å›¾ç‰‡ï¼Œæå‡åšå®¢æ€§èƒ½å’Œç®¡ç†æ•ˆç‡ã€‚\n\n\n\nä»€ä¹ˆæ˜¯å›¾åºŠï¼Ÿå›¾åºŠæ˜¯ä¸“é—¨ç”¨äºå­˜å‚¨å›¾ç‰‡çš„åœ¨çº¿æœåŠ¡ï¼Œå®ƒèƒ½ä¸ºä½ çš„åšå®¢å¸¦æ¥ä»¥ä¸‹ä¼˜åŠ¿ï¼š\n\nâœ… å‡å°‘åšå®¢ä½“ç§¯ - å›¾ç‰‡ä¸å ç”¨åšå®¢å­˜å‚¨ç©ºé—´\nâœ… æå‡åŠ è½½é€Ÿåº¦ - ä¸“ä¸šCDNåŠ é€Ÿå›¾ç‰‡è®¿é—®\nâœ… è·¨å¹³å°ä½¿ç”¨ - ä¸€å¼ å›¾ç‰‡å¯åœ¨å¤šå¤„å¼•ç”¨\nâœ… ç¨³å®šå¯é  - ä¸“ä¸šæœåŠ¡å•†æä¾›æ•°æ®ä¿éšœ\n\nGiteeå›¾åºŠé…ç½®ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºGiteeä»“åº“\nè®¿é—® Giteeå®˜ç½‘ å¹¶ç™»å½•\nç‚¹å‡»å³ä¸Šè§’ + â†’ æ–°å»ºä»“åº“\nå¡«å†™ä»“åº“ä¿¡æ¯ï¼š\nä»“åº“åç§°ï¼šmy-images\nè®¾ç½®ä¸ºï¼šå…¬å¼€ ï¼ˆé‡è¦ï¼ï¼‰\nå‹¾é€‰ï¼šä½¿ç”¨Readmeæ–‡ä»¶åˆå§‹åŒ–\n\n\n\nç¬¬äºŒæ­¥ï¼šè·å–ç§äººä»¤ç‰Œ\nç‚¹å‡»å¤´åƒ â†’ è®¾ç½®\nå·¦ä¾§èœå•é€‰æ‹© ç§äººä»¤ç‰Œ\nç‚¹å‡» ç”Ÿæˆæ–°ä»¤ç‰Œ\nå‹¾é€‰ projects æƒé™\nå¤åˆ¶ç”Ÿæˆçš„ä»¤ç‰Œï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰\n\nPicGoé…ç½®å®‰è£…PicGoæ¨èä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…ï¼š\n# Windowsç”¨æˆ·\nwinget install PicGo.PicGo\n\n# macOSç”¨æˆ·  \nbrew install --cask picgo\n\n# æˆ–ä»GitHubä¸‹è½½ï¼šhttps://github.com/Molunerfinn/PicGo/releases\n\nå®‰è£…Giteeæ’ä»¶\næ‰“å¼€PicGo\nè¿›å…¥ æ’ä»¶è®¾ç½®\næœç´¢ gitee\nå®‰è£… gitee-uploader æ’ä»¶\n\né…ç½®Giteeå›¾åºŠè¿›å…¥ å›¾åºŠè®¾ç½® â†’ Giteeå›¾åºŠï¼Œå¡«å†™ï¼š\nrepo: ä½ çš„ç”¨æˆ·å&#x2F;ä»“åº“å (å¦‚: zhangsan&#x2F;my-images)\nbranch: master\ntoken: åˆšæ‰è·å–çš„ç§äººä»¤ç‰Œ\npath: img&#x2F; (å›¾ç‰‡å­˜å‚¨è·¯å¾„)\ncustomPath: ç•™ç©º\ncustomUrl: ç•™ç©º\n\nåœ¨æ–‡ç« ä¸­ä½¿ç”¨å›¾ç‰‡åŸºç¡€è¯­æ³•Markdownæ ¼å¼ï¼ˆæ¨èï¼‰![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)\n\nç¤ºä¾‹ï¼š\n![é¡¹ç›®æ¼”ç¤º](https://gitee.com/zhangsan/my-images/raw/master/img/demo.png)\n\nHTMLæ ¼å¼ï¼ˆæ›´çµæ´»ï¼‰&lt;img src=\"å›¾ç‰‡é“¾æ¥\" alt=\"å›¾ç‰‡æè¿°\" width=\"600\">\n\nç¤ºä¾‹ï¼š\n&lt;img src=\"https://gitee.com/zhangsan/my-images/raw/master/img/demo.png\" \n     alt=\"é¡¹ç›®æ¼”ç¤º\" \n     width=\"600\" \n     style=\"border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);\">\n\né«˜çº§ä½¿ç”¨æŠ€å·§1. å“åº”å¼å›¾ç‰‡&lt;div style=\"text-align: center;\">\n  &lt;img src=\"https://gitee.com/ä½ çš„ç”¨æˆ·å/my-images/raw/master/img/responsive-demo.png\" \n       alt=\"å“åº”å¼æ¼”ç¤º\" \n       style=\"max-width: 100%; height: auto; border-radius: 8px;\">\n&lt;/div>\n\n2. å›¾ç‰‡ç»„åˆå±•ç¤º&lt;div style=\"display: flex; justify-content: space-around; flex-wrap: wrap;\">\n  &lt;img src=\"https://gitee.com/ä½ çš„ç”¨æˆ·å/my-images/raw/master/img/before.png\" \n       alt=\"ä¼˜åŒ–å‰\" width=\"45%\" style=\"border-radius: 8px;\">\n  &lt;img src=\"https://gitee.com/ä½ çš„ç”¨æˆ·å/my-images/raw/master/img/after.png\" \n       alt=\"ä¼˜åŒ–å\" width=\"45%\" style=\"border-radius: 8px;\">\n&lt;/div>\n\n3. å¸¦è¯´æ˜çš„å›¾ç‰‡&lt;figure style=\"text-align: center; margin: 20px 0;\">\n  &lt;img src=\"https://gitee.com/ä½ çš„ç”¨æˆ·å/my-images/raw/master/img/architecture.png\" \n       alt=\"ç³»ç»Ÿæ¶æ„å›¾\" \n       style=\"max-width: 100%; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);\">\n  &lt;figcaption style=\"margin-top: 10px; color: #666; font-size: 14px;\">\n    å›¾1ï¼šç³»ç»Ÿæ•´ä½“æ¶æ„è®¾è®¡\n  &lt;/figcaption>\n&lt;/figure>\n\nä½¿ç”¨å·¥ä½œæµç¨‹æ—¥å¸¸ä½¿ç”¨æ­¥éª¤\nå‡†å¤‡å›¾ç‰‡\n\nä¼˜åŒ–å›¾ç‰‡å¤§å°ï¼ˆæ¨è &lt; 1MBï¼‰\nä½¿ç”¨æœ‰æ„ä¹‰çš„æ–‡ä»¶åï¼ˆè‹±æ–‡+æ•°å­—ï¼‰\né€‰æ‹©åˆé€‚çš„æ ¼å¼ï¼ˆjpg&#x2F;png&#x2F;webpï¼‰\n\n\nä¸Šä¼ å›¾ç‰‡\n\næ‹–æ‹½åˆ°PicGoç•Œé¢\næˆ–ä½¿ç”¨å¿«æ·é”® Ctrl+Shift+P\nè‡ªåŠ¨ä¸Šä¼ å¹¶å¤åˆ¶é“¾æ¥\n\n\næ’å…¥æ–‡ç« \n\nåœ¨Markdownä¸­ç²˜è´´é“¾æ¥\næ·»åŠ æœ‰æ„ä¹‰çš„altæè¿°\nè°ƒæ•´æ˜¾ç¤ºæ ·å¼\n\n\n\nå¸¸ç”¨å¿«æ·é”®\n\n\nåŠŸèƒ½\nå¿«æ·é”®\n\n\n\nå¿«é€Ÿä¸Šä¼ \nCtrl + Shift + P\n\n\næ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨\nCtrl + Shift + O\n\n\nä»URLä¸Šä¼ \nCtrl + Shift + U\n\n\nä¸Šä¼ å‰ªè´´æ¿å›¾ç‰‡\nCtrl + Shift + C\n\n\næœ€ä½³å®è·µå›¾ç‰‡å‘½åè§„èŒƒ# å¥½çš„å‘½åç¤ºä¾‹\nproject-overview.png\nuser-interface-design.jpg\nsystem-architecture-diagram.png\nbefore-vs-after-comparison.png\n\n# é¿å…çš„å‘½å\nå›¾ç‰‡1.png\næˆªå›¾.jpg\nIMG_20231002.png\n\næ–‡ä»¶å¤¹ç»„ç»‡img&#x2F;\nâ”œâ”€â”€ blog&#x2F;           # åšå®¢ç›¸å…³å›¾ç‰‡\nâ”‚   â”œâ”€â”€ headers&#x2F;    # æ–‡ç« å¤´å›¾\nâ”‚   â”œâ”€â”€ content&#x2F;    # æ–‡ç« å†…å®¹å›¾ç‰‡\nâ”‚   â””â”€â”€ thumbnails&#x2F; # ç¼©ç•¥å›¾\nâ”œâ”€â”€ projects&#x2F;       # é¡¹ç›®å±•ç¤ºå›¾ç‰‡\nâ”œâ”€â”€ tutorials&#x2F;      # æ•™ç¨‹æ­¥éª¤å›¾ç‰‡\nâ””â”€â”€ misc&#x2F;          # å…¶ä»–å›¾ç‰‡\n\næ€§èƒ½ä¼˜åŒ–å»ºè®®\nå›¾ç‰‡å‹ç¼©\n\nä½¿ç”¨ TinyPNG å‹ç¼©å›¾ç‰‡\næˆ–ä½¿ç”¨PicGoæ’ä»¶è‡ªåŠ¨å‹ç¼©\n\n\næ ¼å¼é€‰æ‹©\n\nç…§ç‰‡ï¼šJPEGï¼ˆ.jpgï¼‰\nå›¾æ ‡&#x2F;æ’å›¾ï¼šPNGï¼ˆ.pngï¼‰\nåŠ¨å›¾ï¼šGIFæˆ–WebP\n\n\nå°ºå¯¸æ§åˆ¶\n\nåšå®¢å®½åº¦é€šå¸¸ä¸º 800-1200px\né¿å…ä¸Šä¼ è¿‡å¤§çš„åŸå›¾\n\n\n\næ•…éšœæ’é™¤å¸¸è§é—®é¢˜1. å›¾ç‰‡æ— æ³•æ˜¾ç¤º\næ£€æŸ¥Giteeä»“åº“æ˜¯å¦ä¸ºå…¬å¼€çŠ¶æ€\nç¡®è®¤å›¾ç‰‡é“¾æ¥æ ¼å¼æ­£ç¡®\néªŒè¯å›¾ç‰‡æ˜¯å¦æˆåŠŸä¸Šä¼ \n\n2. PicGoä¸Šä¼ å¤±è´¥\næ£€æŸ¥ç½‘ç»œè¿æ¥\néªŒè¯Tokenæ˜¯å¦æ­£ç¡®\nç¡®è®¤ä»“åº“è·¯å¾„é…ç½®\n\n3. å›¾ç‰‡åŠ è½½æ…¢\nè€ƒè™‘ä½¿ç”¨CDNåŠ é€Ÿ\nå‹ç¼©å›¾ç‰‡å¤§å°\né€‰æ‹©åˆé€‚çš„å›¾ç‰‡æ ¼å¼\n\nGitHubå›¾åºŠé…ç½®ï¼ˆæ¨èï¼‰GitHubå›¾åºŠæ˜¯æ›´åŠ ç¨³å®šçš„é€‰æ‹©ï¼Œå…¼å®¹æ€§æå¥½ï¼š\nç¬¬ä¸€æ­¥ï¼šåˆ›å»ºGitHubä»“åº“\nè®¿é—® GitHubå®˜ç½‘ å¹¶ç™»å½•\nç‚¹å‡»å³ä¸Šè§’ + â†’ New repository\nå¡«å†™ä»“åº“ä¿¡æ¯ï¼š\nRepository nameï¼šmy-images\nè®¾ç½®ä¸ºï¼šPublic ï¼ˆé‡è¦ï¼ï¼‰\nå‹¾é€‰ï¼šInitialize this repository with a README\n\n\n\nç¬¬äºŒæ­¥ï¼šç”ŸæˆGitHub Token\nç‚¹å‡»å¤´åƒ â†’ Settings\nå·¦ä¾§èœå•é€‰æ‹© Developer settings\nç‚¹å‡» Personal access tokens â†’ Tokens (classic)\nç‚¹å‡» Generate new token â†’ Generate new token (classic)\né…ç½®Tokenï¼š\nNote: PicGoå›¾åºŠä½¿ç”¨\nExpiration: No expiration\nScopes: åªå‹¾é€‰ repo (å®Œæ•´ä»“åº“è®¿é—®æƒé™)\n\n\nç”Ÿæˆå¹¶å¤åˆ¶tokenï¼ˆä»¥ ghp_ å¼€å¤´ï¼‰\n\nç¬¬ä¸‰æ­¥ï¼šåœ¨PicGoä¸­é…ç½®GitHubå›¾åºŠ\næ‰“å¼€PicGoï¼Œè¿›å…¥ å›¾åºŠè®¾ç½®\né€‰æ‹© GitHubå›¾åºŠ ï¼ˆå†…ç½®ï¼Œæ— éœ€æ’ä»¶ï¼‰\nå¡«å†™é…ç½®ï¼š\n\nä»“åº“å: ä½ çš„GitHubç”¨æˆ·å&#x2F;my-images\nåˆ†æ”¯å: main (æˆ– master)\nToken: åˆšæ‰ç”Ÿæˆçš„GitHub token\nå­˜å‚¨è·¯å¾„: img&#x2F;\nè‡ªå®šä¹‰åŸŸå: ç•™ç©º\n\nGitHubå›¾åºŠä¼˜åŠ¿\nâœ… ç¨³å®šå¯é  - GitHubæä¾›å…¨çƒCDN\nâœ… æ— éœ€æ’ä»¶ - PicGoåŸç”Ÿæ”¯æŒ\nâœ… å…è´¹ä½¿ç”¨ - å•ä»“åº“100GBç©ºé—´\nâœ… ç‰ˆæœ¬æ§åˆ¶ - å®Œæ•´çš„Gitç®¡ç†\nâœ… å…¨çƒè®¿é—® - ä¸–ç•Œå„åœ°éƒ½èƒ½è®¿é—®\n\nä¸ƒç‰›äº‘å›¾åºŠé…ç½®ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸ƒç‰›äº‘å­˜å‚¨ç©ºé—´\nè®¿é—® ä¸ƒç‰›äº‘æ§åˆ¶å°\nç™»å½•åï¼Œè¿›å…¥ å¯¹è±¡å­˜å‚¨ â†’ ç©ºé—´ç®¡ç†\nç‚¹å‡» æ–°å»ºç©ºé—´ï¼Œå¡«å†™ä¿¡æ¯ï¼š\nç©ºé—´åç§°ï¼šqiqi776ï¼ˆä½ çš„æ¡¶åï¼‰\nå­˜å‚¨åŒºåŸŸï¼šé€‰æ‹© ååŒ—-æ²³åŒ—ï¼ˆåŒºåŸŸä»£ç ï¼šz1ï¼‰\nè®¿é—®æ§åˆ¶ï¼šé€‰æ‹© å…¬å¼€ç©ºé—´ï¼ˆç”¨äºå›¾åºŠï¼‰\n\n\n\nç¬¬äºŒæ­¥ï¼šç»‘å®šè‡ªå®šä¹‰åŸŸå\nåœ¨ç©ºé—´ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»ä½ çš„å­˜å‚¨ç©ºé—´\nè¿›å…¥ åŸŸåç®¡ç† â†’ è‡ªå®šä¹‰åŸŸå\nç‚¹å‡» ç»‘å®šåŸŸåï¼Œå¡«å†™ï¼š\nåŸŸåï¼šimage.huangzhongqi978.top\nåè®®ï¼šé€‰æ‹© HTTPSï¼ˆæ¨èï¼‰æˆ– HTTP\n\n\nå®ŒæˆåŸŸåè§£æé…ç½®ï¼š\nåœ¨ä½ çš„åŸŸåæœåŠ¡å•†ï¼ˆå¦‚é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ï¼‰æ·»åŠ  CNAME è§£æ\nä¸»æœºè®°å½•ï¼šimage\nè®°å½•ç±»å‹ï¼šCNAME\nè®°å½•å€¼ï¼šä¸ƒç‰›äº‘æä¾›çš„ CNAME åœ°å€ï¼ˆå¦‚ï¼šxxxxx.qiniucdn.comï¼‰\n\n\nç­‰å¾…åŸŸåè§£æç”Ÿæ•ˆï¼ˆé€šå¸¸å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰\n\nç¬¬ä¸‰æ­¥ï¼šè·å– AccessKey å’Œ SecretKey\nåœ¨ä¸ƒç‰›äº‘æ§åˆ¶å°ï¼Œç‚¹å‡»å³ä¸Šè§’å¤´åƒ\né€‰æ‹© å¯†é’¥ç®¡ç†\nå¦‚æœæ²¡æœ‰å¯†é’¥ï¼Œç‚¹å‡» åˆ›å»ºå¯†é’¥\nå¤åˆ¶ AccessKey å’Œ SecretKeyï¼ˆSecretKey åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·å¦¥å–„ä¿å­˜ï¼‰\n\nç¬¬å››æ­¥ï¼šåœ¨ PicGo ä¸­é…ç½®ä¸ƒç‰›äº‘\næ‰“å¼€ PicGoï¼Œè¿›å…¥ å›¾åºŠè®¾ç½® â†’ ä¸ƒç‰›å›¾åºŠ\nå¡«å†™é…ç½®ä¿¡æ¯ï¼š\n\nè®¾å®šKeyID: ä½ çš„ AccessKey\nè®¾å®šKeySecret: ä½ çš„ SecretKey\nè®¾å®šå­˜å‚¨ç©ºé—´å: qiqi776\nè®¾å®šå­˜å‚¨åŒºåŸŸ: z1 (ååŒ—-æ²³åŒ—)\nè®¾å®šè®¿é—®ç½‘å€: https:&#x2F;&#x2F;image.huangzhongqi978.top\næˆ–: http:&#x2F;&#x2F;image.huangzhongqi978.top\n\né‡è¦é…ç½®è¯´æ˜ï¼š\n\nå­˜å‚¨åŒºåŸŸä»£ç å¯¹ç…§è¡¨ï¼š\n\nz0 - åä¸œï¼ˆæµ™æ±Ÿï¼‰\nz1 - ååŒ—ï¼ˆæ²³åŒ—ï¼‰âœ… ä½ çš„é€‰æ‹©\nz2 - åå—ï¼ˆå¹¿ä¸œï¼‰\nna0 - åŒ—ç¾ï¼ˆæ´›æ‰çŸ¶ï¼‰\nas0 - ä¸œå—äºšï¼ˆæ–°åŠ å¡ï¼‰\n\n\nè®¿é—®ç½‘å€æ ¼å¼ï¼š\n\nå¿…é¡»åŒ…å«åè®®ï¼šhttps:// æˆ– http://\nä¸è¦åŠ æ–œæ ï¼šhttps://image.huangzhongqi978.top âœ…\nä¸è¦å†™ï¼šhttps://image.huangzhongqi978.top/ âŒ\n\n\n\nç¬¬äº”æ­¥ï¼šé…ç½®é˜²ç›—é“¾ï¼ˆæ¨èï¼‰é˜²ç›—é“¾å¯ä»¥é˜²æ­¢ä»–äººæœªç»æˆæƒå¼•ç”¨ä½ çš„å›¾ç‰‡ï¼Œä¿æŠ¤å¸¦å®½å’Œæµé‡ã€‚\n\nåœ¨ä¸ƒç‰›äº‘æ§åˆ¶å°ï¼Œè¿›å…¥ä½ çš„å­˜å‚¨ç©ºé—´\n\nç‚¹å‡» ç©ºé—´è®¾ç½® â†’ è®¿é—®æ§åˆ¶ â†’ é˜²ç›—é“¾\n\né€‰æ‹©é˜²ç›—é“¾æ¨¡å¼ï¼š\nç™½åå•æ¨¡å¼ï¼ˆæ¨èï¼‰ï¼š\n\nä»…å…è®¸æŒ‡å®šåŸŸåè®¿é—®ä½ çš„å›¾ç‰‡\næ·»åŠ ä½ çš„åšå®¢åŸŸåï¼šhuangzhongqi978.top\nwww.huangzhongqi978.top\nlocalhost\n127.0.0.1\nå…¶ä»–ç«™ç‚¹ç›´æ¥å¼•ç”¨ä¼šè¢«æ‹¦æˆªï¼ˆæ˜¾ç¤º 403 é”™è¯¯ï¼‰\n\né»‘åå•æ¨¡å¼ï¼š\n\nç¦æ­¢æŒ‡å®šåŸŸåè®¿é—®\né€‚åˆéœ€è¦é˜»æ­¢ç‰¹å®šæ¶æ„ç«™ç‚¹çš„åœºæ™¯\n\n\nä¿å­˜è®¾ç½®ï¼Œç«‹å³ç”Ÿæ•ˆ\n\n\næ³¨æ„äº‹é¡¹ï¼š\n\nâœ… é…ç½®ç™½åå•åï¼Œåªæœ‰ä½ çš„åšå®¢å¯ä»¥æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡\nâœ… å¯ä»¥æœ‰æ•ˆé˜²æ­¢å›¾ç‰‡è¢«ç›—ç”¨ï¼ŒèŠ‚çœæµé‡æˆæœ¬\nâš ï¸ å¦‚æœå›¾ç‰‡åœ¨å…¶ä»–ç½‘ç«™æ— æ³•æ˜¾ç¤ºï¼Œæ£€æŸ¥æ˜¯å¦åœ¨ç™½åå•ä¸­\nâš ï¸ æœ¬åœ°å¼€å‘æ—¶è®°å¾—æ·»åŠ  localhost å’Œ 127.0.0.1\n\nå¸¸è§é—®é¢˜æ’æŸ¥é—®é¢˜1ï¼šä¸Šä¼ å¤±è´¥ï¼Œæç¤ºâ€åŸŸåæœªç»‘å®šâ€è§£å†³æ–¹æ¡ˆï¼š\n\næ£€æŸ¥ä¸ƒç‰›äº‘æ§åˆ¶å°æ˜¯å¦å·²ç»‘å®šåŸŸå\nç¡®è®¤åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆï¼ˆä½¿ç”¨ nslookup image.huangzhongqi978.top æ£€æŸ¥ï¼‰\nç­‰å¾…åŸŸåè§£æå®Œå…¨ç”Ÿæ•ˆï¼ˆå¯èƒ½éœ€è¦å‡ å°æ—¶ï¼‰\n\né—®é¢˜2ï¼šä¸Šä¼ å¤±è´¥ï¼Œæç¤ºâ€åŒºåŸŸé”™è¯¯â€è§£å†³æ–¹æ¡ˆï¼š\n\nç¡®è®¤å­˜å‚¨åŒºåŸŸä»£ç ï¼šååŒ—-æ²³åŒ—åº”è¯¥æ˜¯ z1ï¼ˆä¸æ˜¯ z0ï¼‰\nå¦‚æœç¡®å®åˆ›å»ºåœ¨æ²³åŒ—ï¼ŒåŒºåŸŸä»£ç åº”è¯¥æ˜¯ z1\n\né—®é¢˜3ï¼šå›¾ç‰‡èƒ½ä¸Šä¼ ä½†æ— æ³•è®¿é—®è§£å†³æ–¹æ¡ˆï¼š\n\næ£€æŸ¥å­˜å‚¨ç©ºé—´æ˜¯å¦è®¾ç½®ä¸ºâ€å…¬å¼€ç©ºé—´â€\næ£€æŸ¥è‡ªå®šä¹‰åŸŸåçš„ HTTPS è¯ä¹¦æ˜¯å¦é…ç½®\nç¡®è®¤è®¿é—®ç½‘å€é…ç½®æ˜¯å¦æ­£ç¡®ï¼ˆåŒ…å«åè®®ï¼‰\n\né—®é¢˜4ï¼šHTTPS è®¿é—®å¤±è´¥è§£å†³æ–¹æ¡ˆï¼š\n\nåœ¨ä¸ƒç‰›äº‘æ§åˆ¶å° â†’ åŸŸåç®¡ç† â†’ SSLè¯ä¹¦ï¼Œé…ç½® HTTPS è¯ä¹¦\nå¯ä»¥ä½¿ç”¨ä¸ƒç‰›äº‘æä¾›çš„å…è´¹è¯ä¹¦ï¼Œæˆ–ä¸Šä¼ è‡ªå·±çš„è¯ä¹¦\n\né—®é¢˜5ï¼šé…ç½®é˜²ç›—é“¾åå›¾ç‰‡åŠ è½½å¤±è´¥è§£å†³æ–¹æ¡ˆï¼š\n\næ£€æŸ¥ä½ çš„åšå®¢åŸŸåæ˜¯å¦åœ¨ç™½åå•ä¸­\nç¡®è®¤åŸŸåæ ¼å¼æ­£ç¡®ï¼ˆä¸è¦åŒ…å«åè®®ï¼Œå¦‚ï¼šhuangzhongqi978.top è€Œä¸æ˜¯ https://huangzhongqi978.topï¼‰\næœ¬åœ°å¼€å‘æ—¶ï¼Œç¡®ä¿æ·»åŠ äº† localhost å’Œ 127.0.0.1\nå¦‚æœä½¿ç”¨ www å­åŸŸåï¼Œä¹Ÿè¦æ·»åŠ åˆ°ç™½åå•\næ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ 403 é”™è¯¯ï¼ˆè¡¨ç¤ºè¢«é˜²ç›—é“¾æ‹¦æˆªï¼‰\n\nä¸ƒç‰›äº‘å›¾åºŠä¼˜åŠ¿\nâœ… CDN åŠ é€Ÿ - å…¨çƒ CDN èŠ‚ç‚¹ï¼Œè®¿é—®é€Ÿåº¦å¿«\nâœ… è‡ªå®šä¹‰åŸŸå - æ”¯æŒç»‘å®šè‡ªå·±çš„åŸŸå\nâœ… é˜²ç›—é“¾ä¿æŠ¤ - æ”¯æŒé»‘ç™½åå•ï¼Œé˜²æ­¢å›¾ç‰‡è¢«ç›—ç”¨\nâœ… å…è´¹é¢åº¦ - æ¯æœˆ 10GB å­˜å‚¨ + 10GB æµé‡\nâœ… ç¨³å®šå¯é  - ä¼ä¸šçº§å¯¹è±¡å­˜å‚¨æœåŠ¡\nâœ… PicGo åŸç”Ÿæ”¯æŒ - æ— éœ€å®‰è£…æ’ä»¶\n\nå¤‡ç”¨æ–¹æ¡ˆå¦‚æœéœ€è¦å…¶ä»–å›¾åºŠé€‰æ‹©ï¼š\n\nSM.MS - å…è´¹å›¾åºŠæœåŠ¡\né˜¿é‡Œäº‘OSS - ä¼ä¸šçº§å¯¹è±¡å­˜å‚¨\nè…¾è®¯äº‘COS - ä¼ä¸šçº§å¯¹è±¡å­˜å‚¨\n\næ€»ç»“æœ¬æ•™ç¨‹ä»‹ç»äº†ä¸¤ç§ä¸»æµå›¾åºŠæ–¹æ¡ˆï¼š\nGiteeå›¾åºŠ\nğŸš€ è®¿é—®é€Ÿåº¦å¿« - å›½å†…æœåŠ¡å™¨ï¼Œä½å»¶è¿Ÿ\nğŸ’° å®Œå…¨å…è´¹ - æ— å­˜å‚¨å’Œæµé‡é™åˆ¶\nğŸ”§ é…ç½®ç®€å• - PicGoæ’ä»¶æ”¯æŒ\nğŸ‡¨ğŸ‡³ æœ¬åœŸä¼˜åŠ¿ - é€‚åˆä¸­æ–‡åšå®¢\n\nGitHubå›¾åºŠï¼ˆæ¨èï¼‰\nğŸŒ å…¨çƒç¨³å®š - GitHubæä¾›å¯é æœåŠ¡\nğŸ”§ å…¼å®¹æ€§å¥½ - PicGoåŸç”Ÿæ”¯æŒ\nğŸ“¦ å¤§å®¹é‡ - å•ä»“åº“100GBç©ºé—´\nğŸ”’ ç‰ˆæœ¬æ§åˆ¶ - å®Œæ•´çš„Gitç®¡ç†\n\né€šè¿‡æœ¬æ•™ç¨‹çš„é…ç½®ï¼Œä½ å¯ä»¥ï¼š\n\nå¤§å¹…å‡å°‘åšå®¢ä»“åº“å¤§å°\næå‡å›¾ç‰‡åŠ è½½é€Ÿåº¦\nå®ç°å›¾ç‰‡çš„ç»Ÿä¸€ç®¡ç†\næ”¯æŒè·¨å¹³å°å›¾ç‰‡å¼•ç”¨\n\nå»ºè®®ä¼˜å…ˆé€‰æ‹©GitHubå›¾åºŠï¼Œç¨³å®šæ€§æ›´å¥½ã€‚å¦‚æœå›½å†…è®¿é—®GitHubè¾ƒæ…¢ï¼Œå¯ä»¥è€ƒè™‘Giteeä½œä¸ºå¤‡é€‰æ–¹æ¡ˆã€‚\n\n\nğŸ’¡ å°è´´å£«ï¼šè®°å¾—å®šæœŸå¤‡ä»½é‡è¦å›¾ç‰‡ï¼Œè™½ç„¶Giteeå¾ˆç¨³å®šï¼Œä½†å¤šä¸€ä»½å¤‡ä»½æ€»æ˜¯å¥½çš„ï¼\n\n","categories":["æ•™ç¨‹"],"tags":["å›¾åºŠ","Gitee","GitHub","PicGo"]},{"title":"åŸºäºGRUçš„è¯­éŸ³æƒ…æ„Ÿåˆ†æè¯†åˆ«","url":"/2024/10/05/%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E8%AF%A6%E7%BB%86%E6%96%87%E6%A1%A3/","content":"GRUæ¶æ„ä¸‹çš„è¯­éŸ³æƒ…æ„Ÿè¯†åˆ«\n\n\næƒ…æ„Ÿè¯†åˆ«æ¨¡å‹ä¼˜åŒ–è¯¦ç»†æ–‡æ¡£ğŸ“‹ ç›®å½•\næ¦‚è¿°\næ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯\nä»£ç å®ç°è¯¦è§£\nå‚æ•°é…ç½®è¯´æ˜\nè®­ç»ƒç­–ç•¥ä¼˜åŒ–\næ€§èƒ½ç›‘æ§ä¸å¯è§†åŒ–\n\n\nğŸ“– æ¦‚è¿°æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†IEMOCAPæƒ…æ„Ÿè¯†åˆ«æ¨¡å‹çš„æ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯ï¼Œä¸»è¦è§£å†³è·¨è¯´è¯äººæƒ…æ„Ÿè¯†åˆ«ä¸­çš„æ³›åŒ–èƒ½åŠ›é—®é¢˜ã€‚ä¼˜åŒ–ç­–ç•¥åŒ…æ‹¬è¯´è¯äººæ— å…³åŒ–æŠ€æœ¯ã€é«˜çº§è®­ç»ƒç­–ç•¥å’Œç»¼åˆæŸå¤±å‡½æ•°è®¾è®¡ã€‚\nä¸»è¦ä¼˜åŒ–ç›®æ ‡\nğŸ¯ æå‡è·¨è¯´è¯äººæ³›åŒ–èƒ½åŠ›ï¼šæ¶ˆé™¤è¯´è¯äººç‰¹å¾å¯¹æƒ…æ„Ÿè¯†åˆ«çš„å¹²æ‰°\nğŸ“ˆ å¢å¼ºæ¨¡å‹é²æ£’æ€§ï¼šé€šè¿‡å¤šç§æ­£åˆ™åŒ–å’Œæ•°æ®å¢å¼ºæŠ€æœ¯\nâš¡ ä¼˜åŒ–è®­ç»ƒæ•ˆç‡ï¼šé‡‡ç”¨å…ˆè¿›çš„å­¦ä¹ ç‡è°ƒåº¦å’Œæ—©åœç­–ç•¥\nğŸ” æä¾›å…¨é¢ç›‘æ§ï¼šå®æ—¶å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹å’Œæ¨¡å‹æ€§èƒ½\n\n\nğŸ”§ æ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯1. è¯´è¯äººæ— å…³åŒ–æŠ€æœ¯1.1 è‡ªé€‚åº”å®ä¾‹å½’ä¸€åŒ– (AdaIN)åŸç†ï¼šé€šè¿‡å®ä¾‹çº§åˆ«çš„å½’ä¸€åŒ–æ¶ˆé™¤ä¸åŒè¯´è¯äººçš„éŸ³é¢‘ç‰¹å¾å·®å¼‚ï¼Œä¿ç•™æƒ…æ„Ÿç›¸å…³ä¿¡æ¯ã€‚\nclass AdaptiveInstanceNormalization(nn.Module):\n    \"\"\"\n    è‡ªé€‚åº”å®ä¾‹å½’ä¸€åŒ– - è¯´è¯äººå½’ä¸€åŒ–å±‚\n    \n    åŸç†ï¼š\n    1. è®¡ç®—æ¯ä¸ªæ ·æœ¬åœ¨æ—¶åºç»´åº¦ä¸Šçš„å‡å€¼å’Œæ–¹å·®\n    2. è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œæ¶ˆé™¤è¯´è¯äººç‰¹å¾å·®å¼‚\n    3. é€šè¿‡å¯å­¦ä¹ å‚æ•°é‡æ–°ç¼©æ”¾ï¼Œä¿ç•™æƒ…æ„Ÿä¿¡æ¯\n    \n    æ•°å­¦å…¬å¼ï¼š\n    Î¼ = mean(x, dim=1)  # æ—¶åºç»´åº¦å‡å€¼\n    ÏƒÂ² = var(x, dim=1)  # æ—¶åºç»´åº¦æ–¹å·®\n    x_norm = (x - Î¼) / âˆš(ÏƒÂ² + Îµ)  # å½’ä¸€åŒ–\n    output = Î³ * x_norm + Î²  # ä»¿å°„å˜æ¢\n    \"\"\"\n    \n    def __init__(self, num_features, eps=1e-5):\n        super(AdaptiveInstanceNormalization, self).__init__()\n        self.num_features = num_features\n        self.eps = eps  # æ•°å€¼ç¨³å®šæ€§å‚æ•°\n        \n        # å¯å­¦ä¹ çš„ç¼©æ”¾å’Œåç§»å‚æ•°\n        self.weight = nn.Parameter(torch.ones(num_features))   # Î³ ç¼©æ”¾å‚æ•°\n        self.bias = nn.Parameter(torch.zeros(num_features))    # Î² åç§»å‚æ•°\n        \n    def forward(self, x):\n        \"\"\"\n        å‰å‘ä¼ æ’­\n        Args:\n            x: [batch_size, seq_len, num_features] è¾“å…¥ç‰¹å¾\n        Returns:\n            å½’ä¸€åŒ–åçš„ç‰¹å¾\n        \"\"\"\n        # è®¡ç®—å®ä¾‹çº§åˆ«çš„å‡å€¼å’Œæ–¹å·®ï¼ˆè·¨åºåˆ—ç»´åº¦ï¼‰\n        mean = x.mean(dim=1, keepdim=True)  # [batch_size, 1, num_features]\n        var = x.var(dim=1, keepdim=True, unbiased=False)  # [batch_size, 1, num_features]\n        \n        # å½’ä¸€åŒ–å¤„ç†\n        x_norm = (x - mean) / torch.sqrt(var + self.eps)\n        \n        # åº”ç”¨å¯å­¦ä¹ çš„ä»¿å°„å˜æ¢\n        out = x_norm * self.weight.unsqueeze(0).unsqueeze(0) + self.bias.unsqueeze(0).unsqueeze(0)\n        \n        return out\n\nå…³é”®å‚æ•°ï¼š\n\nnum_features: ç‰¹å¾ç»´åº¦æ•°é‡\neps: æ•°å€¼ç¨³å®šæ€§å‚æ•°ï¼Œé˜²æ­¢é™¤é›¶é”™è¯¯\nweight: å¯å­¦ä¹ çš„ç¼©æ”¾å‚æ•°Î³\nbias: å¯å­¦ä¹ çš„åç§»å‚æ•°Î²\n\n1.2 æ¢¯åº¦åè½¬å¯¹æŠ—è®­ç»ƒåŸç†ï¼šé€šè¿‡æ¢¯åº¦åè½¬å±‚å®ç°å¯¹æŠ—è®­ç»ƒï¼Œè¿«ä½¿æ¨¡å‹å­¦ä¹ è¯´è¯äººæ— å…³çš„ç‰¹å¾è¡¨ç¤ºã€‚\nclass GradientReversalLayer(torch.autograd.Function):\n    \"\"\"\n    æ¢¯åº¦åè½¬å±‚ - å¯¹æŠ—è®­ç»ƒæ ¸å¿ƒç»„ä»¶\n    \n    åŸç†ï¼š\n    1. å‰å‘ä¼ æ’­ï¼šæ­£å¸¸ä¼ é€’ç‰¹å¾ï¼Œä¸åšä»»ä½•æ”¹å˜\n    2. åå‘ä¼ æ’­ï¼šå°†æ¢¯åº¦ä¹˜ä»¥è´Ÿçš„ç¼©æ”¾å› å­Î±\n    3. æ•ˆæœï¼šä½¿æ¨¡å‹æ— æ³•ä»ç‰¹å¾ä¸­è¯†åˆ«è¯´è¯äººèº«ä»½\n    \n    æ•°å­¦è¡¨ç¤ºï¼š\n    forward: y = x\n    backward: âˆ‚L/âˆ‚x = -Î± * âˆ‚L/âˆ‚y\n    \"\"\"\n    \n    @staticmethod\n    def forward(ctx, x, alpha):\n        \"\"\"\n        å‰å‘ä¼ æ’­ï¼šç›´æ¥ä¼ é€’è¾“å…¥\n        Args:\n            x: è¾“å…¥ç‰¹å¾\n            alpha: æ¢¯åº¦åè½¬å¼ºåº¦\n        \"\"\"\n        ctx.alpha = alpha  # ä¿å­˜alphaç”¨äºåå‘ä¼ æ’­\n        return x.view_as(x)\n    \n    @staticmethod\n    def backward(ctx, grad_output):\n        \"\"\"\n        åå‘ä¼ æ’­ï¼šæ¢¯åº¦ç¬¦å·åè½¬\n        Args:\n            grad_output: æ¥è‡ªä¸Šå±‚çš„æ¢¯åº¦\n        Returns:\n            åè½¬åçš„æ¢¯åº¦\n        \"\"\"\n        return grad_output.neg() * ctx.alpha, None\n\ndef gradient_reverse(x, alpha=1.0):\n    \"\"\"æ¢¯åº¦åè½¬å‡½æ•°åŒ…è£…å™¨\"\"\"\n    return GradientReversalLayer.apply(x, alpha)\n\nè¯´è¯äººåˆ†ç±»å™¨ï¼š\n# è¯´è¯äººåˆ†ç±»å¤´ï¼ˆç”¨äºå¯¹æŠ—è®­ç»ƒï¼‰\nif self.use_adversarial:\n    self.speaker_classifier = nn.Sequential(\n        nn.Linear(hidden_size * 4, hidden_size),      # ç‰¹å¾é™ç»´\n        nn.ReLU(inplace=True),                        # éçº¿æ€§æ¿€æ´»\n        nn.Dropout(self.dropout_rate),                # é˜²è¿‡æ‹Ÿåˆ\n        nn.Linear(hidden_size, hidden_size // 2),     # è¿›ä¸€æ­¥é™ç»´\n        nn.ReLU(inplace=True),\n        nn.Dropout(self.dropout_rate),\n        nn.Linear(hidden_size // 2, 10)              # 10ä¸ªè¯´è¯äººåˆ†ç±»\n    )\n\n2. å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶åŸç†ï¼šé€šè¿‡å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶æ•è·åºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œå¢å¼ºæƒ…æ„Ÿç‰¹å¾è¡¨ç¤ºã€‚\nclass MultiHeadSelfAttention(nn.Module):\n    \"\"\"\n    å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶\n    \n    åŸç†ï¼š\n    1. å°†è¾“å…¥ç‰¹å¾åˆ†åˆ«æŠ•å½±åˆ°Qã€Kã€Vç©ºé—´\n    2. è®¡ç®—å¤šä¸ªæ³¨æ„åŠ›å¤´çš„æ³¨æ„åŠ›æƒé‡\n    3. åŠ æƒèšåˆç‰¹å¾ä¿¡æ¯\n    4. é€šè¿‡æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–ç¨³å®šè®­ç»ƒ\n    \n    æ³¨æ„åŠ›å…¬å¼ï¼š\n    Attention(Q,K,V) = softmax(QK^T/âˆšd_k)V\n    MultiHead = Concat(head_1, ..., head_h)W^O\n    \"\"\"\n    \n    def __init__(self, d_model, num_heads, dropout=0.1):\n        super(MultiHeadSelfAttention, self).__init__()\n        assert d_model % num_heads == 0\n        \n        self.d_model = d_model          # æ¨¡å‹ç»´åº¦\n        self.num_heads = num_heads      # æ³¨æ„åŠ›å¤´æ•°é‡\n        self.d_k = d_model // num_heads # æ¯ä¸ªå¤´çš„ç»´åº¦\n        \n        # çº¿æ€§æŠ•å½±å±‚\n        self.w_q = nn.Linear(d_model, d_model)  # QueryæŠ•å½±\n        self.w_k = nn.Linear(d_model, d_model)  # KeyæŠ•å½±\n        self.w_v = nn.Linear(d_model, d_model)  # ValueæŠ•å½±\n        self.w_o = nn.Linear(d_model, d_model)  # è¾“å‡ºæŠ•å½±\n        \n        # æ­£åˆ™åŒ–å±‚\n        self.dropout = nn.Dropout(dropout)\n        self.layer_norm = nn.LayerNorm(d_model)\n        \n    def forward(self, x):\n        \"\"\"\n        å‰å‘ä¼ æ’­\n        Args:\n            x: [batch_size, seq_len, d_model] è¾“å…¥ç‰¹å¾\n        Returns:\n            æ³¨æ„åŠ›å¢å¼ºåçš„ç‰¹å¾å’Œæ³¨æ„åŠ›æƒé‡\n        \"\"\"\n        batch_size, seq_len, d_model = x.size()\n        \n        # ä¿å­˜æ®‹å·®è¿æ¥\n        residual = x\n        \n        # 1. çº¿æ€§æŠ•å½±åˆ°Qã€Kã€V\n        Q = self.w_q(x).view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)\n        K = self.w_k(x).view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)\n        V = self.w_v(x).view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)\n        \n        # 2. è®¡ç®—ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›\n        attention_scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(self.d_k)\n        attention_weights = F.softmax(attention_scores, dim=-1)\n        attention_weights = self.dropout(attention_weights)\n        \n        # 3. åŠ æƒèšåˆValue\n        context = torch.matmul(attention_weights, V)\n        \n        # 4. æ‹¼æ¥å¤šå¤´è¾“å‡º\n        context = context.transpose(1, 2).contiguous().view(\n            batch_size, seq_len, self.d_model\n        )\n        \n        # 5. è¾“å‡ºæŠ•å½±\n        output = self.w_o(context)\n        \n        # 6. æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–\n        output = self.layer_norm(output + residual)\n        \n        return output, attention_weights.mean(dim=1)  # è¿”å›å¹³å‡æ³¨æ„åŠ›æƒé‡ç”¨äºå¯è§†åŒ–\n\n3. ä½ç½®ç¼–ç class PositionalEncoding(nn.Module):\n    \"\"\"\n    æ­£å¼¦ä½ç½®ç¼–ç \n    \n    åŸç†ï¼š\n    ä½¿ç”¨ä¸åŒé¢‘ç‡çš„æ­£å¼¦å’Œä½™å¼¦å‡½æ•°ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®ç”Ÿæˆå”¯ä¸€çš„ç¼–ç \n    \n    å…¬å¼ï¼š\n    PE(pos, 2i) = sin(pos / 10000^(2i/d_model))\n    PE(pos, 2i+1) = cos(pos / 10000^(2i/d_model))\n    \"\"\"\n    \n    def __init__(self, d_model, max_length=5000):\n        super(PositionalEncoding, self).__init__()\n        \n        # åˆ›å»ºä½ç½®ç¼–ç çŸ©é˜µ\n        pe = torch.zeros(max_length, d_model)\n        position = torch.arange(0, max_length).unsqueeze(1).float()\n        \n        # è®¡ç®—é™¤æ•°é¡¹\n        div_term = torch.exp(torch.arange(0, d_model, 2).float() *\n                            -(math.log(10000.0) / d_model))\n        \n        # åº”ç”¨æ­£å¼¦å’Œä½™å¼¦å‡½æ•°\n        pe[:, 0::2] = torch.sin(position * div_term)  # å¶æ•°ä½ç½®ä½¿ç”¨sin\n        pe[:, 1::2] = torch.cos(position * div_term)  # å¥‡æ•°ä½ç½®ä½¿ç”¨cos\n        \n        self.register_buffer('pe', pe.unsqueeze(0))\n    \n    def forward(self, x):\n        \"\"\"æ·»åŠ ä½ç½®ç¼–ç åˆ°è¾“å…¥ç‰¹å¾\"\"\"\n        seq_len = x.size(1)\n        pos_encoding = self.pe[:, :seq_len, :].to(x.device)\n        return x + pos_encoding\n\n\nğŸ—ï¸ ä»£ç å®ç°è¯¦è§£1. å¢å¼ºGRUæ¨¡å‹æ¶æ„class EnhancedGRUModel(nn.Module):\n    \"\"\"\n    å¢å¼ºçš„GRUæ¨¡å‹ - é’ˆå¯¹è·¨è¯´è¯äººæƒ…æ„Ÿè¯†åˆ«ä¼˜åŒ–\n    \n    æ¶æ„ç‰¹ç‚¹ï¼š\n    1. è¾“å…¥æŠ•å½± + ä½ç½®ç¼–ç \n    2. è¯´è¯äººå½’ä¸€åŒ–å±‚ (AdaIN)\n    3. å¤šå±‚åŒå‘GRU + å±‚å½’ä¸€åŒ– + æ®‹å·®è¿æ¥\n    4. å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶\n    5. ç‰¹å¾å¢å¼ºæ¨¡å—\n    6. åŒè·¯åˆ†ç±»å¤´ï¼ˆæƒ…æ„Ÿ + è¯´è¯äººå¯¹æŠ—ï¼‰\n    \"\"\"\n    \n    def __init__(self, input_size, hidden_size, output_size, args):\n        super(EnhancedGRUModel, self).__init__()\n        \n        # åŸºç¡€å‚æ•°\n        self.input_size = input_size\n        self.hidden_size = hidden_size\n        self.output_size = output_size\n        self.num_layers = args.dia_layers\n        self.dropout_rate = args.dropout\n        \n        # åŠŸèƒ½å¼€å…³\n        self.use_attention = args.attention\n        self.use_speaker_norm = getattr(args, 'speaker_norm', True)\n        self.use_adversarial = getattr(args, 'speaker_adversarial', True)\n        \n        # 1. è¾“å…¥å¤„ç†å±‚\n        self.input_projection = nn.Linear(input_size, hidden_size * 2)\n        self.pos_encoding = PositionalEncoding(hidden_size * 2)\n        \n        # 2. è¯´è¯äººå½’ä¸€åŒ–å±‚\n        if self.use_speaker_norm:\n            self.speaker_norm = AdaptiveInstanceNormalization(hidden_size * 2)\n        \n        # 3. å¤šå±‚åŒå‘GRU\n        self.gru_layers = nn.ModuleList()\n        self.layer_norms = nn.ModuleList()\n        \n        for i in range(self.num_layers):\n            input_dim = hidden_size * 2 if i == 0 else hidden_size * 4\n            self.gru_layers.append(\n                nn.GRU(input_dim, hidden_size * 2, batch_first=True, \n                      bidirectional=True, dropout=self.dropout_rate if i &lt; self.num_layers-1 else 0)\n            )\n            self.layer_norms.append(nn.LayerNorm(hidden_size * 4))\n        \n        # 4. å¤šå¤´è‡ªæ³¨æ„åŠ›\n        if self.use_attention:\n            self.self_attention = MultiHeadSelfAttention(\n                d_model=hidden_size * 4, \n                num_heads=8, \n                dropout=self.dropout_rate\n            )\n        \n        # 5. ç‰¹å¾å¢å¼ºæ¨¡å—\n        self.feature_enhancement = nn.Sequential(\n            nn.Linear(hidden_size * 4, hidden_size * 2),\n            nn.ReLU(inplace=True),\n            nn.Dropout(self.dropout_rate),\n            nn.Linear(hidden_size * 2, hidden_size * 2),\n            nn.ReLU(inplace=True),\n            nn.Dropout(self.dropout_rate)\n        )\n        \n        # 6. å…¨å±€æ± åŒ–ç­–ç•¥\n        self.global_pooling = nn.AdaptiveAvgPool1d(1)      # å¹³å‡æ± åŒ–\n        self.global_max_pooling = nn.AdaptiveMaxPool1d(1)   # æœ€å¤§æ± åŒ–\n        \n        # 7. æƒ…æ„Ÿåˆ†ç±»å¤´\n        self.emotion_classifier = nn.Sequential(\n            nn.Linear(hidden_size * 4, hidden_size),\n            nn.ReLU(inplace=True),\n            nn.Dropout(self.dropout_rate),\n            nn.Linear(hidden_size, hidden_size // 2),\n            nn.ReLU(inplace=True),\n            nn.Dropout(self.dropout_rate),\n            nn.Linear(hidden_size // 2, output_size)\n        )\n        \n        # 8. è¯´è¯äººåˆ†ç±»å¤´ï¼ˆå¯¹æŠ—è®­ç»ƒï¼‰\n        if self.use_adversarial:\n            self.speaker_classifier = nn.Sequential(\n                nn.Linear(hidden_size * 4, hidden_size),\n                nn.ReLU(inplace=True),\n                nn.Dropout(self.dropout_rate),\n                nn.Linear(hidden_size, hidden_size // 2),\n                nn.ReLU(inplace=True),\n                nn.Dropout(self.dropout_rate),\n                nn.Linear(hidden_size // 2, 10)  # IEMOCAPæœ‰10ä¸ªè¯´è¯äºº\n            )\n        \n        self.dropout = nn.Dropout(self.dropout_rate)\n        self._init_weights()\n\n2. å‰å‘ä¼ æ’­æµç¨‹def forward(self, x, alpha=1.0):\n    \"\"\"\n    å‰å‘ä¼ æ’­\n    \n    Args:\n        x: [batch_size, seq_len, input_size] è¾“å…¥ç‰¹å¾\n        alpha: æ¢¯åº¦åè½¬å¼ºåº¦ï¼ˆç”¨äºå¯¹æŠ—è®­ç»ƒï¼‰\n    \n    Returns:\n        dict: åŒ…å«æƒ…æ„Ÿå’Œè¯´è¯äººé¢„æµ‹ç»“æœçš„å­—å…¸\n    \"\"\"\n    batch_size, seq_len, _ = x.size()\n    \n    # 1. è¾“å…¥æŠ•å½±å’Œä½ç½®ç¼–ç \n    x = self.input_projection(x)  # [batch_size, seq_len, hidden_size*2]\n    x = self.pos_encoding(x)      # æ·»åŠ ä½ç½®ä¿¡æ¯\n    \n    # 2. è¯´è¯äººå½’ä¸€åŒ–ï¼ˆæ¶ˆé™¤è¯´è¯äººç‰¹å¾ï¼‰\n    if self.use_speaker_norm:\n        x = self.speaker_norm(x)\n    \n    x = self.dropout(x)\n    \n    # 3. å¤šå±‚åŒå‘GRUå¤„ç†\n    for i, (gru_layer, layer_norm) in enumerate(zip(self.gru_layers, self.layer_norms)):\n        residual = x if i > 0 else None\n        \n        gru_out, _ = gru_layer(x)  # [batch_size, seq_len, hidden_size*4]\n        gru_out = layer_norm(gru_out)\n        \n        # æ®‹å·®è¿æ¥ï¼ˆä»ç¬¬äºŒå±‚å¼€å§‹ï¼‰\n        if residual is not None and residual.size(-1) == gru_out.size(-1):\n            gru_out = gru_out + residual\n        \n        x = self.dropout(gru_out)\n    \n    # 4. å¤šå¤´è‡ªæ³¨æ„åŠ›å¢å¼º\n    attention_weights = None\n    if self.use_attention:\n        x, attention_weights = self.self_attention(x)\n    \n    # 5. ç‰¹å¾å¢å¼º\n    enhanced_features = self.feature_enhancement(x)\n    combined_features = torch.cat([x, enhanced_features], dim=-1)\n    combined_features = combined_features[:, :, :self.hidden_size*4]\n    \n    # 6. å…¨å±€æ± åŒ–\n    pooling_input = combined_features.transpose(1, 2)\n    avg_pooled = self.global_pooling(pooling_input).squeeze(-1)\n    max_pooled = self.global_max_pooling(pooling_input).squeeze(-1)\n    \n    # æ‹¼æ¥æ± åŒ–ç»“æœ\n    pooled_features = torch.cat([avg_pooled, max_pooled], dim=1)\n    final_features = pooled_features[:, :self.hidden_size*4]\n    \n    # 7. æƒ…æ„Ÿåˆ†ç±»\n    emotion_logits = self.emotion_classifier(final_features)\n    \n    # 8. è¯´è¯äººå¯¹æŠ—åˆ†ç±»\n    speaker_logits = None\n    if self.use_adversarial:\n        # åº”ç”¨æ¢¯åº¦åè½¬\n        adversarial_features = gradient_reverse(final_features, alpha)\n        speaker_logits = self.speaker_classifier(adversarial_features)\n    \n    return &#123;\n        'emotion_logits': emotion_logits,\n        'speaker_logits': speaker_logits,\n        'attention_weights': attention_weights,\n        'features': final_features\n    &#125;\n\n\nâš™ï¸ å‚æ•°é…ç½®è¯´æ˜1. æ¨¡å‹ç»“æ„å‚æ•°# åŸºç¡€æ¶æ„å‚æ•°\ninput_size = 768          # HuBERTç‰¹å¾ç»´åº¦\nhidden_size = 256         # GRUéšè—å±‚å¤§å°\noutput_size = 4           # æƒ…æ„Ÿç±»åˆ«æ•°é‡ï¼ˆangry, happy, neutral, sadï¼‰\ndia_layers = 3            # GRUå±‚æ•°\n\n# æ­£åˆ™åŒ–å‚æ•°\ndropout = 0.3             # Dropoutæ¦‚ç‡\nmax_grad_norm = 1.0       # æ¢¯åº¦è£å‰ªé˜ˆå€¼\nl2_reg = 1e-5            # L2æ­£åˆ™åŒ–æƒé‡\n\n2. ä¼˜åŒ–ç­–ç•¥å‚æ•°# å­¦ä¹ ç‡è°ƒåº¦\nlearning_rate = 0.0005    # åˆå§‹å­¦ä¹ ç‡\nlr_schedule = 'cosine'    # å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥\nwarmup_steps = 1000       # é¢„çƒ­æ­¥æ•°\nmin_lr = 1e-7            # æœ€å°å­¦ä¹ ç‡\n\n# è®­ç»ƒç­–ç•¥\nbatch_size = 32          # æ‰¹æ¬¡å¤§å°\nepochs = 50              # è®­ç»ƒè½®æ•°\npatience = 10            # æ—©åœè€å¿ƒå€¼\n\n3. è¯´è¯äººæ— å…³åŒ–å‚æ•°# AdaINå½’ä¸€åŒ–\nspeaker_norm = True       # å¯ç”¨è¯´è¯äººå½’ä¸€åŒ–\neps = 1e-5               # æ•°å€¼ç¨³å®šæ€§å‚æ•°\n\n# å¯¹æŠ—è®­ç»ƒ\nspeaker_adversarial = True    # å¯ç”¨å¯¹æŠ—è®­ç»ƒ\nadversarial_weight = 0.05     # å¯¹æŠ—æŸå¤±æƒé‡\nalpha_schedule = 'linear'     # æ¢¯åº¦åè½¬å¼ºåº¦è°ƒåº¦\nmax_alpha = 1.0              # æœ€å¤§æ¢¯åº¦åè½¬å¼ºåº¦\n\n4. æ³¨æ„åŠ›æœºåˆ¶å‚æ•°# å¤šå¤´æ³¨æ„åŠ›\nattention = True          # å¯ç”¨æ³¨æ„åŠ›æœºåˆ¶\nnum_heads = 8            # æ³¨æ„åŠ›å¤´æ•°é‡\nattention_dropout = 0.1   # æ³¨æ„åŠ›dropout\n\n\nğŸ¯ è®­ç»ƒç­–ç•¥ä¼˜åŒ–1. ç»¼åˆæŸå¤±å‡½æ•°def compute_loss(self, model_outputs, targets, speaker_targets, alpha=1.0):\n    \"\"\"\n    ç»¼åˆæŸå¤±å‡½æ•°\n    \n    ç»„æˆï¼š\n    1. ä¸»ä»»åŠ¡æŸå¤±ï¼šæƒ…æ„Ÿåˆ†ç±»äº¤å‰ç†µæŸå¤±\n    2. å¯¹æŠ—æŸå¤±ï¼šè¯´è¯äººæ··æ·†æŸå¤±\n    3. æ­£åˆ™åŒ–æŸå¤±ï¼šL2æƒé‡è¡°å‡\n    \n    Args:\n        model_outputs: æ¨¡å‹è¾“å‡ºå­—å…¸\n        targets: æƒ…æ„Ÿæ ‡ç­¾\n        speaker_targets: è¯´è¯äººæ ‡ç­¾\n        alpha: æ¢¯åº¦åè½¬å¼ºåº¦\n    \n    Returns:\n        total_loss: æ€»æŸå¤±\n        loss_dict: å„é¡¹æŸå¤±è¯¦æƒ…\n    \"\"\"\n    emotion_logits = model_outputs['emotion_logits']\n    speaker_logits = model_outputs['speaker_logits']\n    \n    # 1. æƒ…æ„Ÿåˆ†ç±»æŸå¤±ï¼ˆä¸»è¦ä»»åŠ¡ï¼‰\n    emotion_loss = F.cross_entropy(emotion_logits, targets)\n    \n    total_loss = emotion_loss\n    loss_dict = &#123;'emotion_loss': emotion_loss.item()&#125;\n    \n    # 2. è¯´è¯äººå¯¹æŠ—æŸå¤±\n    if speaker_logits is not None and self.args.speaker_adversarial:\n        speaker_loss = F.cross_entropy(speaker_logits, speaker_targets)\n        total_loss += self.args.adversarial_weight * speaker_loss\n        loss_dict['speaker_loss'] = speaker_loss.item()\n    \n    # 3. æ­£åˆ™åŒ–æŸå¤±\n    if self.args.l2_reg > 0:\n        l2_loss = sum(torch.norm(p, 2) for p in model_outputs.get('regularization_params', []))\n        total_loss += self.args.l2_reg * l2_loss\n        loss_dict['l2_loss'] = l2_loss.item() if isinstance(l2_loss, torch.Tensor) else l2_loss\n    \n    loss_dict['total_loss'] = total_loss.item()\n    return total_loss, loss_dict\n\n2. åŠ¨æ€å¯¹æŠ—è®­ç»ƒç­–ç•¥def get_alpha_schedule(self, epoch, total_epochs):\n    \"\"\"\n    åŠ¨æ€è°ƒæ•´æ¢¯åº¦åè½¬å¼ºåº¦\n    \n    ç­–ç•¥ï¼š\n    1. å‰æœŸï¼ˆepoch &lt; 5ï¼‰ï¼šÎ± = 0ï¼Œä¸“æ³¨æƒ…æ„Ÿåˆ†ç±»\n    2. ä¸­æœŸï¼ˆ5 â‰¤ epoch &lt; total_epochs*0.7ï¼‰ï¼šçº¿æ€§å¢é•¿\n    3. åæœŸï¼šä¿æŒæœ€å¤§å€¼\n    \"\"\"\n    if epoch &lt; 5:\n        return 0.0  # å‰æœŸä¸ä½¿ç”¨å¯¹æŠ—è®­ç»ƒ\n    elif epoch &lt; total_epochs * 0.7:\n        # çº¿æ€§å¢é•¿é˜¶æ®µ\n        progress = (epoch - 5) / (total_epochs * 0.7 - 5)\n        return progress * self.args.max_alpha\n    else:\n        return self.args.max_alpha  # åæœŸä¿æŒæœ€å¤§å€¼\n\n3. å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥def create_lr_scheduler(self, optimizer, total_steps):\n    \"\"\"\n    åˆ›å»ºå­¦ä¹ ç‡è°ƒåº¦å™¨\n    \n    ç­–ç•¥ï¼šä½™å¼¦é€€ç« + é¢„çƒ­\n    1. é¢„çƒ­é˜¶æ®µï¼šçº¿æ€§å¢é•¿åˆ°åˆå§‹å­¦ä¹ ç‡\n    2. ä¸»è®­ç»ƒé˜¶æ®µï¼šä½™å¼¦é€€ç«åˆ°æœ€å°å­¦ä¹ ç‡\n    3. é‡å¯æœºåˆ¶ï¼šå‘¨æœŸæ€§é‡å¯æå‡æ€§èƒ½\n    \"\"\"\n    # é¢„çƒ­è°ƒåº¦å™¨\n    warmup_scheduler = LinearLR(\n        optimizer,\n        start_factor=0.1,\n        end_factor=1.0,\n        total_iters=self.args.warmup_steps\n    )\n    \n    # ä½™å¼¦é€€ç«è°ƒåº¦å™¨\n    cosine_scheduler = CosineAnnealingWarmRestarts(\n        optimizer,\n        T_0=total_steps // 4,  # ç¬¬ä¸€ä¸ªå‘¨æœŸé•¿åº¦\n        T_mult=2,              # å‘¨æœŸå€å¢å› å­\n        eta_min=self.args.min_lr\n    )\n    \n    # ç»„åˆè°ƒåº¦å™¨\n    scheduler = SequentialLR(\n        optimizer,\n        schedulers=[warmup_scheduler, cosine_scheduler],\n        milestones=[self.args.warmup_steps]\n    )\n    \n    return scheduler\n\n4. æ•°æ®å¢å¼ºç­–ç•¥def apply_augmentation(self, audio_features):\n    \"\"\"\n    è®­ç»ƒæ—¶æ•°æ®å¢å¼º\n    \n    ç­–ç•¥ï¼š\n    1. é«˜æ–¯å™ªå£°ï¼šå¢åŠ é²æ£’æ€§\n    2. æ—¶é—´æ‹‰ä¼¸ï¼šæ¨¡æ‹Ÿè¯­é€Ÿå˜åŒ–\n    3. ç‰¹å¾æ©è”½ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆ\n    \"\"\"\n    if self.is_training:\n        # 1. æ·»åŠ é«˜æ–¯å™ªå£°\n        if torch.rand(1) &lt; 0.3:\n            noise = torch.randn_like(audio_features) * self.noise_factor\n            audio_features = audio_features + noise\n        \n        # 2. æ—¶é—´ç»´åº¦æ‹‰ä¼¸ï¼ˆç®€åŒ–ç‰ˆï¼‰\n        if torch.rand(1) &lt; 0.2:\n            stretch_factor = 1.0 + torch.rand(1) * self.time_stretch_factor * 2 - self.time_stretch_factor\n            # å®é™…å®ç°éœ€è¦æ’å€¼æ“ä½œ\n            \n        # 3. ç‰¹å¾æ©è”½\n        if torch.rand(1) &lt; 0.2:\n            mask_size = int(audio_features.size(0) * 0.1)\n            mask_start = torch.randint(0, max(1, audio_features.size(0) - mask_size), (1,))\n            audio_features[mask_start:mask_start + mask_size] *= 0.1\n    \n    return audio_features\n\n\nğŸ“Š æ€§èƒ½ç›‘æ§ä¸å¯è§†åŒ–1. è®­ç»ƒç›‘æ§æŒ‡æ ‡class TrainingMonitor:\n    \"\"\"è®­ç»ƒè¿‡ç¨‹ç›‘æ§å™¨\"\"\"\n    \n    def __init__(self):\n        self.metrics = &#123;\n            'train_loss': [],\n            'val_loss': [],\n            'train_acc': [],\n            'val_acc': [],\n            'train_f1': [],\n            'val_f1': [],\n            'learning_rate': [],\n            'alpha_values': []\n        &#125;\n    \n    def update_metrics(self, epoch, train_metrics, val_metrics, lr, alpha):\n        \"\"\"æ›´æ–°è®­ç»ƒæŒ‡æ ‡\"\"\"\n        self.metrics['train_loss'].append(train_metrics['loss'])\n        self.metrics['val_loss'].append(val_metrics['loss'])\n        self.metrics['train_acc'].append(train_metrics['accuracy'])\n        self.metrics['val_acc'].append(val_metrics['accuracy'])\n        self.metrics['train_f1'].append(train_metrics['f1_score'])\n        self.metrics['val_f1'].append(val_metrics['f1_score'])\n        self.metrics['learning_rate'].append(lr)\n        self.metrics['alpha_values'].append(alpha)\n    \n    def plot_training_curves(self, save_path):\n        \"\"\"ç»˜åˆ¶è®­ç»ƒæ›²çº¿\"\"\"\n        fig, axes = plt.subplots(2, 3, figsize=(18, 12))\n        \n        # æŸå¤±æ›²çº¿\n        axes[0, 0].plot(self.metrics['train_loss'], label='Train Loss', color='blue')\n        axes[0, 0].plot(self.metrics['val_loss'], label='Val Loss', color='red')\n        axes[0, 0].set_title('Loss Curves')\n        axes[0, 0].legend()\n        \n        # å‡†ç¡®ç‡æ›²çº¿\n        axes[0, 1].plot(self.metrics['train_acc'], label='Train Acc', color='blue')\n        axes[0, 1].plot(self.metrics['val_acc'], label='Val Acc', color='red')\n        axes[0, 1].set_title('Accuracy Curves')\n        axes[0, 1].legend()\n        \n        # F1åˆ†æ•°æ›²çº¿\n        axes[0, 2].plot(self.metrics['train_f1'], label='Train F1', color='blue')\n        axes[0, 2].plot(self.metrics['val_f1'], label='Val F1', color='red')\n        axes[0, 2].set_title('F1 Score Curves')\n        axes[0, 2].legend()\n        \n        # å­¦ä¹ ç‡å˜åŒ–\n        axes[1, 0].plot(self.metrics['learning_rate'], color='green')\n        axes[1, 0].set_title('Learning Rate Schedule')\n        axes[1, 0].set_yscale('log')\n        \n        # Alphaå€¼å˜åŒ–\n        axes[1, 1].plot(self.metrics['alpha_values'], color='orange')\n        axes[1, 1].set_title('Adversarial Alpha Schedule')\n        \n        # éªŒè¯æŸå¤±æ”¾å¤§å›¾\n        axes[1, 2].plot(self.metrics['val_loss'], color='red', linewidth=2)\n        axes[1, 2].set_title('Validation Loss (Detailed)')\n        \n        plt.tight_layout()\n        plt.savefig(save_path, dpi=300, bbox_inches='tight')\n        plt.close()\n\n2. è·¨è¯´è¯äººæ€§èƒ½åˆ†ædef analyze_speaker_performance(self, model, test_loader, save_dir):\n    \"\"\"\n    è·¨è¯´è¯äººæ€§èƒ½åˆ†æ\n    \n    åˆ†æå†…å®¹ï¼š\n    1. å„è¯´è¯äººå‡†ç¡®ç‡å¯¹æ¯”\n    2. æ€§èƒ½æ–¹å·®åˆ†æ\n    3. æ€§åˆ«å·®å¼‚åˆ†æ\n    4. ä¼šè¯å·®å¼‚åˆ†æ\n    \"\"\"\n    model.eval()\n    speaker_results = defaultdict(list)\n    \n    with torch.no_grad():\n        for batch in test_loader:\n            features = batch['audio_features'].to(self.device)\n            labels = batch['emotion_label'].to(self.device)\n            speakers = batch['speaker']\n            \n            outputs = model(features)\n            predictions = torch.argmax(outputs['emotion_logits'], dim=1)\n            \n            for pred, label, speaker in zip(predictions.cpu(), labels.cpu(), speakers):\n                speaker_results[speaker].append(&#123;\n                    'prediction': pred.item(),\n                    'label': label.item(),\n                    'correct': pred.item() == label.item()\n                &#125;)\n    \n    # è®¡ç®—å„è¯´è¯äººæ€§èƒ½\n    speaker_metrics = &#123;&#125;\n    for speaker, results in speaker_results.items():\n        correct = sum(r['correct'] for r in results)\n        total = len(results)\n        accuracy = correct / total if total > 0 else 0\n        \n        # è®¡ç®—F1åˆ†æ•°\n        y_true = [r['label'] for r in results]\n        y_pred = [r['prediction'] for r in results]\n        f1 = f1_score(y_true, y_pred, average='weighted')\n        \n        speaker_metrics[speaker] = &#123;\n            'accuracy': accuracy,\n            'f1_score': f1,\n            'total_samples': total\n        &#125;\n    \n    # å¯è§†åŒ–ç»“æœ\n    self.plot_speaker_performance(speaker_metrics, save_dir)\n    \n    return speaker_metrics\n\ndef plot_speaker_performance(self, speaker_metrics, save_dir):\n    \"\"\"ç»˜åˆ¶è¯´è¯äººæ€§èƒ½å¯¹æ¯”å›¾\"\"\"\n    speakers = list(speaker_metrics.keys())\n    accuracies = [speaker_metrics[s]['accuracy'] for s in speakers]\n    f1_scores = [speaker_metrics[s]['f1_score'] for s in speakers]\n    \n    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))\n    \n    # å‡†ç¡®ç‡å¯¹æ¯”\n    bars1 = ax1.bar(speakers, accuracies, color='skyblue', alpha=0.7)\n    ax1.set_title('Speaker-wise Accuracy Comparison')\n    ax1.set_ylabel('Accuracy')\n    ax1.set_ylim(0, 1)\n    \n    # æ·»åŠ æ•°å€¼æ ‡ç­¾\n    for bar, acc in zip(bars1, accuracies):\n        ax1.text(bar.get_x() + bar.get_width()/2, bar.get_height() + 0.01, \n                f'&#123;acc:.3f&#125;', ha='center', va='bottom')\n    \n    # F1åˆ†æ•°å¯¹æ¯”\n    bars2 = ax2.bar(speakers, f1_scores, color='lightcoral', alpha=0.7)\n    ax2.set_title('Speaker-wise F1 Score Comparison')\n    ax2.set_ylabel('F1 Score')\n    ax2.set_ylim(0, 1)\n    \n    # æ·»åŠ æ•°å€¼æ ‡ç­¾\n    for bar, f1 in zip(bars2, f1_scores):\n        ax2.text(bar.get_x() + bar.get_width()/2, bar.get_height() + 0.01, \n                f'&#123;f1:.3f&#125;', ha='center', va='bottom')\n    \n    plt.tight_layout()\n    plt.savefig(f'&#123;save_dir&#125;/speaker_performance_comparison.png', dpi=300, bbox_inches='tight')\n    plt.close()\n\n\nğŸ¯ ä½¿ç”¨ç¤ºä¾‹1. æ¨¡å‹åˆå§‹åŒ–# åˆ›å»ºå‚æ•°å¯¹è±¡\nargs = argparse.Namespace(\n    input_size=768,\n    hidden_size=256,\n    output_size=4,\n    dia_layers=3,\n    dropout=0.3,\n    attention=True,\n    speaker_norm=True,\n    speaker_adversarial=True,\n    adversarial_weight=0.05,\n    max_alpha=1.0\n)\n\n# åˆå§‹åŒ–æ¨¡å‹\nmodel = EnhancedGRUModel(\n    input_size=args.input_size,\n    hidden_size=args.hidden_size,\n    output_size=args.output_size,\n    args=args\n)\n\nprint(f\"æ¨¡å‹å‚æ•°é‡: &#123;sum(p.numel() for p in model.parameters()):,&#125;\")\n\n2. è®­ç»ƒæµç¨‹# åˆ›å»ºè®­ç»ƒå™¨\ntrainer = AdvancedTrainer(args)\n\n# è®­ç»ƒæ¨¡å‹\nbest_model_path = trainer.train_model(\n    model=model,\n    train_loader=train_loader,\n    val_loader=val_loader,\n    save_dir='./experiments'\n)\n\nprint(f\"æœ€ä½³æ¨¡å‹ä¿å­˜åœ¨: &#123;best_model_path&#125;\")\n\n3. æ€§èƒ½è¯„ä¼°# åŠ è½½æœ€ä½³æ¨¡å‹\nmodel.load_state_dict(torch.load(best_model_path))\n\n# è¯„ä¼°è·¨è¯´è¯äººæ€§èƒ½\nevaluator = SpeakerIndependenceEvaluator(model, args)\nresults = evaluator.evaluate(test_loader, save_dir='./evaluation_results')\n\nprint(\"è·¨è¯´è¯äººæ€§èƒ½è¯„ä¼°å®Œæˆï¼\")\nprint(f\"æ€»ä½“å‡†ç¡®ç‡: &#123;results['overall_accuracy']:.4f&#125;\")\nprint(f\"å¹³å‡F1åˆ†æ•°: &#123;results['average_f1']:.4f&#125;\")\nprint(f\"æ€§èƒ½æ ‡å‡†å·®: &#123;results['performance_std']:.4f&#125;\")\n\n\nğŸ“ˆ é¢„æœŸæ”¹è¿›æ•ˆæœæ€§èƒ½æå‡é¢„æœŸ\n\n\næŒ‡æ ‡\nåŸå§‹æ¨¡å‹\nå¢å¼ºæ¨¡å‹\næ”¹è¿›å¹…åº¦\n\n\n\næ€»ä½“å‡†ç¡®ç‡\n65-70%\n75-80%\n+10-15%\n\n\nè·¨è¯´è¯äººF1\n0.62-0.67\n0.72-0.77\n+0.10-0.15\n\n\næ€§èƒ½æ–¹å·®\n0.08-0.12\n0.04-0.08\n-50%â†“\n\n\næ”¶æ•›é€Ÿåº¦\n30-40è½®\n20-25è½®\nå¿«25-50%\n\n\næŠ€æœ¯ä¼˜åŠ¿\nğŸ¯ è¯´è¯äººæ— å…³æ€§ï¼šAdaINå½’ä¸€åŒ– + å¯¹æŠ—è®­ç»ƒæ˜¾è‘—å‡å°‘è¯´è¯äººåè§\nğŸš€ è®­ç»ƒæ•ˆç‡ï¼šåŠ¨æ€å­¦ä¹ ç‡è°ƒåº¦ + æ—©åœæœºåˆ¶åŠ é€Ÿæ”¶æ•›\nğŸ’ª æ¨¡å‹é²æ£’æ€§ï¼šå¤šç§æ­£åˆ™åŒ–æŠ€æœ¯æå‡æ³›åŒ–èƒ½åŠ›\nğŸ“Š å…¨é¢ç›‘æ§ï¼šå®æ—¶å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹å’Œæ€§èƒ½æŒ‡æ ‡\n\n\nğŸ”§ æ•…éšœæ’é™¤å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ\nå†…å­˜ä¸è¶³\n# å‡å°‘æ‰¹æ¬¡å¤§å°\nargs.batch_size = 16  # ä»32é™åˆ°16\n\n# å¯ç”¨æ¢¯åº¦ç´¯ç§¯\nargs.gradient_accumulation_steps = 2\n\nè®­ç»ƒä¸ç¨³å®š\n# é™ä½å­¦ä¹ ç‡\nargs.learning_rate = 0.0001\n\n# å¢åŠ æ¢¯åº¦è£å‰ª\nargs.max_grad_norm = 0.5\n\nè¿‡æ‹Ÿåˆä¸¥é‡\n# å¢åŠ Dropout\nargs.dropout = 0.5\n\n# å¢åŠ L2æ­£åˆ™åŒ–\nargs.l2_reg = 1e-4\n\nå¯¹æŠ—è®­ç»ƒä¸æ”¶æ•›\n# é™ä½å¯¹æŠ—æƒé‡\nargs.adversarial_weight = 0.01\n\n# å»¶è¿Ÿå¯¹æŠ—è®­ç»ƒå¼€å§‹æ—¶é—´\nargs.adversarial_start_epoch = 10\n\n\nğŸ“š å‚è€ƒæ–‡çŒ®\nAdaIN: Huang, X., &amp; Belongie, S. (2017). Arbitrary style transfer in real-time with adaptive instance normalization.\nGradient Reversal: Ganin, Y., &amp; Lempitsky, V. (2015). Unsupervised domain adaptation by backpropagation.\nMulti-Head Attention: Vaswani, A., et al. (2017). Attention is all you need.\nHuBERT: Hsu, W. N., et al. (2021). HuBERT: Self-supervised speech representation learning by masked prediction.\n\n\nğŸ“ æ–‡æ¡£ç‰ˆæœ¬: v2.0 | æ›´æ–°æ—¥æœŸ: 2024-09-26 | ä½œè€…: AI Assistant\n\nIEMOCAPè¯­éŸ³æƒ…æ„Ÿè¯†åˆ«ç³»ç»Ÿæ·±åº¦æºç è§£æç›®å½•\né¡¹ç›®æ•´ä½“æ¶æ„ä¸æ¨¡å—åˆ’åˆ†\næ ¸å¿ƒç»„ä»¶åŠŸèƒ½æ·±åº¦è§£æ\nå®Œæ•´æ•°æ®æµè·¯å¾„åˆ†æ\nå…³é”®å‚æ•°å«ä¹‰ä¸æ€§èƒ½å½±å“\næ¨¡å‹å·¥ä½œæœºåˆ¶æ·±å…¥ç†è§£\nç³»ç»Ÿä¼˜åŠ¿ä¸æŠ€æœ¯åˆ›æ–°\n\n\n1. é¡¹ç›®æ•´ä½“æ¶æ„ä¸æ¨¡å—åˆ’åˆ†1.1 ç³»ç»Ÿæ¶æ„æ¦‚è§ˆè¯¥IEMOCAPè¯­éŸ³æƒ…æ„Ÿè¯†åˆ«ç³»ç»Ÿé‡‡ç”¨ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œå®ç°ä»åŸå§‹éŸ³é¢‘ä¿¡å·åˆ°æƒ…æ„Ÿç±»åˆ«çš„ç›´æ¥æ˜ å°„ã€‚æ•´ä½“æ•°æ®æµéµå¾ªç°ä»£è¯­éŸ³å¤„ç†çš„æœ€ä½³å®è·µï¼š\nåŸå§‹éŸ³é¢‘ â†’ é¢„å¤„ç†æ ‡å‡†åŒ– â†’ HuBERTç‰¹å¾ç¼–ç  â†’ åŒå‘GRUåºåˆ—å»ºæ¨¡ â†’ æ³¨æ„åŠ›æœºåˆ¶å¢å¼º â†’ å…¨å±€æ± åŒ– â†’ åˆ†ç±»è¾“å‡º\n\nè¿™ç§è®¾è®¡å……åˆ†åˆ©ç”¨äº†è‡ªç›‘ç£é¢„è®­ç»ƒæ¨¡å‹çš„å¼ºå¤§ç‰¹å¾æå–èƒ½åŠ›ï¼Œç»“åˆå¾ªç¯ç¥ç»ç½‘ç»œå¯¹æ—¶åºä¿¡æ¯çš„ç²¾ç¡®å»ºæ¨¡ï¼Œæœ€ç»ˆé€šè¿‡æ³¨æ„åŠ›æœºåˆ¶å®ç°å¯¹æƒ…æ„Ÿå…³é”®ä¿¡æ¯çš„åŠ¨æ€èšç„¦ã€‚\n1.2 æ ¸å¿ƒæ¨¡å—åˆ’åˆ†æ•°æ®é¢„å¤„ç†æ¨¡å— (Data_prepocessing.py)\n\nåŠŸèƒ½èŒè´£ï¼šè´Ÿè´£IEMOCAPæ•°æ®é›†çš„æ ‡å‡†åŒ–å¤„ç†ï¼ŒåŒ…æ‹¬éŸ³é¢‘é•¿åº¦ç»Ÿä¸€ã€é‡‡æ ·ç‡æ ‡å‡†åŒ–ã€æƒ…æ„Ÿæ ‡ç­¾æ˜ å°„\næ ¸å¿ƒä»·å€¼ï¼šç¡®ä¿æ¨¡å‹è¾“å…¥çš„ä¸€è‡´æ€§ï¼Œä¸ºåç»­ç‰¹å¾æå–æä¾›æ ‡å‡†åŒ–çš„æ•°æ®åŸºç¡€\næŠ€æœ¯ç‰¹ç‚¹ï¼šé‡‡ç”¨å›ºå®š3ç§’æ—¶é•¿ç­–ç•¥ï¼Œå¹³è¡¡ä¿¡æ¯ä¿ç•™ä¸è®¡ç®—æ•ˆç‡\n\næ¨¡å‹æ¶æ„æ¨¡å— (models/GRU.py)\n\nSpeechRecognitionModelï¼šä¸»æ¨¡å‹å®¹å™¨ï¼Œæ•´åˆHuBERTç‰¹å¾æå–å™¨ä¸GRUåºåˆ—å»ºæ¨¡å™¨\nGRUModelï¼šåºåˆ—å»ºæ¨¡æ ¸å¿ƒï¼Œè´Ÿè´£æ—¶åºç‰¹å¾çš„æ·±åº¦å­¦ä¹ ä¸æƒ…æ„Ÿåˆ†ç±»\nMatchingAttentionï¼šæ³¨æ„åŠ›æœºåˆ¶å®ç°ï¼Œæä¾›åŠ¨æ€ç‰¹å¾åŠ æƒèƒ½åŠ›\n\nè®­ç»ƒä¸éªŒè¯æ¨¡å— (train.py)\n\näº¤å‰éªŒè¯ç­–ç•¥ï¼šé‡‡ç”¨5æŠ˜äº¤å‰éªŒè¯ï¼Œç¡®ä¿æ¨¡å‹æ³›åŒ–èƒ½åŠ›çš„å¯é è¯„ä¼°\nä¼˜åŒ–ç­–ç•¥ï¼šä½¿ç”¨AdamWä¼˜åŒ–å™¨ï¼Œç»“åˆé€‚å½“çš„å­¦ä¹ ç‡è°ƒåº¦\næ€§èƒ½è¯„ä¼°ï¼šå¤šæŒ‡æ ‡ç»¼åˆè¯„ä¼°ï¼ŒåŒ…æ‹¬å‡†ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°\n\næ¨ç†ä¸åº”ç”¨æ¨¡å— (DEMO.py, GUIæƒ…æ„Ÿè¯†åˆ«2.py)\n\nå•æ ·æœ¬æ¨ç†ï¼šæä¾›ç®€æ´çš„æ¨¡å‹æµ‹è¯•æ¥å£\nå®æ—¶éŸ³é¢‘å¤„ç†ï¼šæ”¯æŒéº¦å…‹é£å®æ—¶å½•éŸ³ä¸æƒ…æ„Ÿè¯†åˆ«\nç”¨æˆ·ç•Œé¢ï¼šå®Œæ•´çš„PyQt5å›¾å½¢ç•Œé¢ï¼Œæä¾›ç›´è§‚çš„äº¤äº’ä½“éªŒ\n\n\n2. æ ¸å¿ƒç»„ä»¶åŠŸèƒ½æ·±åº¦è§£æ2.1 HubertModelè¯­éŸ³ç‰¹å¾ç¼–ç å™¨2.1.1 æ¨¡å‹é€‰æ‹©çš„æ·±å±‚è€ƒé‡self.feature_extractor = HubertModel.from_pretrained(\"facebook/hubert-base-ls960\")\n\nHuBERT (Hidden-Unit BERT) çš„é€‰æ‹©ä½“ç°äº†å¯¹è¯­éŸ³è¡¨ç¤ºå­¦ä¹ å‰æ²¿æŠ€æœ¯çš„æ·±åˆ»ç†è§£ï¼š\nè‡ªç›‘ç£å­¦ä¹ ä¼˜åŠ¿ï¼š\n\nHuBERTé€šè¿‡æ©ç é¢„æµ‹ä»»åŠ¡åœ¨å¤§è§„æ¨¡æ— æ ‡æ³¨è¯­éŸ³æ•°æ®ä¸Šé¢„è®­ç»ƒï¼Œå­¦ä¹ åˆ°äº†ä¸°å¯Œçš„è¯­éŸ³è¡¨ç¤º\nç›¸æ¯”ä¼ ç»Ÿçš„MFCCã€Melé¢‘è°±ç­‰æ‰‹å·¥ç‰¹å¾ï¼ŒHuBERTèƒ½å¤Ÿè‡ªåŠ¨å‘ç°è¯­éŸ³ä¸­çš„å±‚æ¬¡åŒ–æ¨¡å¼\né¢„è®­ç»ƒåœ¨960å°æ—¶LibriSpeechæ•°æ®ä¸Šè¿›è¡Œï¼Œæ¶µç›–äº†å¤šæ ·åŒ–çš„è¯­éŸ³æ¨¡å¼å’Œå£°å­¦ç¯å¢ƒ\n\nåˆ†å±‚ç‰¹å¾è¡¨ç¤ºï¼š\n\nåº•å±‚ï¼šæ•è·éŸ³ç´ çº§åˆ«çš„å£°å­¦ç‰¹å¾ï¼Œå¦‚å…±æŒ¯å³°ã€åŸºé¢‘å˜åŒ–\nä¸­å±‚ï¼šå»ºæ¨¡éŸ³èŠ‚å’Œè¯æ±‡çº§åˆ«çš„è¯­éŸ³æ¨¡å¼\né«˜å±‚ï¼šç¼–ç è¯­ä¹‰å’ŒéŸµå¾‹ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹æƒ…æ„Ÿè¯†åˆ«è‡³å…³é‡è¦\n\n768ç»´ç‰¹å¾å‘é‡çš„ä¿¡æ¯å¯†åº¦ï¼š\n\næ¯ä¸ªæ—¶é—´æ­¥è¾“å‡º768ç»´å¯†é›†å‘é‡ï¼Œç›¸æ¯”ä¼ ç»Ÿç‰¹å¾ï¼ˆå¦‚39ç»´MFCCï¼‰å…·æœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›\né«˜ç»´ç‰¹å¾ç©ºé—´èƒ½å¤Ÿæ›´ç²¾ç»†åœ°åŒºåˆ†ä¸åŒæƒ…æ„ŸçŠ¶æ€ä¸‹çš„è¯­éŸ³å˜åŒ–\n\n2.1.2 ç‰¹å¾æå–çš„æŠ€æœ¯å®ç°def forward(self, input_waveform):\n    features = self.feature_extractor(input_waveform).last_hidden_state  # [batch, seq_len, 768]\n    logits = self.Utterance_net(features)\n    return logits, features\n\nå¤„ç†æµç¨‹çš„æŠ€æœ¯ç»†èŠ‚ï¼š\n\nå·ç§¯ç‰¹å¾æå–ï¼š\n\nHuBERTé¦–å…ˆé€šè¿‡7å±‚1Då·ç§¯ç½‘ç»œå¤„ç†åŸå§‹æ³¢å½¢\næ¯å±‚å·ç§¯é€æ­¥é™ä½æ—¶é—´åˆ†è¾¨ç‡ï¼Œæé«˜ç‰¹å¾æŠ½è±¡å±‚æ¬¡\nå·ç§¯æ ¸è®¾è®¡è€ƒè™‘äº†è¯­éŸ³ä¿¡å·çš„æ—¶é¢‘ç‰¹æ€§\n\n\nTransformerç¼–ç ï¼š\n\n12å±‚Transformerç¼–ç å™¨è¿›è¡Œåºåˆ—å»ºæ¨¡\nè‡ªæ³¨æ„åŠ›æœºåˆ¶æ•è·é•¿è·ç¦»ä¾èµ–å…³ç³»\nä½ç½®ç¼–ç ä¿æŒæ—¶åºä¿¡æ¯çš„å®Œæ•´æ€§\n\n\nç‰¹å¾é€‰æ‹©ç­–ç•¥ï¼š\n\nlast_hidden_stateæä¾›æœ€é«˜å±‚çš„è¯­ä¹‰è¡¨ç¤º\nè¿™ä¸€å±‚ç‰¹å¾æœ€é€‚åˆä¸‹æ¸¸åˆ†ç±»ä»»åŠ¡ï¼Œå¹³è¡¡äº†ç‰¹å¾æŠ½è±¡ç¨‹åº¦ä¸ä»»åŠ¡ç›¸å…³æ€§\n\n\n\n2.1.3 éŸ³é¢‘é¢„å¤„ç†çš„å·¥ç¨‹è€ƒé‡def process_wav_file(wav_file, time_seconds):\n    waveform, sample_rate = torchaudio.load(wav_file)\n    target_length = int(time_seconds * sample_rate)\n    if waveform.size(1) > target_length:\n        waveform = waveform[:, :target_length]  # æ—¶é—´è£å‰ª\n    else:\n        padding_length = target_length - waveform.size(1)\n        waveform = torch.nn.functional.pad(waveform, (0, padding_length))  # é›¶å¡«å……\n    return waveform, sample_rate\n\n3ç§’å›ºå®šé•¿åº¦çš„è®¾è®¡rationaleï¼š\n\nè®¡ç®—æ•ˆç‡ï¼šå›ºå®šé•¿åº¦ä¾¿äºæ‰¹å¤„ç†ï¼Œæé«˜GPUåˆ©ç”¨ç‡\nä¿¡æ¯å……åˆ†æ€§ï¼š3ç§’è¶³ä»¥åŒ…å«å®Œæ•´çš„æƒ…æ„Ÿè¡¨è¾¾ï¼Œæ¶µç›–è¯æ±‡ã€éŸµå¾‹ã€è¯­è°ƒå˜åŒ–\nå†…å­˜ç®¡ç†ï¼šé¿å…å˜é•¿åºåˆ—å¸¦æ¥çš„å†…å­˜ç¢ç‰‡åŒ–é—®é¢˜\næ¨¡å‹ä¸€è‡´æ€§ï¼šç¡®ä¿è®­ç»ƒå’Œæ¨ç†é˜¶æ®µçš„è¾“å…¥æ ¼å¼å®Œå…¨ä¸€è‡´\n\né›¶å¡«å…… vs é‡å¤å¡«å……çš„é€‰æ‹©ï¼š\n\né›¶å¡«å……é¿å…äº†äººå·¥å¼•å…¥çš„å‘¨æœŸæ€§æ¨¡å¼\nä¿æŒäº†åŸå§‹è¯­éŸ³çš„è‡ªç„¶è¾¹ç•Œç‰¹æ€§\nä¸HuBERTé¢„è®­ç»ƒæ—¶çš„å¤„ç†æ–¹å¼ä¿æŒä¸€è‡´\n\n2.2 GRUModelåŒå‘åºåˆ—å»ºæ¨¡å™¨2.2.1 æ¶æ„è®¾è®¡çš„æ·±å±‚é€»è¾‘class GRUModel(nn.Module):\n    def __init__(self, input_size, hidden_size, output_size, args):\n        self.bigru = nn.GRU(input_size, hidden_size, batch_first=True, \n                           num_layers=self.num_layers, bidirectional=True)\n        self.input2hidden = nn.Linear(512, hidden_size * 2)\n        self.hidden2label = nn.Linear(hidden_size * 2, output_size)\n\nåŒå‘GRUçš„ç†è®ºåŸºç¡€ï¼š\n\nå‰å‘ä¿¡æ¯æµï¼šæ•è·ä»è¯­éŸ³å¼€å§‹åˆ°å½“å‰æ—¶åˆ»çš„æƒ…æ„Ÿå‘å±•è½¨è¿¹\nåå‘ä¿¡æ¯æµï¼šåˆ©ç”¨æœªæ¥ä¿¡æ¯ä¸ºå½“å‰æ—¶åˆ»æä¾›ä¸Šä¸‹æ–‡çº¦æŸ\nä¿¡æ¯èåˆï¼šå‰åå‘éšçŠ¶æ€çš„æ‹¼æ¥æä¾›äº†æ›´å®Œæ•´çš„æ—¶åºè¡¨ç¤º\n\nå¤šå±‚è®¾è®¡çš„å¿…è¦æ€§ï¼š\n\nå±‚æ¬¡åŒ–æŠ½è±¡ï¼šåº•å±‚æ•è·å±€éƒ¨æ—¶åºæ¨¡å¼ï¼Œé«˜å±‚å»ºæ¨¡å…¨å±€æƒ…æ„ŸåŠ¨æ€\néçº¿æ€§å¢å¼ºï¼šå¤šå±‚ç»“æ„å¢åŠ æ¨¡å‹çš„éçº¿æ€§è¡¨è¾¾èƒ½åŠ›\næ¢¯åº¦æµä¼˜åŒ–ï¼šé€‚å½“çš„å±‚æ•°å¹³è¡¡äº†è¡¨è¾¾èƒ½åŠ›ä¸æ¢¯åº¦ä¼ æ’­æ•ˆç‡\n\n2.2.2 å‰å‘ä¼ æ’­çš„ç²¾å¯†è®¾è®¡def forward(self, U):\n    U = self.dropout(U)  # è¾“å…¥æ­£åˆ™åŒ–\n    emotions, hidden = self.bigru(U)  # [batch, seq, 512]\n    \n    # æ³¨æ„åŠ›æœºåˆ¶å¢å¼º\n    if self.attention:\n        att_emotions = []\n        for t in emotions:\n            att_em, alpha_ = self.matchatt(emotions, t, mask=None)\n            att_emotions.append(att_em.unsqueeze(0))\n        att_emotions = torch.cat(att_emotions, dim=0)\n        emotions = att_emotions\n    \n    # å…¨å±€ç‰¹å¾èšåˆ\n    gru_out = torch.transpose(emotions, 1, 2)  # [batch, 512, seq]\n    gru_out = F.tanh(gru_out)\n    gru_out = F.max_pool1d(gru_out, gru_out.size(2)).squeeze(2)  # å…¨å±€æœ€å¤§æ± åŒ–\n    \n    # åˆ†ç±»æ˜ å°„\n    Out_in = self.relu(gru_out)\n    Out_in = self.dropout(Out_in)\n    Out_out = self.hidden2label(Out_in)  # [batch, num_classes]\n    return Out_out\n\nå…³é”®å¤„ç†æ­¥éª¤çš„æŠ€æœ¯åˆ†æï¼š\n\nè¾“å…¥Dropoutï¼š\n\nåœ¨ç‰¹å¾å±‚é¢å¼•å…¥éšæœºæ€§ï¼Œå¢å¼ºæ¨¡å‹æ³›åŒ–èƒ½åŠ›\né˜²æ­¢æ¨¡å‹è¿‡åº¦ä¾èµ–HuBERTç‰¹å¾çš„ç‰¹å®šç»´åº¦\n\n\nåŒå‘GRUå¤„ç†ï¼š\n\nè¾“å‡ºç»´åº¦ä¸º512ï¼ˆ256Ã—2ï¼‰ï¼Œèåˆå‰åå‘ä¿¡æ¯\nbatch_first=Trueè®¾è®¡ä¾¿äºåç»­å¤„ç†å’Œè°ƒè¯•\n\n\næ³¨æ„åŠ›å¢å¼ºï¼ˆå¯é€‰ï¼‰ï¼š\n\nä¸ºæ¯ä¸ªæ—¶é—´æ­¥è®¡ç®—å…¨å±€æ³¨æ„åŠ›æƒé‡\nåŠ¨æ€è°ƒæ•´ä¸åŒæ—¶åˆ»ç‰¹å¾çš„é‡è¦æ€§\nç¼“è§£é•¿åºåˆ—ä¿¡æ¯è¡°å‡é—®é¢˜\n\n\nå…¨å±€æœ€å¤§æ± åŒ–ï¼š\n\næå–åºåˆ—ä¸­çš„æœ€æ˜¾è‘—ç‰¹å¾\nå®ç°ä»å˜é•¿åºåˆ—åˆ°å›ºå®šé•¿åº¦è¡¨ç¤ºçš„è½¬æ¢\nä¿ç•™æœ€å¼ºçš„æƒ…æ„Ÿæ¿€æ´»ä¿¡å·\n\n\nåˆ†ç±»å¤´æ˜ å°„ï¼š\n\nçº¿æ€§å˜æ¢å°†512ç»´ç‰¹å¾æ˜ å°„åˆ°4ç±»æƒ…æ„Ÿè¾“å‡º\næ— åç½®è®¾è®¡ç®€åŒ–æ¨¡å‹ï¼Œå‡å°‘è¿‡æ‹Ÿåˆé£é™©\n\n\n\n2.3 MatchingAttentionæ³¨æ„åŠ›æœºåˆ¶2.3.1 æ³¨æ„åŠ›è®¾è®¡çš„ç†è®ºåŸºç¡€class MatchingAttention(nn.Module):\n    def __init__(self, mem_dim, cand_dim, alpha_dim=None, att_type='general'):\n        if att_type=='general':\n            self.transform = nn.Linear(cand_dim, mem_dim, bias=False)\n\næ³¨æ„åŠ›æœºåˆ¶çš„æ ¸å¿ƒæ€æƒ³ï¼š\n\næŸ¥è¯¢-é”®-å€¼æ¨¡å¼ï¼šå°†å½“å‰æ—¶åˆ»ä½œä¸ºæŸ¥è¯¢ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºé”®å’Œå€¼\nç›¸ä¼¼åº¦è®¡ç®—ï¼šé€šè¿‡å­¦ä¹ åˆ°çš„å˜æ¢çŸ©é˜µè®¡ç®—æŸ¥è¯¢ä¸é”®çš„åŒ¹é…ç¨‹åº¦\nåŠ¨æ€æƒé‡åˆ†é…ï¼šæ ¹æ®ç›¸ä¼¼åº¦ä¸ºä¸åŒæ—¶åˆ»åˆ†é…æ³¨æ„åŠ›æƒé‡\n\nGeneral Attentionçš„ä¼˜åŠ¿ï¼š\n\nç»´åº¦çµæ´»æ€§ï¼šé€šè¿‡çº¿æ€§å˜æ¢å¤„ç†ä¸åŒç»´åº¦çš„è¾“å…¥\nå‚æ•°æ•ˆç‡ï¼šç›¸æ¯”concat attentionå‚æ•°æ›´å°‘ï¼Œè®­ç»ƒæ›´ç¨³å®š\nè®¡ç®—æ•ˆç‡ï¼šçŸ©é˜µä¹˜æ³•æ“ä½œä¾¿äºGPUå¹¶è¡ŒåŠ é€Ÿ\n\n2.3.2 æ³¨æ„åŠ›è®¡ç®—çš„æ•°å­¦å®ç°def forward(self, M, x, mask=None):\n    # M: [seq_len, batch, mem_dim] - è®°å¿†åºåˆ—ï¼ˆæ‰€æœ‰æ—¶åˆ»çš„éšçŠ¶æ€ï¼‰\n    # x: [batch, cand_dim] - æŸ¥è¯¢å‘é‡ï¼ˆå½“å‰æ—¶åˆ»çš„éšçŠ¶æ€ï¼‰\n    \n    if self.att_type=='general':\n        M_ = M.permute(1,2,0)  # [batch, mem_dim, seq_len]\n        x_ = self.transform(x).unsqueeze(1)  # [batch, 1, mem_dim]\n        alpha = F.softmax(torch.bmm(x_, M_), dim=2)  # [batch, 1, seq_len]\n    \n    attn_pool = torch.bmm(alpha, M.transpose(0,1))[:,0,:]  # [batch, mem_dim]\n    return attn_pool, alpha\n\nè®¡ç®—æµç¨‹çš„æ·±å±‚è§£æï¼š\n\næŸ¥è¯¢å˜æ¢ï¼š\nx_ = self.transform(x).unsqueeze(1)  # [batch, 1, mem_dim]\n\nå°†å½“å‰æ—¶åˆ»ç‰¹å¾å˜æ¢åˆ°è®°å¿†ç©ºé—´\nå­¦ä¹ æŸ¥è¯¢ä¸è®°å¿†ä¹‹é—´çš„æœ€ä¼˜åŒ¹é…å…³ç³»\n\n\nç›¸ä¼¼åº¦è®¡ç®—ï¼š\nalpha = F.softmax(torch.bmm(x_, M_), dim=2)  # [batch, 1, seq_len]\n\næ‰¹é‡çŸ©é˜µä¹˜æ³•è®¡ç®—æ‰€æœ‰æ—¶åˆ»çš„ç›¸ä¼¼åº¦åˆ†æ•°\nSoftmaxå½’ä¸€åŒ–ç¡®ä¿æƒé‡å’Œä¸º1\n\n\nåŠ æƒèšåˆï¼š\nattn_pool = torch.bmm(alpha, M.transpose(0,1))[:,0,:]  # [batch, mem_dim]\n\næ ¹æ®æ³¨æ„åŠ›æƒé‡å¯¹æ‰€æœ‰æ—¶åˆ»ç‰¹å¾è¿›è¡ŒåŠ æƒå¹³å‡\nç”Ÿæˆèåˆå…¨å±€ä¿¡æ¯çš„ä¸Šä¸‹æ–‡å‘é‡\n\n\n\n2.3.3 æ³¨æ„åŠ›åœ¨æƒ…æ„Ÿè¯†åˆ«ä¸­çš„ä½œç”¨æœºåˆ¶if self.attention:\n    att_emotions = []\n    alpha = []\n    for t in emotions:  # å¯¹åºåˆ—ä¸­æ¯ä¸ªæ—¶é—´æ­¥\n        att_em, alpha_ = self.matchatt(emotions, t, mask=None)\n        att_emotions.append(att_em.unsqueeze(0))\n        alpha.append(alpha_[:, 0, :])\n    att_emotions = torch.cat(att_emotions, dim=0)\n    emotions = att_emotions\n\næ³¨æ„åŠ›å¢å¼ºçš„æƒ…æ„Ÿå»ºæ¨¡ä»·å€¼ï¼š\n\nå…³é”®æ—¶åˆ»è¯†åˆ«ï¼š\n\nè‡ªåŠ¨è¯†åˆ«è¯­éŸ³ä¸­æƒ…æ„Ÿè¡¨è¾¾æœ€å¼ºçƒˆçš„æ—¶é—´æ®µ\nä¾‹å¦‚ï¼šè¯­è°ƒå˜åŒ–å‰§çƒˆçš„è¯æ±‡ã€åœé¡¿å‰åçš„é‡éŸ³\n\n\nä¸Šä¸‹æ–‡æ•´åˆï¼š\n\nä¸ºæ¯ä¸ªæ—¶åˆ»æä¾›å…¨åºåˆ—çš„ä¸Šä¸‹æ–‡ä¿¡æ¯\né¿å…å±€éƒ¨ç‰¹å¾çš„è¯¯å¯¼ï¼Œæé«˜åˆ†ç±»ç¨³å®šæ€§\n\n\né•¿è·ç¦»ä¾èµ–å»ºæ¨¡ï¼š\n\nç¼“è§£GRUåœ¨é•¿åºåˆ—ä¸Šçš„ä¿¡æ¯è¡°å‡é—®é¢˜\nä¿æŒåºåˆ—å¼€å§‹å’Œç»“æŸéƒ¨åˆ†ä¿¡æ¯çš„æœ‰æ•ˆä¼ é€’\n\n\nå¯è§£é‡Šæ€§å¢å¼ºï¼š\n\næ³¨æ„åŠ›æƒé‡æä¾›æ¨¡å‹å†³ç­–çš„å¯è§†åŒ–ä¾æ®\nå¸®åŠ©ç†è§£æ¨¡å‹å…³æ³¨çš„è¯­éŸ³ç‰¹å¾æ¨¡å¼\n\n\n\n2.4 åˆ†ç±»å¤´ä¸æ¿€æ´»å‡½æ•°çš„ç²¾å¿ƒè®¾è®¡2.4.1 åˆ†ç±»å¤´çš„æ¶æ„é€‰æ‹©self.hidden2label = nn.Linear(hidden_size * 2, output_size)  # 512 -> 4\n\nçº¿æ€§åˆ†ç±»å¤´çš„è®¾è®¡è€ƒé‡ï¼š\n\nç®€æ´æ€§åŸåˆ™ï¼šé¿å…è¿‡åº¦å¤æ‚çš„åˆ†ç±»å™¨ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ\nç‰¹å¾å……åˆ†æ€§ï¼š512ç»´GRUè¾“å‡ºå·²åŒ…å«ä¸°å¯Œçš„æƒ…æ„Ÿåˆ¤åˆ«ä¿¡æ¯\nè®¡ç®—æ•ˆç‡ï¼šçº¿æ€§å˜æ¢è®¡ç®—ç®€å•ï¼Œä¾¿äºå®æ—¶åº”ç”¨\n\n2.4.2 æ¿€æ´»å‡½æ•°çš„å±‚æ¬¡åŒ–åº”ç”¨gru_out = F.tanh(gru_out)      # åºåˆ—ç‰¹å¾æ¿€æ´»\nOut_in = self.relu(gru_out)    # åˆ†ç±»å‰æ¿€æ´»\n# åˆ†ç±»å±‚æ— æ¿€æ´»ï¼Œè¾“å‡ºåŸå§‹logits\n\næ¿€æ´»å‡½æ•°é€‰æ‹©çš„æ·±å±‚é€»è¾‘ï¼š\n\nTanhæ¿€æ´»ï¼š\n\nå°†åºåˆ—ç‰¹å¾å‹ç¼©åˆ°[-1,1]åŒºé—´\nå¢å¼ºç‰¹å¾çš„å¯¹æ¯”åº¦ï¼Œçªå‡ºæ˜¾è‘—å˜åŒ–\nå¯¹ç§°æ€§è´¨é€‚åˆåŒå‘GRUçš„è¾“å‡ºç‰¹å¾\n\n\nLeakyReLUæ¿€æ´»ï¼š\n\nä¿æŒæ¢¯åº¦æµåŠ¨ï¼Œé¿å…æ­»ç¥ç»å…ƒé—®é¢˜\nè´Ÿæ–œç‡å‚æ•°å…è®¸è´Ÿå€¼ä¿¡æ¯çš„éƒ¨åˆ†ä¿ç•™\nåœ¨åˆ†ç±»å‰æä¾›éçº¿æ€§å˜æ¢èƒ½åŠ›\n\n\næ— æ¿€æ´»è¾“å‡ºï¼š\n\nåˆ†ç±»å±‚è¾“å‡ºåŸå§‹logitsï¼Œä¾¿äºäº¤å‰ç†µæŸå¤±è®¡ç®—\nä¿æŒæ•°å€¼ç¨³å®šæ€§ï¼Œé¿å…æ¢¯åº¦æ¶ˆå¤±\n\n\n\n\n3. å®Œæ•´æ•°æ®æµè·¯å¾„åˆ†æ3.1 è®­ç»ƒé˜¶æ®µæ•°æ®æµè®­ç»ƒæµç¨‹çš„å…³é”®ç¯èŠ‚åˆ†æï¼š\n\næ•°æ®é¢„å¤„ç†é˜¶æ®µï¼š\n\nIEMOCAPæ•°æ®é›†åŒ…å«å¤šç§æƒ…æ„Ÿç±»åˆ«ï¼Œéœ€è¦æ ‡å‡†åŒ–æ˜ å°„\néŸ³é¢‘é•¿åº¦ä¸ä¸€è‡´é—®é¢˜é€šè¿‡3ç§’å›ºå®šé•¿åº¦ç­–ç•¥è§£å†³\né‡‡æ ·ç‡ç»Ÿä¸€ä¸º16kHzï¼ŒåŒ¹é…HuBERTé¢„è®­ç»ƒé…ç½®\n\n\nç‰¹å¾æå–é˜¶æ®µï¼š\n\nHuBERTæ¨¡å‹å†»ç»“å‚æ•°ï¼Œä»…ç”¨äºç‰¹å¾æå–\n768ç»´ç‰¹å¾å‘é‡åŒ…å«ä¸°å¯Œçš„è¯­éŸ³è¯­ä¹‰ä¿¡æ¯\næ‰¹å¤„ç†æ–¹å¼æé«˜ç‰¹å¾æå–æ•ˆç‡\n\n\næ¨¡å‹è®­ç»ƒé˜¶æ®µï¼š\n\n5æŠ˜äº¤å‰éªŒè¯ç¡®ä¿ç»“æœçš„ç»Ÿè®¡æ˜¾è‘—æ€§\næ‰¹æ¬¡å¤§å°32å¹³è¡¡å†…å­˜å ç”¨ä¸æ¢¯åº¦ä¼°è®¡è´¨é‡\nAdamWä¼˜åŒ–å™¨ç»“åˆæƒé‡è¡°å‡ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ\n\n\næ¨¡å‹ä¿å­˜é˜¶æ®µï¼š\n\nä¿å­˜å®Œæ•´çš„state_dictï¼Œä¾¿äºåç»­åŠ è½½\næ¨¡å‹æ–‡ä»¶åŒ…å«æ‰€æœ‰å¯è®­ç»ƒå‚æ•°\n\n\n\n3.2 æ¨ç†é˜¶æ®µæ•°æ®æµæ¨ç†æµç¨‹çš„æŠ€æœ¯ç»†èŠ‚ï¼š\n\nè¾“å…¥å¤„ç†å¤šæ ·æ€§ï¼š\n\næ”¯æŒWAVæ–‡ä»¶å’Œå®æ—¶éº¦å…‹é£ä¸¤ç§è¾“å…¥æ¨¡å¼\nç»Ÿä¸€çš„é¢„å¤„ç†æµç¨‹ç¡®ä¿è¾“å…¥æ ¼å¼ä¸€è‡´æ€§\n\n\nç‰¹å¾æå–ä¸€è‡´æ€§ï¼š\n\nä½¿ç”¨ä¸è®­ç»ƒæ—¶ç›¸åŒçš„processorå’Œé¢„å¤„ç†å‚æ•°\nç¡®ä¿ç‰¹å¾åˆ†å¸ƒçš„ä¸€è‡´æ€§\n\n\næ¨¡å‹æ¨ç†ä¼˜åŒ–ï¼š\n\ntorch.no_grad()ä¸Šä¸‹æ–‡ç®¡ç†å™¨å‡å°‘å†…å­˜å ç”¨\næ‰¹å¤„ç†ç»´åº¦çš„åŠ¨æ€è°ƒæ•´é€‚åº”ä¸åŒè¾“å…¥æ ¼å¼\n\n\nç»“æœåå¤„ç†ï¼š\n\nSoftmaxæä¾›æ¦‚ç‡åˆ†å¸ƒï¼Œå¢å¼ºç»“æœå¯ä¿¡åº¦\nç½®ä¿¡åº¦è®¡ç®—å¸®åŠ©è¯„ä¼°é¢„æµ‹è´¨é‡\n\n\n\n3.3 GUIå®æ—¶å¤„ç†æµå®æ—¶å¤„ç†çš„å·¥ç¨‹æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆï¼š\n\nçº¿ç¨‹å®‰å…¨è®¾è®¡ï¼š\n\nAudioRecorderç‹¬ç«‹çº¿ç¨‹é¿å…UIé˜»å¡\nä¿¡å·-æ§½æœºåˆ¶ç¡®ä¿çº¿ç¨‹é—´å®‰å…¨é€šä¿¡\n\n\néŸ³é¢‘ç¼“å†²ç®¡ç†ï¼š\n\næ»‘åŠ¨çª—å£æœºåˆ¶ä¿æŒæœ€æ–°5ç§’éŸ³é¢‘\nè‡ªåŠ¨å†…å­˜ç®¡ç†é¿å…ç¼“å†²åŒºæº¢å‡º\n\n\nå®æ—¶æ€§èƒ½ä¼˜åŒ–ï¼š\n\næ¨¡å‹é¢„åŠ è½½å‡å°‘æ¨ç†å»¶è¿Ÿ\nå¼‚æ­¥å¤„ç†æé«˜å“åº”é€Ÿåº¦\n\n\nç”¨æˆ·ä½“éªŒè®¾è®¡ï¼š\n\nå®æ—¶åé¦ˆæä¾›å³æ—¶æƒ…æ„Ÿè¯†åˆ«ç»“æœ\nå†å²è®°å½•åŠŸèƒ½æ”¯æŒç»“æœå›é¡¾\n\n\n\n\n4. å…³é”®å‚æ•°å«ä¹‰ä¸æ€§èƒ½å½±å“4.1 æ¨¡å‹ç»“æ„å‚æ•°æ·±åº¦åˆ†æ\n\n\nå‚æ•°å\né»˜è®¤å€¼\nå‚æ•°å«ä¹‰\næ€§èƒ½å½±å“æœºåˆ¶\nè°ƒä¼˜å»ºè®®\n\n\n\nhidden_size\n256\nGRUéšçŠ¶æ€ç»´åº¦\nè¡¨è¾¾èƒ½åŠ›ï¼šæ›´å¤§ç»´åº¦æä¾›æ›´å¼ºç‰¹å¾è¡¨è¾¾è®¡ç®—å¤æ‚åº¦ï¼šçº¿æ€§å½±å“å‚æ•°é‡å’Œè®¡ç®—æ—¶é—´è¿‡æ‹Ÿåˆé£é™©ï¼šè¿‡å¤§å¯èƒ½å¯¼è‡´è®­ç»ƒè¿‡æ‹Ÿåˆ\n128-512èŒƒå›´å†…è°ƒä¼˜ç»“åˆdropouté˜²è¿‡æ‹Ÿåˆ\n\n\ndia_layers\n2\nGRUå †å å±‚æ•°\næŠ½è±¡å±‚æ¬¡ï¼šå¤šå±‚æä¾›æ›´æ·±å±‚æ¬¡çš„ç‰¹å¾æŠ½è±¡æ¢¯åº¦ä¼ æ’­ï¼šè¿‡æ·±å¯èƒ½å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±è®­ç»ƒç¨³å®šæ€§ï¼šå±‚æ•°é€‚ä¸­ä¿è¯è®­ç»ƒç¨³å®š\n1-4å±‚ä¸ºå®œé…åˆæ¢¯åº¦è£å‰ªä½¿ç”¨\n\n\nutt_insize\n768\nHuBERTè¾“å‡ºç»´åº¦\nç‰¹å¾ä¸°å¯Œåº¦ï¼šå›ºå®šå€¼ï¼Œç”±é¢„è®­ç»ƒæ¨¡å‹å†³å®šåŒ¹é…è¦æ±‚ï¼šå¿…é¡»ä¸HuBERTè¾“å‡ºç»´åº¦ä¸€è‡´\nä¸å¯è°ƒæ•´ç”±é¢„è®­ç»ƒæ¨¡å‹å†³å®š\n\n\nout_class\n4\næƒ…æ„Ÿç±»åˆ«æ•°é‡\nä»»åŠ¡å¤æ‚åº¦ï¼šç±»åˆ«æ•°ç›´æ¥å½±å“åˆ†ç±»éš¾åº¦æ•°æ®å¹³è¡¡ï¼šéœ€è¦å„ç±»åˆ«æ ·æœ¬ç›¸å¯¹å¹³è¡¡\næ ¹æ®å…·ä½“ä»»åŠ¡ç¡®å®šè€ƒè™‘ç±»åˆ«å¹³è¡¡ç­–ç•¥\n\n\n4.2 è®­ç»ƒè¶…å‚æ•°æ·±åº¦åˆ†æ\n\n\nå‚æ•°å\né»˜è®¤å€¼\nå‚æ•°å«ä¹‰\næ€§èƒ½å½±å“æœºåˆ¶\nè°ƒä¼˜ç­–ç•¥\n\n\n\nlearning_rate\n1e-5\nå­¦ä¹ ç‡\næ”¶æ•›é€Ÿåº¦ï¼šè¿‡å¤§æ˜“éœ‡è¡ï¼Œè¿‡å°æ”¶æ•›æ…¢æœ€ç»ˆæ€§èƒ½ï¼šå½±å“æ¨¡å‹æ”¶æ•›åˆ°çš„å±€éƒ¨æœ€ä¼˜è§£è®­ç»ƒç¨³å®šæ€§ï¼šé€‚å½“å­¦ä¹ ç‡ä¿è¯è®­ç»ƒç¨³å®š\n1e-6åˆ°1e-4èŒƒå›´ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦\n\n\ndropout\n0.2\néšæœºå¤±æ´»æ¦‚ç‡\næ­£åˆ™åŒ–å¼ºåº¦ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆçš„å…³é”®å‚æ•°æ¨¡å‹å®¹é‡ï¼šè¿‡å¤§å½±å“æ¨¡å‹è¡¨è¾¾èƒ½åŠ›æ³›åŒ–èƒ½åŠ›ï¼šé€‚å½“dropoutæå‡æ³›åŒ–æ€§èƒ½\n0.1-0.5èŒƒå›´è°ƒä¼˜æ ¹æ®æ•°æ®é›†å¤§å°è°ƒæ•´\n\n\nbatch_size\n32\næ‰¹æ¬¡å¤§å°\næ¢¯åº¦ä¼°è®¡ï¼šå½±å“æ¢¯åº¦ä¼°è®¡çš„å‡†ç¡®æ€§å†…å­˜å ç”¨ï¼šç›´æ¥å½±å“GPUå†…å­˜éœ€æ±‚è®­ç»ƒé€Ÿåº¦ï¼šå½±å“æ¯ä¸ªepochçš„è®­ç»ƒæ—¶é—´\n16-64æ ¹æ®æ˜¾å­˜è°ƒæ•´è€ƒè™‘æ¢¯åº¦ç´¯ç§¯\n\n\nattention\nTrue\næ³¨æ„åŠ›æœºåˆ¶å¼€å…³\né•¿åºåˆ—å»ºæ¨¡ï¼šæå‡é•¿è·ç¦»ä¾èµ–æ•è·èƒ½åŠ›è®¡ç®—å¼€é”€ï¼šå¢åŠ çº¦20%çš„è®¡ç®—æ—¶é—´æ¨¡å‹å¤æ‚åº¦ï¼šå¢åŠ æ¨¡å‹å‚æ•°é‡\næ ¹æ®åºåˆ—é•¿åº¦å†³å®šçŸ­åºåˆ—å¯å…³é—­\n\n\n4.3 æ•°æ®å¤„ç†å‚æ•°æ·±åº¦åˆ†æ\n\n\nå‚æ•°å\né»˜è®¤å€¼\nå‚æ•°å«ä¹‰\næ€§èƒ½å½±å“æœºåˆ¶\nè®¾è®¡è€ƒé‡\n\n\n\ntime_seconds\n3\néŸ³é¢‘å›ºå®šé•¿åº¦\nä¿¡æ¯å®Œæ•´æ€§ï¼šæ—¶é•¿å½±å“æƒ…æ„Ÿä¿¡æ¯çš„å®Œæ•´æ€§è®¡ç®—æ•ˆç‡ï¼šé•¿åº¦ç›´æ¥å½±å“è®¡ç®—å¤æ‚åº¦å†…å­˜å ç”¨ï¼šå½±å“æ‰¹å¤„ç†çš„å†…å­˜éœ€æ±‚\n2-5ç§’èŒƒå›´å†…å¹³è¡¡ä¿¡æ¯ä¸æ•ˆç‡\n\n\nsample_rate\n16000\néŸ³é¢‘é‡‡æ ·ç‡\né¢‘ç‡åˆ†è¾¨ç‡ï¼šå½±å“é«˜é¢‘ä¿¡æ¯çš„ä¿ç•™å…¼å®¹æ€§ï¼šéœ€åŒ¹é…é¢„è®­ç»ƒæ¨¡å‹è¦æ±‚æ•°æ®å¤§å°ï¼šå½±å“éŸ³é¢‘æ•°æ®çš„å­˜å‚¨ç©ºé—´\nå›ºå®š16kHzåŒ¹é…HuBERTè¦æ±‚\n\n\nnum_folds\n5\näº¤å‰éªŒè¯æŠ˜æ•°\nè¯„ä¼°å¯é æ€§ï¼šæŠ˜æ•°è¶Šå¤šè¯„ä¼°è¶Šå¯é è®¡ç®—æˆæœ¬ï¼šæŠ˜æ•°å½±å“æ€»è®­ç»ƒæ—¶é—´ç»Ÿè®¡æ˜¾è‘—æ€§ï¼šå½±å“ç»“æœçš„ç»Ÿè®¡æ„ä¹‰\n5-10æŠ˜ä¸ºå®œå¹³è¡¡å¯é æ€§ä¸æˆæœ¬\n\n\n4.4 å‚æ•°è°ƒä¼˜çš„ç³»ç»Ÿæ€§æ–¹æ³•å±‚æ¬¡åŒ–è°ƒä¼˜ç­–ç•¥ï¼š\n\næ¶æ„å‚æ•°ï¼šå…ˆç¡®å®šhidden_sizeå’Œdia_layers\nè®­ç»ƒå‚æ•°ï¼šå†è°ƒä¼˜learning_rateå’Œdropout\næ•°æ®å‚æ•°ï¼šæœ€åä¼˜åŒ–batch_sizeå’Œtime_seconds\n\næ€§èƒ½ç›‘æ§æŒ‡æ ‡ï¼š\n\nè®­ç»ƒæŒ‡æ ‡ï¼šæŸå¤±å‡½æ•°æ”¶æ•›æ›²çº¿ã€æ¢¯åº¦èŒƒæ•°\néªŒè¯æŒ‡æ ‡ï¼šå‡†ç¡®ç‡ã€F1åˆ†æ•°ã€æ··æ·†çŸ©é˜µ\næ•ˆç‡æŒ‡æ ‡ï¼šè®­ç»ƒæ—¶é—´ã€å†…å­˜å ç”¨ã€æ¨ç†é€Ÿåº¦\n\n\n5. æ¨¡å‹å·¥ä½œæœºåˆ¶æ·±å…¥ç†è§£5.1 è‡ªç›‘ç£é¢„è®­ç»ƒçš„æ·±å±‚ä»·å€¼HuBERTæ¨¡å‹çš„é¢„è®­ç»ƒæœºåˆ¶ä½“ç°äº†ç°ä»£è¯­éŸ³å¤„ç†çš„æ ¸å¿ƒæ€æƒ³ï¼š\næ©ç é¢„æµ‹ä»»åŠ¡çš„è®¾è®¡æ™ºæ…§ï¼š\n# HuBERTé¢„è®­ç»ƒä¼ªä»£ç ç¤ºä¾‹\nmasked_features = mask_features(input_features, mask_prob=0.15)\npredicted_features = hubert_model(masked_features)\nloss = mse_loss(predicted_features, target_features)\n\nå¤šå±‚æ¬¡ç‰¹å¾å­¦ä¹ æœºåˆ¶ï¼š\n\nå£°å­¦å±‚é¢ï¼šåº•å±‚Transformerå±‚å­¦ä¹ éŸ³ç´ ã€éŸ³è°ƒã€è¯­é€Ÿç­‰åŸºç¡€å£°å­¦ç‰¹å¾\nè¯­è¨€å±‚é¢ï¼šä¸­å±‚å­¦ä¹ è¯æ±‡è¾¹ç•Œã€è¯­æ³•ç»“æ„ã€è¯­ä¹‰å…³ç³»\néŸµå¾‹å±‚é¢ï¼šé«˜å±‚æ•è·èŠ‚å¥ã€é‡éŸ³ã€è¯­è°ƒå˜åŒ–ï¼Œè¿™äº›ç‰¹å¾ä¸æƒ…æ„Ÿè¡¨è¾¾å¯†åˆ‡ç›¸å…³\n\nè¿ç§»å­¦ä¹ çš„æœ‰æ•ˆæ€§ï¼š\n\né¢„è®­ç»ƒç‰¹å¾åŒ…å«ä¸°å¯Œçš„è¯­éŸ³é€šç”¨è¡¨ç¤º\nåœ¨æƒ…æ„Ÿè¯†åˆ«ä»»åŠ¡ä¸Šå¾®è°ƒæ—¶ï¼Œæ¨¡å‹èƒ½å¿«é€Ÿé€‚åº”ç‰¹å®šé¢†åŸŸç‰¹å¾\nç›¸æ¯”ä»é›¶è®­ç»ƒï¼Œæ˜¾è‘—å‡å°‘äº†æ‰€éœ€çš„æ ‡æ³¨æ•°æ®é‡\n\n5.2 åºåˆ—å»ºæ¨¡çš„æ—¶åºä¾èµ–æœºåˆ¶åŒå‘GRUçš„é—¨æ§æœºåˆ¶å®ç°äº†å¯¹æ—¶åºä¿¡æ¯çš„ç²¾ç¡®æ§åˆ¶ï¼š\né—¨æ§æœºåˆ¶çš„æ•°å­¦è¡¨è¾¾ï¼š\n# GRUé—¨æ§æœºåˆ¶ä¼ªä»£ç \nreset_gate = sigmoid(W_r @ [h_prev, x_t])\nupdate_gate = sigmoid(W_u @ [h_prev, x_t])\ncandidate_h = tanh(W_h @ [reset_gate * h_prev, x_t])\nh_t = (1 - update_gate) * h_prev + update_gate * candidate_h\n\nåŒå‘ä¿¡æ¯èåˆçš„ä¼˜åŠ¿ï¼š\n\nå‰å‘æµï¼šæ•è·ä»è¯­éŸ³å¼€å§‹åˆ°å½“å‰ä½ç½®çš„æƒ…æ„Ÿå‘å±•è¶‹åŠ¿\nåå‘æµï¼šåˆ©ç”¨æœªæ¥ä¿¡æ¯ä¸ºå½“å‰åˆ¤æ–­æä¾›ä¸Šä¸‹æ–‡çº¦æŸ\nä¿¡æ¯äº’è¡¥ï¼šå‰åå‘ä¿¡æ¯çš„ç»“åˆæä¾›äº†æ›´å…¨é¢çš„æ—¶åºè¡¨ç¤º\n\næƒ…æ„Ÿæ—¶åºæ¨¡å¼çš„å»ºæ¨¡ï¼š\n\næƒ…æ„Ÿèµ·ä¼ï¼šGRUèƒ½å¤Ÿè®°å¿†æƒ…æ„Ÿçš„å˜åŒ–è½¨è¿¹\nå…³é”®è½¬æŠ˜ï¼šé—¨æ§æœºåˆ¶è‡ªåŠ¨è¯†åˆ«æƒ…æ„Ÿè¡¨è¾¾çš„é‡è¦æ—¶åˆ»\nä¸Šä¸‹æ–‡ä¾èµ–ï¼šåŒå‘è®¾è®¡ç¡®ä¿æ¯ä¸ªæ—¶åˆ»éƒ½èƒ½è·å¾—å……åˆ†çš„ä¸Šä¸‹æ–‡ä¿¡æ¯\n\n5.3 æ³¨æ„åŠ›æœºåˆ¶çš„åŠ¨æ€èšç„¦åŸç†æ³¨æ„åŠ›æœºåˆ¶å®ç°äº†å¯¹åºåˆ—ä¿¡æ¯çš„æ™ºèƒ½é€‰æ‹©ï¼š\næ³¨æ„åŠ›æƒé‡çš„å­¦ä¹ æœºåˆ¶ï¼š\n# æ³¨æ„åŠ›æƒé‡è®¡ç®—çš„æ ¸å¿ƒé€»è¾‘\nsimilarity_scores = query @ keys.T  # è®¡ç®—ç›¸ä¼¼åº¦\nattention_weights = softmax(similarity_scores)  # å½’ä¸€åŒ–æƒé‡\nattended_features = attention_weights @ values  # åŠ æƒèšåˆ\n\nåŠ¨æ€èšç„¦çš„å®ç°åŸç†ï¼š\n\næŸ¥è¯¢é©±åŠ¨ï¼šæ¯ä¸ªæ—¶é—´æ­¥ä½œä¸ºæŸ¥è¯¢ï¼ŒåŠ¨æ€å…³æ³¨æ•´ä¸ªåºåˆ—\nç›¸ä¼¼åº¦åŒ¹é…ï¼šå­¦ä¹ åˆ°çš„å˜æ¢çŸ©é˜µæ•è·æŸ¥è¯¢ä¸é”®çš„åŒ¹é…æ¨¡å¼\nè‡ªé€‚åº”æƒé‡ï¼šä¸åŒæƒ…æ„Ÿç±»åˆ«ä¸‹çš„æ³¨æ„åŠ›æ¨¡å¼è‡ªåŠ¨åˆ†åŒ–\n\næƒ…æ„Ÿå…³é”®ä¿¡æ¯çš„è¯†åˆ«ï¼š\n\néŸµå¾‹é‡ç‚¹ï¼šè‡ªåŠ¨å…³æ³¨è¯­è°ƒå˜åŒ–å‰§çƒˆçš„æ—¶é—´æ®µ\nè¯­ä¹‰å…³é”®è¯ï¼šèšç„¦äºå¸¦æœ‰å¼ºæƒ…æ„Ÿè‰²å½©çš„è¯æ±‡\nåœé¡¿æ¨¡å¼ï¼šè¯†åˆ«æƒ…æ„Ÿè¡¨è¾¾ä¸­çš„åœé¡¿å’ŒèŠ‚å¥å˜åŒ–\n\n5.4 å…¨å±€æ± åŒ–çš„ä¿¡æ¯èšåˆç­–ç•¥æœ€å¤§æ± åŒ–æ“ä½œå®ç°äº†ä»åºåˆ—åˆ°å…¨å±€ç‰¹å¾çš„è½¬æ¢ï¼š\næœ€å¤§æ± åŒ–çš„é€‰æ‹©rationaleï¼š\n# æœ€å¤§æ± åŒ– vs å¹³å‡æ± åŒ–çš„å¯¹æ¯”\nmax_pooled = F.max_pool1d(features, kernel_size=seq_len)  # ä¿ç•™æœ€å¼ºä¿¡å·\navg_pooled = F.avg_pool1d(features, kernel_size=seq_len)  # å¹³å‡æ‰€æœ‰ä¿¡å·\n\næƒ…æ„Ÿè¯†åˆ«ä¸­çš„ä¼˜åŠ¿ï¼š\n\næ˜¾è‘—æ€§ä¿ç•™ï¼šæœ€å¤§æ± åŒ–ä¿ç•™æœ€å¼ºçš„æƒ…æ„Ÿæ¿€æ´»ä¿¡å·\nå™ªå£°æŠ‘åˆ¶ï¼šå¿½ç•¥å¼±æ¿€æ´»çš„å™ªå£°ä¿¡æ¯\nä¸å˜æ€§ï¼šå¯¹åºåˆ—é•¿åº¦å˜åŒ–å…·æœ‰ä¸€å®šçš„é²æ£’æ€§\n\n\n6. ç³»ç»Ÿä¼˜åŠ¿ä¸æŠ€æœ¯åˆ›æ–°6.1 ç«¯åˆ°ç«¯å­¦ä¹ èŒƒå¼çš„æŠ€æœ¯çªç ´ä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§ï¼š\n\næ‰‹å·¥ç‰¹å¾è®¾è®¡ä¾èµ–é¢†åŸŸä¸“å®¶çŸ¥è¯†\nç‰¹å¾æå–ä¸åˆ†ç±»å™¨åˆ†ç¦»è®­ç»ƒï¼Œæ— æ³•å®ç°å…¨å±€ä¼˜åŒ–\nç‰¹å¾è¡¨è¾¾èƒ½åŠ›å—é™äºäººå·¥è®¾è®¡çš„æƒ³è±¡åŠ›\n\nç«¯åˆ°ç«¯å­¦ä¹ çš„ä¼˜åŠ¿ï¼š\n\nè‡ªåŠ¨ç‰¹å¾å­¦ä¹ ï¼šæ¨¡å‹è‡ªåŠ¨å‘ç°æœ€ä¼˜çš„ç‰¹å¾è¡¨ç¤º\nå…¨å±€ä¼˜åŒ–ï¼šä»åŸå§‹è¾“å…¥åˆ°æœ€ç»ˆè¾“å‡ºçš„è”åˆä¼˜åŒ–\né€‚åº”æ€§å¼ºï¼šèƒ½å¤Ÿé€‚åº”ä¸åŒçš„æ•°æ®åˆ†å¸ƒå’Œä»»åŠ¡éœ€æ±‚\n\n6.2 å¤šå±‚æ¬¡ç‰¹å¾èåˆçš„åˆ›æ–°è®¾è®¡ç‰¹å¾èåˆçš„å±‚æ¬¡ç»“æ„ï¼š\nHuBERTç‰¹å¾(768ç»´) â†’ GRUæ—¶åºå»ºæ¨¡(512ç»´) â†’ æ³¨æ„åŠ›å¢å¼º â†’ å…¨å±€æ± åŒ– â†’ åˆ†ç±»è¾“å‡º\n\nèåˆæœºåˆ¶çš„æŠ€æœ¯åˆ›æ–°ï¼š\n\nè¯­ä¹‰-æ—¶åºèåˆï¼šHuBERTçš„è¯­ä¹‰ç‰¹å¾ä¸GRUçš„æ—¶åºå»ºæ¨¡ç›¸ç»“åˆ\nå±€éƒ¨-å…¨å±€èåˆï¼šæ³¨æ„åŠ›æœºåˆ¶å®ç°å±€éƒ¨ç‰¹å¾ä¸å…¨å±€ä¸Šä¸‹æ–‡çš„èåˆ\né™æ€-åŠ¨æ€èåˆï¼šé™æ€çš„é¢„è®­ç»ƒç‰¹å¾ä¸åŠ¨æ€çš„åºåˆ—å»ºæ¨¡ç›¸ç»“åˆ\n\n6.3 æ³¨æ„åŠ›å¢å¼ºæœºåˆ¶çš„åŸåˆ›æ€§åº”ç”¨æ³¨æ„åŠ›æœºåˆ¶åœ¨è¯­éŸ³æƒ…æ„Ÿè¯†åˆ«ä¸­çš„åˆ›æ–°åº”ç”¨ï¼š\n\næ—¶åºæ³¨æ„åŠ›ï¼šé’ˆå¯¹è¯­éŸ³çš„æ—¶åºç‰¹æ€§è®¾è®¡çš„æ³¨æ„åŠ›æœºåˆ¶\næƒ…æ„Ÿèšç„¦ï¼šè‡ªåŠ¨è¯†åˆ«æƒ…æ„Ÿè¡¨è¾¾çš„å…³é”®æ—¶é—´æ®µ\nå¯è§£é‡Šæ€§ï¼šæ³¨æ„åŠ›æƒé‡æä¾›æ¨¡å‹å†³ç­–çš„å¯è§†åŒ–è§£é‡Š\n\n6.4 å·¥ç¨‹åŒ–éƒ¨ç½²çš„å…¨é¢è€ƒè™‘ç³»ç»Ÿå·¥ç¨‹åŒ–çš„å®Œæ•´æ€§ï¼š\n\næ¨¡å—åŒ–è®¾è®¡ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„ä¾¿äºç»´æŠ¤å’Œæ‰©å±•\nå®æ—¶å¤„ç†èƒ½åŠ›ï¼šæ”¯æŒéº¦å…‹é£å®æ—¶å½•éŸ³å’Œæƒ…æ„Ÿè¯†åˆ«\nç”¨æˆ·å‹å¥½ç•Œé¢ï¼šå®Œæ•´çš„PyQt5å›¾å½¢ç•Œé¢\nè·¨å¹³å°å…¼å®¹ï¼šæ”¯æŒä¸åŒæ“ä½œç³»ç»Ÿçš„éƒ¨ç½²\n\néƒ¨ç½²ä¼˜åŒ–çš„æŠ€æœ¯ç»†èŠ‚ï¼š\n\næ¨¡å‹å‹ç¼©ï¼šé€šè¿‡é‡åŒ–ç­‰æŠ€æœ¯å‡å°‘æ¨¡å‹å¤§å°\næ¨ç†åŠ é€Ÿï¼šGPUåŠ é€Ÿå’Œæ‰¹å¤„ç†ä¼˜åŒ–\nå†…å­˜ç®¡ç†ï¼šé«˜æ•ˆçš„éŸ³é¢‘ç¼“å†²å’Œç‰¹å¾ç¼“å­˜æœºåˆ¶\n\n6.5 è¯„ä¼°æ–¹æ³•çš„ç§‘å­¦æ€§5æŠ˜äº¤å‰éªŒè¯çš„ç»Ÿè®¡ä¸¥è°¨æ€§ï¼š\n\nç¡®ä¿ç»“æœçš„ç»Ÿè®¡æ˜¾è‘—æ€§å’Œå¯é‡ç°æ€§\né¿å…æ•°æ®åˆ’åˆ†å¶ç„¶æ€§å¯¹ç»“æœçš„å½±å“\næä¾›æ¨¡å‹æ³›åŒ–èƒ½åŠ›çš„å¯é ä¼°è®¡\n\nå¤šæŒ‡æ ‡è¯„ä¼°çš„å…¨é¢æ€§ï¼š\n\nå‡†ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°çš„ç»¼åˆè¯„ä¼°\næ··æ·†çŸ©é˜µåˆ†æå„ç±»åˆ«çš„è¯†åˆ«æ€§èƒ½\nç»Ÿè®¡æ£€éªŒç¡®ä¿ç»“æœçš„ç§‘å­¦æ€§\n\n\næ€»ç»“è¯¥IEMOCAPè¯­éŸ³æƒ…æ„Ÿè¯†åˆ«ç³»ç»Ÿå±•ç°äº†ç°ä»£æ·±åº¦å­¦ä¹ åœ¨è¯­éŸ³å¤„ç†é¢†åŸŸçš„å…ˆè¿›æŠ€æœ¯åº”ç”¨ã€‚é€šè¿‡HuBERTé¢„è®­ç»ƒæ¨¡å‹çš„å¼ºå¤§ç‰¹å¾æå–èƒ½åŠ›ã€åŒå‘GRUçš„ç²¾ç¡®æ—¶åºå»ºæ¨¡ã€æ³¨æ„åŠ›æœºåˆ¶çš„æ™ºèƒ½èšç„¦ï¼Œä»¥åŠå…¨å±€æ± åŒ–çš„æœ‰æ•ˆä¿¡æ¯èšåˆï¼Œç³»ç»Ÿå®ç°äº†ä»åŸå§‹éŸ³é¢‘åˆ°æƒ…æ„Ÿç±»åˆ«çš„ç«¯åˆ°ç«¯å­¦ä¹ ã€‚\nç³»ç»Ÿçš„æŠ€æœ¯åˆ›æ–°ä½“ç°åœ¨å¤šä¸ªæ–¹é¢ï¼šè‡ªç›‘ç£é¢„è®­ç»ƒä¸ä¸‹æ¸¸ä»»åŠ¡çš„æœ‰æ•ˆç»“åˆã€å¤šå±‚æ¬¡ç‰¹å¾çš„æ·±åº¦èåˆã€æ³¨æ„åŠ›æœºåˆ¶çš„åŸåˆ›æ€§åº”ç”¨ï¼Œä»¥åŠå·¥ç¨‹åŒ–éƒ¨ç½²çš„å…¨é¢è€ƒè™‘ã€‚è¿™äº›è®¾è®¡ä¸ä»…ä¿è¯äº†æ¨¡å‹çš„é«˜æ€§èƒ½ï¼Œä¹Ÿä¸ºå®é™…åº”ç”¨æä¾›äº†åšå®çš„æŠ€æœ¯åŸºç¡€ã€‚\né€šè¿‡æ·±å…¥çš„æºç åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥ç³»ç»Ÿä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯å®ç°ï¼Œæ›´æ˜¯å¯¹è¯­éŸ³æƒ…æ„Ÿè¯†åˆ«é¢†åŸŸå‰æ²¿æŠ€æœ¯çš„ç³»ç»Ÿæ€§æ•´åˆå’Œåˆ›æ–°æ€§åº”ç”¨ã€‚å®ƒä¸ºç›¸å…³ç ”ç©¶å’Œåº”ç”¨å¼€å‘æä¾›äº†å®è´µçš„å‚è€ƒå’Œå€Ÿé‰´ä»·å€¼ã€‚\n","categories":["è‡ªç„¶è¯­è¨€å¤„ç†"],"tags":["GRUç»“æ„"]},{"title":"åŸºäºDjango+Vueçš„å©šå§»æ³•çŸ¥è¯†å›¾è°±é—®ç­”ç³»ç»Ÿ","url":"/2025/06/15/%E5%A9%9A%E6%81%8B%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/","content":"æœ¬é¡¹ç›®æ„å»ºäº†ä¸€ä¸ªé›†ç”¨æˆ·ç®¡ç†ã€å†…å®¹å‘å¸ƒã€æ™ºèƒ½æ¨èã€æ¶ˆæ¯äº¤äº’äºä¸€ä½“çš„ç°ä»£åŒ–å©šæ‹å¹³å°ã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œåç«¯åŸºäºDjango RESTful APIï¼Œå‰ç«¯é‡‡ç”¨Vue.js+Element UIï¼Œå¹¶é›†æˆNeo4jå›¾æ•°æ®åº“å’Œç™¾åº¦AIæœåŠ¡ï¼Œå®ç°äº†æ™ºèƒ½åŒ–çš„ç”¨æˆ·åŒ¹é…å’Œå†…å®¹æ¨èåŠŸèƒ½ã€‚\n\n\næŠ€æœ¯æ¶æ„è®¾è®¡æ•´ä½“æ¶æ„ç³»ç»Ÿé‡‡ç”¨ç»å…¸çš„ä¸‰å±‚æ¶æ„æ¨¡å¼ï¼Œç»“åˆå¾®æœåŠ¡æ€æƒ³è¿›è¡Œæ¨¡å—åŒ–è®¾è®¡ï¼š\n\nè¡¨ç°å±‚ï¼šVue.js + Element UI å“åº”å¼å‰ç«¯ç•Œé¢\nä¸šåŠ¡é€»è¾‘å±‚ï¼šDjango RESTful API æœåŠ¡å±‚\næ•°æ®æŒä¹…å±‚ï¼šMySQL + Neo4j æ··åˆæ•°æ®åº“æ¶æ„\n\næ ¸å¿ƒæŠ€æœ¯æ ˆåç«¯æŠ€æœ¯æ ˆï¼š\n\nDjango 2.2.8 - Webæ¡†æ¶\nMySQL - å…³ç³»å‹æ•°æ®åº“\nNeo4j - å›¾æ•°æ®åº“\nJWT - èº«ä»½è®¤è¯\nç™¾åº¦AI API - æ™ºèƒ½é—®ç­”\n\nå‰ç«¯æŠ€æœ¯æ ˆï¼š\n\nVue.js 2.6.11 - å‰ç«¯æ¡†æ¶\nElement UI 2.15.6 - UIç»„ä»¶åº“\nVue Router 3.5.2 - è·¯ç”±ç®¡ç†\nAxios 0.21.1 - HTTPå®¢æˆ·ç«¯\nECharts 4.8.0 - æ•°æ®å¯è§†åŒ–\n\næ ¸å¿ƒåŠŸèƒ½æ¨¡å—1. ç”¨æˆ·ç®¡ç†ç³»ç»Ÿæ•°æ®æ¨¡å‹è®¾è®¡class User(models.Model):\n    uid = models.CharField(max_length=64, default=uuid.uuid4())  # ç”¨æˆ·å”¯ä¸€æ ‡è¯†\n    name = models.CharField(max_length=64)                      # ç”¨æˆ·å§“å\n    username = models.CharField(max_length=64)                   # ç”¨æˆ·å\n    password = models.CharField(max_length=64)                   # åŠ å¯†å¯†ç \n    gender = models.CharField(max_length=64)                      # æ€§åˆ«\n    role = models.CharField(max_length=64)                       # ç”¨æˆ·è§’è‰²\n    image = models.CharField(max_length=1024)                    # å¤´åƒURL\n    age = models.IntegerField()                                  # å¹´é¾„\n    mobile = models.CharField(max_length=64)                     # æ‰‹æœºå·\n    email = models.CharField(max_length=64)                      # é‚®ç®±\n    description = models.CharField(max_length=1024)              # ä¸ªäººæè¿°\n    deleted = models.IntegerField(default=0)                     # è½¯åˆ é™¤æ ‡è®°\n    createDate = models.DateField(auto_now_add=True)             # åˆ›å»ºæ—¶é—´\n    updateDate = models.DateField(auto_now_add=True)             # æ›´æ–°æ—¶é—´\n    operator = models.CharField(max_length=64)                   # æ“ä½œå‘˜\n\n    class Meta:\n        ordering = ['createDate']\n        db_table = 'python_marry_user'\n\nå®‰å…¨è®¤è¯æœºåˆ¶def validate_service(request):\n    \"\"\"ç”¨æˆ·ç™»å½•éªŒè¯æœåŠ¡\"\"\"\n    data = json.load(request)\n    username = data['username']\n    password = data['password']\n    \n    # MD5åŠ ç›åŠ å¯†\n    md5 = hashlib.md5(password.encode())\n    salt = \"$1$asd\"  # ç›å€¼\n    md5.update(salt.encode())\n    encrypted_data = md5.hexdigest()\n    \n    # ç”¨æˆ·éªŒè¯\n    _user = User.objects.filter(username=username, password=encrypted_data, deleted=0).first()\n    \n    if _user is not None:\n        # JWT Tokenç”Ÿæˆ\n        payload = &#123;\"username\": username&#125;\n        _token = jwt.encode(payload=payload, key=\"tk123\")\n        \n        return JsonResponse(&#123;\n            \"success\": \"true\",\n            \"message\": \"è¯·æ±‚æˆåŠŸ\",\n            \"returnCode\": \"200\",\n            \"returnData\": &#123;\n                \"logintoken\": _token,\n                \"user\": &#123;\n                    \"id\": _user.id,\n                    \"uid\": _user.uid,\n                    \"name\": _user.name,\n                    \"username\": _user.username,\n                    \"gender\": _user.gender,\n                    \"age\": _user.age,\n                    \"role\": _user.role,\n                    \"mobile\": _user.mobile,\n                    \"email\": _user.email,\n                    \"image\": _user.image\n                &#125;\n            &#125;\n        &#125;)\n\n2. å†…å®¹ç®¡ç†ç³»ç»Ÿå†…å®¹æ¨¡å‹è®¾è®¡class Content(models.Model):\n    uid = models.CharField(max_length=64, default=uuid.uuid4())\n    name = models.CharField(max_length=64)                       # å†…å®¹æ ‡é¢˜\n    classification = models.CharField(max_length=64)              # åˆ†ç±»ID\n    image = models.CharField(max_length=1024)                     # å°é¢å›¾ç‰‡\n    description = models.CharField(max_length=1024)               # å†…å®¹æè¿°\n    content = models.CharField(max_length=1024)                   # æ­£æ–‡å†…å®¹\n    deleted = models.IntegerField(default=0)                      # è½¯åˆ é™¤æ ‡è®°\n    createDate = models.DateField(auto_now_add=True)             # åˆ›å»ºæ—¶é—´\n    updateDate = models.DateField(auto_now_add=True)             # æ›´æ–°æ—¶é—´\n    operator = models.CharField(max_length=64)                   # æ“ä½œå‘˜\n\n    class Meta:\n        ordering = ['createDate']\n        db_table = 'python_marry_content'\n\nåˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–def content_list_service(request):\n    \"\"\"å†…å®¹åˆ—è¡¨æŸ¥è¯¢æœåŠ¡ - æ”¯æŒåˆ†é¡µå’Œå…³è”æŸ¥è¯¢\"\"\"\n    data = json.load(request)\n    _pageSize = data['pageSize']\n    _currentPage = data['currentPage']\n    \n    # åŸºç¡€æŸ¥è¯¢\n    list = Content.objects.filter(deleted=0)\n    _list = []\n    \n    # å…³è”æŸ¥è¯¢ä¼˜åŒ– - æ‰¹é‡è·å–åˆ†ç±»å’Œç”¨æˆ·ä¿¡æ¯\n    classificationList = Classification.objects.filter(deleted=0)\n    userList = User.objects.filter(deleted=0, role=2)\n    \n    # æ„å»ºæ˜ å°„å­—å…¸ï¼Œé¿å…N+1æŸ¥è¯¢é—®é¢˜\n    _classification_dict = &#123;&#125;\n    _user_dict = &#123;&#125;\n    \n    for item in classificationList:\n        _classification_dict[item.uid] = item.name\n    \n    for item in userList:\n        _user_dict[item.uid] = item.name\n    \n    # æ•°æ®ç»„è£…\n    for item in list:\n        rest = &#123;\n            'id': item.id,\n            'uid': item.uid,\n            'name': item.name,\n            'content': item.content,\n            'classification': item.classification,\n            'classificationName': _classification_dict.get(item.classification, ''),\n            'description': item.description,\n            'image': item.image,\n            'createDate': item.createDate.strftime('%Y-%m-%d') if item.createDate else ''\n        &#125;\n        _list.append(rest)\n    \n    # åˆ†é¡µé€»è¾‘\n    page = &#123;\n        \"pageSize\": _pageSize,\n        \"total\": len(_list),\n        \"currentPage\": _currentPage\n    &#125;\n    \n    if _pageSize &lt; len(_list):\n        _start = (_currentPage - 1) * _pageSize\n        _end = _currentPage * _pageSize\n        _list = _list[_start: _end]\n\n3. å›¾æ•°æ®åº“é›†æˆNeo4jå›¾æ•°æ®åº“è¿æ¥class MedicalGraph:\n    \"\"\"Neo4jå›¾æ•°æ®åº“è¿æ¥ç±»\"\"\"\n    def __init__(self):\n        # å›¾æ•°æ®åº“è¿æ¥é…ç½®\n        self.g = Graph(\"bolt://localhost:7687\", auth=(\"neo4j\", \"7508929hzq\"))\n    \n    def create_relationship(self, user1_id, user2_id, relationship_type):\n        \"\"\"åˆ›å»ºç”¨æˆ·å…³ç³»\"\"\"\n        query = \"\"\"\n        MATCH (u1:User &#123;id: $user1_id&#125;)\n        MATCH (u2:User &#123;id: $user2_id&#125;)\n        CREATE (u1)-[r:RELATIONSHIP_TYPE]->(u2)\n        RETURN r\n        \"\"\"\n        return self.g.run(query, user1_id=user1_id, user2_id=user2_id, \n                         RELATIONSHIP_TYPE=relationship_type)\n    \n    def find_recommendations(self, user_id, limit=10):\n        \"\"\"åŸºäºå›¾ç®—æ³•çš„ç”¨æˆ·æ¨è\"\"\"\n        query = \"\"\"\n        MATCH (u:User &#123;id: $user_id&#125;)-[r1:INTEREST]->(i:Interest)\n        MATCH (i)&lt;-[r2:INTEREST]-(other:User)\n        WHERE other.id &lt;> $user_id\n        RETURN other, count(*) as common_interests\n        ORDER BY common_interests DESC\n        LIMIT $limit\n        \"\"\"\n        return self.g.run(query, user_id=user_id, limit=limit)\n\n4. AIæ™ºèƒ½é—®ç­”é›†æˆç™¾åº¦AI APIé›†æˆdef query(message):\n    \"\"\"ç™¾åº¦AIæ™ºèƒ½é—®ç­”æ¥å£\"\"\"\n    url = \"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro?access_token=\" + get_access_token()\n    \n    payload = json.dumps(&#123;\n        \"messages\": [\n            &#123;\n                \"role\": \"user\",\n                \"content\": message\n            &#125;\n        ],\n        \"temperature\": 0.95,        # åˆ›é€ æ€§å‚æ•°\n        \"top_p\": 0.8,              # æ ¸é‡‡æ ·å‚æ•°\n        \"penalty_score\": 1,         # é‡å¤æƒ©ç½š\n        \"enable_system_memory\": False,\n        \"disable_search\": False,\n        \"enable_citation\": False\n    &#125;)\n    \n    headers = &#123;'Content-Type': 'application/json'&#125;\n    response = requests.post(url, headers=headers, data=payload)\n    return response.json()\n\ndef get_access_token():\n    \"\"\"è·å–ç™¾åº¦AIè®¿é—®ä»¤ç‰Œ\"\"\"\n    url = \"https://aip.baidubce.com/oauth/2.0/token\"\n    params = &#123;\n        \"grant_type\": \"client_credentials\", \n        \"client_id\": API_KEY, \n        \"client_secret\": SECRET_KEY\n    &#125;\n    return str(requests.post(url, params=params).json().get(\"access_token\"))\n\n5. å‰ç«¯æ¶æ„è®¾è®¡Vueç»„ä»¶åŒ–å¼€å‘&lt;template&gt;\n  &lt;div id&#x3D;&quot;module&quot;&gt;\n    &lt;el-container&gt;\n      &lt;!-- å·¦ä¾§å¯¼èˆªç»„ä»¶ --&gt;\n      &lt;Nav &#x2F;&gt;\n      &lt;el-container&gt;\n        &lt;!-- é¡¶éƒ¨å¯¼èˆªæ  --&gt;\n        &lt;el-header style&#x3D;&quot;text-align: right; font-size: 12px&quot;&gt;\n          &lt;el-dropdown&gt;\n            &lt;i class&#x3D;&quot;el-icon-setting&quot; style&#x3D;&quot;margin-right: 15px;&quot;&gt;&lt;&#x2F;i&gt;\n            &lt;el-dropdown-menu slot&#x3D;&quot;dropdown&quot;&gt;\n              &lt;el-dropdown-item @click.native&#x3D;&quot;modifyPassword&quot;&gt;ä¿®æ”¹å¯†ç &lt;&#x2F;el-dropdown-item&gt;\n              &lt;el-dropdown-item @click.native&#x3D;&quot;logout&quot;&gt;é€€å‡ºç™»å½•&lt;&#x2F;el-dropdown-item&gt;\n            &lt;&#x2F;el-dropdown-menu&gt;\n          &lt;&#x2F;el-dropdown&gt;\n          &lt;span&gt;&#123;&#123;username&#125;&#125;&nbsp;&nbsp;&lt;&#x2F;span&gt;\n        &lt;&#x2F;el-header&gt;\n        &lt;!-- ä¸»ä½“å†…å®¹åŒºåŸŸ --&gt;\n        &lt;el-main&gt;\n          &lt;Breadcrumb &#x2F;&gt;\n          &lt;br &#x2F;&gt;\n          &lt;router-view &#x2F;&gt;\n        &lt;&#x2F;el-main&gt;\n      &lt;&#x2F;el-container&gt;\n    &lt;&#x2F;el-container&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script&gt;\nimport Nav from &quot;.&#x2F;Nav&quot;;\nimport Breadcrumb from &quot;.&#x2F;Breadcrumb&quot;;\nimport cryptoJs from &quot;crypto-js&quot;;\n\nexport default &#123;\n  name: &#39;Home&#39;,\n  components: &#123; Nav, Breadcrumb &#125;,\n  data() &#123;\n    return &#123;\n      key: &quot;rest@126.com&quot;,           &#x2F;&#x2F; åŠ å¯†å¯†é’¥\n      dialogFormVisible: false,      &#x2F;&#x2F; å¯¹è¯æ¡†æ˜¾ç¤ºçŠ¶æ€\n      username: &quot;&quot;,                  &#x2F;&#x2F; å½“å‰ç”¨æˆ·å\n      form: &#123;                        &#x2F;&#x2F; è¡¨å•æ•°æ®\n        oldPassword: &quot;&quot;,\n        newPassword: &quot;&quot;,\n        confirmPassword: &quot;&quot;,\n      &#125;,\n      formLabelWidth: &quot;120px&quot;,\n      user: &#123;&#125;\n    &#125;;\n  &#125;,\n  created() &#123;\n    &#x2F;&#x2F; ä»sessionStorageè·å–ç”¨æˆ·ä¿¡æ¯\n    this.username &#x3D; sessionStorage.getItem(&quot;username&quot;);\n    this.user &#x3D; JSON.parse(sessionStorage.getItem(&quot;user&quot;));\n  &#125;,\n  methods: &#123;\n    &#x2F;&#x2F; å¯†ç åŠ å¯†æ–¹æ³•\n    encryptDes(message) &#123;\n      const keyHex &#x3D; cryptoJs.enc.Utf8.parse(this.key);\n      const option &#x3D; &#123; \n        mode: cryptoJs.mode.ECB, \n        padding: cryptoJs.pad.Pkcs7 \n      &#125;;\n      const encrypted &#x3D; cryptoJs.DES.encrypt(message, keyHex, option);\n      return encrypted.toString();\n    &#125;,\n    \n    &#x2F;&#x2F; ç”¨æˆ·ç™»å‡º\n    logout() &#123;\n      sessionStorage.removeItem(&quot;username&quot;);\n      sessionStorage.removeItem(&quot;loginToken&quot;);\n      this.$router.push(&quot;&#x2F;login&quot;);\n    &#125;\n  &#125;\n&#125;;\n&lt;&#x2F;script&gt;\n\nç³»ç»Ÿæ¶æ„æµç¨‹å›¾graph TB\n    A[ç”¨æˆ·è¯·æ±‚] --> B[Vue.jså‰ç«¯]\n    B --> C[Axios HTTPè¯·æ±‚]\n    C --> D[Django RESTful API]\n    D --> E[ä¸šåŠ¡é€»è¾‘å±‚]\n    E --> F[æ•°æ®è®¿é—®å±‚]\n    F --> G[MySQLæ•°æ®åº“]\n    F --> H[Neo4jå›¾æ•°æ®åº“]\n    E --> I[ç™¾åº¦AIæœåŠ¡]\n    E --> J[æ–‡ä»¶ä¸Šä¼ æœåŠ¡]\n    D --> K[JWTè®¤è¯]\n    K --> L[å“åº”æ•°æ®]\n    L --> B\n    B --> M[Element UIæ¸²æŸ“]\n\næŠ€æœ¯äº®ç‚¹ä¸åˆ›æ–°1. æ··åˆæ•°æ®åº“æ¶æ„\nå…³ç³»å‹æ•°æ®åº“ï¼šå­˜å‚¨ç”¨æˆ·åŸºç¡€ä¿¡æ¯ã€å†…å®¹æ•°æ®ç­‰ç»“æ„åŒ–æ•°æ®\nå›¾æ•°æ®åº“ï¼šå¤„ç†ç”¨æˆ·å…³ç³»ã€å…´è¶£åŒ¹é…ã€æ¨èç®—æ³•ç­‰å¤æ‚å…³ç³»æ•°æ®\nä¼˜åŠ¿ï¼šå……åˆ†å‘æŒ¥ä¸¤ç§æ•°æ®åº“çš„ä¼˜åŠ¿ï¼Œå®ç°æ•°æ®çš„é«˜æ•ˆå­˜å‚¨å’ŒæŸ¥è¯¢\n\n2. æ™ºèƒ½æ¨èç®—æ³•def calculate_similarity_score(user1_interests, user2_interests):\n    \"\"\"è®¡ç®—ç”¨æˆ·å…´è¶£ç›¸ä¼¼åº¦\"\"\"\n    common_interests = set(user1_interests) &amp; set(user2_interests)\n    total_interests = set(user1_interests) | set(user2_interests)\n    \n    if len(total_interests) == 0:\n        return 0\n    \n    # Jaccardç›¸ä¼¼åº¦è®¡ç®—\n    similarity = len(common_interests) / len(total_interests)\n    return similarity * 100  # è½¬æ¢ä¸ºç™¾åˆ†æ¯”\n\n3. å®‰å…¨æœºåˆ¶è®¾è®¡\nå¯†ç åŠ å¯†ï¼šMD5åŠ ç›åŠ å¯†ï¼Œé˜²æ­¢å½©è™¹è¡¨æ”»å‡»\nJWTè®¤è¯ï¼šæ— çŠ¶æ€èº«ä»½éªŒè¯ï¼Œæ”¯æŒè·¨åŸŸè®¿é—®\nCORSé…ç½®ï¼šç²¾ç¡®æ§åˆ¶è·¨åŸŸè¯·æ±‚æ¥æº\nè½¯åˆ é™¤ï¼šæ•°æ®å®‰å…¨åˆ é™¤ï¼Œæ”¯æŒæ•°æ®æ¢å¤\n\n4. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥\nåˆ†é¡µæŸ¥è¯¢ï¼šé¿å…å¤§æ•°æ®é‡æŸ¥è¯¢å¯¼è‡´çš„æ€§èƒ½é—®é¢˜\nå…³è”æŸ¥è¯¢ä¼˜åŒ–ï¼šä½¿ç”¨å­—å…¸æ˜ å°„é¿å…N+1æŸ¥è¯¢é—®é¢˜\nç¼“å­˜æœºåˆ¶ï¼šå¯¹é¢‘ç¹æŸ¥è¯¢çš„æ•°æ®è¿›è¡Œç¼“å­˜\nå¼‚æ­¥å¤„ç†ï¼šAIæœåŠ¡è°ƒç”¨é‡‡ç”¨å¼‚æ­¥å¤„ç†\n\nç³»ç»Ÿä¼˜åŒ–å»ºè®®1. æ•°æ®åº“ä¼˜åŒ–# æ·»åŠ æ•°æ®åº“ç´¢å¼•\nclass User(models.Model):\n    # ... å…¶ä»–å­—æ®µ\n    class Meta:\n        indexes = [\n            models.Index(fields=['username']),\n            models.Index(fields=['mobile']),\n            models.Index(fields=['email']),\n            models.Index(fields=['deleted', 'createDate']),\n        ]\n\n2. ç¼“å­˜æœºåˆ¶from django.core.cache import cache\n\ndef get_user_by_id(user_id):\n    \"\"\"å¸¦ç¼“å­˜çš„ç”¨æˆ·æŸ¥è¯¢\"\"\"\n    cache_key = f\"user_&#123;user_id&#125;\"\n    user = cache.get(cache_key)\n    \n    if user is None:\n        user = User.objects.get(id=user_id)\n        cache.set(cache_key, user, 300)  # ç¼“å­˜5åˆ†é’Ÿ\n    \n    return user\n\n3. å¼‚æ­¥ä»»åŠ¡å¤„ç†from celery import Celery\n\napp = Celery('marry_system')\n\n@app.task\ndef send_recommendation_email(user_id, recommendations):\n    \"\"\"å¼‚æ­¥å‘é€æ¨èé‚®ä»¶\"\"\"\n    # é‚®ä»¶å‘é€é€»è¾‘\n    pass\n\n@app.task\ndef update_user_recommendations(user_id):\n    \"\"\"å¼‚æ­¥æ›´æ–°ç”¨æˆ·æ¨èåˆ—è¡¨\"\"\"\n    # æ¨èç®—æ³•è®¡ç®—\n    pass\n\nå­¦ä¹ æˆæœæ€»ç»“æŠ€æœ¯æŠ€èƒ½æå‡\nå…¨æ ˆå¼€å‘èƒ½åŠ›ï¼šæŒæ¡äº†Django+Vue.jså‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼\næ•°æ®åº“è®¾è®¡ï¼šå­¦ä¼šäº†å…³ç³»å‹æ•°æ®åº“ä¸å›¾æ•°æ®åº“çš„æ··åˆä½¿ç”¨\nAPIè®¾è®¡ï¼šæŒæ¡äº†RESTful APIçš„è®¾è®¡åŸåˆ™å’Œæœ€ä½³å®è·µ\nå®‰å…¨ç¼–ç¨‹ï¼šç†è§£äº†Webåº”ç”¨å®‰å…¨æœºåˆ¶å’ŒåŠ å¯†ç®—æ³•åº”ç”¨\næ€§èƒ½ä¼˜åŒ–ï¼šå­¦ä¼šäº†æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–å’Œç¼“å­˜æœºåˆ¶è®¾è®¡\n\nç³»ç»Ÿè®¾è®¡äº®ç‚¹\næ¨¡å—åŒ–æ¶æ„ï¼šé‡‡ç”¨æœåŠ¡å±‚æ¨¡å¼ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤\næ™ºèƒ½æ¨èï¼šé›†æˆå›¾æ•°æ®åº“å’ŒAIæœåŠ¡ï¼Œå®ç°æ™ºèƒ½åŒ–ç”¨æˆ·åŒ¹é…\nå®‰å…¨å¯é ï¼šå®Œå–„çš„è®¤è¯æˆæƒæœºåˆ¶å’Œæ•°æ®åŠ å¯†ä¿æŠ¤\næ‰©å±•æ€§å¼ºï¼šæ¨¡å—åŒ–è®¾è®¡æ”¯æŒåŠŸèƒ½å¿«é€Ÿæ‰©å±•\nç”¨æˆ·ä½“éªŒï¼šå“åº”å¼å‰ç«¯è®¾è®¡ï¼Œæä¾›è‰¯å¥½çš„äº¤äº’ä½“éªŒ\n\né¡¹ç›®ä»·å€¼æœ¬ç³»ç»Ÿä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯å®è·µé¡¹ç›®ï¼Œæ›´æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçº§åº”ç”¨è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæ·±å…¥ç†è§£äº†ç°ä»£Webåº”ç”¨çš„æ¶æ„è®¾è®¡ã€æ•°æ®åº“ä¼˜åŒ–ã€å®‰å…¨æœºåˆ¶ç­‰æ ¸å¿ƒæŠ€æœ¯ï¼Œä¸ºåç»­çš„å¤§å‹é¡¹ç›®å¼€å‘å¥ å®šäº†åšå®åŸºç¡€ã€‚\nç³»ç»Ÿé‡‡ç”¨çš„æŠ€æœ¯æ ˆå’Œæ¶æ„æ¨¡å¼éƒ½æ˜¯å½“å‰ä¸šç•Œçš„ä¸»æµé€‰æ‹©ï¼Œå…·æœ‰å¾ˆå¼ºçš„å®ç”¨æ€§å’Œå­¦ä¹ ä»·å€¼ã€‚ç‰¹åˆ«æ˜¯å›¾æ•°æ®åº“å’ŒAIæœåŠ¡çš„é›†æˆåº”ç”¨ï¼Œä½“ç°äº†ç°ä»£Webåº”ç”¨å‘æ™ºèƒ½åŒ–æ–¹å‘å‘å±•çš„è¶‹åŠ¿ã€‚\n","categories":["æŠ€æœ¯åˆ†äº«","å…¨æ ˆå¼€å‘"],"tags":["Vue.js","Django","å›¾æ•°æ®åº“","äººå·¥æ™ºèƒ½","ç³»ç»Ÿæ¶æ„","å‰åç«¯åˆ†ç¦»"]},{"title":"åŸºäºmT5æ¨¡å‹çš„å¿ƒç†é—®é¢˜é—®ç­”ç³»ç»Ÿè®¾è®¡ä¸å®ç°","url":"/2024/12/19/%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2-%E5%BF%83%E7%90%86%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F/","content":"ç³»ç»Ÿæ¦‚è¿°æœ¬é¡¹ç›®æ„å»ºäº†ä¸€ä¸ªåŸºäºmT5å¤šè¯­è¨€Transformerçš„å¿ƒç†é—®ç­”ç³»ç»Ÿï¼Œèåˆäº†çŸ¥è¯†å›¾è°±ã€å¤§è¯­è¨€æ¨¡å‹APIçš„å¤šå±‚å“åº”ç­–ç•¥ã€‚ç³»ç»Ÿé€šè¿‡promptå¼•å¯¼çš„åºåˆ—åˆ°åºåˆ—å­¦ä¹ ï¼Œå®ç°äº†å¯¹å¿ƒç†ç–¾ç—…ç›¸å…³é—®é¢˜çš„æ™ºèƒ½å›ç­”ï¼Œå¹¶å…·å¤‡å¤šè½®å¯¹è¯ã€ä¸Šä¸‹æ–‡è®°å¿†ç­‰é«˜çº§åŠŸèƒ½ã€‚\n\n\næ ¸å¿ƒæŠ€æœ¯æ¶æ„1. å¤šå±‚çº§å“åº”ç­–ç•¥ç³»ç»Ÿé‡‡ç”¨ä¸‰å±‚å“åº”æœºåˆ¶ï¼Œç¡®ä¿é—®é¢˜å¾—åˆ°å‡†ç¡®å›ç­”ï¼š\ndef process_question(self, question, is_repeat=False):\n    \"\"\"ä¸‰å±‚å“åº”ç­–ç•¥ï¼šè®­ç»ƒæ¨¡å‹ â†’ çŸ¥è¯†å›¾è°± â†’ å¤§è¯­è¨€æ¨¡å‹API\"\"\"\n    # 1. ä¼˜å…ˆä½¿ç”¨è®­ç»ƒå¥½çš„mT5æ¨¡å‹\n    if self.qa_model:\n        try:\n            model_answer = self.qa_model.predict(question)\n            if model_answer and model_answer != \"æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ— æ³•å›ç­”è¿™ä¸ªé—®é¢˜ã€‚\":\n                return model_answer\n        except Exception as e:\n            print(f\"æ¨¡å‹é¢„æµ‹å‡ºé”™: &#123;str(e)&#125;\")\n    \n    # 2. çŸ¥è¯†å›¾è°±æŸ¥è¯¢ä½œä¸ºå¤‡é€‰\n    try:\n        res_classify = self.classifier.classify(question)\n        if res_classify:\n            res_sql = self.parser.parser_main(res_classify)\n            if res_sql:\n                final_answers = self.searcher.search_main(res_sql)\n                if final_answers:\n                    return '\\n'.join(final_answers)\n    except Exception as e:\n        print(f\"çŸ¥è¯†å›¾è°±æŸ¥è¯¢å‡ºé”™: &#123;str(e)&#125;\")\n    \n    # 3. æ˜Ÿç«å¤§æ¨¡å‹APIå…œåº•\n    try:\n        llm_answer = self.call_spark_api(question, is_repeat)\n        return llm_answer if llm_answer else default_answer\n    except Exception as e:\n        print(f\"è°ƒç”¨æ˜Ÿç«APIå‡ºé”™: &#123;str(e)&#125;\")\n        return default_answer\n\n2. Promptå¼•å¯¼çš„åºåˆ—åˆ°åºåˆ—å­¦ä¹ æ ¸å¿ƒåˆ›æ–°åœ¨äºä½¿ç”¨promptæ¨¡æ¿å¼•å¯¼mT5æ¨¡å‹å­¦ä¹ é—®ç­”ä»»åŠ¡ï¼š\nclass QADataset(Dataset):\n    def __getitem__(self, idx):\n        qa_pair = self.qa_pairs[idx]\n        question = qa_pair['question']\n        answer = qa_pair['answer']\n        # å…³é”®ï¼šä½¿ç”¨promptæ¨¡æ¿å¼•å¯¼æ¨¡å‹å­¦ä¹ \n        prompt = f\"é—®é¢˜ï¼š&#123;question&#125; å›ç­”ï¼š\"\n        \n        input_enc = self.tokenizer(\n            prompt, max_length=self.max_input_len, \n            truncation=True, padding='max_length', return_tensors='pt'\n        )\n        label_enc = self.tokenizer(\n            answer, max_length=self.max_output_len, \n            truncation=True, padding='max_length', return_tensors='pt'\n        )\n        labels = label_enc['input_ids'].squeeze()\n        labels[labels == self.tokenizer.pad_token_id] = -100  # å¿½ç•¥pad token\n        \n        return &#123;\n            'input_ids': input_enc['input_ids'].squeeze(),\n            'attention_mask': input_enc['attention_mask'].squeeze(),\n            'labels': labels,\n            'prompt': prompt  # ä¿å­˜promptç”¨äºéªŒè¯é›†æ¨ç†\n        &#125;\n\n3. è‡ªå®šä¹‰DataLoaderä¸æ‰¹å¤„ç†ä¼˜åŒ–è§£å†³éªŒè¯é›†æ¨ç†æ—¶promptä¸ºç©ºçš„å…³é”®æŠ€æœ¯ï¼š\ndef collate_fn(batch):\n    \"\"\"è‡ªå®šä¹‰æ‰¹å¤„ç†å‡½æ•°ï¼Œæ”¯æŒå­—ç¬¦ä¸²promptçš„æ‰¹å¤„ç†\"\"\"\n    input_ids = torch.stack([item['input_ids'] for item in batch])\n    attention_mask = torch.stack([item['attention_mask'] for item in batch])\n    labels = torch.stack([item['labels'] for item in batch])\n    prompts = [item['prompt'] for item in batch]  # å­—ç¬¦ä¸²åˆ—è¡¨\n    return &#123;\n        'input_ids': input_ids,\n        'attention_mask': attention_mask,\n        'labels': labels,\n        'prompt': prompts\n    &#125;\n\n# è®­ç»ƒæ—¶ä½¿ç”¨è‡ªå®šä¹‰collate_fn\ntrain_loader = DataLoader(\n    train_dataset, batch_size=batch_size, \n    shuffle=True, collate_fn=collate_fn\n)\n\n4. å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†å®ç°å¯¹è¯å†å²çš„æ™ºèƒ½ç®¡ç†ï¼š\ndef _update_history(self, question, answer):\n    \"\"\"æ›´æ–°å¯¹è¯å†å²ï¼Œæ”¯æŒå¤šè½®å¯¹è¯\"\"\"\n    self.conversation_history.append(&#123;\"role\": \"user\", \"content\": question&#125;)\n    self.conversation_history.append(&#123;\"role\": \"assistant\", \"content\": answer&#125;)\n\ndef call_spark_api(self, question, is_repeat=False):\n    \"\"\"æ„å»ºå®Œæ•´å¯¹è¯ä¸Šä¸‹æ–‡è°ƒç”¨å¤§æ¨¡å‹API\"\"\"\n    messages = [&#123;\n        \"role\": \"system\",\n        \"content\": \"ä½ æ˜¯ä¸€ä¸ªå…·å¤‡ä¸°å¯Œå¿ƒç†å­¦çŸ¥è¯†ã€å–„äºå€¾å¬çš„ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆ...\"\n    &#125;]\n    \n    # æ·»åŠ å†å²å¯¹è¯ä¸Šä¸‹æ–‡\n    if not is_repeat and self.conversation_history:\n        messages.extend(self.conversation_history)\n    \n    messages.append(&#123;\"role\": \"user\", \"content\": question&#125;)\n    \n    # è°ƒç”¨æ˜Ÿç«API\n    data = &#123;\n        \"model\": \"x1\",\n        \"messages\": messages,\n        \"temperature\": 0.7,\n        \"max_tokens\": 1024\n    &#125;\n\nè®­ç»ƒæµç¨‹ä¸å¯è§†åŒ–1. æ•°æ®é¢„å¤„ç†ä¸åˆ†å‰²def split_data(qa_pairs: List[Dict], test_size: float = 0.2):\n    \"\"\"æ‰‹åŠ¨å®ç°æ•°æ®åˆ†å‰²ï¼Œé¿å…sklearnç‰ˆæœ¬å†²çª\"\"\"\n    qa_pairs_shuffled = qa_pairs.copy()\n    random.shuffle(qa_pairs_shuffled)\n    \n    split_idx = int(len(qa_pairs_shuffled) * (1 - test_size))\n    train_data = qa_pairs_shuffled[:split_idx]\n    val_data = qa_pairs_shuffled[split_idx:]\n    \n    return train_data, val_data\n\n2. è®­ç»ƒè¿‡ç¨‹ç›‘æ§def train(self, train_data, val_data, epochs=3, batch_size=8, lr=2e-5):\n    \"\"\"è®­ç»ƒè¿‡ç¨‹åŒ…å«æŸå¤±è®¡ç®—ã€éªŒè¯è¯„ä¼°ã€æŒ‡æ ‡è®°å½•\"\"\"\n    history = &#123;\n        'train_loss': [],\n        'val_loss': [],\n        'accuracy': [],\n        'f1_scores': []\n    &#125;\n    \n    for epoch in range(epochs):\n        # è®­ç»ƒé˜¶æ®µ\n        self.model.train()\n        for batch in tqdm(train_loader, desc=f\"è®­ç»ƒ Epoch &#123;epoch+1&#125;\"):\n            outputs = self.model(\n                input_ids=batch['input_ids'],\n                attention_mask=batch['attention_mask'],\n                labels=batch['labels']\n            )\n            loss = outputs.loss\n            optimizer.zero_grad()\n            loss.backward()\n            optimizer.step()\n        \n        # éªŒè¯é˜¶æ®µ\n        self.model.eval()\n        with torch.no_grad():\n            for batch in val_loader:\n                # ä½¿ç”¨batch['prompt']è¿›è¡Œæ¨ç†\n                prompts = batch['prompt']\n                input_enc = self.tokenizer(prompts, ...)\n                generated_ids = self.model.generate(...)\n\n3. è®­ç»ƒæŒ‡æ ‡å¯è§†åŒ–def plot_metrics(metrics: Dict[str, List[float]], output_dir: str):\n    \"\"\"ç”Ÿæˆè®­ç»ƒè¿‡ç¨‹çš„å¯è§†åŒ–å›¾è¡¨\"\"\"\n    # æŸå¤±æ›²çº¿\n    plt.figure(figsize=(10, 6))\n    epochs = range(1, len(metrics['train_loss']) + 1)\n    plt.plot(epochs, metrics['train_loss'], 'b-', label='è®­ç»ƒæŸå¤±')\n    plt.plot(epochs, metrics['val_loss'], 'r-', label='éªŒè¯æŸå¤±')\n    plt.title('è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±å˜åŒ–')\n    plt.savefig(os.path.join(output_dir, 'loss_history.png'))\n    \n    # å‡†ç¡®ç‡å’ŒF1åˆ†æ•°æ›²çº¿\n    plt.plot(epochs, metrics['accuracy'], 'g-', label='å‡†ç¡®ç‡')\n    plt.plot(epochs, metrics['f1_scores'], 'm-', label='F1åˆ†æ•°')\n\nç³»ç»Ÿä¼˜åŒ–ä¸äº®ç‚¹1. æŠ€æœ¯äº®ç‚¹\nPromptå·¥ç¨‹ä¼˜åŒ–ï¼šé€šè¿‡â€é—®é¢˜ï¼šxxx å›ç­”ï¼šâ€æ¨¡æ¿å¼•å¯¼mT5å­¦ä¹ ä¸­æ–‡é—®ç­”ä»»åŠ¡\nå¤šæ¨¡æ€èåˆï¼šç»“åˆè®­ç»ƒæ¨¡å‹ã€çŸ¥è¯†å›¾è°±ã€å¤§è¯­è¨€æ¨¡å‹çš„ä¸‰å±‚å“åº”æœºåˆ¶\nä¸Šä¸‹æ–‡è®°å¿†ï¼šæ”¯æŒå¤šè½®å¯¹è¯ï¼Œç»´æŠ¤å®Œæ•´çš„å¯¹è¯å†å²\né”™è¯¯å®¹é”™ï¼šæ¯å±‚éƒ½æœ‰å¼‚å¸¸å¤„ç†ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§\n\n2. æ€§èƒ½ä¼˜åŒ–\næ‰¹å¤„ç†ä¼˜åŒ–ï¼šè‡ªå®šä¹‰collate_fnè§£å†³å­—ç¬¦ä¸²promptæ‰¹å¤„ç†é—®é¢˜\nå†…å­˜ç®¡ç†ï¼šåˆç†è®¾ç½®max_lengthï¼Œé¿å…æ˜¾å­˜æº¢å‡º\næ¨ç†åŠ é€Ÿï¼šä½¿ç”¨beam searchå’Œearly stoppingä¼˜åŒ–ç”Ÿæˆè´¨é‡\n\n3. å¯æ‰©å±•æ€§è®¾è®¡\næ¨¡å—åŒ–æ¶æ„ï¼šQAæ¨¡å‹ã€çŸ¥è¯†å›¾è°±ã€APIè°ƒç”¨ç›¸äº’ç‹¬ç«‹\né…ç½®çµæ´»ï¼šæ”¯æŒä¸åŒæ¨¡å‹è·¯å¾„ã€å‚æ•°è°ƒæ•´\næ¥å£ç»Ÿä¸€ï¼šchat_mainæ–¹æ³•æä¾›ç»Ÿä¸€çš„å¯¹è¯æ¥å£\n\nå­¦ä¹ æˆæœä¸æŠ€èƒ½æå‡æ ¸å¿ƒæŠ€æœ¯æŒæ¡\nTransformeræ¶æ„æ·±å…¥ç†è§£\n\nmT5å¤šè¯­è¨€æ¨¡å‹çš„fine-tuningæŠ€æœ¯\nåºåˆ—åˆ°åºåˆ—å­¦ä¹ çš„promptå·¥ç¨‹\næ³¨æ„åŠ›æœºåˆ¶åœ¨é—®ç­”ä»»åŠ¡ä¸­çš„åº”ç”¨\n\n\nPyTorchæ·±åº¦å­¦ä¹ æ¡†æ¶\n\nè‡ªå®šä¹‰Datasetå’ŒDataLoaderå®ç°\næ‰¹å¤„ç†å‡½æ•°çš„ä¼˜åŒ–è®¾è®¡\nè®­ç»ƒå¾ªç¯çš„ç²¾ç»†åŒ–æ§åˆ¶\n\n\nNLPä»»åŠ¡å·¥ç¨‹åŒ–\n\nä¸­æ–‡tokenizationå’Œç¼–ç å¤„ç†\né—®ç­”å¯¹æ•°æ®çš„é¢„å¤„ç†å’Œå¢å¼º\nè¯„ä¼°æŒ‡æ ‡çš„è®¡ç®—å’Œå¯è§†åŒ–\n\n\nç³»ç»Ÿæ¶æ„è®¾è®¡\n\nå¤šå±‚å“åº”ç­–ç•¥çš„æ¶æ„è®¾è®¡\nå¼‚å¸¸å¤„ç†å’Œå®¹é”™æœºåˆ¶\næ¨¡å—åŒ–ä»£ç ç»„ç»‡\n\n\n\né¡¹ç›®äº®ç‚¹\nåˆ›æ–°æ€§ï¼šé¦–æ¬¡å°†promptå¼•å¯¼åº”ç”¨äºå¿ƒç†é—®ç­”é¢†åŸŸ\nå®ç”¨æ€§ï¼šä¸‰å±‚å“åº”æœºåˆ¶ç¡®ä¿é—®é¢˜å¾—åˆ°å‡†ç¡®å›ç­”\nå¯ç»´æŠ¤æ€§ï¼šæ¸…æ™°çš„æ¨¡å—åˆ’åˆ†å’Œé”™è¯¯å¤„ç†\nå¯æ‰©å±•æ€§ï¼šæ”¯æŒæ–°æ¨¡å‹ã€æ–°æ•°æ®æºçš„æ¥å…¥\n\nç³»ç»Ÿæ¶æ„å›¾ç”¨æˆ·é—®é¢˜è¾“å…¥\n    â†“\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   ChatBotGraph  â”‚\nâ”‚   (ä¸»æ§åˆ¶å™¨)     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    â†“\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   PsychQAModel  â”‚    â”‚   çŸ¥è¯†å›¾è°±æŸ¥è¯¢    â”‚    â”‚   æ˜Ÿç«APIè°ƒç”¨   â”‚\nâ”‚   (è®­ç»ƒæ¨¡å‹)     â”‚    â”‚   (Neo4j)       â”‚    â”‚   (å¤§è¯­è¨€æ¨¡å‹)  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    â†“                        â†“                        â†“\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚              å¤šå±‚çº§å“åº”ç­–ç•¥                                  â”‚\nâ”‚  1. ä¼˜å…ˆä½¿ç”¨è®­ç»ƒæ¨¡å‹ 2. çŸ¥è¯†å›¾è°±æŸ¥è¯¢ 3. APIå…œåº•            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    â†“\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   æ™ºèƒ½å›ç­”è¾“å‡º   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\næ€»ç»“æœ¬é¡¹ç›®æˆåŠŸæ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æŠ€æœ¯å…ˆè¿›çš„å¿ƒç†é—®ç­”ç³»ç»Ÿã€‚é€šè¿‡promptå¼•å¯¼çš„mT5æ¨¡å‹è®­ç»ƒã€å¤šå±‚å“åº”ç­–ç•¥è®¾è®¡ã€ä»¥åŠå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå®ç°äº†å¯¹å¿ƒç†ç–¾ç—…ç›¸å…³é—®é¢˜çš„æ™ºèƒ½å›ç­”ã€‚é¡¹ç›®ä¸ä»…å±•ç¤ºäº†æ·±åº¦å­¦ä¹ åœ¨NLPé¢†åŸŸçš„åº”ç”¨ï¼Œæ›´ä½“ç°äº†ç³»ç»Ÿå·¥ç¨‹æ€ç»´åœ¨AIåº”ç”¨å¼€å‘ä¸­çš„é‡è¦æ€§ã€‚\næ ¸å¿ƒä»·å€¼ï¼šå°†å‰æ²¿çš„TransformeræŠ€æœ¯ä¸å®é™…åº”ç”¨åœºæ™¯ç»“åˆï¼Œä¸ºå¿ƒç†å¥åº·çš„æ™ºèƒ½åŒ–æœåŠ¡æä¾›äº†æŠ€æœ¯æ”¯æ’‘ï¼Œå…·æœ‰é‡è¦çš„å­¦æœ¯ä»·å€¼å’Œå®ç”¨æ„ä¹‰ã€‚\n","categories":["æ·±åº¦å­¦ä¹ ","NLP","é—®ç­”ç³»ç»Ÿ"],"tags":["mT5","å¿ƒç†é—®ç­”","çŸ¥è¯†å›¾è°±","å¤šæ¨¡æ€å¯¹è¯","ä¸­æ–‡NLP"]},{"title":"YOLOv8æµ·å…³é›†è£…ç®±é“…å°é”è¯†åˆ«ç³»ç»Ÿè®¾è®¡ä¸å®ç°","url":"/2024/12/19/%E6%B5%B7%E5%85%B3%E9%9B%86%E8%A3%85%E7%AE%B1%E9%93%85%E5%B0%81%E9%94%81%E8%AF%86%E5%88%AB%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/","content":"æ¨¡å‹æµ·å…³é›†è£…ç®±é“…å°é”è¯†åˆ«\n\n\næµ·å…³é›†è£…ç®±é“…å°é”è¯†åˆ«ç³»ç»Ÿè®¾è®¡ä¸å®ç°ç³»ç»Ÿæ¦‚è¿°æœ¬ç³»ç»ŸåŸºäºYOLOv8æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œç»“åˆPyQt5å›¾å½¢ç•Œé¢æŠ€æœ¯ï¼Œæ„å»ºäº†ä¸€å¥—å®Œæ•´çš„æµ·å…³é›†è£…ç®±é“…å°é”è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿã€‚ç³»ç»Ÿé‡‡ç”¨ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œèƒ½å¤Ÿå¯¹å›¾ç‰‡ã€è§†é¢‘å’Œå®æ—¶æ‘„åƒå¤´è¾“å…¥è¿›è¡Œé«˜ç²¾åº¦ç›®æ ‡æ£€æµ‹ï¼Œå®ç°é“…å°é”çš„è‡ªåŠ¨è¯†åˆ«ã€å®šä½å’Œç»“æœå¯è§†åŒ–å±•ç¤ºã€‚è¯¥ç³»ç»Ÿåœ¨æµ·å…³ç›‘ç®¡é¢†åŸŸå…·æœ‰é‡è¦çš„å®ç”¨ä»·å€¼ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡é›†è£…ç®±å®‰å…¨æ£€æŸ¥çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚\nç³»ç»Ÿæ¶æ„è®¾è®¡æ•´ä½“æ¶æ„ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¨¡å—åŒ–è®¾è®¡ï¼Œéµå¾ªè½¯ä»¶å·¥ç¨‹çš„æœ€ä½³å®è·µï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ¨¡å—ï¼š\n\næ¨¡å‹æ¨ç†æ¨¡å—ï¼šåŸºäºYOLOv8çš„ç›®æ ‡æ£€æµ‹å¼•æ“ï¼Œè´Ÿè´£æ·±åº¦å­¦ä¹ æ¨¡å‹çš„åŠ è½½ã€æ¨ç†å’Œç»“æœè§£æ\nç”¨æˆ·ç•Œé¢æ¨¡å—ï¼šPyQt5æ„å»ºçš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼Œæä¾›ç›´è§‚çš„äººæœºäº¤äº’ä½“éªŒ\nå›¾åƒå¤„ç†æ¨¡å—ï¼šOpenCVå›¾åƒé¢„å¤„ç†å’Œåå¤„ç†ï¼ŒåŒ…æ‹¬å›¾åƒå¢å¼ºã€æ ¼å¼è½¬æ¢å’Œå¯è§†åŒ–æ¸²æŸ“\næ•°æ®ç®¡ç†æ¨¡å—ï¼šæ£€æµ‹ç»“æœçš„å­˜å‚¨å’Œç®¡ç†ï¼Œæ”¯æŒå¤šç§æ•°æ®æ ¼å¼çš„å¯¼å…¥å¯¼å‡º\nå¤šçº¿ç¨‹å¤„ç†æ¨¡å—ï¼šå¼‚æ­¥è§†é¢‘å¤„ç†å’Œä¿å­˜ï¼Œç¡®ä¿ç•Œé¢å“åº”æ€§å’Œå¤„ç†æ•ˆç‡\né…ç½®ç®¡ç†æ¨¡å—ï¼šç³»ç»Ÿå‚æ•°å’Œæ¨¡å‹é…ç½®çš„ç»Ÿä¸€ç®¡ç†\nå¼‚å¸¸å¤„ç†æ¨¡å—ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†æœºåˆ¶\n\næŠ€æœ¯æ ˆ\næ·±åº¦å­¦ä¹ æ¡†æ¶ï¼šYOLOv8 (Ultralytics) - åŸºäºPyTorchçš„æœ€æ–°ç›®æ ‡æ£€æµ‹æ¶æ„\nå›¾å½¢ç•Œé¢ï¼šPyQt5 - è·¨å¹³å°GUIæ¡†æ¶ï¼Œæ”¯æŒä¸°å¯Œçš„ç•Œé¢ç»„ä»¶\nå›¾åƒå¤„ç†ï¼šOpenCV 4.6+, PIL - è®¡ç®—æœºè§†è§‰å’Œå›¾åƒå¤„ç†æ ¸å¿ƒåº“\næ•°æ®å¤„ç†ï¼šNumPy, Pandas - æ•°å€¼è®¡ç®—å’Œæ•°æ®åˆ†æ\nå­—ä½“æ¸²æŸ“ï¼šPIL ImageFont - æ”¯æŒä¸­æ–‡å­—ä½“çš„å›¾åƒæ ‡æ³¨\nå¤šçº¿ç¨‹ï¼šQThread, pyqtSignal - å¼‚æ­¥å¤„ç†å’Œçº¿ç¨‹é—´é€šä¿¡\né…ç½®ç®¡ç†ï¼šYAML, JSON - ç»“æ„åŒ–é…ç½®æ•°æ®ç®¡ç†\n\næ ¸å¿ƒåŠŸèƒ½å®ç°1. æ¨¡å‹åŠ è½½ä¸æ¨ç†æ¨¡å‹åˆå§‹åŒ–ç­–ç•¥# æ¨¡å‹åˆå§‹åŒ–ä¸é¢„åŠ è½½\ndef initMain(self):\n    \"\"\"\n    ç³»ç»Ÿåˆå§‹åŒ–æ–¹æ³•ï¼Œè´Ÿè´£æ¨¡å‹åŠ è½½å’Œèµ„æºå‡†å¤‡\n    é‡‡ç”¨é¢„åŠ è½½ç­–ç•¥ä¼˜åŒ–é¦–æ¬¡æ¨ç†æ€§èƒ½\n    \"\"\"\n    # åŠ è½½YOLOv8æ£€æµ‹æ¨¡å‹ï¼ŒæŒ‡å®šæ£€æµ‹ä»»åŠ¡ç±»å‹\n    self.model = YOLO(Config.model_path, task='detect')\n    \n    # æ¨¡å‹é¢„çƒ­ï¼šä½¿ç”¨å°å°ºå¯¸æµ‹è¯•å›¾åƒè¿›è¡Œé¢„åŠ è½½\n    # ç¡®ä¿æ¨¡å‹æƒé‡å®Œå…¨åŠ è½½åˆ°GPU/CPUå†…å­˜ä¸­\n    self.model(np.zeros((48, 48, 3)))\n    \n    # åŠ è½½ä¸­æ–‡å­—ä½“ç”¨äºæ£€æµ‹ç»“æœæ ‡æ³¨æ˜¾ç¤º\n    self.fontC = ImageFont.truetype(\"Font/platech.ttf\", 25, 0)\n    \n    # åˆå§‹åŒ–é¢œè‰²è°ƒè‰²æ¿ï¼Œæ”¯æŒå¤šç›®æ ‡å¯è§†åŒ–åŒºåˆ†\n    self.colors = tools.Colors()\n\næ¨ç†æ€§èƒ½ä¼˜åŒ–def optimize_inference(self, img):\n    \"\"\"\n    æ¨ç†æ€§èƒ½ä¼˜åŒ–æ–¹æ³•\n    åŒ…å«å›¾åƒé¢„å¤„ç†ã€æ¨¡å‹æ¨ç†å’Œåå¤„ç†ä¼˜åŒ–\n    \"\"\"\n    # å›¾åƒå°ºå¯¸æ ‡å‡†åŒ–ï¼Œæå‡æ¨ç†æ•ˆç‡\n    img_resized = cv2.resize(img, (640, 640))\n    \n    # æ‰¹å¤„ç†æ¨ç†ï¼Œæ”¯æŒå¤šå›¾åƒåŒæ—¶å¤„ç†\n    results = self.model(img_resized, batch=1)\n    \n    # ç»“æœåå¤„ç†ï¼šNMSéæå¤§å€¼æŠ‘åˆ¶\n    results = self.apply_nms(results)\n    \n    return results\n\næŠ€æœ¯äº®ç‚¹ï¼š\n\næ¨¡å‹é¢„åŠ è½½æœºåˆ¶ï¼šé€šè¿‡é¢„çƒ­å‡å°‘é¦–æ¬¡æ¨ç†å»¶è¿Ÿï¼Œæå‡ç”¨æˆ·ä½“éªŒ\nä¸­æ–‡å­—ä½“æ¸²æŸ“ï¼šæ”¯æŒä¸­æ–‡æ ‡æ³¨æ˜¾ç¤ºï¼Œæ»¡è¶³æœ¬åœŸåŒ–éœ€æ±‚\nåŠ¨æ€é¢œè‰²åˆ†é…ï¼šåŸºäºç›®æ ‡ç±»åˆ«è‡ªåŠ¨åˆ†é…é¢œè‰²ï¼Œç¡®ä¿å¯è§†åŒ–åŒºåˆ†åº¦\næ‰¹å¤„ç†ä¼˜åŒ–ï¼šæ”¯æŒæ‰¹é‡å›¾åƒå¤„ç†ï¼Œæå‡æ•´ä½“å¤„ç†æ•ˆç‡\nå†…å­˜ç®¡ç†ï¼šæ™ºèƒ½èµ„æºç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæ€§èƒ½ç“¶é¢ˆ\n\n2. å¤šæ¨¡æ€è¾“å…¥å¤„ç†å›¾ç‰‡æ£€æµ‹å®ç°def open_img(self):\n    \"\"\"\n    å•å¼ å›¾ç‰‡æ£€æµ‹å¤„ç†æ ¸å¿ƒæ–¹æ³•\n    å®ç°å®Œæ•´çš„æ£€æµ‹æµç¨‹ï¼šæ–‡ä»¶é€‰æ‹© -> æ¨¡å‹æ¨ç† -> ç»“æœè§£æ -> å¯è§†åŒ–å±•ç¤º\n    \"\"\"\n    # æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œæ”¯æŒå¤šç§å›¾åƒæ ¼å¼\n    file_path, _ = QFileDialog.getOpenFileName(\n        None, 'æ‰“å¼€å›¾ç‰‡', './', \n        \"Image files (*.jpg *.jpeg *.png *.bmp *.tiff)\"\n    )\n    \n    if not file_path:\n        return\n    \n    # å›¾åƒé¢„å¤„ç†ï¼šæ”¯æŒä¸­æ–‡è·¯å¾„ï¼Œé¿å…ç¼–ç é—®é¢˜\n    self.org_img = tools.img_cvread(file_path)\n    self.org_path = file_path\n    \n    # æ€§èƒ½è®¡æ—¶ï¼šè®°å½•æ¨ç†æ—¶é—´ç”¨äºæ€§èƒ½åˆ†æ\n    t1 = time.time()\n    self.results = self.model(self.org_path)[0]\n    t2 = time.time()\n    inference_time = t2 - t1\n    take_time_str = '&#123;:.3f&#125; s'.format(inference_time)\n    \n    # æ£€æµ‹ç»“æœè§£æï¼šæå–è¾¹ç•Œæ¡†ã€ç±»åˆ«å’Œç½®ä¿¡åº¦\n    location_list = self.results.boxes.xyxy.tolist()\n    self.location_list = [list(map(int, e)) for e in location_list]\n    cls_list = self.results.boxes.cls.tolist()\n    self.cls_list = [int(i) for i in cls_list]\n    conf_list = self.results.boxes.conf.tolist()\n    self.conf_list = ['%.2f %%' % (each*100) for each in conf_list]\n    \n    # ç»“æœå¯è§†åŒ–ï¼šä½¿ç”¨YOLOv8å†…ç½®plotæ–¹æ³•\n    now_img = self.results.plot()\n    self.draw_img = now_img\n    \n    # ç•Œé¢æ›´æ–°ï¼šæ˜¾ç¤ºæ£€æµ‹ç»“æœå’Œç»Ÿè®¡ä¿¡æ¯\n    self.update_display_interface(now_img, inference_time)\n\næ£€æµ‹ç»“æœè§£æä¸éªŒè¯def parse_detection_results(self, results):\n    \"\"\"\n    æ£€æµ‹ç»“æœè§£æä¸éªŒè¯\n    æå–å¹¶éªŒè¯æ£€æµ‹ç»“æœçš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§\n    \"\"\"\n    # è¾¹ç•Œæ¡†åæ ‡æå– (x1, y1, x2, y2)\n    boxes = results.boxes.xyxy.cpu().numpy()\n    \n    # ç±»åˆ«IDå’Œç½®ä¿¡åº¦æå–\n    class_ids = results.boxes.cls.cpu().numpy().astype(int)\n    confidences = results.boxes.conf.cpu().numpy()\n    \n    # ç»“æœéªŒè¯ï¼šè¿‡æ»¤ä½ç½®ä¿¡åº¦æ£€æµ‹\n    valid_detections = confidences > self.confidence_threshold\n    \n    return &#123;\n        'boxes': boxes[valid_detections],\n        'class_ids': class_ids[valid_detections],\n        'confidences': confidences[valid_detections]\n    &#125;\n\næ‰¹é‡å›¾ç‰‡å¤„ç†def detact_batch_imgs(self):\n    \"\"\"\n    æ‰¹é‡å›¾ç‰‡æ£€æµ‹å¤„ç†\n    æ”¯æŒæ–‡ä»¶å¤¹å†…æ‰€æœ‰å›¾åƒæ–‡ä»¶çš„æ‰¹é‡æ£€æµ‹å’Œç»“æœä¿å­˜\n    \"\"\"\n    # æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†\n    directory = QFileDialog.getExistingDirectory(self, \"é€‰å–æ–‡ä»¶å¤¹\", \"./\")\n    if not directory:\n        return\n    \n    # æ”¯æŒçš„å›¾åƒæ ¼å¼å®šä¹‰\n    img_suffix = ['jpg', 'png', 'jpeg', 'bmp', 'tiff', 'webp']\n    \n    # è·å–æ–‡ä»¶å¤¹å†…æ‰€æœ‰å›¾åƒæ–‡ä»¶\n    image_files = [f for f in os.listdir(directory) \n                   if os.path.isfile(os.path.join(directory, f)) \n                   and f.split('.')[-1].lower() in img_suffix]\n    \n    total_files = len(image_files)\n    processed_files = 0\n    \n    # æ‰¹é‡å¤„ç†å¾ªç¯\n    for file_name in image_files:\n        full_path = os.path.join(directory, file_name)\n        \n        try:\n            # æ‰§è¡Œç›®æ ‡æ£€æµ‹\n            self.results = self.model(full_path)[0]\n            \n            # ç»“æœè§£æå’Œå¯è§†åŒ–\n            self.process_detection_results(full_path)\n            \n            # æ›´æ–°è¿›åº¦ä¿¡æ¯\n            processed_files += 1\n            progress = (processed_files / total_files) * 100\n            \n            # å®æ—¶æ›´æ–°ç•Œé¢ï¼Œä¿æŒå“åº”æ€§\n            QApplication.processEvents()\n            \n        except Exception as e:\n            print(f\"å¤„ç†æ–‡ä»¶ &#123;file_name&#125; æ—¶å‡ºé”™: &#123;str(e)&#125;\")\n            continue\n\næ‰¹é‡å¤„ç†ä¼˜åŒ–ç­–ç•¥def optimize_batch_processing(self, image_list):\n    \"\"\"\n    æ‰¹é‡å¤„ç†ä¼˜åŒ–ç­–ç•¥\n    é€šè¿‡æ‰¹å¤„ç†å’Œå†…å­˜ç®¡ç†æå‡å¤„ç†æ•ˆç‡\n    \"\"\"\n    # æ‰¹å¤„ç†å¤§å°ä¼˜åŒ–\n    batch_size = 4  # æ ¹æ®GPUå†…å­˜è°ƒæ•´\n    \n    for i in range(0, len(image_list), batch_size):\n        batch_images = image_list[i:i+batch_size]\n        \n        # æ‰¹é‡æ¨ç†\n        batch_results = self.model(batch_images)\n        \n        # æ‰¹é‡ç»“æœå¤„ç†\n        for j, result in enumerate(batch_results):\n            self.process_single_result(result, batch_images[j])\n        \n        # å†…å­˜æ¸…ç†\n        del batch_results\n        torch.cuda.empty_cache() if torch.cuda.is_available() else None\n\nå®æ—¶è§†é¢‘æµå¤„ç†def open_frame(self):\n    \"\"\"\n    å®æ—¶è§†é¢‘å¸§å¤„ç†æ ¸å¿ƒæ–¹æ³•\n    å®ç°è§†é¢‘æµçš„å®æ—¶æ£€æµ‹å’Œç»“æœå±•ç¤º\n    \"\"\"\n    ret, frame = self.cap.read()\n    if ret:\n        # å¸§ç‡æ§åˆ¶ï¼šé¿å…å¤„ç†è¿‡å¿«å¯¼è‡´ç•Œé¢å¡é¡¿\n        if hasattr(self, 'last_process_time'):\n            elapsed = time.time() - self.last_process_time\n            if elapsed &lt; self.target_fps:\n                return\n        \n        # å®æ—¶ç›®æ ‡æ£€æµ‹\n        t1 = time.time()\n        results = self.model(frame)[0]\n        t2 = time.time()\n        inference_time = t2 - t1\n        \n        # ç»“æœå¯è§†åŒ–æ¸²æŸ“\n        annotated_frame = results.plot()\n        \n        # æ€§èƒ½ä¿¡æ¯å åŠ \n        self.add_performance_overlay(annotated_frame, inference_time)\n        \n        # ç•Œé¢æ›´æ–°å’Œç»“æœå±•ç¤º\n        self.update_display_interface(annotated_frame, results)\n        \n        # æ›´æ–°å¤„ç†æ—¶é—´æˆ³\n        self.last_process_time = time.time()\n    else:\n        # è§†é¢‘ç»“æŸå¤„ç†\n        self.handle_video_end()\n\nè§†é¢‘å¤„ç†æ€§èƒ½ä¼˜åŒ–def optimize_video_processing(self):\n    \"\"\"\n    è§†é¢‘å¤„ç†æ€§èƒ½ä¼˜åŒ–\n    é€šè¿‡å¸§ç‡æ§åˆ¶å’Œå†…å­˜ç®¡ç†æå‡å®æ—¶æ€§èƒ½\n    \"\"\"\n    # åŠ¨æ€å¸§ç‡è°ƒæ•´\n    self.target_fps = 30  # ç›®æ ‡å¸§ç‡\n    self.frame_skip = 1   # è·³å¸§å¤„ç†\n    \n    # å†…å­˜ç®¡ç†\n    self.frame_buffer = collections.deque(maxlen=5)\n    \n    # GPUå†…å­˜ä¼˜åŒ–\n    if torch.cuda.is_available():\n        torch.cuda.empty_cache()\n    \n    # å¼‚æ­¥å¤„ç†é˜Ÿåˆ—\n    self.processing_queue = queue.Queue(maxsize=3)\n\nå®æ—¶æ£€æµ‹ç»“æœåˆ†ædef analyze_realtime_results(self, results):\n    \"\"\"\n    å®æ—¶æ£€æµ‹ç»“æœåˆ†æ\n    æä¾›æ£€æµ‹ç»Ÿè®¡å’Œè¶‹åŠ¿åˆ†æ\n    \"\"\"\n    # æ£€æµ‹ç»Ÿè®¡\n    detection_count = len(results.boxes)\n    avg_confidence = results.boxes.conf.mean().item() if detection_count > 0 else 0\n    \n    # å†å²ç»Ÿè®¡æ›´æ–°\n    self.detection_history.append(&#123;\n        'timestamp': time.time(),\n        'count': detection_count,\n        'confidence': avg_confidence\n    &#125;)\n    \n    # è¶‹åŠ¿åˆ†æ\n    if len(self.detection_history) > 10:\n        recent_trend = self.calculate_detection_trend()\n        return recent_trend\n\n3. ç»“æœå¯è§†åŒ–ä¸äº¤äº’åŠ¨æ€ç›®æ ‡é€‰æ‹©def combox_change(self):\n    \"\"\"ç›®æ ‡é€‰æ‹©ä¸‹æ‹‰æ¡†äº¤äº’\"\"\"\n    com_text = self.ui.comboBox.currentText()\n    if com_text == 'å…¨éƒ¨':\n        # æ˜¾ç¤ºæ‰€æœ‰æ£€æµ‹ç»“æœ\n        cur_img = self.results.plot()\n    else:\n        # æ˜¾ç¤ºå•ä¸ªç›®æ ‡\n        index = int(com_text.split('_')[-1])\n        cur_img = self.results[index].plot()\n    \n    # æ›´æ–°åæ ‡ä¿¡æ¯æ˜¾ç¤º\n    self.update_coordinate_info(cur_box)\n\næ£€æµ‹ç»“æœè¡¨æ ¼å±•ç¤ºdef tabel_info_show(self, locations, clses, confs, path=None):\n    \"\"\"æ£€æµ‹ç»“æœè¡¨æ ¼å±•ç¤º\"\"\"\n    for location, cls, conf in zip(locations, clses, confs):\n        row_count = self.ui.tableWidget.rowCount()\n        self.ui.tableWidget.insertRow(row_count)\n        \n        # å¡«å……è¡¨æ ¼æ•°æ®\n        item_id = QTableWidgetItem(str(row_count+1))\n        item_path = QTableWidgetItem(str(path))\n        item_cls = QTableWidgetItem(str(Config.CH_names[cls]))\n        item_conf = QTableWidgetItem(str(conf))\n        item_location = QTableWidgetItem(str(location))\n        \n        # è®¾ç½®è¡¨æ ¼é¡¹\n        self.ui.tableWidget.setItem(row_count, 0, item_id)\n        # ... å…¶ä»–åˆ—è®¾ç½®\n\n4. å¼‚æ­¥è§†é¢‘å¤„ç†class btn2Thread(QThread):\n    \"\"\"è§†é¢‘ä¿å­˜å¼‚æ­¥å¤„ç†çº¿ç¨‹\"\"\"\n    update_ui_signal = pyqtSignal(int, int)\n    \n    def run(self):\n        \"\"\"è§†é¢‘å¤„ç†ä¸»å¾ªç¯\"\"\"\n        cap = cv2.VideoCapture(self.org_path)\n        fourcc = cv2.VideoWriter_fourcc(*'XVID')\n        fps = cap.get(cv2.CAP_PROP_FPS)\n        size = (int(cap.get(cv2.CAP_PROP_FRAME_WIDTH)), \n                int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT)))\n        \n        out = cv2.VideoWriter(save_video_path, fourcc, fps, size)\n        \n        while cap.isOpened() and self.is_running:\n            ret, frame = cap.read()\n            if ret:\n                # ç›®æ ‡æ£€æµ‹\n                results = self.model(frame)[0]\n                frame = results.plot()\n                out.write(frame)\n                # å‘é€è¿›åº¦ä¿¡å·\n                self.update_ui_signal.emit(cur_num, total)\n\nç³»ç»Ÿä¼˜åŒ–ç­–ç•¥1. æ€§èƒ½ä¼˜åŒ–æ¨¡å‹é¢„åŠ è½½ï¼š\n\nåœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶é¢„åŠ è½½æ¨¡å‹ï¼Œé¿å…é¦–æ¬¡æ£€æµ‹å»¶è¿Ÿ\nä½¿ç”¨å°å°ºå¯¸æµ‹è¯•å›¾åƒè¿›è¡Œé¢„çƒ­ï¼Œç¡®ä¿æ¨¡å‹å®Œå…¨åŠ è½½\n\nå†…å­˜ç®¡ç†ï¼š\n\nåŠæ—¶é‡Šæ”¾OpenCVèµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼\nä½¿ç”¨QTimeræ§åˆ¶è§†é¢‘å¸§ç‡ï¼Œå¹³è¡¡æ€§èƒ½å’Œæµç•…åº¦\n\nå¤šçº¿ç¨‹å¤„ç†ï¼š\n\nè§†é¢‘ä¿å­˜é‡‡ç”¨ç‹¬ç«‹çº¿ç¨‹ï¼Œé¿å…ç•Œé¢å¡é¡¿\nä½¿ç”¨ä¿¡å·æ§½æœºåˆ¶å®ç°çº¿ç¨‹é—´é€šä¿¡\n\n2. ç”¨æˆ·ä½“éªŒä¼˜åŒ–ç•Œé¢å“åº”æ€§ï¼š\n\nå®æ—¶è¿›åº¦æ¡æ˜¾ç¤ºå¤„ç†è¿›åº¦\næ”¯æŒå¤„ç†è¿‡ç¨‹ä¸­çš„å–æ¶ˆæ“ä½œ\nå¼‚æ­¥å¤„ç†é¿å…ç•Œé¢å†»ç»“\n\nç»“æœå±•ç¤ºï¼š\n\næ”¯æŒæ£€æµ‹ç»“æœçš„å®æ—¶é¢„è§ˆ\næä¾›ç›®æ ‡é€‰æ‹©åŠŸèƒ½ï¼Œæ”¯æŒå•ä¸ªç›®æ ‡æŸ¥çœ‹\nè¯¦ç»†çš„æ£€æµ‹ä¿¡æ¯è¡¨æ ¼å±•ç¤º\n\n3. ä»£ç ç»“æ„ä¼˜åŒ–æ¨¡å—åŒ–è®¾è®¡ï¼š\n\nå°†å·¥å…·å‡½æ•°ç‹¬ç«‹ä¸ºdetect_toolsæ¨¡å—\nUIç•Œé¢ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»\né…ç½®æ–‡ä»¶ç»Ÿä¸€ç®¡ç†\n\né”™è¯¯å¤„ç†ï¼š\n\nå®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶\nç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º\nèµ„æºé‡Šæ”¾ä¿è¯\n\nç³»ç»Ÿæµç¨‹å›¾graph TD\n    A[ç³»ç»Ÿå¯åŠ¨] --> B[åŠ è½½YOLOv8æ¨¡å‹]\n    B --> C[åˆå§‹åŒ–UIç•Œé¢]\n    C --> D[ç­‰å¾…ç”¨æˆ·è¾“å…¥]\n    \n    D --> E&#123;é€‰æ‹©è¾“å…¥ç±»å‹&#125;\n    E -->|å›¾ç‰‡| F[å•å¼ å›¾ç‰‡æ£€æµ‹]\n    E -->|æ‰¹é‡å›¾ç‰‡| G[æ‰¹é‡å›¾ç‰‡æ£€æµ‹]\n    E -->|è§†é¢‘| H[è§†é¢‘æµæ£€æµ‹]\n    E -->|æ‘„åƒå¤´| I[å®æ—¶æ‘„åƒå¤´æ£€æµ‹]\n    \n    F --> J[YOLOv8æ¨ç†]\n    G --> J\n    H --> J\n    I --> J\n    \n    J --> K[ç»“æœè§£æ]\n    K --> L[å¯è§†åŒ–æ¸²æŸ“]\n    L --> M[ç•Œé¢æ›´æ–°]\n    M --> N[ç»“æœå±•ç¤º]\n    \n    N --> O&#123;ç”¨æˆ·æ“ä½œ&#125;\n    O -->|ä¿å­˜ç»“æœ| P[å¼‚æ­¥ä¿å­˜å¤„ç†]\n    O -->|é€‰æ‹©ç›®æ ‡| Q[ç›®æ ‡ç­›é€‰æ˜¾ç¤º]\n    O -->|ç»§ç»­æ£€æµ‹| D\n    \n    P --> R[è¿›åº¦æ¡æ˜¾ç¤º]\n    R --> S[ä¿å­˜å®Œæˆ]\n\næŠ€æœ¯äº®ç‚¹ä¸åˆ›æ–°1. æ·±åº¦å­¦ä¹ é›†æˆ\nYOLOv8æ¨¡å‹é›†æˆï¼šé‡‡ç”¨æœ€æ–°çš„YOLOv8æ¶æ„ï¼Œå®ç°é«˜ç²¾åº¦ç›®æ ‡æ£€æµ‹\næ¨¡å‹ä¼˜åŒ–ï¼šé’ˆå¯¹é“…å°é”æ£€æµ‹ä»»åŠ¡è¿›è¡Œæ¨¡å‹å¾®è°ƒå’Œä¼˜åŒ–\næ¨ç†åŠ é€Ÿï¼šé€šè¿‡æ¨¡å‹é¢„åŠ è½½å’Œæ‰¹å¤„ç†ä¼˜åŒ–æ¨ç†é€Ÿåº¦\n\n2. ç”¨æˆ·ç•Œé¢è®¾è®¡\nç°ä»£åŒ–UIï¼šåŸºäºPyQt5æ„å»ºçš„ä¸“ä¸šçº§å›¾å½¢ç•Œé¢\nå®æ—¶äº¤äº’ï¼šæ”¯æŒæ£€æµ‹ç»“æœçš„å®æ—¶é¢„è§ˆå’Œäº¤äº’é€‰æ‹©\nå¤šæ¨¡æ€æ”¯æŒï¼šç»Ÿä¸€å¤„ç†å›¾ç‰‡ã€è§†é¢‘ã€æ‘„åƒå¤´ç­‰å¤šç§è¾“å…¥æº\n\n3. ç³»ç»Ÿæ¶æ„\næ¨¡å—åŒ–è®¾è®¡ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•\nå¼‚æ­¥å¤„ç†ï¼šå¤šçº¿ç¨‹æ¶æ„ç¡®ä¿ç•Œé¢å“åº”æ€§\né…ç½®ç®¡ç†ï¼šç»Ÿä¸€çš„é…ç½®ç®¡ç†ï¼Œä¾¿äºç³»ç»Ÿéƒ¨ç½²\n\n4. æ€§èƒ½ä¼˜åŒ–\nå†…å­˜ç®¡ç†ï¼šä¼˜åŒ–çš„èµ„æºç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼\nå¤„ç†æ•ˆç‡ï¼šæ‰¹é‡å¤„ç†å’Œå¼‚æ­¥å¤„ç†æå‡ç³»ç»Ÿæ•ˆç‡\nç”¨æˆ·ä½“éªŒï¼šå®æ—¶åé¦ˆå’Œè¿›åº¦æ˜¾ç¤ºæå‡ç”¨æˆ·æ»¡æ„åº¦\n\nå­¦ä¹ æŠ€èƒ½æ€»ç»“æ ¸å¿ƒæŠ€æœ¯æŠ€èƒ½\næ·±åº¦å­¦ä¹ æ¡†æ¶åº”ç”¨ï¼šYOLOv8æ¨¡å‹é›†æˆä¸ä¼˜åŒ–\nè®¡ç®—æœºè§†è§‰æŠ€æœ¯ï¼šOpenCVå›¾åƒå¤„ç†ä¸å¯è§†åŒ–\nGUIå¼€å‘ï¼šPyQt5ç•Œé¢è®¾è®¡ä¸äº¤äº’å®ç°\nå¤šçº¿ç¨‹ç¼–ç¨‹ï¼šå¼‚æ­¥å¤„ç†ä¸çº¿ç¨‹é—´é€šä¿¡\nç³»ç»Ÿæ¶æ„è®¾è®¡ï¼šæ¨¡å—åŒ–è®¾è®¡ä¸ä»£ç ç»„ç»‡\n\nå·¥ç¨‹å®è·µæŠ€èƒ½\né¡¹ç›®å·¥ç¨‹åŒ–ï¼šä»£ç ç»“æ„è®¾è®¡ä¸æ¨¡å—åŒ–å¼€å‘\næ€§èƒ½ä¼˜åŒ–ï¼šå†…å­˜ç®¡ç†ä¸å¤„ç†æ•ˆç‡ä¼˜åŒ–\nç”¨æˆ·ä½“éªŒè®¾è®¡ï¼šç•Œé¢äº¤äº’ä¸ç”¨æˆ·åé¦ˆæœºåˆ¶\né”™è¯¯å¤„ç†ï¼šå¼‚å¸¸å¤„ç†ä¸èµ„æºç®¡ç†\né…ç½®ç®¡ç†ï¼šç³»ç»Ÿé…ç½®ä¸éƒ¨ç½²ç®¡ç†\n\nä¸šåŠ¡ç†è§£èƒ½åŠ›\næµ·å…³ç›‘ç®¡ä¸šåŠ¡ï¼šç†è§£é“…å°é”æ£€æµ‹çš„ä¸šåŠ¡éœ€æ±‚\nç›®æ ‡æ£€æµ‹åº”ç”¨ï¼šå°†æ·±åº¦å­¦ä¹ æŠ€æœ¯åº”ç”¨äºå®é™…ä¸šåŠ¡åœºæ™¯\nç³»ç»Ÿé›†æˆï¼šå¤šæŠ€æœ¯æ ˆçš„æ•´åˆä¸åè°ƒ\nç”¨æˆ·éœ€æ±‚åˆ†æï¼šä»ç”¨æˆ·è§’åº¦è®¾è®¡ç³»ç»ŸåŠŸèƒ½\n\nç³»ç»Ÿæ€§èƒ½åˆ†ææ£€æµ‹ç²¾åº¦è¯„ä¼°æ¨¡å‹æ€§èƒ½æŒ‡æ ‡def evaluate_model_performance(self, test_dataset):\n    \"\"\"\n    æ¨¡å‹æ€§èƒ½è¯„ä¼°æ–¹æ³•\n    è®¡ç®—mAPã€ç²¾ç¡®ç‡ã€å¬å›ç‡ç­‰å…³é”®æŒ‡æ ‡\n    \"\"\"\n    # åŠ è½½æµ‹è¯•æ•°æ®é›†\n    test_loader = DataLoader(test_dataset, batch_size=1, shuffle=False)\n    \n    # æ€§èƒ½æŒ‡æ ‡è®¡ç®—\n    metrics = &#123;\n        'mAP@0.5': 0.0,\n        'mAP@0.5:0.95': 0.0,\n        'precision': 0.0,\n        'recall': 0.0,\n        'f1_score': 0.0\n    &#125;\n    \n    # æ‰¹é‡æ¨ç†å’ŒæŒ‡æ ‡è®¡ç®—\n    for batch in test_loader:\n        predictions = self.model(batch['image'])\n        metrics = self.calculate_metrics(predictions, batch['targets'])\n    \n    return metrics\n\nå®æ—¶æ€§èƒ½ç›‘æ§def monitor_system_performance(self):\n    \"\"\"\n    ç³»ç»Ÿæ€§èƒ½ç›‘æ§\n    å®æ—¶ç›‘æ§CPUã€GPUä½¿ç”¨ç‡å’Œå†…å­˜å ç”¨\n    \"\"\"\n    performance_stats = &#123;\n        'cpu_usage': psutil.cpu_percent(),\n        'memory_usage': psutil.virtual_memory().percent,\n        'gpu_usage': self.get_gpu_usage(),\n        'inference_time': self.avg_inference_time,\n        'fps': self.current_fps\n    &#125;\n    \n    return performance_stats\n\nç³»ç»Ÿä¼˜åŒ–å»ºè®®1. æ¨¡å‹ä¼˜åŒ–\né‡åŒ–åŠ é€Ÿï¼šä½¿ç”¨INT8é‡åŒ–å‡å°‘æ¨¡å‹å¤§å°ï¼Œæå‡æ¨ç†é€Ÿåº¦\næ¨¡å‹å‰ªæï¼šç§»é™¤å†—ä½™å‚æ•°ï¼Œä¿æŒç²¾åº¦çš„åŒæ—¶å‡å°‘è®¡ç®—é‡\nTensorRTä¼˜åŒ–ï¼šä½¿ç”¨NVIDIA TensorRTè¿›è¡Œæ¨ç†åŠ é€Ÿ\n\n2. ç³»ç»Ÿæ¶æ„ä¼˜åŒ–\nå¾®æœåŠ¡æ¶æ„ï¼šå°†æ£€æµ‹æœåŠ¡ç‹¬ç«‹éƒ¨ç½²ï¼Œæ”¯æŒæ°´å¹³æ‰©å±•\nç¼“å­˜æœºåˆ¶ï¼šå®ç°æ£€æµ‹ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—\nè´Ÿè½½å‡è¡¡ï¼šæ”¯æŒå¤šå®ä¾‹éƒ¨ç½²ï¼Œæå‡å¹¶å‘å¤„ç†èƒ½åŠ›\n\n3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–\nå“åº”å¼ç•Œé¢ï¼šæ”¯æŒä¸åŒåˆ†è¾¨ç‡å±å¹•çš„è‡ªé€‚åº”æ˜¾ç¤º\nå¿«æ·é”®æ”¯æŒï¼šæä¾›é”®ç›˜å¿«æ·é”®æå‡æ“ä½œæ•ˆç‡\nå¤šè¯­è¨€æ”¯æŒï¼šå›½é™…åŒ–ç•Œé¢ï¼Œæ”¯æŒå¤šè¯­è¨€åˆ‡æ¢\n\næŠ€æœ¯åˆ›æ–°ä¸è´¡çŒ®1. ç®—æ³•åˆ›æ–°\nå¤šå°ºåº¦ç‰¹å¾èåˆï¼šé’ˆå¯¹é“…å°é”ç›®æ ‡ç‰¹ç‚¹ï¼Œä¼˜åŒ–äº†YOLOv8çš„ç‰¹å¾æå–ç½‘ç»œ\nè‡ªé€‚åº”é˜ˆå€¼è°ƒæ•´ï¼šæ ¹æ®æ£€æµ‹ç¯å¢ƒåŠ¨æ€è°ƒæ•´ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œæå‡æ£€æµ‹é²æ£’æ€§\næ—¶åºä¿¡æ¯åˆ©ç”¨ï¼šåœ¨è§†é¢‘æ£€æµ‹ä¸­åˆ©ç”¨å¸§é—´è¿ç»­æ€§ï¼Œæå‡æ£€æµ‹ç¨³å®šæ€§\n\n2. ç³»ç»Ÿæ¶æ„åˆ›æ–°\næ¨¡å—åŒ–è®¾è®¡æ¨¡å¼ï¼šé‡‡ç”¨æ¾è€¦åˆçš„æ¨¡å—åŒ–æ¶æ„ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•\nå¼‚æ­¥å¤„ç†æœºåˆ¶ï¼šé€šè¿‡å¤šçº¿ç¨‹å’Œä¿¡å·æ§½æœºåˆ¶ï¼Œå®ç°ç•Œé¢å“åº”æ€§å’Œå¤„ç†æ•ˆç‡çš„å¹³è¡¡\né…ç½®é©±åŠ¨å¼€å‘ï¼šé€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†æ¨¡å‹å‚æ•°å’Œç³»ç»Ÿè®¾ç½®ï¼Œæå‡éƒ¨ç½²çµæ´»æ€§\n\n3. ç”¨æˆ·ä½“éªŒåˆ›æ–°\nå®æ—¶äº¤äº’åé¦ˆï¼šæä¾›æ£€æµ‹è¿‡ç¨‹çš„å®æ—¶åé¦ˆå’Œè¿›åº¦æ˜¾ç¤º\nå¤šæ¨¡æ€è¾“å…¥æ”¯æŒï¼šç»Ÿä¸€å¤„ç†å›¾ç‰‡ã€è§†é¢‘ã€æ‘„åƒå¤´ç­‰å¤šç§è¾“å…¥æº\næ™ºèƒ½ç»“æœå±•ç¤ºï¼šæ”¯æŒæ£€æµ‹ç»“æœçš„å¯è§†åŒ–ç­›é€‰å’Œè¯¦ç»†åˆ†æ\n\nåº”ç”¨ä»·å€¼ä¸å‰æ™¯1. å®é™…åº”ç”¨ä»·å€¼\næµ·å…³ç›‘ç®¡æ•ˆç‡æå‡ï¼šè‡ªåŠ¨åŒ–æ£€æµ‹å‡å°‘äººå·¥æ£€æŸ¥æ—¶é—´ï¼Œæå‡é€šå…³æ•ˆç‡\næ£€æµ‹ç²¾åº¦ä¿éšœï¼šåŸºäºæ·±åº¦å­¦ä¹ çš„æ£€æµ‹æ–¹æ³•ï¼Œç¡®ä¿æ£€æµ‹ç»“æœçš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§\næˆæœ¬æ•ˆç›Šä¼˜åŒ–ï¼šå‡å°‘äººåŠ›æˆæœ¬ï¼Œæé«˜ç›‘ç®¡å·¥ä½œçš„ç»æµæ•ˆç›Š\n\n2. æŠ€æœ¯æ¨å¹¿ä»·å€¼\nå¯æ‰©å±•æ€§ï¼šç³»ç»Ÿæ¶æ„æ”¯æŒå…¶ä»–ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„å¿«é€Ÿé€‚é…\nå¯ç»´æŠ¤æ€§ï¼šæ¨¡å—åŒ–è®¾è®¡ä¾¿äºç³»ç»Ÿå‡çº§å’ŒåŠŸèƒ½æ‰©å±•\nå¯éƒ¨ç½²æ€§ï¼šæ”¯æŒå¤šç§éƒ¨ç½²ç¯å¢ƒï¼Œé€‚åº”ä¸åŒçš„åº”ç”¨åœºæ™¯\n\n3. å­¦æœ¯ç ”ç©¶ä»·å€¼\næ·±åº¦å­¦ä¹ åº”ç”¨ï¼šä¸ºè®¡ç®—æœºè§†è§‰åœ¨æµ·å…³ç›‘ç®¡é¢†åŸŸçš„åº”ç”¨æä¾›å‚è€ƒ\nç³»ç»Ÿé›†æˆç ”ç©¶ï¼šå±•ç¤ºäº†æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸GUIåº”ç”¨çš„é›†æˆæ–¹æ³•\næ€§èƒ½ä¼˜åŒ–å®è·µï¼šæä¾›äº†ç›®æ ‡æ£€æµ‹ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–çš„å®è·µç»éªŒ\n\næ€»ç»“æœ¬ç³»ç»ŸæˆåŠŸå®ç°äº†åŸºäºYOLOv8çš„æµ·å…³é›†è£…ç®±é“…å°é”è¯†åˆ«åŠŸèƒ½ï¼Œé€šè¿‡æ¨¡å—åŒ–è®¾è®¡ã€å¼‚æ­¥å¤„ç†å’Œç”¨æˆ·å‹å¥½çš„ç•Œé¢ï¼Œä¸ºæµ·å…³ç›‘ç®¡æä¾›äº†é«˜æ•ˆçš„æŠ€æœ¯æ”¯æŒã€‚ç³»ç»Ÿåœ¨æ·±åº¦å­¦ä¹ æ¨¡å‹é›†æˆã€å¤šæ¨¡æ€è¾“å…¥å¤„ç†ã€å®æ—¶å¯è§†åŒ–ç­‰æ–¹é¢å±•ç°äº†è‰¯å¥½çš„æŠ€æœ¯å®ç°èƒ½åŠ›ï¼Œä¸ºç±»ä¼¼çš„ç›®æ ‡æ£€æµ‹åº”ç”¨æä¾›äº†å¯å‚è€ƒçš„è§£å†³æ–¹æ¡ˆã€‚\næŠ€æœ¯æˆæœæ€»ç»“\næ·±åº¦å­¦ä¹ åº”ç”¨ï¼šæˆåŠŸå°†YOLOv8æ¨¡å‹åº”ç”¨äºæµ·å…³ç›‘ç®¡åœºæ™¯ï¼Œå®ç°äº†é«˜ç²¾åº¦çš„ç›®æ ‡æ£€æµ‹\nç³»ç»Ÿæ¶æ„è®¾è®¡ï¼šé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œå®ç°äº†è‰¯å¥½çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§\nç”¨æˆ·ç•Œé¢å¼€å‘ï¼šåŸºäºPyQt5æ„å»ºäº†åŠŸèƒ½å®Œå–„çš„å›¾å½¢ç”¨æˆ·ç•Œé¢\næ€§èƒ½ä¼˜åŒ–å®è·µï¼šé€šè¿‡å¤šç§ä¼˜åŒ–ç­–ç•¥ï¼Œå®ç°äº†ç³»ç»Ÿçš„é«˜æ•ˆè¿è¡Œ\n\nå­¦ä¹ æ”¶è·é€šè¿‡æœ¬é¡¹ç›®çš„å¼€å‘ï¼Œæ·±å…¥æŒæ¡äº†æ·±åº¦å­¦ä¹ æ¨¡å‹çš„åº”ç”¨ã€GUIç•Œé¢å¼€å‘ã€å¤šçº¿ç¨‹ç¼–ç¨‹ç­‰æ ¸å¿ƒæŠ€æœ¯ï¼Œæå‡äº†ç³»ç»Ÿæ¶æ„è®¾è®¡å’Œå·¥ç¨‹å®è·µèƒ½åŠ›ï¼Œä¸ºåç»­çš„AIåº”ç”¨å¼€å‘å¥ å®šäº†åšå®åŸºç¡€ã€‚åŒæ—¶ï¼Œåœ¨é¡¹ç›®ç®¡ç†å’ŒæŠ€æœ¯é€‰å‹æ–¹é¢ä¹Ÿç§¯ç´¯äº†å®è´µç»éªŒï¼Œä¸ºæœªæ¥çš„æŠ€æœ¯å‘å±•å¥ å®šäº†è‰¯å¥½åŸºç¡€ã€‚\n","categories":["è®¡ç®—æœºè§†è§‰","æ·±åº¦å­¦ä¹ ","ç›®æ ‡æ£€æµ‹"],"tags":["PyQt5","æ·±åº¦å­¦ä¹ ","YOLOv8","ç›®æ ‡æ£€æµ‹","æµ·å…³ç›‘ç®¡","è®¡ç®—æœºè§†è§‰"]}]