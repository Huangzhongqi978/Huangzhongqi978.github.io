<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><meta name="referrer" content="no-referrer"><title>基于Minio+Redis+Springboot+Vue的云盘存储系统 | 奇点智库 SingularityMind</title><meta name="author" content="HuangZhongqi"><meta name="copyright" content="HuangZhongqi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f5f0fa"><meta name="description" content="基于Spring Boot + Vue.js构建的现代化云盘存储系统，集成MinIO对象存储、Redis缓存、MySQL数据库，实现文件上传下载、分享、预览等核心功能，支持QQ第三方登录、文件回收站、视频转码等高级特性。">
<meta property="og:type" content="article">
<meta property="og:title" content="基于Minio+Redis+Springboot+Vue的云盘存储系统">
<meta property="og:url" content="https://huangzhongqi978.top/2024/12/24/EasyPan%E4%BA%91%E7%9B%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/">
<meta property="og:site_name" content="奇点智库 SingularityMind">
<meta property="og:description" content="基于Spring Boot + Vue.js构建的现代化云盘存储系统，集成MinIO对象存储、Redis缓存、MySQL数据库，实现文件上传下载、分享、预览等核心功能，支持QQ第三方登录、文件回收站、视频转码等高级特性。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162009784.png">
<meta property="article:published_time" content="2024-12-24T14:30:00.000Z">
<meta property="article:modified_time" content="2025-11-03T08:20:20.649Z">
<meta property="article:author" content="HuangZhongqi">
<meta property="article:tag" content="Spring Boot">
<meta property="article:tag" content="Vue.js">
<meta property="article:tag" content="MinIO">
<meta property="article:tag" content="Redis">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="云存储">
<meta property="article:tag" content="文件管理">
<meta property="article:tag" content="微服务架构">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162009784.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "基于Minio+Redis+Springboot+Vue的云盘存储系统",
  "url": "https://huangzhongqi978.top/2024/12/24/EasyPan%E4%BA%91%E7%9B%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/",
  "image": "https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162009784.png",
  "datePublished": "2024-12-24T14:30:00.000Z",
  "dateModified": "2025-11-03T08:20:20.649Z",
  "author": [
    {
      "@type": "Person",
      "name": "HuangZhongqi",
      "url": "https://huangzhongqi978.top"
    }
  ]
}</script><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/img/logo.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/logo.png"><link rel="icon" type="image/png" href="/img/logo.png"><link rel="apple-touch-icon" sizes="180x180" href="/img/logo.png"><link rel="apple-touch-icon" href="/img/logo.png"><link rel="canonical" href="https://huangzhongqi978.top/2024/12/24/EasyPan%E4%BA%91%E7%9B%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="/css/qr-modal.css"><link rel="stylesheet" href="/css/reading-progress.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        try {
          const parsed = JSON.parse(itemStr)
          // 如果是新格式（包含 value 和 expiry）
          if (parsed && typeof parsed === 'object' && 'value' in parsed) {
            if ('expiry' in parsed && Date.now() > parsed.expiry) {
              localStorage.removeItem(key)
              return undefined
            }
            return parsed.value
          }
          // 如果是旧格式（纯字符串），直接返回
          return parsed
        } catch (e) {
          // 如果不是有效的 JSON，可能是旧格式的字符串值，直接返回
          return itemStr
        }
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#2d0a3d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f5f0fa')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '基于Minio+Redis+Springboot+Vue的云盘存储系统',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}
window.mouseTrailConfig = { enable: true, lineWidth: 2, trailLength: 20, mobile: false };</script><link rel="stylesheet" href="/css/custom-font.css"><link rel="stylesheet" href="/css/index-header-fix.css"><link rel="stylesheet" href="/css/background-fix.css"><link rel="stylesheet" href="/css/header-transparent.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(http://image.huangzhongqi978.top/bg.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://gitee.com/huangzhongqi776/my-images/raw/master/ff71db1967b4c412f794ffe33ef624f.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/ referrerpolicy="no-referrer"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">48</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/tags/YOLO/"><i class="fa-fw fas fa-eye"></i><span> YOLO</span></a></div><div class="menus_item"><a class="site-page" href="/tags/NLP/"><i class="fa-fw fas fa-language"></i><span> NLP</span></a></div><div class="menus_item"><a class="site-page" href="/tags/LLM/"><i class="fa-fw fas fa-brain"></i><span> LLM</span></a></div><div class="menus_item"><a class="site-page" href="/tags/Python/"><i class="fa-fw fab fa-python"></i><span> Python</span></a></div><div class="menus_item"><a class="site-page" href="/tags/Java/"><i class="fa-fw fab fa-java"></i><span> Java</span></a></div><div class="menus_item"><a class="site-page" href="/tags/C++.html"><i class="fa-fw fas fa-code"></i><span> C++</span></a></div><div class="menus_item"><a class="site-page" href="/tags/CV.html"><i class="fa-fw fas fa-camera"></i><span> CV</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user-circle"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162009784.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">奇点智库 SingularityMind</span></a><a class="nav-page-title" href="/"><span class="site-name">基于Minio+Redis+Springboot+Vue的云盘存储系统</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/tags/YOLO/"><i class="fa-fw fas fa-eye"></i><span> YOLO</span></a></div><div class="menus_item"><a class="site-page" href="/tags/NLP/"><i class="fa-fw fas fa-language"></i><span> NLP</span></a></div><div class="menus_item"><a class="site-page" href="/tags/LLM/"><i class="fa-fw fas fa-brain"></i><span> LLM</span></a></div><div class="menus_item"><a class="site-page" href="/tags/Python/"><i class="fa-fw fab fa-python"></i><span> Python</span></a></div><div class="menus_item"><a class="site-page" href="/tags/Java/"><i class="fa-fw fab fa-java"></i><span> Java</span></a></div><div class="menus_item"><a class="site-page" href="/tags/C++.html"><i class="fa-fw fas fa-code"></i><span> C++</span></a></div><div class="menus_item"><a class="site-page" href="/tags/CV.html"><i class="fa-fw fas fa-camera"></i><span> CV</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user-circle"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">基于Minio+Redis+Springboot+Vue的云盘存储系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-24T14:30:00.000Z" title="发表于 2024-12-24 22:30:00">2024-12-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-03T08:20:20.649Z" title="更新于 2025-11-03 16:20:20">2025-11-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/">后端开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">系统设计</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>基于Spring Boot + Vue.js构建的现代化云盘存储系统，集成MinIO对象存储、Redis缓存、MySQL数据库，实现文件上传下载、分享、预览等核心功能，支持QQ第三方登录、文件回收站、视频转码等高级特性。</p>
<span id="more"></span>

<h2 id="系统架构设计"><a href="#系统架构设计" class="headerlink" title="系统架构设计"></a>系统架构设计</h2><h3 id="技术栈选型"><a href="#技术栈选型" class="headerlink" title="技术栈选型"></a>技术栈选型</h3><p><strong>后端技术栈：</strong></p>
<ul>
<li>Spring Boot 2.6.1 - 微服务框架</li>
<li>MyBatis Plus 3.4.1 - ORM框架</li>
<li>MySQL 8.0.30 - 关系型数据库</li>
<li>Redis - 缓存与会话管理</li>
<li>MinIO - 对象存储服务</li>
<li>FFmpeg - 视频转码处理</li>
</ul>
<p><strong>前端技术栈：</strong></p>
<ul>
<li>Vue.js 3.x - 前端框架</li>
<li>Element Plus - UI组件库</li>
<li>Axios - HTTP客户端</li>
<li>Vue Router - 路由管理</li>
</ul>
<h3 id="系统架构图"><a href="#系统架构图" class="headerlink" title="系统架构图"></a>系统架构图</h3><pre class="line-numbers language-mermaid" data-language="mermaid"><code class="language-mermaid"><span class="token keyword">graph</span> TB
    A<span class="token text string">[用户浏览器]</span> <span class="token arrow operator">--></span> B<span class="token text string">[Nginx反向代理]</span>
    B <span class="token arrow operator">--></span> C<span class="token text string">[Vue.js前端应用]</span>
    B <span class="token arrow operator">--></span> D<span class="token text string">[Spring Boot后端服务]</span>
    D <span class="token arrow operator">--></span> E<span class="token text string">[MySQL数据库]</span>
    D <span class="token arrow operator">--></span> F<span class="token text string">[Redis缓存]</span>
    D <span class="token arrow operator">--></span> G<span class="token text string">[MinIO对象存储]</span>
    D <span class="token arrow operator">--></span> H<span class="token text string">[FFmpeg转码服务]</span>
    
    <span class="token keyword">subgraph</span> <span class="token string">"核心模块"</span>
        I<span class="token text string">[用户管理模块]</span>
        J<span class="token text string">[文件管理模块]</span>
        K<span class="token text string">[分享管理模块]</span>
        L<span class="token text string">[回收站模块]</span>
    <span class="token keyword">end</span>
    
    D <span class="token arrow operator">--></span> I
    D <span class="token arrow operator">--></span> J
    D <span class="token arrow operator">--></span> K
    D <span class="token arrow operator">--></span> L<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="核心功能实现"><a href="#核心功能实现" class="headerlink" title="核心功能实现"></a>核心功能实现</h2><h3 id="1-文件存储架构"><a href="#1-文件存储架构" class="headerlink" title="1. 文件存储架构"></a>1. 文件存储架构</h3><p>系统采用<strong>MinIO对象存储</strong>作为主要存储方案，结合<strong>Redis缓存</strong>优化性能：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * MinIO服务接口 - 文件存储核心服务
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MinioService</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 上传文件到MinIO</span>
    <span class="token keyword">void</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> objectName<span class="token punctuation">,</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 分片上传支持大文件</span>
    <span class="token keyword">void</span> <span class="token function">uploadChunk</span><span class="token punctuation">(</span><span class="token class-name">String</span> objectName<span class="token punctuation">,</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token keyword">int</span> chunkIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 合并分片文件</span>
    <span class="token keyword">void</span> <span class="token function">mergeChunks</span><span class="token punctuation">(</span><span class="token class-name">String</span> objectName<span class="token punctuation">,</span> <span class="token keyword">int</span> chunkCount<span class="token punctuation">,</span> <span class="token class-name">String</span> userId<span class="token punctuation">,</span> <span class="token class-name">String</span> fileId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 获取文件输入流</span>
    <span class="token class-name">InputStream</span> <span class="token function">getFileInputStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> objectName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 检查文件是否存在</span>
    <span class="token keyword">boolean</span> <span class="token function">fileExists</span><span class="token punctuation">(</span><span class="token class-name">String</span> objectName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>存储优化策略：</strong></p>
<ul>
<li><strong>分片上传</strong>：支持大文件断点续传</li>
<li><strong>文件去重</strong>：基于MD5哈希值避免重复存储</li>
<li><strong>缓存机制</strong>：Redis缓存热点文件元数据</li>
<li><strong>CDN加速</strong>：静态资源通过Nginx缓存</li>
</ul>
<h3 id="2-文件分享机制"><a href="#2-文件分享机制" class="headerlink" title="2. 文件分享机制"></a>2. 文件分享机制</h3><p>实现<strong>安全可控</strong>的文件分享功能，支持提取码和过期时间：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 文件分享控制器 - 核心分享逻辑
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/file"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileInfoController</span> <span class="token punctuation">&#123;</span>
    
    <span class="token comment">/**
     * 创建文件分享链接
     * 支持自定义提取码和过期时间
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/shareFile"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@LoginValidator</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">shareFile</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">ShareDTO</span> shareDTO<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SessionWebUserVO</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SessionWebUserVO</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 验证文件所有权</span>
        <span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> fileInfoService<span class="token punctuation">.</span><span class="token function">getOne</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileInfo</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">FileInfo</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span> shareDTO<span class="token punctuation">.</span><span class="token function">getFileId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">FileInfo</span><span class="token operator">::</span><span class="token function">getUserId</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>fileInfo <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BizException</span><span class="token punctuation">(</span><span class="token string">"文件不存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 生成分享令牌和提取码</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> <span class="token class-name">StringTools</span><span class="token punctuation">.</span><span class="token function">getRandomString</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> code <span class="token operator">=</span> shareDTO<span class="token punctuation">.</span><span class="token function">getExtractCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> expire <span class="token operator">=</span> shareDTO<span class="token punctuation">.</span><span class="token function">getExpireHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> shareDTO<span class="token punctuation">.</span><span class="token function">getExpireHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 构建下载信息DTO</span>
        <span class="token class-name">DownloadFileDTO</span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DownloadFileDTO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dto<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dto<span class="token punctuation">.</span><span class="token function">setFilename</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dto<span class="token punctuation">.</span><span class="token function">setFilePath</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span><span class="token function">getFilePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dto<span class="token punctuation">.</span><span class="token function">setExtractCode</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 存储到Redis，设置过期时间</span>
        redisComponent<span class="token punctuation">.</span><span class="token function">saveDownloadCode</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> dto<span class="token punctuation">,</span> expire <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"shareUrl"</span><span class="token punctuation">,</span> <span class="token string">"/file/shareDownload/"</span> <span class="token operator">+</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"extractCode"</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"expireTime"</span><span class="token punctuation">,</span> expire <span class="token operator">+</span> <span class="token string">"小时"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">/**
     * 分享文件下载 - 支持未登录访问
     * 验证提取码和过期时间
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/shareDownload/&#123;token&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">shareDownload</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span>
                              <span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> token<span class="token punctuation">,</span> 
                              <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> extractCode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">DownloadFileDTO</span> dto <span class="token operator">=</span> redisComponent<span class="token punctuation">.</span><span class="token function">getDownloadCode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dto <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&#123;\"error\":\"链接已失效\"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token comment">// 验证提取码</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getExtractCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>dto<span class="token punctuation">.</span><span class="token function">getExtractCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dto<span class="token punctuation">.</span><span class="token function">getExtractCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>extractCode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&#123;\"error\":\"提取码错误\"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token comment">// 从MinIO下载文件</span>
        <span class="token class-name">String</span> filePath <span class="token operator">=</span> dto<span class="token punctuation">.</span><span class="token function">getFilePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> filename <span class="token operator">=</span> dto<span class="token punctuation">.</span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minioService<span class="token punctuation">.</span><span class="token function">fileExists</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> minioService<span class="token punctuation">.</span><span class="token function">getFileInputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/x-msdownload; charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            filename <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>filename<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ISO8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Disposition"</span><span class="token punctuation">,</span> <span class="token string">"attachment;filename=\""</span> <span class="token operator">+</span> filename <span class="token operator">+</span> <span class="token string">"\""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">readFileFromStream</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-用户认证与授权"><a href="#3-用户认证与授权" class="headerlink" title="3. 用户认证与授权"></a>3. 用户认证与授权</h3><p>集成<strong>QQ第三方登录</strong>，实现多种认证方式：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 用户控制器 - 认证与授权管理
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInfoController</span> <span class="token punctuation">&#123;</span>
    
    <span class="token comment">/**
     * QQ第三方登录回调处理
     * 实现OAuth2.0标准流程
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/api/qq/callback"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">SessionWebUserVO</span> <span class="token function">qqCallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> param<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">String</span> code <span class="token operator">=</span> param<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 1. 授权码换取访问令牌</span>
        <span class="token class-name">String</span> tokenUrl <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
            <span class="token string">"https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&amp;client_id=%s&amp;client_secret=%s&amp;code=%s&amp;redirect_uri=%s"</span><span class="token punctuation">,</span> 
            qqAppId<span class="token punctuation">,</span> qqAppKey<span class="token punctuation">,</span> code<span class="token punctuation">,</span> qqRedirectUri<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> tokenResp <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>tokenUrl<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 2. 访问令牌换取OpenID</span>
        <span class="token class-name">String</span> accessToken <span class="token operator">=</span> <span class="token function">extractAccessToken</span><span class="token punctuation">(</span>tokenResp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> openIdUrl <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"https://graph.qq.com/oauth2.0/me?access_token=%s"</span><span class="token punctuation">,</span> accessToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> openIdResp <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>openIdUrl<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> openId <span class="token operator">=</span> <span class="token function">extractOpenId</span><span class="token punctuation">(</span>openIdResp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 3. 获取用户信息</span>
        <span class="token class-name">String</span> userInfoUrl <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
            <span class="token string">"https://graph.qq.com/user/get_user_info?access_token=%s&amp;oauth_consumer_key=%s&amp;openid=%s"</span><span class="token punctuation">,</span> 
            accessToken<span class="token punctuation">,</span> qqAppId<span class="token punctuation">,</span> openId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> userInfoResp <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>userInfoUrl<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JSONObject</span> userJson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span>userInfoResp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 4. 查找或创建用户</span>
        <span class="token class-name">UserInfo</span> user <span class="token operator">=</span> userInfoService<span class="token punctuation">.</span><span class="token function">getOne</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">UserInfo</span><span class="token operator">::</span><span class="token function">getQqOpenId</span><span class="token punctuation">,</span> openId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            user <span class="token operator">=</span> <span class="token function">createUserFromQQ</span><span class="token punctuation">(</span>userJson<span class="token punctuation">,</span> openId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            userInfoService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token comment">// 5. 构建会话信息</span>
        <span class="token class-name">SessionWebUserVO</span> vo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SessionWebUserVO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setNickname</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getNickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setAvatar</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getQqAvatar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> vo<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">/**
     * 头像上传与更新
     * 支持MinIO存储和本地文件兼容
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/updateUserAvatar"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@LoginValidator</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateUserAvatar</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">MultipartFile</span> avatar<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SessionWebUserVO</span> userVo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SessionWebUserVO</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> avatarObjectName <span class="token operator">=</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">FILE_FOLDER_AVATAR_NAME</span> <span class="token operator">+</span> userVo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">AVATAR_SUFFIX</span><span class="token punctuation">;</span>
        
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 上传到MinIO</span>
            minioService<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span>avatarObjectName<span class="token punctuation">,</span> avatar<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// 更新数据库</span>
            <span class="token class-name">UserInfo</span> userInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            userInfo<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>userVo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            userInfo<span class="token punctuation">.</span><span class="token function">setAvatar</span><span class="token punctuation">(</span>avatarObjectName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            userInfo<span class="token punctuation">.</span><span class="token function">setQqAvatar</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清除QQ头像</span>
            userInfoService<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// 更新会话</span>
            userVo<span class="token punctuation">.</span><span class="token function">setAvatar</span><span class="token punctuation">(</span>avatarObjectName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">,</span> userVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BizException</span><span class="token punctuation">(</span><span class="token string">"头像更新失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-文件预览系统"><a href="#4-文件预览系统" class="headerlink" title="4. 文件预览系统"></a>4. 文件预览系统</h3><p>支持<strong>多格式文件预览</strong>，包括图片、视频、文档等：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 文件预览控制器 - 多格式预览支持
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/preview/&#123;id&#125;"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">previewFile</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span>
                       <span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@NotBlank</span> <span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">SessionWebUserVO</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SessionWebUserVO</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> fileInfoService<span class="token punctuation">.</span><span class="token function">getOne</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileInfo</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">FileInfo</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">FileInfo</span><span class="token operator">::</span><span class="token function">getUserId</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fileInfo <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    
    <span class="token class-name">String</span> filePath <span class="token operator">=</span> fileInfo<span class="token punctuation">.</span><span class="token function">getFilePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> filename <span class="token operator">=</span> fileInfo<span class="token punctuation">.</span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>minioService<span class="token punctuation">.</span><span class="token function">fileExists</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> minioService<span class="token punctuation">.</span><span class="token function">getFileInputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> contentType <span class="token operator">=</span> <span class="token function">getPreviewContentType</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 检查是否支持预览</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"application/octet-stream"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&#123;\"error\":\"暂不支持该类型文件预览\"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 图片设置缓存</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"image/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token string">"max-age=2592000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">readFileFromStream</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/**
 * 根据文件扩展名获取预览Content-Type
 */</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">getPreviewContentType</span><span class="token punctuation">(</span><span class="token class-name">String</span> filename<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span> suffix <span class="token operator">=</span> <span class="token class-name">StringTools</span><span class="token punctuation">.</span><span class="token function">getFileSuffix</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>suffix<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token string">".jpg"</span><span class="token operator">:</span>
        <span class="token keyword">case</span> <span class="token string">".jpeg"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">"image/jpeg"</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">".png"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">"image/png"</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">".mp4"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">"video/mp4"</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">".pdf"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">"application/pdf"</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">".txt"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">"text/plain"</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">".html"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">"text/html"</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-回收站机制"><a href="#5-回收站机制" class="headerlink" title="5. 回收站机制"></a>5. 回收站机制</h3><p>实现<strong>软删除</strong>和<strong>恢复机制</strong>，保护用户数据：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 回收站控制器 - 文件恢复与彻底删除
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/recycle"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RecycleController</span> <span class="token punctuation">&#123;</span>
    
    <span class="token comment">/**
     * 加载回收站文件列表
     * 按删除时间倒序排列
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/loadRecycleList"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileInfoVO</span><span class="token punctuation">></span></span> <span class="token function">loadRecycleList</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">FileInfoQuery</span> query<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileInfo</span><span class="token punctuation">></span></span> pageParam <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> query<span class="token punctuation">.</span><span class="token function">getLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        query<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">SessionWebUserVO</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        query<span class="token punctuation">.</span><span class="token function">setDeleted</span><span class="token punctuation">(</span><span class="token class-name">FileDelFlagEnums</span><span class="token punctuation">.</span><span class="token constant">RECYCLE</span><span class="token punctuation">.</span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        query<span class="token punctuation">.</span><span class="token function">setOrderBy</span><span class="token punctuation">(</span><span class="token string">"recovery_time desc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> fileInfoService<span class="token punctuation">.</span><span class="token function">pageInfo</span><span class="token punctuation">(</span>pageParam<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">/**
     * 恢复文件到原位置
     * 支持批量恢复
     */</span>
    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">"/recoverFile/&#123;ids&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">recoverFile</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"ids"</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@NotEmpty</span> <span class="token class-name">String</span> ids<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SessionWebUserVO</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SessionWebUserVO</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fileInfoService<span class="token punctuation">.</span><span class="token function">recoverFileBatch</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">/**
     * 彻底删除文件
     * 从数据库和MinIO中永久删除
     */</span>
    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">"/delFile/&#123;ids&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delFile</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"ids"</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@NotEmpty</span> <span class="token class-name">String</span> ids<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SessionWebUserVO</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SessionWebUserVO</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userFileService<span class="token punctuation">.</span><span class="token function">delFileBatch</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ids<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="系统优化与亮点"><a href="#系统优化与亮点" class="headerlink" title="系统优化与亮点"></a>系统优化与亮点</h2><h3 id="1-性能优化策略"><a href="#1-性能优化策略" class="headerlink" title="1. 性能优化策略"></a>1. 性能优化策略</h3><p><strong>缓存架构设计：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * Redis缓存组件 - 多级缓存策略
 */</span>
<span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span><span class="token string">"redisComponent"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisComponent</span> <span class="token punctuation">&#123;</span>
    
    <span class="token comment">// 用户空间使用情况缓存</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveUserSpaceUse</span><span class="token punctuation">(</span><span class="token class-name">String</span> userId<span class="token punctuation">,</span> <span class="token class-name">UserSpaceDTO</span> userSpaceDto<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        redisUtils<span class="token punctuation">.</span><span class="token function">setex</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">REDIS_KEY_USER_SPACE_USE</span> <span class="token operator">+</span> userId<span class="token punctuation">,</span> 
                        userSpaceDto<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">REDIS_KEY_EXPIRE_ONE_DAY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">// 文件下载码缓存（支持自定义过期时间）</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveDownloadCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">,</span> <span class="token class-name">DownloadFileDTO</span> fileDTO<span class="token punctuation">,</span> <span class="token keyword">long</span> expireSeconds<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        redisUtils<span class="token punctuation">.</span><span class="token function">setex</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">REDIS_KEY_DOWNLOAD</span> <span class="token operator">+</span> code<span class="token punctuation">,</span> fileDTO<span class="token punctuation">,</span> expireSeconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">// 临时文件大小统计</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveFileTempSize</span><span class="token punctuation">(</span><span class="token class-name">String</span> userId<span class="token punctuation">,</span> <span class="token class-name">String</span> fileId<span class="token punctuation">,</span> <span class="token class-name">Long</span> fileSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Long</span> currentSize <span class="token operator">=</span> <span class="token function">getFileTempSize</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> fileId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">REDIS_KEY_USER_FILE_TEMP_SIZE</span> <span class="token operator">+</span> userId <span class="token operator">+</span> fileId<span class="token punctuation">;</span>
        redisUtils<span class="token punctuation">.</span><span class="token function">setex</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> currentSize <span class="token operator">+</span> fileSize<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">REDIS_KEY_EXPIRE_ONE_HOUR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>数据库优化：</strong></p>
<ul>
<li><strong>索引优化</strong>：用户ID、文件类型、删除状态等关键字段建立复合索引</li>
<li><strong>分页查询</strong>：MyBatis Plus分页插件，避免全表扫描</li>
<li><strong>连接池配置</strong>：HikariCP高性能连接池</li>
</ul>
<h3 id="2-安全机制设计"><a href="#2-安全机制设计" class="headerlink" title="2. 安全机制设计"></a>2. 安全机制设计</h3><p><strong>文件访问控制：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 登录验证切面 - 统一权限控制
 */</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginAspect</span> <span class="token punctuation">&#123;</span>
    
    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">"@annotation(loginValidator)"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">around</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> point<span class="token punctuation">,</span> <span class="token class-name">LoginValidator</span> loginValidator<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>loginValidator<span class="token punctuation">.</span><span class="token function">validated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 验证用户登录状态</span>
            <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> <span class="token function">getHttpSession</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SessionWebUserVO</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SessionWebUserVO</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BizException</span><span class="token punctuation">(</span><span class="token class-name">ResponseCode</span><span class="token punctuation">.</span><span class="token constant">CODE_901</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> point<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>数据加密存储：</strong></p>
<ul>
<li><strong>密码加密</strong>：MD5 + 盐值加密</li>
<li><strong>文件路径</strong>：UUID生成唯一标识</li>
<li><strong>分享链接</strong>：32位随机字符串</li>
</ul>
<h3 id="3-微服务架构设计"><a href="#3-微服务架构设计" class="headerlink" title="3. 微服务架构设计"></a>3. 微服务架构设计</h3><p><strong>模块化设计：</strong></p>
<pre class="line-numbers language-none"><code class="language-none">easypan-server&#x2F;
├── common&#x2F;                 # 公共模块
│   └── common-util&#x2F;        # 工具类库
├── server&#x2F;                # 主服务模块
│   ├── controller&#x2F;        # 控制器层
│   ├── service&#x2F;          # 业务逻辑层
│   ├── mapper&#x2F;           # 数据访问层
│   └── entity&#x2F;           # 实体类<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>依赖管理：</strong></p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- 父POM统一版本管理 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springboot.version</span><span class="token punctuation">></span></span>2.6.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springboot.version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mysql.version</span><span class="token punctuation">></span></span>8.0.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mysql.version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mybatis-plus.version</span><span class="token punctuation">></span></span>3.4.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mybatis-plus.version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fastjson.version</span><span class="token punctuation">></span></span>2.0.21<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fastjson.version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="技术亮点总结"><a href="#技术亮点总结" class="headerlink" title="技术亮点总结"></a>技术亮点总结</h2><h3 id="1-架构设计亮点"><a href="#1-架构设计亮点" class="headerlink" title="1. 架构设计亮点"></a>1. 架构设计亮点</h3><ul>
<li><strong>分层架构</strong>：Controller-Service-Mapper清晰分层</li>
<li><strong>模块化设计</strong>：common-util工具库独立打包</li>
<li><strong>缓存策略</strong>：Redis多级缓存提升性能</li>
<li><strong>存储分离</strong>：MinIO对象存储 + MySQL元数据</li>
</ul>
<h3 id="2-功能实现亮点"><a href="#2-功能实现亮点" class="headerlink" title="2. 功能实现亮点"></a>2. 功能实现亮点</h3><ul>
<li><strong>分片上传</strong>：支持大文件断点续传</li>
<li><strong>文件分享</strong>：提取码 + 过期时间双重保护</li>
<li><strong>第三方登录</strong>：QQ OAuth2.0标准实现</li>
<li><strong>文件预览</strong>：多格式预览支持</li>
<li><strong>回收站机制</strong>：软删除 + 恢复功能</li>
</ul>
<h3 id="3-性能优化亮点"><a href="#3-性能优化亮点" class="headerlink" title="3. 性能优化亮点"></a>3. 性能优化亮点</h3><ul>
<li><strong>连接池优化</strong>：HikariCP高性能连接池</li>
<li><strong>缓存策略</strong>：Redis缓存热点数据</li>
<li><strong>静态资源</strong>：Nginx缓存 + CDN加速</li>
<li><strong>数据库优化</strong>：复合索引 + 分页查询</li>
</ul>
<h3 id="4-安全机制亮点"><a href="#4-安全机制亮点" class="headerlink" title="4. 安全机制亮点"></a>4. 安全机制亮点</h3><ul>
<li><strong>权限控制</strong>：AOP切面统一验证</li>
<li><strong>数据加密</strong>：密码MD5加密存储</li>
<li><strong>文件隔离</strong>：用户文件路径隔离</li>
<li><strong>访问控制</strong>：分享链接权限验证</li>
</ul>
<h2 id="学习收获与技能提升"><a href="#学习收获与技能提升" class="headerlink" title="学习收获与技能提升"></a>学习收获与技能提升</h2><h3 id="技术能力提升"><a href="#技术能力提升" class="headerlink" title="技术能力提升"></a>技术能力提升</h3><ol>
<li><strong>Spring Boot微服务架构</strong>：掌握企业级应用开发模式</li>
<li><strong>对象存储技术</strong>：MinIO分布式存储实践</li>
<li><strong>缓存架构设计</strong>：Redis多级缓存策略</li>
<li><strong>第三方集成</strong>：OAuth2.0标准实现</li>
<li><strong>文件处理技术</strong>：分片上传、转码、预览</li>
</ol>
<h3 id="系统设计能力"><a href="#系统设计能力" class="headerlink" title="系统设计能力"></a>系统设计能力</h3><ol>
<li><strong>架构设计</strong>：分层架构、模块化设计</li>
<li><strong>性能优化</strong>：缓存策略、数据库优化</li>
<li><strong>安全设计</strong>：权限控制、数据加密</li>
<li><strong>用户体验</strong>：文件预览、分享机制</li>
</ol>
<h3 id="工程实践能力"><a href="#工程实践能力" class="headerlink" title="工程实践能力"></a>工程实践能力</h3><ol>
<li><strong>代码规范</strong>：统一异常处理、响应格式</li>
<li><strong>测试驱动</strong>：单元测试、集成测试</li>
<li><strong>部署运维</strong>：Docker容器化、Nginx配置</li>
<li><strong>监控告警</strong>：日志管理、性能监控</li>
</ol>
<p>通过EasyPan云盘系统的设计与实现，深入理解了现代Web应用的全栈开发模式，掌握了微服务架构、对象存储、缓存设计等核心技术，为后续大型项目开发奠定了坚实基础。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://huangzhongqi978.top">HuangZhongqi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://huangzhongqi978.top/2024/12/24/EasyPan%E4%BA%91%E7%9B%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/">https://huangzhongqi978.top/2024/12/24/EasyPan%E4%BA%91%E7%9B%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://huangzhongqi978.top" target="_blank">奇点智库 SingularityMind</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring-Boot/">Spring Boot</a><a class="post-meta__tags" href="/tags/Vue-js/">Vue.js</a><a class="post-meta__tags" href="/tags/MinIO/">MinIO</a><a class="post-meta__tags" href="/tags/Redis/">Redis</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E5%AD%98%E5%82%A8/">云存储</a><a class="post-meta__tags" href="/tags/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/">文件管理</a><a class="post-meta__tags" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/">微服务架构</a></div><div class="post-share"><div class="social-share" data-image="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162009784.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>如果觉得文章不错，欢迎打赏支持！</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/alipay-qrcode.png" target="_blank"><img class="post-qr-code-img" src="/img/alipay-qrcode.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li><li class="reward-item"><a href="/img/wechat-qrcode.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat-qrcode.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/01/27/AI%E6%99%BA%E8%83%BD%E7%AD%94%E9%A2%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="基于Spring Cloud与Vue3的AI智能答题系统"><img class="cover" src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162047789.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post" referrerpolicy="no-referrer"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">基于Spring Cloud与Vue3的AI智能答题系统</div></div><div class="info-2"><div class="info-item-1">基于Spring Cloud微服务架构的AI智能答题系统，集成了现代分布式技术栈与人工智能能力，为用户提供智能化的面试题练习与AI辅助答题服务。系统采用云原生架构设计，具备高可用、高并发、可扩展的特性。   系统概述本系统是一个基于Spring Cloud微服务架构的AI智能答题平台，旨在为用户提供智能化的面试题练习服务。系统集成了OpenAI大语言模型、阿里云语音合成、分布式消息队列等先进技术，构建了完整的智能答题生态。 核心特性 智能AI答题：集成OpenAI GPT模型，提供智能题目生成与答案评估 多模态交互：支持文本、语音等多种交互方式 分布式架构：基于Spring Cloud微服务架构，支持水平扩展 云原生部署：集成Nacos配置中心、Redis缓存、MinIO对象存储 智能审核：AI自动审核用户提交的题目内容  系统架构设计整体架构图graph TB     %% 用户层     subgraph "用户层"         A[Web前端]         B[移动端H5]         C[微信小程序]     end      %% 网关层     subgr...</div></div></div></a><a class="pagination-related" href="/2024/12/19/%E6%B5%B7%E5%85%B3%E9%9B%86%E8%A3%85%E7%AE%B1%E9%93%85%E5%B0%81%E9%94%81%E8%AF%86%E5%88%AB%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="YOLOv8海关集装箱铅封锁识别系统设计与实现"><img class="cover" src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103161133558.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post" referrerpolicy="no-referrer"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">YOLOv8海关集装箱铅封锁识别系统设计与实现</div></div><div class="info-2"><div class="info-item-1">模型海关集装箱铅封锁识别   海关集装箱铅封锁识别系统设计与实现系统概述本系统基于YOLOv8深度学习框架，结合PyQt5图形界面技术，构建了一套完整的海关集装箱铅封锁自动识别系统。系统采用端到端的深度学习架构，能够对图片、视频和实时摄像头输入进行高精度目标检测，实现铅封锁的自动识别、定位和结果可视化展示。该系统在海关监管领域具有重要的实用价值，能够显著提升集装箱安全检查的效率和准确性。 系统架构设计整体架构系统采用分层模块化设计，遵循软件工程的最佳实践，主要包含以下核心模块：  模型推理模块：基于YOLOv8的目标检测引擎，负责深度学习模型的加载、推理和结果解析 用户界面模块：PyQt5构建的图形用户界面，提供直观的人机交互体验 图像处理模块：OpenCV图像预处理和后处理，包括图像增强、格式转换和可视化渲染 数据管理模块：检测结果的存储和管理，支持多种数据格式的导入导出 多线程处理模块：异步视频处理和保存，确保界面响应性和处理效率 配置管理模块：系统参数和模型配置的统一管理 异常处理模块：完善的错误处理和资源管理机制  技术栈 深度学习框架：YOLOv8 (Ultralyti...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/06/15/%E5%A9%9A%E6%81%8B%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/" title="基于Django+Vue的婚姻法知识图谱问答系统"><img class="cover" src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103161244190.png" alt="cover" referrerpolicy="no-referrer"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-15</div><div class="info-item-2">基于Django+Vue的婚姻法知识图谱问答系统</div></div><div class="info-2"><div class="info-item-1">本项目构建了一个集用户管理、内容发布、智能推荐、消息交互于一体的现代化婚恋平台。系统采用前后端分离架构，后端基于Django RESTful API，前端采用Vue.js+Element UI，并集成Neo4j图数据库和百度AI服务，实现了智能化的用户匹配和内容推荐功能。   技术架构设计整体架构系统采用经典的三层架构模式，结合微服务思想进行模块化设计：  表现层：Vue.js + Element UI 响应式前端界面 业务逻辑层：Django RESTful API 服务层 数据持久层：MySQL + Neo4j 混合数据库架构  核心技术栈后端技术栈：  Django 2.2.8 - Web框架 MySQL - 关系型数据库 Neo4j - 图数据库 JWT - 身份认证 百度AI API - 智能问答  前端技术栈：  Vue.js 2.6.11 - 前端框架 Element UI 2.15.6 - UI组件库 Vue Router 3.5.2 - 路由管理 Axios 0.21.1 - HTTP客户端 ECharts 4.8.0 - 数据可视化  核心功能模块1. 用户管...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://gitee.com/huangzhongqi776/my-images/raw/master/ff71db1967b4c412f794ffe33ef624f.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/ referrerpolicy="no-referrer"></div><div class="author-info-name">HuangZhongqi</div><div class="author-info-description">Deep Learning & Computer Vision</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">48</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Huangzhongqi978"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Huangzhongqi978" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://twitter.com/" target="_blank" title="Twitter"><i class="fab fa-twitter" style="color: #1da1f2;"></i></a><a class="social-icon" href="https://linkedin.com/in/huangzhongqi" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0077b5;"></i></a><a class="social-icon" href="mailto:huangzhongqi978@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon qr-trigger" href="javascript:void(0)" title="WeChat" data-qr-src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251005125834859.png" data-qr-type="WeChat"><i class="fab fa-weixin" style="color: #07c160;"></i></a><a class="social-icon qr-trigger" href="javascript:void(0)" title="QQ" data-qr-src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251005125800207.png" data-qr-type="QQ"><i class="fab fa-qq" style="color: #12b7f5;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">奇点智库 - 人工智能技术博客与文档，分享深度学习、NLP、计算机视觉技术</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.</span> <span class="toc-text">系统架构设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E6%A0%88%E9%80%89%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">技术栈选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="toc-number">1.2.</span> <span class="toc-text">系统架构图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.</span> <span class="toc-text">核心功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E6%9E%B6%E6%9E%84"><span class="toc-number">2.1.</span> <span class="toc-text">1. 文件存储架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%96%87%E4%BB%B6%E5%88%86%E4%BA%AB%E6%9C%BA%E5%88%B6"><span class="toc-number">2.2.</span> <span class="toc-text">2. 文件分享机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83"><span class="toc-number">2.3.</span> <span class="toc-text">3. 用户认证与授权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%96%87%E4%BB%B6%E9%A2%84%E8%A7%88%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.4.</span> <span class="toc-text">4. 文件预览系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%9B%9E%E6%94%B6%E7%AB%99%E6%9C%BA%E5%88%B6"><span class="toc-number">2.5.</span> <span class="toc-text">5. 回收站机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96%E4%B8%8E%E4%BA%AE%E7%82%B9"><span class="toc-number">3.</span> <span class="toc-text">系统优化与亮点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">3.1.</span> <span class="toc-text">1. 性能优化策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E8%AE%BE%E8%AE%A1"><span class="toc-number">3.2.</span> <span class="toc-text">2. 安全机制设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">3.3.</span> <span class="toc-text">3. 微服务架构设计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E4%BA%AE%E7%82%B9%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">技术亮点总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%BA%AE%E7%82%B9"><span class="toc-number">4.1.</span> <span class="toc-text">1. 架构设计亮点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%BA%AE%E7%82%B9"><span class="toc-number">4.2.</span> <span class="toc-text">2. 功能实现亮点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E4%BA%AE%E7%82%B9"><span class="toc-number">4.3.</span> <span class="toc-text">3. 性能优化亮点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E4%BA%AE%E7%82%B9"><span class="toc-number">4.4.</span> <span class="toc-text">4. 安全机制亮点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%94%B6%E8%8E%B7%E4%B8%8E%E6%8A%80%E8%83%BD%E6%8F%90%E5%8D%87"><span class="toc-number">5.</span> <span class="toc-text">学习收获与技能提升</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E8%83%BD%E5%8A%9B%E6%8F%90%E5%8D%87"><span class="toc-number">5.1.</span> <span class="toc-text">技术能力提升</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%83%BD%E5%8A%9B"><span class="toc-number">5.2.</span> <span class="toc-text">系统设计能力</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5%E8%83%BD%E5%8A%9B"><span class="toc-number">5.3.</span> <span class="toc-text">工程实践能力</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/10/Yolo11%E4%BA%A4%E9%80%9A%E6%A0%87%E5%BF%97%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/" title="Yolo11交通标志检测系统"><img src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251005131157954.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Yolo11交通标志检测系统"/ referrerpolicy="no-referrer"></a><div class="content"><a class="title" href="/2025/09/10/Yolo11%E4%BA%A4%E9%80%9A%E6%A0%87%E5%BF%97%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/" title="Yolo11交通标志检测系统">Yolo11交通标志检测系统</a><time datetime="2025-09-10T07:59:31.000Z" title="发表于 2025-09-10 15:59:31">2025-09-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/05/technical_report/" title="基于LLM和RAG的领克汽车智能问答系统"><img src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103160846304.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于LLM和RAG的领克汽车智能问答系统"/ referrerpolicy="no-referrer"></a><div class="content"><a class="title" href="/2025/09/05/technical_report/" title="基于LLM和RAG的领克汽车智能问答系统">基于LLM和RAG的领克汽车智能问答系统</a><time datetime="2025-09-05T05:59:31.000Z" title="发表于 2025-09-05 13:59:31">2025-09-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/15/p2%E6%A3%80%E6%B5%8B%E5%A4%B4%E4%BA%A4%E9%80%9A%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/" title="添加P2检测头与SE机制的YOLOv8交通车辆与道路监检测系统优化"><img src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103161622681.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="添加P2检测头与SE机制的YOLOv8交通车辆与道路监检测系统优化"/ referrerpolicy="no-referrer"></a><div class="content"><a class="title" href="/2025/07/15/p2%E6%A3%80%E6%B5%8B%E5%A4%B4%E4%BA%A4%E9%80%9A%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F/" title="添加P2检测头与SE机制的YOLOv8交通车辆与道路监检测系统优化">添加P2检测头与SE机制的YOLOv8交通车辆与道路监检测系统优化</a><time datetime="2025-07-14T16:00:00.000Z" title="发表于 2025-07-15 00:00:00">2025-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/15/%E5%A9%9A%E6%81%8B%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/" title="基于Django+Vue的婚姻法知识图谱问答系统"><img src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103161244190.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于Django+Vue的婚姻法知识图谱问答系统"/ referrerpolicy="no-referrer"></a><div class="content"><a class="title" href="/2025/06/15/%E5%A9%9A%E6%81%8B%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/" title="基于Django+Vue的婚姻法知识图谱问答系统">基于Django+Vue的婚姻法知识图谱问答系统</a><time datetime="2025-06-15T02:30:00.000Z" title="发表于 2025-06-15 10:30:00">2025-06-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/27/AI%E6%99%BA%E8%83%BD%E7%AD%94%E9%A2%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="基于Spring Cloud与Vue3的AI智能答题系统"><img src="https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162047789.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于Spring Cloud与Vue3的AI智能答题系统"/ referrerpolicy="no-referrer"></a><div class="content"><a class="title" href="/2025/01/27/AI%E6%99%BA%E8%83%BD%E7%AD%94%E9%A2%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="基于Spring Cloud与Vue3的AI智能答题系统">基于Spring Cloud与Vue3的AI智能答题系统</a><time datetime="2025-01-27T02:00:00.000Z" title="发表于 2025-01-27 10:00:00">2025-01-27</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://gitee.com/huangzhongqi776/my-images/raw/master/20251103162009784.png);"><div class="footer-other"><div class="footer-copyright"></div><div class="footer_custom_text"><div style="line-height: 1.8;">
  <div>© 2025 HuangZhongqi</div>
  <div style="margin-top: 8px;">
    <a href="https://beian.miit.gov.cn" target="_blank" rel="noopener" style="color: inherit; text-decoration: none;">
      <img src="/img/gongxin.png" alt="ICP备案" style="height: 16px; vertical-align: middle; margin-right: 4px;">ICP备案鲁ICP备2025190459号
    </a>
  </div>
  <div style="margin-top: 8px;">
    <a href="http://www.beian.gov.cn" target="_blank" rel="noopener" style="color: inherit; text-decoration: none;">
      <img src="/img/备案图标.png" alt="公安备案" style="height: 16px; vertical-align: middle; margin-right: 4px;">公安备案鲁公网安备37028102001667号
    </a>
  </div>
  <div style="margin-top: 8px;">Copyright © 2022 - 2025 Huang Zhongqi. All Rights Reserved. 黄中奇版权所有</div>
</div>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><script src="/js/qr-modal.js"></script><script src="/js/reading-progress.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'Huangzhongqi978/blog-commnts',
      'data-repo-id': 'R_kgDOQOt6kA',
      'data-category-id': 'DIC_kwDOQOt6kM4CxaSm',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script src="/js/mouse-trail.js"></script><script src="/js/background-check.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/fireworks.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/click-show-text.min.js" data-mobile="false" data-text="好棒！,加油！,很棒！,点赞！,太棒了！,优秀！,精彩！,赞！" data-fontsize="15px" data-random="true" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div></body></html>